/*!
 *  build: 杭州数蛙科技有限公司 
 *  copyright: dgiot-dashboard 
 *  author: h7ml(h7ml@qq.com) 
 *  time: Wed Nov 17 2021 04:11:49 GMT+0000 (Coordinated Universal Time)
 */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0c1521e2"],{"09bb":function(e,t,a){"use strict";a("cab1")},"0dc8":function(e,t,a){"use strict";a("1af7")},"1af7":function(e,t,a){},"1d8d":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"standard"},[a("div",{staticClass:"devicesright",staticStyle:{padding:"20px"}},[a("el-form",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline,size:"small"}},[a("el-form-item",{attrs:{label:"标准类型"}},[a("el-select",{attrs:{placeholder:"选择标准类型"},model:{value:e.formInline.model,callback:function(t){e.$set(e.formInline,"model",t)},expression:"formInline.model"}},[a("el-option",{attrs:{label:"性能检测",value:"性能检测"}})],1)],1),a("el-form-item",{attrs:{label:"标准类别"}},[a("el-select",{attrs:{placeholder:"选择标准类别"},model:{value:e.formInline.standard,callback:function(t){e.$set(e.formInline,"standard",t)},expression:"formInline.standard"}},e._l(e.standard,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"检测名称"}},[a("el-input",{attrs:{placeholder:"请输入检测名称"},model:{value:e.formInline.name,callback:function(t){e.$set(e.formInline,"name",t)},expression:"formInline.name"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.getStandardFromDict(0)}}},[e._v(" 查询 ")]),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.reset.apply(null,arguments)}}},[e._v(" 重置 ")])],1)],1),a("div",{staticClass:"adddevices"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.addStandard}},[e._v(" 新增检测标准 ")])],1),a("div",{staticClass:"tableblock"},[a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.standardList,"tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{label:"序号",type:"index",width:"50"}}),a("el-table-column",{attrs:{label:"检测标准名称",prop:"data.name",width:"200"}}),a("el-table-column",{attrs:{label:"标准类型",prop:"data.model"}}),a("el-table-column",{attrs:{label:"适用产品",prop:"data.product",width:"200"}}),a("el-table-column",{attrs:{label:"标准类别",prop:"data.standard",width:"200"}}),a("el-table-column",{attrs:{label:"标准发行单位",prop:"data.client",width:"250"}}),a("el-table-column",{attrs:{label:"标准发行时间",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.$timestampToTime(t.row.data.start_time)))])]}}])}),a("el-table-column",{attrs:{label:"备注",prop:"data.desc",width:"220"}}),a("el-table-column",{attrs:{label:"创建时间",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.$timestampToTime(t.row.createdAt)))])]}}])}),a("el-table-column",{attrs:{label:"检测标准管理",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-dropdown",{attrs:{"split-button":"",type:"primary"},on:{click:function(a){return e.editorReport(t.row)}}},[e._v(" 编辑 "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{nativeOn:{click:function(a){return e.addChildReport(t.row)}}},[e._v(" 子项新增 ")]),a("el-dropdown-item",[a("router-link",{attrs:{target:"_blank",to:"/pdf/download"}},[e._v(" 下载 ")])],1),a("el-dropdown-item",{nativeOn:{click:function(a){return e.childManage(t.row)}}},[e._v(" 子项管理 ")]),a("el-dropdown-item",{nativeOn:{click:function(a){return e.deleteReport(t.row.objectId)}}},[e._v(" 删除 ")])],1)],1)]}}])})],1)],1),a("div",{staticClass:"pageblock"},[a("el-pagination",{attrs:{layout:"total, sizes, prev, pager, next, jumper","page-size":e.pagesize,"page-sizes":[10,20,30,50],total:e.standardList.length},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1)],1),a("el-dialog",{attrs:{"append-to-body":!0,title:e.actionTypeTxt+"检验标准",visible:e.dialogVisible,width:"60%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",{staticClass:"addContent"},[a("el-form",{ref:"standardFormRef",attrs:{model:e.standardFormModel,rules:e.formrule}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"检验标准名称","label-width":e.formLabelWidth,prop:"name"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"检验标准名称"},model:{value:e.standardFormModel.name,callback:function(t){e.$set(e.standardFormModel,"name",t)},expression:"standardFormModel.name"}})],1),a("el-form-item",{attrs:{label:"适用产品","label-width":e.formLabelWidth,prop:"product"}},[a("el-select",{attrs:{placeholder:"选择适用产品"},model:{value:e.standardFormModel.product,callback:function(t){e.$set(e.standardFormModel,"product",t)},expression:"standardFormModel.product"}},e._l(e.pumpmodel,(function(e,t){return a("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1),a("el-form-item",{attrs:{label:"标准类型","label-width":e.formLabelWidth,prop:"model"}},[a("el-select",{attrs:{placeholder:"选择标准类型"},model:{value:e.standardFormModel.model,callback:function(t){e.$set(e.standardFormModel,"model",t)},expression:"standardFormModel.model"}},[a("el-option",{attrs:{label:"性能检测",value:"性能检测"}})],1)],1),a("el-form-item",{attrs:{label:"备注信息","label-width":e.formLabelWidth}},[a("el-input",{attrs:{placeholder:"请输入标准备注信息",rows:4,type:"textarea"},model:{value:e.standardFormModel.desc,callback:function(t){e.$set(e.standardFormModel,"desc",t)},expression:"standardFormModel.desc"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"检测标准文号","label-width":e.formLabelWidth,prop:"inspection_number"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入检测标准文号"},model:{value:e.standardFormModel.inspection_number,callback:function(t){e.$set(e.standardFormModel,"inspection_number",t)},expression:"standardFormModel.inspection_number"}})],1),a("el-form-item",{attrs:{label:"标准类别","label-width":e.formLabelWidth,prop:"standard"}},[a("el-select",{attrs:{placeholder:"选择标准类别"},model:{value:e.standardFormModel.standard,callback:function(t){e.$set(e.standardFormModel,"standard",t)},expression:"standardFormModel.standard"}},e._l(e.standard,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"标准发行单位","label-width":e.formLabelWidth,prop:"client"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入标准发行单位"},model:{value:e.standardFormModel.client,callback:function(t){e.$set(e.standardFormModel,"client",t)},expression:"standardFormModel.client"}})],1),a("el-form-item",{attrs:{label:"标准发行时间","label-width":e.formLabelWidth}},[a("el-date-picker",{attrs:{placeholder:"选择日期",type:"date","value-format":"timestamp"},model:{value:e.standardFormModel.start_time,callback:function(t){e.$set(e.standardFormModel,"start_time",t)},expression:"standardFormModel.start_time"}})],1),a("el-form-item",{attrs:{label:"标准源文件","label-width":e.formLabelWidth,required:""}},[a("el-input",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{placeholder:"请输入内容"},model:{value:e.standardFormModel.filesrc,callback:function(t){e.$set(e.standardFormModel,"filesrc",t)},expression:"standardFormModel.filesrc"}},[a("template",{slot:"append"},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v(" 点击上传 ")]),a("form",{ref:"uploadform",staticStyle:{position:"absolute"},attrs:{enctype:"multipart/form-data",method:"POST"}},[a("input",{staticStyle:{position:"relative",top:"-30px","z-index":"5",width:"100px",height:"40px",cursor:"pointer",opacity:"0"},attrs:{type:"file"},on:{change:function(t){return e.upload(t)}}})])],1)],2)],1)],1)],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.postStandardToDict("standardFormRef")}}},[e._v(" 确 定 ")])],1)]),a("el-dialog",{attrs:{"append-to-body":!0,title:"标准子项新增",visible:e.dialogReport,width:"50%"},on:{"update:visible":function(t){e.dialogReport=t}}},[a("el-form",{ref:"dynamicValidateForm",staticClass:"demo-dynamic",attrs:{"label-width":"100px",model:e.dynamicValidateForm,size:"small"}},[e._l(e.dynamicValidateForm.domains,(function(t,n){return a("el-row",{key:t.key},[a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"子项名称"+(n+1),prop:"domains."+n+".name",rules:{required:!0,message:"子项目名称"+(n+1)+"不能为空",trigger:"blur"}}},[a("el-input",{model:{value:t.name,callback:function(a){e.$set(t,"name",a)},expression:"domain.name"}})],1)],1),a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"保证值"+(n+1),prop:"domains."+n+".title",rules:{required:!0,message:"保证值"+(n+1)+"不能为空",trigger:"blur"}}},[a("el-input",{model:{value:t.title,callback:function(a){e.$set(t,"title",a)},expression:"domain.title"}})],1)],1),a("el-col",{staticStyle:{float:"right"},attrs:{span:4}},[a("el-button",{staticStyle:{"margin-left":"5px"},attrs:{size:"small",type:"danger"},on:{click:function(a){return a.preventDefault(),e.removeDomain(t)}}},[e._v(" 删除 ")])],1)],1)})),a("el-form-item",[a("el-button",{on:{click:e.addDomain}},[e._v(" 新增子项 ")])],1)],2),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogReport=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.reportChildren("dynamicValidateForm")}}},[e._v(" 确 定 ")])],1)],1),a("el-dialog",{attrs:{"append-to-body":!0,title:"标准子项管理",visible:e.dialogTableVisible,width:"50%"},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[a("el-table",{staticStyle:{width:"100%","text-align":"center"},attrs:{data:e.childrenData.slice((e.currentPage-1)*e.pageSize,e.currentPage*e.pageSize)}},[a("el-table-column",{attrs:{align:"center",index:function(t){return t+1+(e.currentPage-1)*e.pageSize},label:"序号",type:"index",width:"50"}}),a("el-table-column",{attrs:{align:"center",label:"名称",prop:"name"}}),a("el-table-column",{attrs:{align:"center",label:"保证值",prop:"title"}}),a("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(a){return e.deleteChildren(t.$index)}}},[e._v(" 删除 ")])]}}])})],1),a("div",{staticClass:"block",staticStyle:{"margin-top":"15px"}},[a("el-pagination",{attrs:{align:"center",layout:"total, sizes, prev, pager, next, jumper","page-size":e.pageSize,"page-sizes":[1,5,10,20],total:e.childrenData.length},on:{"current-change":e.handleChildCurrentChange,"size-change":e.handleChildSizeChange}})],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogTableVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.ReportChildrenDelete.apply(null,arguments)}}},[e._v(" 确 定 ")])],1)],1)],1)},r=[],i=a("1da1"),l=(a("96cf"),a("b0c0"),a("d81d"),a("ac1f"),a("1276"),a("c19f"),a("d3b7"),a("5cc69"),a("907a"),a("9a8c"),a("a975"),a("735e"),a("c1ac"),a("d139"),a("3a7b"),a("d5d6"),a("82f8"),a("e91f"),a("60bd"),a("5f96"),a("3280"),a("3fcc"),a("ca91"),a("25a1"),a("cd26"),a("3c5d"),a("2954"),a("649e"),a("219c"),a("170b"),a("b39a"),a("72f7"),a("a434"),a("99af"),a("926a"),a("e0e9")),o={},s={data:function(){return{loading:!1,dialogTableVisible:!1,dialogReport:!1,pumpmodel:["离心泵","潜水泵","混流泵","螺杆泵","轴流泵","旋涡泵","电动泵","蒸汽泵","齿轮泵","罗茨泵","滑片泵","喷射泵","升液泵","电磁泵"],standard:[{label:"国际标准",value:"ITBZ"},{label:"国家标准",value:"GJBZ"},{label:"行业标准",value:"HYBZ"},{label:"企业标准",value:"QYBZ"},{label:"地方标准",value:"DFBZ"},{label:"其他标准",value:"OTHER"}],formLabelWidth:"120px",dialogVisible:!1,departmentid:"",formInline:{name:"",standard:"",model:""},standardList:[],multipleSelection:[],pagesize:10,start:0,total:0,actionTypeTxt:"新增",standardFormModel:{name:"",product:"",inspection_number:"",standard:"",start_time:"",model:"",filesrc:"",desc:"",client:"",reportchildren:[]},formrule:{name:[{required:!0,message:"请输入检测标准名称",trigger:"blur"}],product:[{required:!0,message:"请选择标准适用产品",trigger:"change"}],inspection_number:[{required:!0,message:"请输入检测标准文号",trigger:"blur"}],standard:[{required:!0,message:"请选择标准类别",trigger:"change"}],client:[{required:!0,message:"请输入检测标准发行单位",trigger:"blur"}],model:[{required:!0,message:"请选择标准类型",trigger:"change"}]},departmentlaboratory:[],testbedlist:[],productlist:[],dynamicValidateForm:{domains:[{title:"",key:Date.now(),value:"",name:"",evidenceway:"",assess:""}]},childrenData:[],currentPage:1,pageSize:10}},watch:{dialogVisible:{deep:!0,handler:function(e){e||(this.$refs.standardFormRef.resetFields(),this.standardFormModel.desc="",this.standardFormModel.start_time="",this.standardFormModel.filesrc="",this.standardFormModel.name="",this.standardFormModel.product="",this.standardFormModel.inspection_number="",this.standardFormModel.standard="",this.standardFormModel.model="",this.standardFormModel.client="",this.standardFormModel.reportchildren=[])}}},mounted:function(){this.getStandardFromDict()},methods:{handleChildSizeChange:function(e){this.currentPage=1,this.pageSize=e},handleChildCurrentChange:function(e){this.currentPage=e},returnStandard:function(e){var t="";return this.standard.map((function(a){a.value==e&&(t=a.label)})),t},reset:function(){this.formInline.model="",this.formInline.standard="",this.formInline.name="",this.getStandardFromDict()},getStandardFromDict:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var n,r,i,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return 0==e&&(t.start=0),n=t.$loading({text:"加载中",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),r={where:{type:"inspectionStandard"},order:"-updatedAt"},a.next=5,Object(l["queryDict"])(r);case 5:i=a.sent,o=i.results,n.close(),t.standardList=o;case 9:case"end":return a.stop()}}),a)})))()},handleSelectionChange:function(e){this.multipleSelection=e},handleSizeChange:function(e){this.pagesize=e},handleCurrentChange:function(e){this.start=(e-1)*this.pagesize},addStandard:function(e){this.reportid="",this.dialogVisible=!0},upload:function(e){if(e){var t=e.target.files[0],a=t.name,n=e.target.files[0].type,r=(t.type.split("/")[0],"application/pdf"===n);if(!r)return this.$message({message:"只能上传PDF格式文件",type:"error"}),!1;this.loading=!0;var i=new FileReader;i.readAsDataURL(t);var l=this;i.onloadend=function(){var e=i.result,t=l.dataURItoBlob(e);l.uploadFile(t,a)}}},dataURItoBlob:function(e){for(var t=atob(e.split(",")[1]),a=e.split(",")[0].split(":")[1].split(";")[0],n=new ArrayBuffer(t.length),r=new Uint8Array(n),i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return new Blob([n],{type:a})},uploadFile:function(e,t){var a=this,n=new FormData;n.append("file",e,t),n.append("output","json"),n.append("path",Cookies.get("appids")),n.append("scene",Cookies.get("appids")),n.append("auth_token",Cookies.get("access_token_pump"));this.$http.post(Cookies.get("fileserver"),n).then((function(e){e&&(a.loading=!1,a.standardFormModel.filesrc=e.body.url)})).catch((function(e){a.loading=!1,a.$message.error(e)}))},postStandardToDict:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return t.$message.error("有必填项未填写"),!1;if(""!=t.standardFormModel.filesrc){var a=t.$store.state.user.roles[0]["name"];if(a){var n="role:"+a,r={};r[n]={read:!0,write:!0},t.$axiosWen.post("classes/Dict",{ACL:r,type:"inspectionStandard",data:t.standardFormModel,key:""}).then((function(e){e&&(t.$message({type:"success",message:"".concat(t.actionTypeTxt,"成功")}),t.dialogVisible=!1,t.getStandardFromDict(),t.$refs.standardFormRef.resetFields(),t.reportid="")})).catch((function(e){t.$message({message:"添加失败"})}))}else t.$message({message:"未获取到角色名"})}else t.$message.error("请上传检验标准PDF文件")}))},editorReport:function(e){this.dialogVisible=!0,this.reportid=e.objectId,this.standardFormModel.name=e.data.name,this.standardFormModel.product=e.data.product,this.standardFormModel.inspection_number=e.data.inspection_number,this.standardFormModel.standard=e.data.standard,this.standardFormModel.start_time=e.data.start_time,this.standardFormModel.model=e.data.model,this.standardFormModel.filesrc=e.data.filesrc,this.standardFormModel.desc=e.data.desc,this.standardFormModel.client=e.data.client,this.standardFormModel.reportchildren=e.data.reportchildren},deleteReport:function(e){var t=this;this.$confirm("此操作将永久此检测标准, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(){t.$axiosWen.delete("classes/Dict/"+e).then((function(e){e&&(t.$message({type:"success",message:"删除成功!"}),t.getStandardFromDict())}))}))},addDomain:function(){this.dynamicValidateForm.domains.push({title:"",key:Date.now(),value:"",name:"",evidenceway:"",assess:""})},removeDomain:function(e){var t=this.dynamicValidateForm.domains.indexOf(e);-1!==t&&this.dynamicValidateForm.domains.splice(t,1)},addChildReport:function(e){this.dialogReport=!0,this.reportid=e.id,this.standardFormModel.name=e.data.name,this.standardFormModel.product=e.data.product,this.standardFormModel.inspection_number=e.data.inspection_number,this.standardFormModel.standard=e.data.standard,this.standardFormModel.start_time=e.data.start_time,this.standardFormModel.model=e.data.model,this.standardFormModel.filesrc=e.data.filesrc,this.standardFormModel.desc=e.data.desc,this.standardFormModel.client=e.data.client,this.standardFormModel.reportchildren=e.data.reportchildren},reportChildren:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return t.$message.error("请填写完整"),!1;var a=Parse.Object.extend("InspectionStandard"),n=new a;n.id=t.reportid,t.form.reportchildren=t.form.reportchildren.concat(t.dynamicValidateForm.domains),n.set("data",t.form),n.save().then((function(e){t.$message.success("新增成功"),t.dialogReport=!1,t.dynamicValidateForm.domains=[{title:"",key:Date.now(),value:"",name:"",evidenceway:"",assess:""}]}))}))},childManage:function(e){this.childrenData=e.data.reportchildren.concat([]),this.dialogTableVisible=!0,this.reportid=e.id},deleteChildren:function(e){this.childrenData.splice(e+(this.currentPage-1)*this.pageSize,1)},ReportChildrenDelete:function(){var e=this;this.$confirm("是否删除标准子项, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t=Parse.Object.extend("InspectionStandard"),a=new t;a.id=e.reportid,o.reportchildren=e.childrenData,a.set("data",o),a.save().then((function(t){t&&(e.$message({type:"success",message:"删除成功!"}),e.dialogTableVisible=!1,e.getStandardFromDict(),e.required="")}))}))}}},d=s,c=(a("0dc8"),a("2877")),u=Object(c["a"])(d,n,r,!1,null,"84ceeb70",null);t["default"]=u.exports},"28c0":function(e,t,a){"use strict";a("395e")},3068:function(e,t,a){"use strict";a("33dc")},"33dc":function(e,t,a){},"395e":function(e,t,a){},6200:function(e,t,a){},a939:function(e,t,a){"use strict";a("6200")},b91d:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"reportmodule"},[a("div",{staticClass:"add"},[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.addmodule.apply(null,arguments)}}},[e._v(" 新 增 ")])],1),a("div",{staticClass:"reportlist"},[a("el-table",{staticStyle:{width:"100%","text-align":"center"},attrs:{data:e.tableData,stripe:""}},[a("el-table-column",{attrs:{align:"center",label:"ID"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.objectId))])]}}])}),a("el-table-column",{attrs:{align:"center",label:"产品名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.data.sample))])]}}])}),a("el-table-column",{attrs:{align:"center",label:"检验类别"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.data.category))])]}}])}),a("el-table-column",{attrs:{align:"center",label:"检验标准"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.data.inspection_standard))])]}}])}),a("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleEdit(t.row.objectId)}}},[e._v(" 详 情 ")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){return e.editorDetail(t.row.objectId)}}},[e._v(" 编 辑 ")]),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDelete(t.row.objectId)}}},[e._v(" 删 除 ")])]}}])})],1),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{layout:"total, sizes, prev, pager, next, jumper","page-size":e.length,"page-sizes":[5,10,20],total:e.total},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1)],1),a("el-dialog",{staticStyle:{"box-sizing":"border-box",padding:"20px"},attrs:{"append-to-body":!0,title:"模板详情",visible:e.dialogTableVisible,width:"50%"},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[a("el-table",{staticStyle:{width:"100%","text-align":"center"},attrs:{border:"",data:e.gridData}},[a("el-table-column",{attrs:{align:"center",label:"id"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{size:"medium"}},[e._v(" "+e._s(t.row.id)+" ")])]}}])}),a("el-table-column",{attrs:{align:"center",label:"检验项目"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.inspecting)+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:"保证值",property:"title"}}),a("el-table-column",{attrs:{align:"center",label:"测试值",property:"value"}}),a("el-table-column",{attrs:{align:"center",label:"评定",property:""}})],1)],1)],1)},r=[],i=(a("a9e3"),a("0a78")),l=a("973c"),o={data:function(){return{tableData:[],total:0,start:0,length:10,dialogTableVisible:!1,gridData:[]}},mounted:function(){this.reportList()},methods:{addmodule:function(){this.$router.push({path:"/reportmodule/module"})},handleEdit:function(e){var t=this;this.dialogTableVisible=!0,Object(l["getReportdetail"])(e).then((function(e){t.gridData=e.data.inspecting})).catch((function(e){}))},handleDelete:function(e){var t=this;this.$confirm("此操作将永久删除此检验标准, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a=Parse.Object.extend("Datas"),n=new Parse.Query(a);n.get(e).then((function(e){e.destroy().then((function(e){t.$message({type:"success",message:"删除成功!"}),t.reportList()}),(function(e){}))}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},reportList:function(){var e=this;Object(l["getReport"])(this.start,this.length).then((function(t){e.tableData=t.data,e.total=t.data.length}))},handleSizeChange:function(e){this.pagesize=e,this.reportList(this.start,this.pagesize)},handleCurrentChange:function(e){this.start=Number(e-1)*Number(this.pagesize),this.reportList(this.start,this.pagesize)},editorDetail:function(e){this.$router.push({path:"/reportmodule/module",query:{id:e}}),Object(i["setToken"])("reportId",e,"sessionStorage")}}},s=o,d=(a("09bb"),a("28c0"),a("2877")),c=Object(d["a"])(s,n,r,!1,null,"5c0dd539",null);t["default"]=c.exports},cab1:function(e,t,a){},fcac:function(e,t,a){"use strict";a.r(t);var n,r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"module"},[a("div",{attrs:{id:"editor_holder"}}),a("el-button",{staticStyle:{"margin-top":"20px"},attrs:{type:"primary"},on:{click:e.addmodule}},[e._v(" 保 存 ")])],1)},i=[],l=(a("d81d"),a("973c")),o=(a("8bbf"),{type:"object",title:"水泵检测模板配置",properties:{sample:{type:"string",description:"产品名称",minLength:10},category:{type:"string",description:"检验类别"},inspection_standard:{type:"string",description:"检验标准"},inspecting:{type:"array",title:"检测名称",items:{type:"object",properties:{inspecting_item:{type:"string",description:"检验项目"},guarantee_value:{type:"array",title:"保证值",format:"table",uniqueItems:!0,items:{type:"object",title:"保证值",properties:{title:{type:"string",description:"保证值"},value:{type:"string",description:"测试值"},assess:{type:"string",description:"评定"},evidenceway:{type:"string",description:"取证方式"},evidence:{type:"string",description:"证据链"}}}}}}}},default:{}});JSONEditor.defaults.options.theme="foundation4";var s={data:function(){return{default:"",reportId:"",editor:""}},mounted:function(){this.getSchema()},methods:{getSchema:function(){if(this.reportId=this.$route.query.id,JSONEditor.defaults.options.show_errors="change",this.reportId){var e=Parse.Object.extend("Datas"),t=new Parse.Query(e);t.get(this.reportId).then((function(e){o.default=e.attributes.data,o.default.inspecting.map((function(e){e.guarantee_value.map((function(e){delete e.id}))})),n=new JSONEditor(document.getElementById("editor_holder"),{schema:o,theme:"foundation4"})}))}else o.default={},n=new JSONEditor(document.getElementById("editor_holder"),{schema:o})},addmodule:function(){var e=this,t=n.validate({});t.length||Object(l["addReport"])(n.getValue(),this.reportId).then((function(t){t&&(e.$message({type:"success",message:"添加成功!"}),e.$router.push({path:"/reportmodule/index"}))})).catch((function(t){e.$message({type:"error",message:t.error})}))}}},d=s,c=(a("3068"),a("a939"),a("2877")),u=Object(c["a"])(d,r,i,!1,null,"539e17a6",null);t["default"]=u.exports}}]);