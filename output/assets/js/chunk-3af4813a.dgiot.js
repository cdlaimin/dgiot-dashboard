/*!
 *  build: 杭州数蛙科技有限公司 
 *  copyright: dgiot-dashboard 
 *  author: h7ml(h7ml@qq.com) 
 *  time: Mon Nov 15 2021 03:38:27 GMT+0000 (Coordinated Universal Time)
 */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3af4813a"],{"1aa3":function(e,t,n){"use strict";n.d(t,"f",(function(){return i})),n.d(t,"b",(function(){return s})),n.d(t,"g",(function(){return r})),n.d(t,"h",(function(){return o})),n.d(t,"i",(function(){return a})),n.d(t,"e",(function(){return h})),n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return c}));class i{constructor(){this.changeType=1}}class s{constructor(e,t,n,i,s){this.ownerId=e,this.lineNumber=t,this.column=n,this.options=i,this.order=s}static applyInjectedText(e,t){if(!t||0===t.length)return e;let n="",i=0;for(const s of t)n+=e.substring(i,s.column-1),i=s.column-1,n+=s.options.content;return n+=e.substring(i),n}static fromDecorations(e){const t=[];for(const n of e)n.options.before&&n.options.before.content.length>0&&t.push(new s(n.ownerId,n.range.startLineNumber,n.range.startColumn,n.options.before,0)),n.options.after&&n.options.after.content.length>0&&t.push(new s(n.ownerId,n.range.endLineNumber,n.range.endColumn,n.options.after,1));return t.sort((e,t)=>e.lineNumber===t.lineNumber?e.column===t.column?e.order-t.order:e.column-t.column:e.lineNumber-t.lineNumber),t}}class r{constructor(e,t,n){this.changeType=2,this.lineNumber=e,this.detail=t,this.injectedText=n}}class o{constructor(e,t){this.changeType=3,this.fromLineNumber=e,this.toLineNumber=t}}class a{constructor(e,t,n,i){this.changeType=4,this.injectedTexts=i,this.fromLineNumber=e,this.toLineNumber=t,this.detail=n}}class h{constructor(){this.changeType=5}}class l{constructor(e,t,n,i){this.changes=e,this.versionId=t,this.isUndoing=n,this.isRedoing=i,this.resultingSelection=null}containsEvent(e){for(let t=0,n=this.changes.length;t<n;t++){const n=this.changes[t];if(n.changeType===e)return!0}return!1}static merge(e,t){const n=[].concat(e.changes).concat(t.changes),i=t.versionId,s=e.isUndoing||t.isUndoing,r=e.isRedoing||t.isRedoing;return new l(n,i,s,r)}}class u{constructor(e){this.changes=e}}class c{constructor(e,t){this.rawContentChangedEvent=e,this.contentChangedEvent=t}merge(e){const t=l.merge(this.rawContentChangedEvent,e.rawContentChangedEvent),n=c._mergeChangeEvents(this.contentChangedEvent,e.contentChangedEvent);return new c(t,n)}static _mergeChangeEvents(e,t){const n=[].concat(e.changes).concat(t.changes),i=t.eol,s=t.versionId,r=e.isUndoing||t.isUndoing,o=e.isRedoing||t.isRedoing,a=e.isFlush||t.isFlush;return{changes:n,eol:i,versionId:s,isUndoing:r,isRedoing:o,isFlush:a}}}},"1e57":function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"e",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"f",(function(){return h})),n.d(t,"a",(function(){return l}));var i,s,r=n("6977");(function(e){e[e["Left"]=1]="Left",e[e["Center"]=2]="Center",e[e["Right"]=4]="Right",e[e["Full"]=7]="Full"})(i||(i={})),function(e){e[e["Inline"]=1]="Inline",e[e["Gutter"]=2]="Gutter"}(s||(s={}));class o{constructor(e){this._textModelResolvedOptionsBrand=void 0,this.tabSize=Math.max(1,0|e.tabSize),this.indentSize=0|e.tabSize,this.insertSpaces=Boolean(e.insertSpaces),this.defaultEOL=0|e.defaultEOL,this.trimAutoWhitespace=Boolean(e.trimAutoWhitespace),this.bracketPairColorizationOptions=e.bracketPairColorizationOptions}equals(e){return this.tabSize===e.tabSize&&this.indentSize===e.indentSize&&this.insertSpaces===e.insertSpaces&&this.defaultEOL===e.defaultEOL&&this.trimAutoWhitespace===e.trimAutoWhitespace&&Object(r["d"])(this.bracketPairColorizationOptions,e.bracketPairColorizationOptions)}createChangeEvent(e){return{tabSize:this.tabSize!==e.tabSize,indentSize:this.indentSize!==e.indentSize,insertSpaces:this.insertSpaces!==e.insertSpaces,trimAutoWhitespace:this.trimAutoWhitespace!==e.trimAutoWhitespace}}}class a{constructor(e,t){this._findMatchBrand=void 0,this.range=e,this.matches=t}}class h{constructor(e,t,n,i,s,r){this.identifier=e,this.range=t,this.text=n,this.forceMoveMarkers=i,this.isAutoWhitespaceEdit=s,this._isTracked=r}}class l{constructor(e,t,n){this.reverseEdits=e,this.changes=t,this.trimAutoWhitespaceLineNumbers=n}}},"209c":function(e,t,n){"use strict";n.d(t,"b",(function(){return _})),n.d(t,"a",(function(){return p}));var i=n("05b0"),s=n("c59a"),r=n("a24f"),o=n("aac4"),a=n("8c64"),h=n("98ff"),l=n("1907");function u(e){return e.toString()}class c{constructor(e,t,n,i,s,r,o){this.beforeVersionId=e,this.afterVersionId=t,this.beforeEOL=n,this.afterEOL=i,this.beforeCursorState=s,this.afterCursorState=r,this.changes=o}static create(e,t){const n=e.getAlternativeVersionId(),i=g(e);return new c(n,n,i,i,t,t,[])}append(e,t,n,i,s){t.length>0&&(this.changes=Object(a["b"])(this.changes,t)),this.afterEOL=n,this.afterVersionId=i,this.afterCursorState=s}static _writeSelectionsSize(e){return 4+16*(e?e.length:0)}static _writeSelections(e,t,n){if(h["f"](e,t?t.length:0,n),n+=4,t)for(const i of t)h["f"](e,i.selectionStartLineNumber,n),n+=4,h["f"](e,i.selectionStartColumn,n),n+=4,h["f"](e,i.positionLineNumber,n),n+=4,h["f"](e,i.positionColumn,n),n+=4;return n}static _readSelections(e,t,n){const i=h["c"](e,t);t+=4;for(let s=0;s<i;s++){const i=h["c"](e,t);t+=4;const s=h["c"](e,t);t+=4;const o=h["c"](e,t);t+=4;const a=h["c"](e,t);t+=4,n.push(new r["a"](i,s,o,a))}return t}serialize(){let e=10+c._writeSelectionsSize(this.beforeCursorState)+c._writeSelectionsSize(this.afterCursorState)+4;for(const i of this.changes)e+=i.writeSize();const t=new Uint8Array(e);let n=0;h["f"](t,this.beforeVersionId,n),n+=4,h["f"](t,this.afterVersionId,n),n+=4,h["g"](t,this.beforeEOL,n),n+=1,h["g"](t,this.afterEOL,n),n+=1,n=c._writeSelections(t,this.beforeCursorState,n),n=c._writeSelections(t,this.afterCursorState,n),h["f"](t,this.changes.length,n),n+=4;for(const i of this.changes)n=i.write(t,n);return t.buffer}static deserialize(e){const t=new Uint8Array(e);let n=0;const i=h["c"](t,n);n+=4;const s=h["c"](t,n);n+=4;const r=h["d"](t,n);n+=1;const o=h["d"](t,n);n+=1;const l=[];n=c._readSelections(t,n,l);const u=[];n=c._readSelections(t,n,u);const d=h["c"](t,n);n+=4;const f=[];for(let h=0;h<d;h++)n=a["a"].read(t,n,f);return new c(i,s,r,o,l,u,f)}}class d{constructor(e,t){this.model=e,this._data=c.create(e,t)}get type(){return 0}get resource(){return o["a"].isUri(this.model)?this.model:this.model.uri}get label(){return i["a"]("edit","Typing")}toString(){const e=this._data instanceof c?this._data:c.deserialize(this._data);return e.changes.map(e=>e.toString()).join(", ")}matchesResource(e){const t=o["a"].isUri(this.model)?this.model:this.model.uri;return t.toString()===e.toString()}setModel(e){this.model=e}canAppend(e){return this.model===e&&this._data instanceof c}append(e,t,n,i,s){this._data instanceof c&&this._data.append(e,t,n,i,s)}close(){this._data instanceof c&&(this._data=this._data.serialize())}open(){this._data instanceof c||(this._data=c.deserialize(this._data))}undo(){if(o["a"].isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof c&&(this._data=this._data.serialize());const e=c.deserialize(this._data);this.model._applyUndo(e.changes,e.beforeEOL,e.beforeVersionId,e.beforeCursorState)}redo(){if(o["a"].isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof c&&(this._data=this._data.serialize());const e=c.deserialize(this._data);this.model._applyRedo(e.changes,e.afterEOL,e.afterVersionId,e.afterCursorState)}heapSize(){return this._data instanceof c&&(this._data=this._data.serialize()),this._data.byteLength+168}}class f{constructor(e,t){this.type=1,this.label=e,this._isOpen=!0,this._editStackElementsArr=t.slice(0),this._editStackElementsMap=new Map;for(const n of this._editStackElementsArr){const e=u(n.resource);this._editStackElementsMap.set(e,n)}this._delegate=null}get resources(){return this._editStackElementsArr.map(e=>e.resource)}prepareUndoRedo(){if(this._delegate)return this._delegate.prepareUndoRedo(this)}matchesResource(e){const t=u(e);return this._editStackElementsMap.has(t)}setModel(e){const t=u(o["a"].isUri(e)?e:e.uri);this._editStackElementsMap.has(t)&&this._editStackElementsMap.get(t).setModel(e)}canAppend(e){if(!this._isOpen)return!1;const t=u(e.uri);if(this._editStackElementsMap.has(t)){const n=this._editStackElementsMap.get(t);return n.canAppend(e)}return!1}append(e,t,n,i,s){const r=u(e.uri),o=this._editStackElementsMap.get(r);o.append(e,t,n,i,s)}close(){this._isOpen=!1}open(){}undo(){this._isOpen=!1;for(const e of this._editStackElementsArr)e.undo()}redo(){for(const e of this._editStackElementsArr)e.redo()}heapSize(e){const t=u(e);if(this._editStackElementsMap.has(t)){const e=this._editStackElementsMap.get(t);return e.heapSize()}return 0}split(){return this._editStackElementsArr}toString(){let e=[];for(const t of this._editStackElementsArr)e.push(`${Object(l["b"])(t.resource)}: ${t}`);return`{${e.join(", ")}}`}}function g(e){const t=e.getEOL();return"\n"===t?0:1}function _(e){return!!e&&(e instanceof d||e instanceof f)}class p{constructor(e,t){this._model=e,this._undoRedoService=t}pushStackElement(){const e=this._undoRedoService.getLastElement(this._model.uri);_(e)&&e.close()}popStackElement(){const e=this._undoRedoService.getLastElement(this._model.uri);_(e)&&e.open()}clear(){this._undoRedoService.removeElements(this._model.uri)}_getOrCreateEditStackElement(e){const t=this._undoRedoService.getLastElement(this._model.uri);if(_(t)&&t.canAppend(this._model))return t;const n=new d(this._model,e);return this._undoRedoService.pushElement(n),n}pushEOL(e){const t=this._getOrCreateEditStackElement(null);this._model.setEOL(e),t.append(this._model,[],g(this._model),this._model.getAlternativeVersionId(),null)}pushEditOperation(e,t,n){const i=this._getOrCreateEditStackElement(e),s=this._model.applyEdits(t,!0),r=p._computeCursorState(n,s),o=s.map((e,t)=>({index:t,textChange:e.textChange}));return o.sort((e,t)=>e.textChange.oldPosition===t.textChange.oldPosition?e.index-t.index:e.textChange.oldPosition-t.textChange.oldPosition),i.append(this._model,o.map(e=>e.textChange),g(this._model),this._model.getAlternativeVersionId(),r),r}static _computeCursorState(e,t){try{return e?e(t):null}catch(n){return Object(s["f"])(n),null}}}},"2b64":function(e,t,n){"use strict";n.d(t,"u",(function(){return h})),n.d(t,"E",(function(){return l})),n.d(t,"I",(function(){return u})),n.d(t,"H",(function(){return c})),n.d(t,"s",(function(){return d})),n.d(t,"C",(function(){return f})),n.d(t,"h",(function(){return g})),n.d(t,"J",(function(){return m})),n.d(t,"D",(function(){return _})),n.d(t,"n",(function(){return C})),n.d(t,"y",(function(){return b})),n.d(t,"z",(function(){return L})),n.d(t,"d",(function(){return k})),n.d(t,"t",(function(){return w})),n.d(t,"B",(function(){return x})),n.d(t,"p",(function(){return I})),n.d(t,"m",(function(){return N})),n.d(t,"i",(function(){return S})),n.d(t,"w",(function(){return T})),n.d(t,"f",(function(){return v})),n.d(t,"e",(function(){return O})),n.d(t,"q",(function(){return E})),n.d(t,"G",(function(){return D})),n.d(t,"b",(function(){return A})),n.d(t,"r",(function(){return R})),n.d(t,"a",(function(){return M})),n.d(t,"g",(function(){return B})),n.d(t,"j",(function(){return y})),n.d(t,"x",(function(){return z})),n.d(t,"v",(function(){return P})),n.d(t,"c",(function(){return F})),n.d(t,"A",(function(){return V})),n.d(t,"o",(function(){return W})),n.d(t,"l",(function(){return j})),n.d(t,"k",(function(){return U})),n.d(t,"F",(function(){return H}));var i=n("aac4"),s=n("537c"),r=n("d1b6"),o=n("85f1"),a=n("1dea");class h{constructor(e,t){this.language=e,this.id=t}}class l{static getLanguageId(e){return(255&e)>>>0}static getTokenType(e){return(1792&e)>>>8}static getFontStyle(e){return(14336&e)>>>11}static getForeground(e){return(8372224&e)>>>14}static getBackground(e){return(4286578688&e)>>>23}static getClassNameFromMetadata(e){let t=this.getForeground(e),n="mtk"+t,i=this.getFontStyle(e);return 1&i&&(n+=" mtki"),2&i&&(n+=" mtkb"),4&i&&(n+=" mtku"),n}static getInlineStyleFromMetadata(e,t){const n=this.getForeground(e),i=this.getFontStyle(e);let s=`color: ${t[n]};`;return 1&i&&(s+="font-style: italic;"),2&i&&(s+="font-weight: bold;"),4&i&&(s+="text-decoration: underline;"),s}}const u=function(){let e=Object.create(null);return e[0]="symbol-method",e[1]="symbol-function",e[2]="symbol-constructor",e[3]="symbol-field",e[4]="symbol-variable",e[5]="symbol-class",e[6]="symbol-struct",e[7]="symbol-interface",e[8]="symbol-module",e[9]="symbol-property",e[10]="symbol-event",e[11]="symbol-operator",e[12]="symbol-unit",e[13]="symbol-value",e[14]="symbol-constant",e[15]="symbol-enum",e[16]="symbol-enum-member",e[17]="symbol-keyword",e[27]="symbol-snippet",e[18]="symbol-text",e[19]="symbol-color",e[20]="symbol-file",e[21]="symbol-reference",e[22]="symbol-customcolor",e[23]="symbol-folder",e[24]="symbol-type-parameter",e[25]="account",e[26]="issues",function(t){const n=e[t];let i=n&&a["d"].get(n);return i||(console.info("No codicon found for CompletionItemKind "+t),i=a["b"].symbolProperty),i.classNames}}();let c=function(){let e=Object.create(null);return e["method"]=0,e["function"]=1,e["constructor"]=2,e["field"]=3,e["variable"]=4,e["class"]=5,e["struct"]=6,e["interface"]=7,e["module"]=8,e["property"]=9,e["event"]=10,e["operator"]=11,e["unit"]=12,e["value"]=13,e["constant"]=14,e["enum"]=15,e["enum-member"]=16,e["enumMember"]=16,e["keyword"]=17,e["snippet"]=27,e["text"]=18,e["color"]=19,e["file"]=20,e["reference"]=21,e["customcolor"]=22,e["folder"]=23,e["type-parameter"]=24,e["typeParameter"]=24,e["account"]=25,e["issue"]=26,function(t,n){let i=e[t];return"undefined"!==typeof i||n||(i=9),i}}();var d,f,g,_,p;function m(e){return e&&i["a"].isUri(e.uri)&&s["a"].isIRange(e.range)&&(s["a"].isIRange(e.originSelectionRange)||s["a"].isIRange(e.targetSelectionRange))}(function(e){e[e["Automatic"]=0]="Automatic",e[e["Explicit"]=1]="Explicit"})(d||(d={})),function(e){e[e["Invoke"]=1]="Invoke",e[e["TriggerCharacter"]=2]="TriggerCharacter",e[e["ContentChange"]=3]="ContentChange"}(f||(f={})),function(e){e[e["Text"]=0]="Text",e[e["Read"]=1]="Read",e[e["Write"]=2]="Write"}(g||(g={})),function(e){const t=new Map;t.set("file",0),t.set("module",1),t.set("namespace",2),t.set("package",3),t.set("class",4),t.set("method",5),t.set("property",6),t.set("field",7),t.set("constructor",8),t.set("enum",9),t.set("interface",10),t.set("function",11),t.set("variable",12),t.set("constant",13),t.set("string",14),t.set("number",15),t.set("boolean",16),t.set("array",17),t.set("object",18),t.set("key",19),t.set("null",20),t.set("enum-member",21),t.set("struct",22),t.set("event",23),t.set("operator",24),t.set("type-parameter",25);const n=new Map;function i(e){return t.get(e)}function s(e){return n.get(e)}function r(e,t){const i=n.get(e);let s=i&&a["d"].get("symbol-"+i);return s||(console.info("No codicon found for SymbolKind "+e),s=a["b"].symbolProperty),`${t?"inline":"block"} ${s.classNames}`}n.set(0,"file"),n.set(1,"module"),n.set(2,"namespace"),n.set(3,"package"),n.set(4,"class"),n.set(5,"method"),n.set(6,"property"),n.set(7,"field"),n.set(8,"constructor"),n.set(9,"enum"),n.set(10,"interface"),n.set(11,"function"),n.set(12,"variable"),n.set(13,"constant"),n.set(14,"string"),n.set(15,"number"),n.set(16,"boolean"),n.set(17,"array"),n.set(18,"object"),n.set(19,"key"),n.set(20,"null"),n.set(21,"enum-member"),n.set(22,"struct"),n.set(23,"event"),n.set(24,"operator"),n.set(25,"type-parameter"),e.fromString=i,e.toString=s,e.toCssClassName=r}(_||(_={}));class C{constructor(e){this.value=e}}C.Comment=new C("comment"),C.Imports=new C("imports"),C.Region=new C("region"),function(e){e[e["Other"]=0]="Other",e[e["Type"]=1]="Type",e[e["Parameter"]=2]="Parameter"}(p||(p={}));const b=new r["a"],L=new r["a"],k=new r["a"],w=new r["a"],x=new r["a"],I=new r["a"],N=new r["a"],S=new r["a"],T=new r["a"],v=new r["a"],O=new r["a"],E=new r["a"],D=new r["a"],A=new r["a"],R=new r["a"],M=new r["a"],B=new r["a"],y=new r["a"],z=new r["a"],P=new r["a"],F=new r["a"],V=new r["a"],W=new r["a"],j=new r["a"],U=new r["a"],H=new o["a"]},"6d2d":function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return h}));const i="`~!@#$%^&*()-=+[{]}\\|;:'\",.<>/?";function s(e=""){let t="(-?\\d*\\.\\d\\w*)|([^";for(const n of i)e.indexOf(n)>=0||(t+="\\"+n);return t+="\\s]+)",new RegExp(t,"g")}const r=s();function o(e){let t=r;if(e&&e instanceof RegExp)if(e.global)t=e;else{let n="g";e.ignoreCase&&(n+="i"),e.multiline&&(n+="m"),e.unicode&&(n+="u"),t=new RegExp(e.source,n)}return t.lastIndex=0,t}const a={maxLen:1e3,windowSize:15,timeBudget:150};function h(e,t,n,i,s=a){if(n.length>s.maxLen){let r=e-s.maxLen/2;return r<0?r=0:i+=r,n=n.substring(r,e+s.maxLen/2),h(e,t,n,i,s)}const r=Date.now(),o=e-1-i;let u=-1,c=null;for(let a=1;;a++){if(Date.now()-r>=s.timeBudget)break;const e=o-s.windowSize*a;t.lastIndex=Math.max(0,e);const i=l(t,n,o,u);if(!i&&c)break;if(c=i,e<=0)break;u=e}if(c){let e={word:c[0],startColumn:i+1+c.index,endColumn:i+1+c.index+c[0].length};return t.lastIndex=0,e}return null}function l(e,t,n,i){let s;while(s=e.exec(t)){const t=s.index||0;if(t<=n&&e.lastIndex>=n)return s;if(i>0&&t>i)return null}return null}},"75de":function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return g})),n.d(t,"e",(function(){return m})),n.d(t,"b",(function(){return C}));var i=n("2dd7"),s=n("e385"),r=n("abda"),o=n("537c"),a=n("1e57");const h=999;class l{constructor(e,t,n,i){this.searchString=e,this.isRegex=t,this.matchCase=n,this.wordSeparators=i}parseSearchRequest(){if(""===this.searchString)return null;let e;e=this.isRegex?u(this.searchString):this.searchString.indexOf("\n")>=0;let t=null;try{t=i["q"](this.searchString,this.isRegex,{matchCase:this.matchCase,wholeWord:!1,multiline:e,global:!0,unicode:!0})}catch(r){return null}if(!t)return null;let n=!this.isRegex&&!e;return n&&this.searchString.toLowerCase()!==this.searchString.toUpperCase()&&(n=this.matchCase),new c(t,this.wordSeparators?Object(s["a"])(this.wordSeparators):null,n?this.searchString:null)}}function u(e){if(!e||0===e.length)return!1;for(let t=0,n=e.length;t<n;t++){const i=e.charCodeAt(t);if(92===i){if(t++,t>=n)break;const i=e.charCodeAt(t);if(110===i||114===i||87===i||119===i)return!0}}return!1}class c{constructor(e,t,n){this.regex=e,this.wordSeparators=t,this.simpleSearch=n}}function d(e,t,n){if(!n)return new a["b"](e,null);let i=[];for(let s=0,r=t.length;s<r;s++)i[s]=t[s];return new a["b"](e,i)}class f{constructor(e){let t=[],n=0;for(let i=0,s=e.length;i<s;i++)10===e.charCodeAt(i)&&(t[n++]=i);this._lineFeedsOffsets=t}findLineFeedCountBeforeOffset(e){const t=this._lineFeedsOffsets;let n=0,i=t.length-1;if(-1===i)return 0;if(e<=t[0])return 0;while(n<i){const s=n+((i-n)/2>>0);t[s]>=e?i=s-1:t[s+1]>=e?(n=s,i=s):n=s+1}return n+1}}class g{static findMatches(e,t,n,i,s){const r=t.parseSearchRequest();return r?r.regex.multiline?this._doFindMatchesMultiline(e,n,new C(r.wordSeparators,r.regex),i,s):this._doFindMatchesLineByLine(e,n,r,i,s):[]}static _getMultilineMatchRange(e,t,n,i,s,r){let a,h,l=0;if(i?(l=i.findLineFeedCountBeforeOffset(s),a=t+s+l):a=t+s,i){let e=i.findLineFeedCountBeforeOffset(s+r.length),t=e-l;h=a+r.length+t}else h=a+r.length;const u=e.getPositionAt(a),c=e.getPositionAt(h);return new o["a"](u.lineNumber,u.column,c.lineNumber,c.column)}static _doFindMatchesMultiline(e,t,n,i,s){const r=e.getOffsetAt(t.getStartPosition()),o=e.getValueInRange(t,1),a="\r\n"===e.getEOL()?new f(o):null,h=[];let l,u=0;n.reset(0);while(l=n.next(o))if(h[u++]=d(this._getMultilineMatchRange(e,r,o,a,l.index,l[0]),l,i),u>=s)return h;return h}static _doFindMatchesLineByLine(e,t,n,i,s){const r=[];let o=0;if(t.startLineNumber===t.endLineNumber){const a=e.getLineContent(t.startLineNumber).substring(t.startColumn-1,t.endColumn-1);return o=this._findMatchesInLine(n,a,t.startLineNumber,t.startColumn-1,o,r,i,s),r}const a=e.getLineContent(t.startLineNumber).substring(t.startColumn-1);o=this._findMatchesInLine(n,a,t.startLineNumber,t.startColumn-1,o,r,i,s);for(let h=t.startLineNumber+1;h<t.endLineNumber&&o<s;h++)o=this._findMatchesInLine(n,e.getLineContent(h),h,0,o,r,i,s);if(o<s){const a=e.getLineContent(t.endLineNumber).substring(0,t.endColumn-1);o=this._findMatchesInLine(n,a,t.endLineNumber,0,o,r,i,s)}return r}static _findMatchesInLine(e,t,n,i,s,r,h,l){const u=e.wordSeparators;if(!h&&e.simpleSearch){const h=e.simpleSearch,c=h.length,d=t.length;let f=-c;while(-1!==(f=t.indexOf(h,f+c)))if((!u||m(u,t,d,f,c))&&(r[s++]=new a["b"](new o["a"](n,f+1+i,n,f+1+c+i),null),s>=l))return s;return s}const c=new C(e.wordSeparators,e.regex);let f;c.reset(0);do{if(f=c.next(t),f&&(r[s++]=d(new o["a"](n,f.index+1+i,n,f.index+1+f[0].length+i),f,h),s>=l))return s}while(f);return s}static findNextMatch(e,t,n,i){const s=t.parseSearchRequest();if(!s)return null;const r=new C(s.wordSeparators,s.regex);return s.regex.multiline?this._doFindNextMatchMultiline(e,n,r,i):this._doFindNextMatchLineByLine(e,n,r,i)}static _doFindNextMatchMultiline(e,t,n,i){const s=new r["a"](t.lineNumber,1),a=e.getOffsetAt(s),h=e.getLineCount(),l=e.getValueInRange(new o["a"](s.lineNumber,s.column,h,e.getLineMaxColumn(h)),1),u="\r\n"===e.getEOL()?new f(l):null;n.reset(t.column-1);let c=n.next(l);return c?d(this._getMultilineMatchRange(e,a,l,u,c.index,c[0]),c,i):1!==t.lineNumber||1!==t.column?this._doFindNextMatchMultiline(e,new r["a"](1,1),n,i):null}static _doFindNextMatchLineByLine(e,t,n,i){const s=e.getLineCount(),r=t.lineNumber,o=e.getLineContent(r),a=this._findFirstMatchInLine(n,o,r,t.column,i);if(a)return a;for(let h=1;h<=s;h++){const t=(r+h-1)%s,o=e.getLineContent(t+1),a=this._findFirstMatchInLine(n,o,t+1,1,i);if(a)return a}return null}static _findFirstMatchInLine(e,t,n,i,s){e.reset(i-1);const r=e.next(t);return r?d(new o["a"](n,r.index+1,n,r.index+1+r[0].length),r,s):null}static findPreviousMatch(e,t,n,i){const s=t.parseSearchRequest();if(!s)return null;const r=new C(s.wordSeparators,s.regex);return s.regex.multiline?this._doFindPreviousMatchMultiline(e,n,r,i):this._doFindPreviousMatchLineByLine(e,n,r,i)}static _doFindPreviousMatchMultiline(e,t,n,i){const s=this._doFindMatchesMultiline(e,new o["a"](1,1,t.lineNumber,t.column),n,i,10*h);if(s.length>0)return s[s.length-1];const a=e.getLineCount();return t.lineNumber!==a||t.column!==e.getLineMaxColumn(a)?this._doFindPreviousMatchMultiline(e,new r["a"](a,e.getLineMaxColumn(a)),n,i):null}static _doFindPreviousMatchLineByLine(e,t,n,i){const s=e.getLineCount(),r=t.lineNumber,o=e.getLineContent(r).substring(0,t.column-1),a=this._findLastMatchInLine(n,o,r,i);if(a)return a;for(let h=1;h<=s;h++){const t=(s+r-h-1)%s,o=e.getLineContent(t+1),a=this._findLastMatchInLine(n,o,t+1,i);if(a)return a}return null}static _findLastMatchInLine(e,t,n,i){let s,r=null;e.reset(0);while(s=e.next(t))r=d(new o["a"](n,s.index+1,n,s.index+1+s[0].length),s,i);return r}}function _(e,t,n,i,s){if(0===i)return!0;const r=t.charCodeAt(i-1);if(0!==e.get(r))return!0;if(13===r||10===r)return!0;if(s>0){const n=t.charCodeAt(i);if(0!==e.get(n))return!0}return!1}function p(e,t,n,i,s){if(i+s===n)return!0;const r=t.charCodeAt(i+s);if(0!==e.get(r))return!0;if(13===r||10===r)return!0;if(s>0){const n=t.charCodeAt(i+s-1);if(0!==e.get(n))return!0}return!1}function m(e,t,n,i,s){return _(e,t,n,i,s)&&p(e,t,n,i,s)}class C{constructor(e,t){this._wordSeparators=e,this._searchRegex=t,this._prevMatchStartIndex=-1,this._prevMatchLength=0}reset(e){this._searchRegex.lastIndex=e,this._prevMatchStartIndex=-1,this._prevMatchLength=0}next(e){const t=e.length;let n;do{if(this._prevMatchStartIndex+this._prevMatchLength===t)return null;if(n=this._searchRegex.exec(e),!n)return null;const s=n.index,r=n[0].length;if(s===this._prevMatchStartIndex&&r===this._prevMatchLength){if(0===r){i["z"](e,t,this._searchRegex.lastIndex)>65535?this._searchRegex.lastIndex+=2:this._searchRegex.lastIndex+=1;continue}return null}if(this._prevMatchStartIndex=s,this._prevMatchLength=r,!this._wordSeparators||m(this._wordSeparators,e,t,s,r))return n}while(n);return null}}},8407:function(e,t,n){"use strict";n.d(t,"f",(function(){return h})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return g})),n.d(t,"e",(function(){return m})),n.d(t,"d",(function(){return C}));var i=n("1c57"),s=n("3f16"),r=n("abda"),o=n("537c"),a=n("2b64");function h(e){let t=0,n=0,i=0,s=0;for(let r=0,o=e.length;r<o;r++){const a=e.charCodeAt(r);13===a?(0===t&&(n=r),t++,r+1<o&&10===e.charCodeAt(r+1)?(s|=2,r++):s|=3,i=r+1):10===a&&(s|=1,0===t&&(n=r),t++,i=r+1)}return 0===t&&(n=e.length),[t,n,e.length-i,s]}function l(e){return(16384|e<<0|2<<23)>>>0}const u=new Uint32Array(0).buffer;class c{constructor(){this.tokens=[]}add(e,t){if(this.tokens.length>0){const n=this.tokens[this.tokens.length-1],i=n.startLineNumber+n.tokens.length-1;if(i+1===e)return void n.tokens.push(t)}this.tokens.push(new _(e,[t]))}}class d{constructor(e){this._tokens=e,this._tokenCount=e.length/4}toString(e){let t=[];for(let n=0;n<this._tokenCount;n++)t.push(`(${this._getDeltaLine(n)+e},${this._getStartCharacter(n)}-${this._getEndCharacter(n)})`);return`[${t.join(",")}]`}getMaxDeltaLine(){const e=this._getTokenCount();return 0===e?-1:this._getDeltaLine(e-1)}getRange(){const e=this._getTokenCount();if(0===e)return null;const t=this._getStartCharacter(0),n=this._getDeltaLine(e-1),i=this._getEndCharacter(e-1);return new o["a"](0,t+1,n,i+1)}_getTokenCount(){return this._tokenCount}_getDeltaLine(e){return this._tokens[4*e]}_getStartCharacter(e){return this._tokens[4*e+1]}_getEndCharacter(e){return this._tokens[4*e+2]}isEmpty(){return 0===this._getTokenCount()}getLineTokens(e){let t=0,n=this._getTokenCount()-1;while(t<n){const i=t+Math.floor((n-t)/2),s=this._getDeltaLine(i);if(s<e)t=i+1;else{if(!(s>e)){let s=i;while(s>t&&this._getDeltaLine(s-1)===e)s--;let r=i;while(r<n&&this._getDeltaLine(r+1)===e)r++;return new f(this._tokens.subarray(4*s,4*r+4))}n=i-1}}return this._getDeltaLine(t)===e?new f(this._tokens.subarray(4*t,4*t+4)):null}clear(){this._tokenCount=0}removeTokens(e,t,n,i){const s=this._tokens,r=this._tokenCount;let o=0,a=!1,h=0;for(let l=0;l<r;l++){const r=4*l,u=s[r],c=s[r+1],d=s[r+2],f=s[r+3];if((u>e||u===e&&d>=t)&&(u<n||u===n&&c<=i))a=!0;else{if(0===o&&(h=u),a){const e=4*o;s[e]=u-h,s[e+1]=c,s[e+2]=d,s[e+3]=f}o++}}return this._tokenCount=o,h}split(e,t,n,i){const s=this._tokens,r=this._tokenCount;let o=[],a=[],h=o,l=0,u=0;for(let c=0;c<r;c++){const r=4*c,o=s[r],d=s[r+1],f=s[r+2],g=s[r+3];if(o>e||o===e&&f>=t){if(o<n||o===n&&d<=i)continue;h!==a&&(h=a,l=0,u=o)}h[l++]=o-u,h[l++]=d,h[l++]=f,h[l++]=g}return[new d(new Uint32Array(o)),new d(new Uint32Array(a)),u]}acceptDeleteRange(e,t,n,i,s){const r=this._tokens,o=this._tokenCount,a=i-t;let h=0,l=!1;for(let u=0;u<o;u++){const c=4*u;let d=r[c],f=r[c+1],g=r[c+2];const _=r[c+3];if(d<t||d===t&&g<=n){h++;continue}if(d===t&&f<n)d===i&&g>s?g-=s-n:g=n;else if(d===t&&f===n){if(!(d===i&&g>s)){l=!0;continue}g-=s-n}else if(d<i||d===i&&f<s){if(!(d===i&&g>s)){l=!0;continue}d===t?(f=n,g=f+(g-s)):(f=0,g=f+(g-s))}else if(d>i){if(0===a&&!l){h=o;break}d-=a}else{if(!(d===i&&f>=s))throw new Error("Not possible!");e&&0===d&&(f+=e,g+=e),d-=a,f-=s-n,g-=s-n}const p=4*h;r[p]=d,r[p+1]=f,r[p+2]=g,r[p+3]=_,h++}this._tokenCount=h}acceptInsertText(e,t,n,i,s,r){const o=0===n&&1===i&&(r>=48&&r<=57||r>=65&&r<=90||r>=97&&r<=122),a=this._tokens,h=this._tokenCount;for(let l=0;l<h;l++){const r=4*l;let h=a[r],u=a[r+1],c=a[r+2];if(!(h<e||h===e&&c<t)){if(h===e&&c===t){if(!o)continue;c+=1}else if(h===e&&u<t&&t<c)0===n?c+=i:c=t;else{if(h===e&&u===t&&o)continue;if(h===e)if(h+=n,0===n)u+=i,c+=i;else{const e=c-u;u=s+(u-t),c=u+e}else h+=n}a[r]=h,a[r+1]=u,a[r+2]=c}}}}class f{constructor(e){this._tokens=e}getCount(){return this._tokens.length/4}getStartCharacter(e){return this._tokens[4*e+1]}getEndCharacter(e){return this._tokens[4*e+2]}getMetadata(e){return this._tokens[4*e+3]}}class g{constructor(e,t){this.startLineNumber=e,this.tokens=t,this.endLineNumber=this.startLineNumber+this.tokens.getMaxDeltaLine()}toString(){return this.tokens.toString(this.startLineNumber)}_updateEndLineNumber(){this.endLineNumber=this.startLineNumber+this.tokens.getMaxDeltaLine()}isEmpty(){return this.tokens.isEmpty()}getLineTokens(e){return this.startLineNumber<=e&&e<=this.endLineNumber?this.tokens.getLineTokens(e-this.startLineNumber):null}getRange(){const e=this.tokens.getRange();return e?new o["a"](this.startLineNumber+e.startLineNumber,e.startColumn,this.startLineNumber+e.endLineNumber,e.endColumn):e}removeTokens(e){const t=e.startLineNumber-this.startLineNumber,n=e.endLineNumber-this.startLineNumber;this.startLineNumber+=this.tokens.removeTokens(t,e.startColumn-1,n,e.endColumn-1),this._updateEndLineNumber()}split(e){const t=e.startLineNumber-this.startLineNumber,n=e.endLineNumber-this.startLineNumber,[i,s,r]=this.tokens.split(t,e.startColumn-1,n,e.endColumn-1);return[new g(this.startLineNumber,i),new g(this.startLineNumber+r,s)]}applyEdit(e,t){const[n,i,s]=h(t);this.acceptEdit(e,n,i,s,t.length>0?t.charCodeAt(0):0)}acceptEdit(e,t,n,i,s){this._acceptDeleteRange(e),this._acceptInsertText(new r["a"](e.startLineNumber,e.startColumn),t,n,i,s),this._updateEndLineNumber()}_acceptDeleteRange(e){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return;const t=e.startLineNumber-this.startLineNumber,n=e.endLineNumber-this.startLineNumber;if(n<0){const e=n-t;return void(this.startLineNumber-=e)}const i=this.tokens.getMaxDeltaLine();if(!(t>=i+1)){if(t<0&&n>=i+1)return this.startLineNumber=0,void this.tokens.clear();if(t<0){const i=-t;this.startLineNumber-=i,this.tokens.acceptDeleteRange(e.startColumn-1,0,0,n,e.endColumn-1)}else this.tokens.acceptDeleteRange(0,t,e.startColumn-1,n,e.endColumn-1)}}_acceptInsertText(e,t,n,i,s){if(0===t&&0===n)return;const r=e.lineNumber-this.startLineNumber;if(r<0)return void(this.startLineNumber+=t);const o=this.tokens.getMaxDeltaLine();r>=o+1||this.tokens.acceptInsertText(r,e.column-1,t,n,i,s)}}class _{constructor(e,t){this.startLineNumber=e,this.tokens=t}}function p(e){return e instanceof Uint32Array?e:new Uint32Array(e)}class m{constructor(){this._pieces=[],this._isComplete=!1}flush(){this._pieces=[],this._isComplete=!1}isEmpty(){return 0===this._pieces.length}set(e,t){this._pieces=e||[],this._isComplete=t}setPartial(e,t){let n=e;if(t.length>0){const i=t[0].getRange(),s=t[t.length-1].getRange();if(!i||!s)return e;n=e.plusRange(i).plusRange(s)}let s=null;for(let i=0,r=this._pieces.length;i<r;i++){const e=this._pieces[i];if(e.endLineNumber<n.startLineNumber)continue;if(e.startLineNumber>n.endLineNumber){s=s||{index:i};break}if(e.removeTokens(n),e.isEmpty()){this._pieces.splice(i,1),i--,r--;continue}if(e.endLineNumber<n.startLineNumber)continue;if(e.startLineNumber>n.endLineNumber){s=s||{index:i};continue}const[t,o]=e.split(n);t.isEmpty()?s=s||{index:i}:o.isEmpty()||(this._pieces.splice(i,1,t,o),i++,r++,s=s||{index:i})}return s=s||{index:this._pieces.length},t.length>0&&(this._pieces=i["b"](this._pieces,s.index,t)),n}isComplete(){return this._isComplete}addSemanticTokens(e,t){const n=this._pieces;if(0===n.length)return t;const i=m._findFirstPieceWithLine(n,e),r=n[i].getLineTokens(e);if(!r)return t;const o=t.getCount(),a=r.getCount();let h=0,l=[],u=0,c=0;const d=(e,t)=>{e!==c&&(c=e,l[u++]=e,l[u++]=t)};for(let s=0;s<a;s++){const e=r.getStartCharacter(s),n=r.getEndCharacter(s),i=r.getMetadata(s),a=((1&i?2048:0)|(2&i?4096:0)|(4&i?8192:0)|(8&i?8372224:0)|(16&i?4286578688:0))>>>0,l=~a>>>0;while(h<o&&t.getEndOffset(h)<=e)d(t.getEndOffset(h),t.getMetadata(h)),h++;h<o&&t.getStartOffset(h)<e&&d(e,t.getMetadata(h));while(h<o&&t.getEndOffset(h)<n)d(t.getEndOffset(h),t.getMetadata(h)&l|i&a),h++;if(h<o)d(n,t.getMetadata(h)&l|i&a),t.getEndOffset(h)===n&&h++;else{const e=Math.min(Math.max(0,h-1),o-1);d(n,t.getMetadata(e)&l|i&a)}}while(h<o)d(t.getEndOffset(h),t.getMetadata(h)),h++;return new s["a"](new Uint32Array(l),t.getLineContent())}static _findFirstPieceWithLine(e,t){let n=0,i=e.length-1;while(n<i){let s=n+Math.floor((i-n)/2);if(e[s].endLineNumber<t)n=s+1;else{if(!(e[s].startLineNumber>t)){while(s>n&&e[s-1].startLineNumber<=t&&t<=e[s-1].endLineNumber)s--;return s}i=s-1}}return n}acceptEdit(e,t,n,i,s){for(const r of this._pieces)r.acceptEdit(e,t,n,i,s)}}class C{constructor(){this._lineTokens=[],this._len=0}flush(){this._lineTokens=[],this._len=0}getTokens(e,t,n){let i=null;if(t<this._len&&(i=this._lineTokens[t]),null!==i&&i!==u)return new s["a"](p(i),n);let r=new Uint32Array(2);return r[0]=n.length,r[1]=l(e),new s["a"](r,n)}static _massageTokens(e,t,n){const i=n?p(n):null;if(0===t){let t=!1;if(i&&i.length>1&&(t=a["E"].getLanguageId(i[1])!==e),!t)return u}if(!i||0===i.length){const n=new Uint32Array(2);return n[0]=t,n[1]=l(e),n.buffer}return i[i.length-2]=t,0===i.byteOffset&&i.byteLength===i.buffer.byteLength?i.buffer:i}_ensureLine(e){while(e>=this._len)this._lineTokens[this._len]=null,this._len++}_deleteLines(e,t){0!==t&&(e+t>this._len&&(t=this._len-e),this._lineTokens.splice(e,t),this._len-=t)}_insertLines(e,t){if(0===t)return;let n=[];for(let i=0;i<t;i++)n[i]=null;this._lineTokens=i["b"](this._lineTokens,e,n),this._len+=t}setTokens(e,t,n,i,s){const r=C._massageTokens(e,n,i);this._ensureLine(t);const o=this._lineTokens[t];return this._lineTokens[t]=r,!!s&&!C._equals(o,r)}static _equals(e,t){if(!e||!t)return!e&&!t;const n=p(e),i=p(t);if(n.length!==i.length)return!1;for(let s=0,r=n.length;s<r;s++)if(n[s]!==i[s])return!1;return!0}acceptEdit(e,t,n){this._acceptDeleteRange(e),this._acceptInsertText(new r["a"](e.startLineNumber,e.startColumn),t,n)}_acceptDeleteRange(e){const t=e.startLineNumber-1;if(t>=this._len)return;if(e.startLineNumber===e.endLineNumber){if(e.startColumn===e.endColumn)return;return void(this._lineTokens[t]=C._delete(this._lineTokens[t],e.startColumn-1,e.endColumn-1))}this._lineTokens[t]=C._deleteEnding(this._lineTokens[t],e.startColumn-1);const n=e.endLineNumber-1;let i=null;n<this._len&&(i=C._deleteBeginning(this._lineTokens[n],e.endColumn-1)),this._lineTokens[t]=C._append(this._lineTokens[t],i),this._deleteLines(e.startLineNumber,e.endLineNumber-e.startLineNumber)}_acceptInsertText(e,t,n){if(0===t&&0===n)return;const i=e.lineNumber-1;i>=this._len||(0!==t?(this._lineTokens[i]=C._deleteEnding(this._lineTokens[i],e.column-1),this._lineTokens[i]=C._insert(this._lineTokens[i],e.column-1,n),this._insertLines(e.lineNumber,t)):this._lineTokens[i]=C._insert(this._lineTokens[i],e.column-1,n))}static _deleteBeginning(e,t){return null===e||e===u?e:C._delete(e,0,t)}static _deleteEnding(e,t){if(null===e||e===u)return e;const n=p(e),i=n[n.length-2];return C._delete(e,t,i)}static _delete(e,t,n){if(null===e||e===u||t===n)return e;const i=p(e),r=i.length>>>1;if(0===t&&i[i.length-2]===n)return u;const o=s["a"].findIndexInTokensArray(i,t),a=o>0?i[o-1<<1]:0,h=i[o<<1];if(n<h){const s=n-t;for(let e=o;e<r;e++)i[e<<1]-=s;return e}let l,c;a!==t?(i[o<<1]=t,l=o+1<<1,c=t):(l=o<<1,c=a);const d=n-t;for(let s=o+1;s<r;s++){const e=i[s<<1]-d;e>c&&(i[l++]=e,i[l++]=i[1+(s<<1)],c=e)}if(l===i.length)return e;let f=new Uint32Array(l);return f.set(i.subarray(0,l),0),f.buffer}static _append(e,t){if(t===u)return e;if(e===u)return t;if(null===e)return e;if(null===t)return null;const n=p(e),i=p(t),s=i.length>>>1;let r=new Uint32Array(n.length+i.length);r.set(n,0);let o=n.length;const a=n[n.length-2];for(let h=0;h<s;h++)r[o++]=i[h<<1]+a,r[o++]=i[1+(h<<1)];return r.buffer}static _insert(e,t,n){if(null===e||e===u)return e;const i=p(e),r=i.length>>>1;let o=s["a"].findIndexInTokensArray(i,t);if(o>0){const e=i[o-1<<1];e===t&&o--}for(let s=o;s<r;s++)i[s<<1]+=n;return e}}},"84a6":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("2dd7"),s=n("abda"),r=n("b230");class o{constructor(e,t,n,i){this._uri=e,this._lines=t,this._eol=n,this._versionId=i,this._lineStarts=null,this._cachedTextValue=null}dispose(){this._lines.length=0}get version(){return this._versionId}getText(){return null===this._cachedTextValue&&(this._cachedTextValue=this._lines.join(this._eol)),this._cachedTextValue}onEvents(e){e.eol&&e.eol!==this._eol&&(this._eol=e.eol,this._lineStarts=null);const t=e.changes;for(const n of t)this._acceptDeleteRange(n.range),this._acceptInsertText(new s["a"](n.range.startLineNumber,n.range.startColumn),n.text);this._versionId=e.versionId,this._cachedTextValue=null}_ensureLineStarts(){if(!this._lineStarts){const e=this._eol.length,t=this._lines.length,n=new Uint32Array(t);for(let i=0;i<t;i++)n[i]=this._lines[i].length+e;this._lineStarts=new r["a"](n)}}_setLineText(e,t){this._lines[e]=t,this._lineStarts&&this._lineStarts.changeValue(e,this._lines[e].length+this._eol.length)}_acceptDeleteRange(e){if(e.startLineNumber!==e.endLineNumber)this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.endLineNumber-1].substring(e.endColumn-1)),this._lines.splice(e.startLineNumber,e.endLineNumber-e.startLineNumber),this._lineStarts&&this._lineStarts.removeValues(e.startLineNumber,e.endLineNumber-e.startLineNumber);else{if(e.startColumn===e.endColumn)return;this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.startLineNumber-1].substring(e.endColumn-1))}}_acceptInsertText(e,t){if(0===t.length)return;let n=Object(i["Q"])(t);if(1===n.length)return void this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+n[0]+this._lines[e.lineNumber-1].substring(e.column-1));n[n.length-1]+=this._lines[e.lineNumber-1].substring(e.column-1),this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+n[0]);let s=new Uint32Array(n.length-1);for(let i=1;i<n.length;i++)this._lines.splice(e.lineNumber+i-1,0,n[i]),s[i-1]=n[i].length+this._eol.length;this._lineStarts&&this._lineStarts.insertValues(e.lineNumber,s)}}},"8c64":function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var i=n("98ff"),s=n("5433");function r(e){return e.replace(/\n/g,"\\n").replace(/\r/g,"\\r")}class o{constructor(e,t,n,i){this.oldPosition=e,this.oldText=t,this.newPosition=n,this.newText=i}get oldLength(){return this.oldText.length}get oldEnd(){return this.oldPosition+this.oldText.length}get newLength(){return this.newText.length}get newEnd(){return this.newPosition+this.newText.length}toString(){return 0===this.oldText.length?`(insert@${this.oldPosition} "${r(this.newText)}")`:0===this.newText.length?`(delete@${this.oldPosition} "${r(this.oldText)}")`:`(replace@${this.oldPosition} "${r(this.oldText)}" with "${r(this.newText)}")`}static _writeStringSize(e){return 4+2*e.length}static _writeString(e,t,n){const s=t.length;i["f"](e,s,n),n+=4;for(let r=0;r<s;r++)i["e"](e,t.charCodeAt(r),n),n+=2;return n}static _readString(e,t){const n=i["c"](e,t);return t+=4,Object(s["b"])(e,t,n)}writeSize(){return 8+o._writeStringSize(this.oldText)+o._writeStringSize(this.newText)}write(e,t){return i["f"](e,this.oldPosition,t),t+=4,i["f"](e,this.newPosition,t),t+=4,t=o._writeString(e,this.oldText,t),t=o._writeString(e,this.newText,t),t}static read(e,t,n){const s=i["c"](e,t);t+=4;const r=i["c"](e,t);t+=4;const a=o._readString(e,t);t+=o._writeStringSize(a);const h=o._readString(e,t);return t+=o._writeStringSize(h),n.push(new o(s,a,r,h)),t}}function a(e,t){if(null===e||0===e.length)return t;const n=new h(e,t);return n.compress()}class h{constructor(e,t){this._prevEdits=e,this._currEdits=t,this._result=[],this._resultLen=0,this._prevLen=this._prevEdits.length,this._prevDeltaOffset=0,this._currLen=this._currEdits.length,this._currDeltaOffset=0}compress(){let e=0,t=0,n=this._getPrev(e),i=this._getCurr(t);while(e<this._prevLen||t<this._currLen){if(null===n){this._acceptCurr(i),i=this._getCurr(++t);continue}if(null===i){this._acceptPrev(n),n=this._getPrev(++e);continue}if(i.oldEnd<=n.newPosition){this._acceptCurr(i),i=this._getCurr(++t);continue}if(n.newEnd<=i.oldPosition){this._acceptPrev(n),n=this._getPrev(++e);continue}if(i.oldPosition<n.newPosition){const[e,t]=h._splitCurr(i,n.newPosition-i.oldPosition);this._acceptCurr(e),i=t;continue}if(n.newPosition<i.oldPosition){const[e,t]=h._splitPrev(n,i.oldPosition-n.newPosition);this._acceptPrev(e),n=t;continue}let s,r;if(i.oldEnd===n.newEnd)s=n,r=i,n=this._getPrev(++e),i=this._getCurr(++t);else if(i.oldEnd<n.newEnd){const[e,o]=h._splitPrev(n,i.oldLength);s=e,r=i,n=o,i=this._getCurr(++t)}else{const[t,o]=h._splitCurr(i,n.newLength);s=n,r=t,n=this._getPrev(++e),i=o}this._result[this._resultLen++]=new o(s.oldPosition,s.oldText,r.newPosition,r.newText),this._prevDeltaOffset+=s.newLength-s.oldLength,this._currDeltaOffset+=r.newLength-r.oldLength}const s=h._merge(this._result),r=h._removeNoOps(s);return r}_acceptCurr(e){this._result[this._resultLen++]=h._rebaseCurr(this._prevDeltaOffset,e),this._currDeltaOffset+=e.newLength-e.oldLength}_getCurr(e){return e<this._currLen?this._currEdits[e]:null}_acceptPrev(e){this._result[this._resultLen++]=h._rebasePrev(this._currDeltaOffset,e),this._prevDeltaOffset+=e.newLength-e.oldLength}_getPrev(e){return e<this._prevLen?this._prevEdits[e]:null}static _rebaseCurr(e,t){return new o(t.oldPosition-e,t.oldText,t.newPosition,t.newText)}static _rebasePrev(e,t){return new o(t.oldPosition,t.oldText,t.newPosition+e,t.newText)}static _splitPrev(e,t){const n=e.newText.substr(0,t),i=e.newText.substr(t);return[new o(e.oldPosition,e.oldText,e.newPosition,n),new o(e.oldEnd,"",e.newPosition+t,i)]}static _splitCurr(e,t){const n=e.oldText.substr(0,t),i=e.oldText.substr(t);return[new o(e.oldPosition,n,e.newPosition,e.newText),new o(e.oldPosition+t,i,e.newEnd,"")]}static _merge(e){if(0===e.length)return e;let t=[],n=0,i=e[0];for(let s=1;s<e.length;s++){const r=e[s];i.oldEnd===r.oldPosition?i=new o(i.oldPosition,i.oldText+r.oldText,i.newPosition,i.newText+r.newText):(t[n++]=i,i=r)}return t[n++]=i,t}static _removeNoOps(e){if(0===e.length)return e;let t=[],n=0;for(let i=0;i<e.length;i++){const s=e[i];s.oldText!==s.newText&&(t[n++]=s)}return t}}},"9afb":function(e,t,n){"use strict";n.d(t,"b",(function(){return en})),n.d(t,"a",(function(){return cn}));var i=n("c59a"),s=n("5ee7"),r=n("71e2"),o=n("2dd7"),a=n("aac4"),h=n("ae6d"),l=n("abda"),u=n("537c"),c=n("a24f"),d=n("1e57"),f=n("209c");class g{constructor(){this.spacesDiff=0,this.looksLikeAlignment=!1}}function _(e,t,n,i,s){let r;for(s.spacesDiff=0,s.looksLikeAlignment=!1,r=0;r<t&&r<i;r++){let t=e.charCodeAt(r),i=n.charCodeAt(r);if(t!==i)break}let o=0,a=0;for(let d=r;d<t;d++){let t=e.charCodeAt(d);32===t?o++:a++}let h=0,l=0;for(let d=r;d<i;d++){let e=n.charCodeAt(d);32===e?h++:l++}if(o>0&&a>0)return;if(h>0&&l>0)return;let u=Math.abs(a-l),c=Math.abs(o-h);if(0===u)return s.spacesDiff=c,void(c>0&&0<=h-1&&h-1<e.length&&h<n.length&&32!==n.charCodeAt(h)&&32===e.charCodeAt(h-1)&&44===e.charCodeAt(e.length-1)&&(s.looksLikeAlignment=!0));c%u!==0||(s.spacesDiff=c/u)}function p(e,t,n){const i=Math.min(e.getLineCount(),1e4);let s=0,r=0,o="",a=0;const h=[2,4,6,8,3,5,7],l=8;let u=[0,0,0,0,0,0,0,0,0],c=new g;for(let g=1;g<=i;g++){let i=e.getLineLength(g),h=e.getLineContent(g);const d=i<=65536;let f=!1,p=0,m=0,C=0;for(let t=0,n=i;t<n;t++){let n=d?h.charCodeAt(t):e.getLineCharCode(g,t);if(9===n)C++;else{if(32!==n){f=!0,p=t;break}m++}}if(!f)continue;if(C>0?s++:m>1&&r++,_(o,a,h,p,c),c.looksLikeAlignment&&(!n||t!==c.spacesDiff))continue;let b=c.spacesDiff;b<=l&&u[b]++,o=h,a=p}let d=n;s!==r&&(d=s<r);let f=t;if(d){let e=d?0:.1*i;h.forEach(t=>{let n=u[t];n>e&&(e=n,f=t)}),4===f&&u[4]>0&&u[2]>0&&u[2]>=u[4]/2&&(f=2)}return{insertSpaces:d,tabSize:f}}function m(e){return(1&e.metadata)>>>0}function C(e,t){e.metadata=254&e.metadata|t<<0}function b(e){return(2&e.metadata)>>>1===1}function L(e,t){e.metadata=253&e.metadata|(t?1:0)<<1}function k(e){return(4&e.metadata)>>>2===1}function w(e,t){e.metadata=251&e.metadata|(t?1:0)<<2}function x(e){return(24&e.metadata)>>>3}function I(e,t){e.metadata=231&e.metadata|t<<3}function N(e){return(32&e.metadata)>>>5===1}function S(e,t){e.metadata=223&e.metadata|(t?1:0)<<5}class T{constructor(e,t,n){this.metadata=0,this.parent=this,this.left=this,this.right=this,C(this,1),this.start=t,this.end=n,this.delta=0,this.maxEnd=n,this.id=e,this.ownerId=0,this.options=null,w(this,!1),I(this,1),S(this,!1),this.cachedVersionId=0,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=n,this.range=null,L(this,!1)}reset(e,t,n,i){this.start=t,this.end=n,this.maxEnd=n,this.cachedVersionId=e,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=n,this.range=i}setOptions(e){this.options=e;let t=this.options.className;w(this,"squiggly-error"===t||"squiggly-warning"===t||"squiggly-info"===t),I(this,this.options.stickiness),S(this,this.options.collapseOnReplaceEdit)}setCachedOffsets(e,t,n){this.cachedVersionId!==n&&(this.range=null),this.cachedVersionId=n,this.cachedAbsoluteStart=e,this.cachedAbsoluteEnd=t}detach(){this.parent=null,this.left=null,this.right=null}}const v=new T(null,0,0);v.parent=v,v.left=v,v.right=v,C(v,0);class O{constructor(){this.root=v,this.requestNormalizeDelta=!1}intervalSearch(e,t,n,i,s){return this.root===v?[]:P(this,e,t,n,i,s)}search(e,t,n){return this.root===v?[]:z(this,e,t,n)}collectNodesFromOwner(e){return B(this,e)}collectNodesPostOrder(){return y(this)}insert(e){F(this,e),this._normalizeDeltaIfNecessary()}delete(e){W(this,e),this._normalizeDeltaIfNecessary()}resolveNode(e,t){const n=e;let i=0;while(e!==this.root)e===e.parent.right&&(i+=e.parent.delta),e=e.parent;const s=n.start+i,r=n.end+i;n.setCachedOffsets(s,r,t)}acceptReplace(e,t,n,i){const s=R(this,e,e+t);for(let r=0,o=s.length;r<o;r++){const e=s[r];W(this,e)}this._normalizeDeltaIfNecessary(),M(this,e,e+t,n),this._normalizeDeltaIfNecessary();for(let r=0,o=s.length;r<o;r++){const o=s[r];o.start=o.cachedAbsoluteStart,o.end=o.cachedAbsoluteEnd,A(o,e,e+t,n,i),o.maxEnd=o.end,F(this,o)}this._normalizeDeltaIfNecessary()}_normalizeDeltaIfNecessary(){this.requestNormalizeDelta&&(this.requestNormalizeDelta=!1,E(this))}}function E(e){let t=e.root,n=0;while(t!==v)t.left===v||b(t.left)?t.right===v||b(t.right)?(t.start=n+t.start,t.end=n+t.end,t.delta=0,G(t),L(t,!0),L(t.left,!1),L(t.right,!1),t===t.parent.right&&(n-=t.parent.delta),t=t.parent):(n+=t.delta,t=t.right):t=t.left;L(e.root,!1)}function D(e,t,n,i){return e<n||!(e>n)&&(1!==i&&(2===i||t))}function A(e,t,n,i,s){const r=x(e),o=0===r||2===r,a=1===r||2===r,h=n-t,l=i,u=Math.min(h,l),c=e.start;let d=!1;const f=e.end;let g=!1;t<=c&&f<=n&&N(e)&&(e.start=t,d=!0,e.end=t,g=!0);{const e=s?1:h>0?2:0;!d&&D(c,o,t,e)&&(d=!0),!g&&D(f,a,t,e)&&(g=!0)}if(u>0&&!s){const e=h>l?2:0;!d&&D(c,o,t+u,e)&&(d=!0),!g&&D(f,a,t+u,e)&&(g=!0)}{const i=s?1:0;!d&&D(c,o,n,i)&&(e.start=t+l,d=!0),!g&&D(f,a,n,i)&&(e.end=t+l,g=!0)}const _=l-h;d||(e.start=Math.max(0,c+_)),g||(e.end=Math.max(0,f+_)),e.start>e.end&&(e.end=e.start)}function R(e,t,n){let i=e.root,s=0,r=0,o=0,a=0,h=[],l=0;while(i!==v)if(b(i))L(i.left,!1),L(i.right,!1),i===i.parent.right&&(s-=i.parent.delta),i=i.parent;else{if(!b(i.left)){if(r=s+i.maxEnd,r<t){L(i,!0);continue}if(i.left!==v){i=i.left;continue}}o=s+i.start,o>n?L(i,!0):(a=s+i.end,a>=t&&(i.setCachedOffsets(o,a,0),h[l++]=i),L(i,!0),i.right===v||b(i.right)||(s+=i.delta,i=i.right))}return L(e.root,!1),h}function M(e,t,n,i){let s=e.root,r=0,o=0,a=0;const h=i-(n-t);while(s!==v)if(b(s))L(s.left,!1),L(s.right,!1),s===s.parent.right&&(r-=s.parent.delta),G(s),s=s.parent;else{if(!b(s.left)){if(o=r+s.maxEnd,o<t){L(s,!0);continue}if(s.left!==v){s=s.left;continue}}a=r+s.start,a>n?(s.start+=h,s.end+=h,s.delta+=h,(s.delta<-1073741824||s.delta>1073741824)&&(e.requestNormalizeDelta=!0),L(s,!0)):(L(s,!0),s.right===v||b(s.right)||(r+=s.delta,s=s.right))}L(e.root,!1)}function B(e,t){let n=e.root,i=[],s=0;while(n!==v)b(n)?(L(n.left,!1),L(n.right,!1),n=n.parent):n.left===v||b(n.left)?(n.ownerId===t&&(i[s++]=n),L(n,!0),n.right===v||b(n.right)||(n=n.right)):n=n.left;return L(e.root,!1),i}function y(e){let t=e.root,n=[],i=0;while(t!==v)b(t)?(L(t.left,!1),L(t.right,!1),t=t.parent):t.left===v||b(t.left)?t.right===v||b(t.right)?(n[i++]=t,L(t,!0)):t=t.right:t=t.left;return L(e.root,!1),n}function z(e,t,n,i){let s=e.root,r=0,o=0,a=0,h=[],l=0;while(s!==v){if(b(s)){L(s.left,!1),L(s.right,!1),s===s.parent.right&&(r-=s.parent.delta),s=s.parent;continue}if(s.left!==v&&!b(s.left)){s=s.left;continue}o=r+s.start,a=r+s.end,s.setCachedOffsets(o,a,i);let e=!0;t&&s.ownerId&&s.ownerId!==t&&(e=!1),n&&k(s)&&(e=!1),e&&(h[l++]=s),L(s,!0),s.right===v||b(s.right)||(r+=s.delta,s=s.right)}return L(e.root,!1),h}function P(e,t,n,i,s,r){let o=e.root,a=0,h=0,l=0,u=0,c=[],d=0;while(o!==v)if(b(o))L(o.left,!1),L(o.right,!1),o===o.parent.right&&(a-=o.parent.delta),o=o.parent;else{if(!b(o.left)){if(h=a+o.maxEnd,h<t){L(o,!0);continue}if(o.left!==v){o=o.left;continue}}if(l=a+o.start,l>n)L(o,!0);else{if(u=a+o.end,u>=t){o.setCachedOffsets(l,u,r);let e=!0;i&&o.ownerId&&o.ownerId!==i&&(e=!1),s&&k(o)&&(e=!1),e&&(c[d++]=o)}L(o,!0),o.right===v||b(o.right)||(a+=o.delta,o=o.right)}}return L(e.root,!1),c}function F(e,t){if(e.root===v)return t.parent=v,t.left=v,t.right=v,C(t,0),e.root=t,e.root;V(e,t),K(t.parent);let n=t;while(n!==e.root&&1===m(n.parent))if(n.parent===n.parent.parent.left){const t=n.parent.parent.right;1===m(t)?(C(n.parent,0),C(t,0),C(n.parent.parent,1),n=n.parent.parent):(n===n.parent.right&&(n=n.parent,H(e,n)),C(n.parent,0),C(n.parent.parent,1),$(e,n.parent.parent))}else{const t=n.parent.parent.left;1===m(t)?(C(n.parent,0),C(t,0),C(n.parent.parent,1),n=n.parent.parent):(n===n.parent.left&&(n=n.parent,$(e,n)),C(n.parent,0),C(n.parent.parent,1),H(e,n.parent.parent))}return C(e.root,0),t}function V(e,t){let n=0,i=e.root;const s=t.start,r=t.end;while(1){const e=J(s,r,i.start+n,i.end+n);if(e<0){if(i.left===v){t.start-=n,t.end-=n,t.maxEnd-=n,i.left=t;break}i=i.left}else{if(i.right===v){t.start-=n+i.delta,t.end-=n+i.delta,t.maxEnd-=n+i.delta,i.right=t;break}n+=i.delta,i=i.right}}t.parent=i,t.left=v,t.right=v,C(t,1)}function W(e,t){let n,i;if(t.left===v?(n=t.right,i=t,n.delta+=t.delta,(n.delta<-1073741824||n.delta>1073741824)&&(e.requestNormalizeDelta=!0),n.start+=t.delta,n.end+=t.delta):t.right===v?(n=t.left,i=t):(i=j(t.right),n=i.right,n.start+=i.delta,n.end+=i.delta,n.delta+=i.delta,(n.delta<-1073741824||n.delta>1073741824)&&(e.requestNormalizeDelta=!0),i.start+=t.delta,i.end+=t.delta,i.delta=t.delta,(i.delta<-1073741824||i.delta>1073741824)&&(e.requestNormalizeDelta=!0)),i===e.root)return e.root=n,C(n,0),t.detach(),U(),G(n),void(e.root.parent=v);let s,r=1===m(i);if(i===i.parent.left?i.parent.left=n:i.parent.right=n,i===t?n.parent=i.parent:(i.parent===t?n.parent=i:n.parent=i.parent,i.left=t.left,i.right=t.right,i.parent=t.parent,C(i,m(t)),t===e.root?e.root=i:t===t.parent.left?t.parent.left=i:t.parent.right=i,i.left!==v&&(i.left.parent=i),i.right!==v&&(i.right.parent=i)),t.detach(),r)return K(n.parent),i!==t&&(K(i),K(i.parent)),void U();K(n),K(n.parent),i!==t&&(K(i),K(i.parent));while(n!==e.root&&0===m(n))n===n.parent.left?(s=n.parent.right,1===m(s)&&(C(s,0),C(n.parent,1),H(e,n.parent),s=n.parent.right),0===m(s.left)&&0===m(s.right)?(C(s,1),n=n.parent):(0===m(s.right)&&(C(s.left,0),C(s,1),$(e,s),s=n.parent.right),C(s,m(n.parent)),C(n.parent,0),C(s.right,0),H(e,n.parent),n=e.root)):(s=n.parent.left,1===m(s)&&(C(s,0),C(n.parent,1),$(e,n.parent),s=n.parent.left),0===m(s.left)&&0===m(s.right)?(C(s,1),n=n.parent):(0===m(s.left)&&(C(s.right,0),C(s,1),H(e,s),s=n.parent.left),C(s,m(n.parent)),C(n.parent,0),C(s.left,0),$(e,n.parent),n=e.root));C(n,0),U()}function j(e){while(e.left!==v)e=e.left;return e}function U(){v.parent=v,v.delta=0,v.start=0,v.end=0}function H(e,t){const n=t.right;n.delta+=t.delta,(n.delta<-1073741824||n.delta>1073741824)&&(e.requestNormalizeDelta=!0),n.start+=t.delta,n.end+=t.delta,t.right=n.left,n.left!==v&&(n.left.parent=t),n.parent=t.parent,t.parent===v?e.root=n:t===t.parent.left?t.parent.left=n:t.parent.right=n,n.left=t,t.parent=n,G(t),G(n)}function $(e,t){const n=t.left;t.delta-=n.delta,(t.delta<-1073741824||t.delta>1073741824)&&(e.requestNormalizeDelta=!0),t.start-=n.delta,t.end-=n.delta,t.left=n.right,n.right!==v&&(n.right.parent=t),n.parent=t.parent,t.parent===v?e.root=n:t===t.parent.right?t.parent.right=n:t.parent.left=n,n.right=t,t.parent=n,G(t),G(n)}function q(e){let t=e.end;if(e.left!==v){const n=e.left.maxEnd;n>t&&(t=n)}if(e.right!==v){const n=e.right.maxEnd+e.delta;n>t&&(t=n)}return t}function G(e){e.maxEnd=q(e)}function K(e){while(e!==v){const t=q(e);if(e.maxEnd===t)return;e.maxEnd=t,e=e.parent}}function J(e,t,n,i){return e===n?t-i:e-n}class Y{constructor(e,t){this.piece=e,this.color=t,this.size_left=0,this.lf_left=0,this.parent=this,this.left=this,this.right=this}next(){if(this.right!==Q)return Z(this.right);let e=this;while(e.parent!==Q){if(e.parent.left===e)break;e=e.parent}return e.parent===Q?Q:e.parent}prev(){if(this.left!==Q)return X(this.left);let e=this;while(e.parent!==Q){if(e.parent.right===e)break;e=e.parent}return e.parent===Q?Q:e.parent}detach(){this.parent=null,this.left=null,this.right=null}}const Q=new Y(null,0);function Z(e){while(e.left!==Q)e=e.left;return e}function X(e){while(e.right!==Q)e=e.right;return e}function ee(e){return e===Q?0:e.size_left+e.piece.length+ee(e.right)}function te(e){return e===Q?0:e.lf_left+e.piece.lineFeedCnt+te(e.right)}function ne(){Q.parent=Q}function ie(e,t){let n=t.right;n.size_left+=t.size_left+(t.piece?t.piece.length:0),n.lf_left+=t.lf_left+(t.piece?t.piece.lineFeedCnt:0),t.right=n.left,n.left!==Q&&(n.left.parent=t),n.parent=t.parent,t.parent===Q?e.root=n:t.parent.left===t?t.parent.left=n:t.parent.right=n,n.left=t,t.parent=n}function se(e,t){let n=t.left;t.left=n.right,n.right!==Q&&(n.right.parent=t),n.parent=t.parent,t.size_left-=n.size_left+(n.piece?n.piece.length:0),t.lf_left-=n.lf_left+(n.piece?n.piece.lineFeedCnt:0),t.parent===Q?e.root=n:t===t.parent.right?t.parent.right=n:t.parent.left=n,n.right=t,t.parent=n}function re(e,t){let n,i;if(t.left===Q?(i=t,n=i.right):t.right===Q?(i=t,n=i.left):(i=Z(t.right),n=i.right),i===e.root)return e.root=n,n.color=0,t.detach(),ne(),void(e.root.parent=Q);let s,r=1===i.color;if(i===i.parent.left?i.parent.left=n:i.parent.right=n,i===t?(n.parent=i.parent,he(e,n)):(i.parent===t?n.parent=i:n.parent=i.parent,he(e,n),i.left=t.left,i.right=t.right,i.parent=t.parent,i.color=t.color,t===e.root?e.root=i:t===t.parent.left?t.parent.left=i:t.parent.right=i,i.left!==Q&&(i.left.parent=i),i.right!==Q&&(i.right.parent=i),i.size_left=t.size_left,i.lf_left=t.lf_left,he(e,i)),t.detach(),n.parent.left===n){let t=ee(n),i=te(n);if(t!==n.parent.size_left||i!==n.parent.lf_left){let s=t-n.parent.size_left,r=i-n.parent.lf_left;n.parent.size_left=t,n.parent.lf_left=i,ae(e,n.parent,s,r)}}if(he(e,n.parent),r)ne();else{while(n!==e.root&&0===n.color)n===n.parent.left?(s=n.parent.right,1===s.color&&(s.color=0,n.parent.color=1,ie(e,n.parent),s=n.parent.right),0===s.left.color&&0===s.right.color?(s.color=1,n=n.parent):(0===s.right.color&&(s.left.color=0,s.color=1,se(e,s),s=n.parent.right),s.color=n.parent.color,n.parent.color=0,s.right.color=0,ie(e,n.parent),n=e.root)):(s=n.parent.left,1===s.color&&(s.color=0,n.parent.color=1,se(e,n.parent),s=n.parent.left),0===s.left.color&&0===s.right.color?(s.color=1,n=n.parent):(0===s.left.color&&(s.right.color=0,s.color=1,ie(e,s),s=n.parent.left),s.color=n.parent.color,n.parent.color=0,s.left.color=0,se(e,n.parent),n=e.root));n.color=0,ne()}}function oe(e,t){he(e,t);while(t!==e.root&&1===t.parent.color)if(t.parent===t.parent.parent.left){const n=t.parent.parent.right;1===n.color?(t.parent.color=0,n.color=0,t.parent.parent.color=1,t=t.parent.parent):(t===t.parent.right&&(t=t.parent,ie(e,t)),t.parent.color=0,t.parent.parent.color=1,se(e,t.parent.parent))}else{const n=t.parent.parent.left;1===n.color?(t.parent.color=0,n.color=0,t.parent.parent.color=1,t=t.parent.parent):(t===t.parent.left&&(t=t.parent,se(e,t)),t.parent.color=0,t.parent.parent.color=1,ie(e,t.parent.parent))}e.root.color=0}function ae(e,t,n,i){while(t!==e.root&&t!==Q)t.parent.left===t&&(t.parent.size_left+=n,t.parent.lf_left+=i),t=t.parent}function he(e,t){let n=0,i=0;if(t!==e.root){if(0===n){while(t!==e.root&&t===t.parent.right)t=t.parent;if(t===e.root)return;t=t.parent,n=ee(t.left)-t.size_left,i=te(t.left)-t.lf_left,t.size_left+=n,t.lf_left+=i}while(t!==e.root&&(0!==n||0!==i))t.parent.left===t&&(t.parent.size_left+=n,t.parent.lf_left+=i),t=t.parent}}Q.parent=Q,Q.left=Q,Q.right=Q,Q.color=0;var le=n("75de");const ue=65535;function ce(e){let t;return t=e[e.length-1]<65536?new Uint16Array(e.length):new Uint32Array(e.length),t.set(e,0),t}class de{constructor(e,t,n,i,s){this.lineStarts=e,this.cr=t,this.lf=n,this.crlf=i,this.isBasicASCII=s}}function fe(e,t=!0){let n=[0],i=1;for(let s=0,r=e.length;s<r;s++){const t=e.charCodeAt(s);13===t?s+1<r&&10===e.charCodeAt(s+1)?(n[i++]=s+2,s++):n[i++]=s+1:10===t&&(n[i++]=s+1)}return t?ce(n):n}function ge(e,t){e.length=0,e[0]=0;let n=1,i=0,s=0,r=0,o=!0;for(let h=0,l=t.length;h<l;h++){const a=t.charCodeAt(h);13===a?h+1<l&&10===t.charCodeAt(h+1)?(r++,e[n++]=h+2,h++):(i++,e[n++]=h+1):10===a?(s++,e[n++]=h+1):o&&9!==a&&(a<32||a>126)&&(o=!1)}const a=new de(ce(e),i,s,r,o);return e.length=0,a}class _e{constructor(e,t,n,i,s){this.bufferIndex=e,this.start=t,this.end=n,this.lineFeedCnt=i,this.length=s}}class pe{constructor(e,t){this.buffer=e,this.lineStarts=t}}class me{constructor(e,t){this._pieces=[],this._tree=e,this._BOM=t,this._index=0,e.root!==Q&&e.iterate(e.root,e=>(e!==Q&&this._pieces.push(e.piece),!0))}read(){return 0===this._pieces.length?0===this._index?(this._index++,this._BOM):null:this._index>this._pieces.length-1?null:0===this._index?this._BOM+this._tree.getPieceContent(this._pieces[this._index++]):this._tree.getPieceContent(this._pieces[this._index++])}}class Ce{constructor(e){this._limit=e,this._cache=[]}get(e){for(let t=this._cache.length-1;t>=0;t--){let n=this._cache[t];if(n.nodeStartOffset<=e&&n.nodeStartOffset+n.node.piece.length>=e)return n}return null}get2(e){for(let t=this._cache.length-1;t>=0;t--){let n=this._cache[t];if(n.nodeStartLineNumber&&n.nodeStartLineNumber<e&&n.nodeStartLineNumber+n.node.piece.lineFeedCnt>=e)return n}return null}set(e){this._cache.length>=this._limit&&this._cache.shift(),this._cache.push(e)}validate(e){let t=!1,n=this._cache;for(let i=0;i<n.length;i++){let s=n[i];(null===s.node.parent||s.nodeStartOffset>=e)&&(n[i]=null,t=!0)}if(t){let e=[];for(const t of n)null!==t&&e.push(t);this._cache=e}}}class be{constructor(e,t,n){this.create(e,t,n)}create(e,t,n){this._buffers=[new pe("",[0])],this._lastChangeBufferPos={line:0,column:0},this.root=Q,this._lineCnt=1,this._length=0,this._EOL=t,this._EOLLength=t.length,this._EOLNormalized=n;let i=null;for(let s=0,r=e.length;s<r;s++)if(e[s].buffer.length>0){e[s].lineStarts||(e[s].lineStarts=fe(e[s].buffer));let t=new _e(s+1,{line:0,column:0},{line:e[s].lineStarts.length-1,column:e[s].buffer.length-e[s].lineStarts[e[s].lineStarts.length-1]},e[s].lineStarts.length-1,e[s].buffer.length);this._buffers.push(e[s]),i=this.rbInsertRight(i,t)}this._searchCache=new Ce(1),this._lastVisitedLine={lineNumber:0,value:""},this.computeBufferMetadata()}normalizeEOL(e){let t=ue,n=t-Math.floor(t/3),i=2*n,s="",r=0,o=[];if(this.iterate(this.root,t=>{let a=this.getNodeContent(t),h=a.length;if(r<=n||r+h<i)return s+=a,r+=h,!0;let l=s.replace(/\r\n|\r|\n/g,e);return o.push(new pe(l,fe(l))),s=a,r=h,!0}),r>0){let t=s.replace(/\r\n|\r|\n/g,e);o.push(new pe(t,fe(t)))}this.create(o,e,!0)}getEOL(){return this._EOL}setEOL(e){this._EOL=e,this._EOLLength=this._EOL.length,this.normalizeEOL(e)}createSnapshot(e){return new me(this,e)}getOffsetAt(e,t){let n=0,i=this.root;while(i!==Q)if(i.left!==Q&&i.lf_left+1>=e)i=i.left;else{if(i.lf_left+i.piece.lineFeedCnt+1>=e){n+=i.size_left;let s=this.getAccumulatedValue(i,e-i.lf_left-2);return n+(s+t-1)}e-=i.lf_left+i.piece.lineFeedCnt,n+=i.size_left+i.piece.length,i=i.right}return n}getPositionAt(e){e=Math.floor(e),e=Math.max(0,e);let t=this.root,n=0,i=e;while(t!==Q)if(0!==t.size_left&&t.size_left>=e)t=t.left;else{if(t.size_left+t.piece.length>=e){let s=this.getIndexOf(t,e-t.size_left);if(n+=t.lf_left+s.index,0===s.index){let e=this.getOffsetAt(n+1,1),t=i-e;return new l["a"](n+1,t+1)}return new l["a"](n+1,s.remainder+1)}if(e-=t.size_left+t.piece.length,n+=t.lf_left+t.piece.lineFeedCnt,t.right===Q){let t=this.getOffsetAt(n+1,1),s=i-e-t;return new l["a"](n+1,s+1)}t=t.right}return new l["a"](1,1)}getValueInRange(e,t){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return"";let n=this.nodeAt2(e.startLineNumber,e.startColumn),i=this.nodeAt2(e.endLineNumber,e.endColumn),s=this.getValueInRange2(n,i);return t?t===this._EOL&&this._EOLNormalized&&t===this.getEOL()&&this._EOLNormalized?s:s.replace(/\r\n|\r|\n/g,t):s}getValueInRange2(e,t){if(e.node===t.node){let n=e.node,i=this._buffers[n.piece.bufferIndex].buffer,s=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);return i.substring(s+e.remainder,s+t.remainder)}let n=e.node,i=this._buffers[n.piece.bufferIndex].buffer,s=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start),r=i.substring(s+e.remainder,s+n.piece.length);n=n.next();while(n!==Q){let e=this._buffers[n.piece.bufferIndex].buffer,i=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);if(n===t.node){r+=e.substring(i,i+t.remainder);break}r+=e.substr(i,n.piece.length),n=n.next()}return r}getLinesContent(){let e=[],t=0,n="",i=!1;return this.iterate(this.root,s=>{if(s===Q)return!0;const r=s.piece;let o=r.length;if(0===o)return!0;const a=this._buffers[r.bufferIndex].buffer,h=this._buffers[r.bufferIndex].lineStarts,l=r.start.line,u=r.end.line;let c=h[l]+r.start.column;if(i&&(10===a.charCodeAt(c)&&(c++,o--),e[t++]=n,n="",i=!1,0===o))return!0;if(l===u)return this._EOLNormalized||13!==a.charCodeAt(c+o-1)?n+=a.substr(c,o):(i=!0,n+=a.substr(c,o-1)),!0;n+=this._EOLNormalized?a.substring(c,Math.max(c,h[l+1]-this._EOLLength)):a.substring(c,h[l+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=n;for(let i=l+1;i<u;i++)n=this._EOLNormalized?a.substring(h[i],h[i+1]-this._EOLLength):a.substring(h[i],h[i+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=n;return this._EOLNormalized||13!==a.charCodeAt(h[u]+r.end.column-1)?n=a.substr(h[u],r.end.column):(i=!0,0===r.end.column?t--:n=a.substr(h[u],r.end.column-1)),!0}),i&&(e[t++]=n,n=""),e[t++]=n,e}getLength(){return this._length}getLineCount(){return this._lineCnt}getLineContent(e){return this._lastVisitedLine.lineNumber===e||(this._lastVisitedLine.lineNumber=e,e===this._lineCnt?this._lastVisitedLine.value=this.getLineRawContent(e):this._EOLNormalized?this._lastVisitedLine.value=this.getLineRawContent(e,this._EOLLength):this._lastVisitedLine.value=this.getLineRawContent(e).replace(/(\r\n|\r|\n)$/,"")),this._lastVisitedLine.value}_getCharCode(e){if(e.remainder===e.node.piece.length){let t=e.node.next();if(!t)return 0;let n=this._buffers[t.piece.bufferIndex],i=this.offsetInBuffer(t.piece.bufferIndex,t.piece.start);return n.buffer.charCodeAt(i)}{let t=this._buffers[e.node.piece.bufferIndex],n=this.offsetInBuffer(e.node.piece.bufferIndex,e.node.piece.start),i=n+e.remainder;return t.buffer.charCodeAt(i)}}getLineCharCode(e,t){let n=this.nodeAt2(e,t+1);return this._getCharCode(n)}getLineLength(e){if(e===this.getLineCount()){let t=this.getOffsetAt(e,1);return this.getLength()-t}return this.getOffsetAt(e+1,1)-this.getOffsetAt(e,1)-this._EOLLength}findMatchesInNode(e,t,n,i,s,r,o,a,h,l,c){let d,f,g,_=this._buffers[e.piece.bufferIndex],p=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start),m=this.offsetInBuffer(e.piece.bufferIndex,s),C=this.offsetInBuffer(e.piece.bufferIndex,r),b={line:0,column:0};t._wordSeparators?(f=_.buffer.substring(m,C),g=e=>e+m,t.reset(0)):(f=_.buffer,g=e=>e,t.reset(m));do{if(d=t.next(f),d){if(g(d.index)>=C)return l;this.positionInBuffer(e,g(d.index)-p,b);let t=this.getLineFeedCnt(e.piece.bufferIndex,s,b),r=b.line===s.line?b.column-s.column+i:b.column+1,o=r+d[0].length;if(c[l++]=Object(le["d"])(new u["a"](n+t,r,n+t,o),d,a),g(d.index)+d[0].length>=C)return l;if(l>=h)return l}}while(d);return l}findMatchesLineByLine(e,t,n,i){const s=[];let r=0;const o=new le["b"](t.wordSeparators,t.regex);let a=this.nodeAt2(e.startLineNumber,e.startColumn);if(null===a)return[];let h=this.nodeAt2(e.endLineNumber,e.endColumn);if(null===h)return[];let l=this.positionInBuffer(a.node,a.remainder),u=this.positionInBuffer(h.node,h.remainder);if(a.node===h.node)return this.findMatchesInNode(a.node,o,e.startLineNumber,e.startColumn,l,u,t,n,i,r,s),s;let c=e.startLineNumber,d=a.node;while(d!==h.node){let h=this.getLineFeedCnt(d.piece.bufferIndex,l,d.piece.end);if(h>=1){let a=this._buffers[d.piece.bufferIndex].lineStarts,u=this.offsetInBuffer(d.piece.bufferIndex,d.piece.start),f=a[l.line+h],g=c===e.startLineNumber?e.startColumn:1;if(r=this.findMatchesInNode(d,o,c,g,l,this.positionInBuffer(d,f-u),t,n,i,r,s),r>=i)return s;c+=h}let u=c===e.startLineNumber?e.startColumn-1:0;if(c===e.endLineNumber){const a=this.getLineContent(c).substring(u,e.endColumn-1);return r=this._findMatchesInLine(t,o,a,e.endLineNumber,u,r,s,n,i),s}if(r=this._findMatchesInLine(t,o,this.getLineContent(c).substr(u),c,u,r,s,n,i),r>=i)return s;c++,a=this.nodeAt2(c,1),d=a.node,l=this.positionInBuffer(a.node,a.remainder)}if(c===e.endLineNumber){let a=c===e.startLineNumber?e.startColumn-1:0;const h=this.getLineContent(c).substring(a,e.endColumn-1);return r=this._findMatchesInLine(t,o,h,e.endLineNumber,a,r,s,n,i),s}let f=c===e.startLineNumber?e.startColumn:1;return r=this.findMatchesInNode(h.node,o,c,f,l,u,t,n,i,r,s),s}_findMatchesInLine(e,t,n,i,s,r,o,a,h){const l=e.wordSeparators;if(!a&&e.simpleSearch){const t=e.simpleSearch,a=t.length,c=n.length;let f=-a;while(-1!==(f=n.indexOf(t,f+a)))if((!l||Object(le["e"])(l,n,c,f,a))&&(o[r++]=new d["b"](new u["a"](i,f+1+s,i,f+1+a+s),null),r>=h))return r;return r}let c;t.reset(0);do{if(c=t.next(n),c&&(o[r++]=Object(le["d"])(new u["a"](i,c.index+1+s,i,c.index+1+c[0].length+s),c,a),r>=h))return r}while(c);return r}insert(e,t,n=!1){if(this._EOLNormalized=this._EOLNormalized&&n,this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",this.root!==Q){let{node:n,remainder:i,nodeStartOffset:s}=this.nodeAt(e),r=n.piece,o=r.bufferIndex,a=this.positionInBuffer(n,i);if(0===n.piece.bufferIndex&&r.end.line===this._lastChangeBufferPos.line&&r.end.column===this._lastChangeBufferPos.column&&s+r.length===e&&t.length<ue)return this.appendToNode(n,t),void this.computeBufferMetadata();if(s===e)this.insertContentToNodeLeft(t,n),this._searchCache.validate(e);else if(s+n.piece.length>e){let e=[],s=new _e(r.bufferIndex,a,r.end,this.getLineFeedCnt(r.bufferIndex,a,r.end),this.offsetInBuffer(o,r.end)-this.offsetInBuffer(o,a));if(this.shouldCheckCRLF()&&this.endWithCR(t)){let e=this.nodeCharCodeAt(n,i);if(10===e){let e={line:s.start.line+1,column:0};s=new _e(s.bufferIndex,e,s.end,this.getLineFeedCnt(s.bufferIndex,e,s.end),s.length-1),t+="\n"}}if(this.shouldCheckCRLF()&&this.startWithLF(t)){let s=this.nodeCharCodeAt(n,i-1);if(13===s){let s=this.positionInBuffer(n,i-1);this.deleteNodeTail(n,s),t="\r"+t,0===n.piece.length&&e.push(n)}else this.deleteNodeTail(n,a)}else this.deleteNodeTail(n,a);let h=this.createNewPieces(t);s.length>0&&this.rbInsertRight(n,s);let l=n;for(let t=0;t<h.length;t++)l=this.rbInsertRight(l,h[t]);this.deleteNodes(e)}else this.insertContentToNodeRight(t,n)}else{let e=this.createNewPieces(t),n=this.rbInsertLeft(null,e[0]);for(let t=1;t<e.length;t++)n=this.rbInsertRight(n,e[t])}this.computeBufferMetadata()}delete(e,t){if(this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",t<=0||this.root===Q)return;let n=this.nodeAt(e),i=this.nodeAt(e+t),s=n.node,r=i.node;if(s===r){let r=this.positionInBuffer(s,n.remainder),o=this.positionInBuffer(s,i.remainder);if(n.nodeStartOffset===e){if(t===s.piece.length){let e=s.next();return re(this,s),this.validateCRLFWithPrevNode(e),void this.computeBufferMetadata()}return this.deleteNodeHead(s,o),this._searchCache.validate(e),this.validateCRLFWithPrevNode(s),void this.computeBufferMetadata()}return n.nodeStartOffset+s.piece.length===e+t?(this.deleteNodeTail(s,r),this.validateCRLFWithNextNode(s),void this.computeBufferMetadata()):(this.shrinkNode(s,r,o),void this.computeBufferMetadata())}let o=[],a=this.positionInBuffer(s,n.remainder);this.deleteNodeTail(s,a),this._searchCache.validate(e),0===s.piece.length&&o.push(s);let h=this.positionInBuffer(r,i.remainder);this.deleteNodeHead(r,h),0===r.piece.length&&o.push(r);let l=s.next();for(let c=l;c!==Q&&c!==r;c=c.next())o.push(c);let u=0===s.piece.length?s.prev():s;this.deleteNodes(o),this.validateCRLFWithNextNode(u),this.computeBufferMetadata()}insertContentToNodeLeft(e,t){let n=[];if(this.shouldCheckCRLF()&&this.endWithCR(e)&&this.startWithLF(t)){let i=t.piece,s={line:i.start.line+1,column:0},r=new _e(i.bufferIndex,s,i.end,this.getLineFeedCnt(i.bufferIndex,s,i.end),i.length-1);t.piece=r,e+="\n",ae(this,t,-1,-1),0===t.piece.length&&n.push(t)}let i=this.createNewPieces(e),s=this.rbInsertLeft(t,i[i.length-1]);for(let r=i.length-2;r>=0;r--)s=this.rbInsertLeft(s,i[r]);this.validateCRLFWithPrevNode(s),this.deleteNodes(n)}insertContentToNodeRight(e,t){this.adjustCarriageReturnFromNext(e,t)&&(e+="\n");let n=this.createNewPieces(e),i=this.rbInsertRight(t,n[0]),s=i;for(let r=1;r<n.length;r++)s=this.rbInsertRight(s,n[r]);this.validateCRLFWithPrevNode(i)}positionInBuffer(e,t,n){let i=e.piece,s=e.piece.bufferIndex,r=this._buffers[s].lineStarts,o=r[i.start.line]+i.start.column,a=o+t,h=i.start.line,l=i.end.line,u=0,c=0,d=0;while(h<=l){if(u=h+(l-h)/2|0,d=r[u],u===l)break;if(c=r[u+1],a<d)l=u-1;else{if(!(a>=c))break;h=u+1}}return n?(n.line=u,n.column=a-d,null):{line:u,column:a-d}}getLineFeedCnt(e,t,n){if(0===n.column)return n.line-t.line;let i=this._buffers[e].lineStarts;if(n.line===i.length-1)return n.line-t.line;let s=i[n.line+1],r=i[n.line]+n.column;if(s>r+1)return n.line-t.line;let o=r-1,a=this._buffers[e].buffer;return 13===a.charCodeAt(o)?n.line-t.line+1:n.line-t.line}offsetInBuffer(e,t){let n=this._buffers[e].lineStarts;return n[t.line]+t.column}deleteNodes(e){for(let t=0;t<e.length;t++)re(this,e[t])}createNewPieces(e){if(e.length>ue){let t=[];while(e.length>ue){const n=e.charCodeAt(ue-1);let i;13===n||n>=55296&&n<=56319?(i=e.substring(0,ue-1),e=e.substring(ue-1)):(i=e.substring(0,ue),e=e.substring(ue));let s=fe(i);t.push(new _e(this._buffers.length,{line:0,column:0},{line:s.length-1,column:i.length-s[s.length-1]},s.length-1,i.length)),this._buffers.push(new pe(i,s))}let n=fe(e);return t.push(new _e(this._buffers.length,{line:0,column:0},{line:n.length-1,column:e.length-n[n.length-1]},n.length-1,e.length)),this._buffers.push(new pe(e,n)),t}let t=this._buffers[0].buffer.length;const n=fe(e,!1);let i=this._lastChangeBufferPos;if(this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-1]===t&&0!==t&&this.startWithLF(e)&&this.endWithCR(this._buffers[0].buffer)){this._lastChangeBufferPos={line:this._lastChangeBufferPos.line,column:this._lastChangeBufferPos.column+1},i=this._lastChangeBufferPos;for(let e=0;e<n.length;e++)n[e]+=t+1;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(n.slice(1)),this._buffers[0].buffer+="_"+e,t+=1}else{if(0!==t)for(let e=0;e<n.length;e++)n[e]+=t;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(n.slice(1)),this._buffers[0].buffer+=e}const s=this._buffers[0].buffer.length;let r=this._buffers[0].lineStarts.length-1,o=s-this._buffers[0].lineStarts[r],a={line:r,column:o},h=new _e(0,i,a,this.getLineFeedCnt(0,i,a),s-t);return this._lastChangeBufferPos=a,[h]}getLineRawContent(e,t=0){let n=this.root,i="",s=this._searchCache.get2(e);if(s){n=s.node;let r=this.getAccumulatedValue(n,e-s.nodeStartLineNumber-1),o=this._buffers[n.piece.bufferIndex].buffer,a=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);if(s.nodeStartLineNumber+n.piece.lineFeedCnt!==e){let i=this.getAccumulatedValue(n,e-s.nodeStartLineNumber);return o.substring(a+r,a+i-t)}i=o.substring(a+r,a+n.piece.length)}else{let s=0;const r=e;while(n!==Q)if(n.left!==Q&&n.lf_left>=e-1)n=n.left;else{if(n.lf_left+n.piece.lineFeedCnt>e-1){let i=this.getAccumulatedValue(n,e-n.lf_left-2),o=this.getAccumulatedValue(n,e-n.lf_left-1),a=this._buffers[n.piece.bufferIndex].buffer,h=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);return s+=n.size_left,this._searchCache.set({node:n,nodeStartOffset:s,nodeStartLineNumber:r-(e-1-n.lf_left)}),a.substring(h+i,h+o-t)}if(n.lf_left+n.piece.lineFeedCnt===e-1){let t=this.getAccumulatedValue(n,e-n.lf_left-2),s=this._buffers[n.piece.bufferIndex].buffer,r=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);i=s.substring(r+t,r+n.piece.length);break}e-=n.lf_left+n.piece.lineFeedCnt,s+=n.size_left+n.piece.length,n=n.right}}n=n.next();while(n!==Q){let e=this._buffers[n.piece.bufferIndex].buffer;if(n.piece.lineFeedCnt>0){let s=this.getAccumulatedValue(n,0),r=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);return i+=e.substring(r,r+s-t),i}{let t=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);i+=e.substr(t,n.piece.length)}n=n.next()}return i}computeBufferMetadata(){let e=this.root,t=1,n=0;while(e!==Q)t+=e.lf_left+e.piece.lineFeedCnt,n+=e.size_left+e.piece.length,e=e.right;this._lineCnt=t,this._length=n,this._searchCache.validate(this._length)}getIndexOf(e,t){let n=e.piece,i=this.positionInBuffer(e,t),s=i.line-n.start.line;if(this.offsetInBuffer(n.bufferIndex,n.end)-this.offsetInBuffer(n.bufferIndex,n.start)===t){let t=this.getLineFeedCnt(e.piece.bufferIndex,n.start,i);if(t!==s)return{index:t,remainder:0}}return{index:s,remainder:i.column}}getAccumulatedValue(e,t){if(t<0)return 0;let n=e.piece,i=this._buffers[n.bufferIndex].lineStarts,s=n.start.line+t+1;return s>n.end.line?i[n.end.line]+n.end.column-i[n.start.line]-n.start.column:i[s]-i[n.start.line]-n.start.column}deleteNodeTail(e,t){const n=e.piece,i=n.lineFeedCnt,s=this.offsetInBuffer(n.bufferIndex,n.end),r=t,o=this.offsetInBuffer(n.bufferIndex,r),a=this.getLineFeedCnt(n.bufferIndex,n.start,r),h=a-i,l=o-s,u=n.length+l;e.piece=new _e(n.bufferIndex,n.start,r,a,u),ae(this,e,l,h)}deleteNodeHead(e,t){const n=e.piece,i=n.lineFeedCnt,s=this.offsetInBuffer(n.bufferIndex,n.start),r=t,o=this.getLineFeedCnt(n.bufferIndex,r,n.end),a=this.offsetInBuffer(n.bufferIndex,r),h=o-i,l=s-a,u=n.length+l;e.piece=new _e(n.bufferIndex,r,n.end,o,u),ae(this,e,l,h)}shrinkNode(e,t,n){const i=e.piece,s=i.start,r=i.end,o=i.length,a=i.lineFeedCnt,h=t,l=this.getLineFeedCnt(i.bufferIndex,i.start,h),u=this.offsetInBuffer(i.bufferIndex,t)-this.offsetInBuffer(i.bufferIndex,s);e.piece=new _e(i.bufferIndex,i.start,h,l,u),ae(this,e,u-o,l-a);let c=new _e(i.bufferIndex,n,r,this.getLineFeedCnt(i.bufferIndex,n,r),this.offsetInBuffer(i.bufferIndex,r)-this.offsetInBuffer(i.bufferIndex,n)),d=this.rbInsertRight(e,c);this.validateCRLFWithPrevNode(d)}appendToNode(e,t){this.adjustCarriageReturnFromNext(t,e)&&(t+="\n");const n=this.shouldCheckCRLF()&&this.startWithLF(t)&&this.endWithCR(e),i=this._buffers[0].buffer.length;this._buffers[0].buffer+=t;const s=fe(t,!1);for(let d=0;d<s.length;d++)s[d]+=i;if(n){let e=this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-2];this._buffers[0].lineStarts.pop(),this._lastChangeBufferPos={line:this._lastChangeBufferPos.line-1,column:i-e}}this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(s.slice(1));const r=this._buffers[0].lineStarts.length-1,o=this._buffers[0].buffer.length-this._buffers[0].lineStarts[r],a={line:r,column:o},h=e.piece.length+t.length,l=e.piece.lineFeedCnt,u=this.getLineFeedCnt(0,e.piece.start,a),c=u-l;e.piece=new _e(e.piece.bufferIndex,e.piece.start,a,u,h),this._lastChangeBufferPos=a,ae(this,e,t.length,c)}nodeAt(e){let t=this.root,n=this._searchCache.get(e);if(n)return{node:n.node,nodeStartOffset:n.nodeStartOffset,remainder:e-n.nodeStartOffset};let i=0;while(t!==Q)if(t.size_left>e)t=t.left;else{if(t.size_left+t.piece.length>=e){i+=t.size_left;let n={node:t,remainder:e-t.size_left,nodeStartOffset:i};return this._searchCache.set(n),n}e-=t.size_left+t.piece.length,i+=t.size_left+t.piece.length,t=t.right}return null}nodeAt2(e,t){let n=this.root,i=0;while(n!==Q)if(n.left!==Q&&n.lf_left>=e-1)n=n.left;else{if(n.lf_left+n.piece.lineFeedCnt>e-1){let s=this.getAccumulatedValue(n,e-n.lf_left-2),r=this.getAccumulatedValue(n,e-n.lf_left-1);return i+=n.size_left,{node:n,remainder:Math.min(s+t-1,r),nodeStartOffset:i}}if(n.lf_left+n.piece.lineFeedCnt===e-1){let s=this.getAccumulatedValue(n,e-n.lf_left-2);if(s+t-1<=n.piece.length)return{node:n,remainder:s+t-1,nodeStartOffset:i};t-=n.piece.length-s;break}e-=n.lf_left+n.piece.lineFeedCnt,i+=n.size_left+n.piece.length,n=n.right}n=n.next();while(n!==Q){if(n.piece.lineFeedCnt>0){let e=this.getAccumulatedValue(n,0),i=this.offsetOfNode(n);return{node:n,remainder:Math.min(t-1,e),nodeStartOffset:i}}if(n.piece.length>=t-1){let e=this.offsetOfNode(n);return{node:n,remainder:t-1,nodeStartOffset:e}}t-=n.piece.length,n=n.next()}return null}nodeCharCodeAt(e,t){if(e.piece.lineFeedCnt<1)return-1;let n=this._buffers[e.piece.bufferIndex],i=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start)+t;return n.buffer.charCodeAt(i)}offsetOfNode(e){if(!e)return 0;let t=e.size_left;while(e!==this.root)e.parent.right===e&&(t+=e.parent.size_left+e.parent.piece.length),e=e.parent;return t}shouldCheckCRLF(){return!(this._EOLNormalized&&"\n"===this._EOL)}startWithLF(e){if("string"===typeof e)return 10===e.charCodeAt(0);if(e===Q||0===e.piece.lineFeedCnt)return!1;let t=e.piece,n=this._buffers[t.bufferIndex].lineStarts,i=t.start.line,s=n[i]+t.start.column;if(i===n.length-1)return!1;let r=n[i+1];return!(r>s+1)&&10===this._buffers[t.bufferIndex].buffer.charCodeAt(s)}endWithCR(e){return"string"===typeof e?13===e.charCodeAt(e.length-1):e!==Q&&0!==e.piece.lineFeedCnt&&13===this.nodeCharCodeAt(e,e.piece.length-1)}validateCRLFWithPrevNode(e){if(this.shouldCheckCRLF()&&this.startWithLF(e)){let t=e.prev();this.endWithCR(t)&&this.fixCRLF(t,e)}}validateCRLFWithNextNode(e){if(this.shouldCheckCRLF()&&this.endWithCR(e)){let t=e.next();this.startWithLF(t)&&this.fixCRLF(e,t)}}fixCRLF(e,t){let n,i=[],s=this._buffers[e.piece.bufferIndex].lineStarts;n=0===e.piece.end.column?{line:e.piece.end.line-1,column:s[e.piece.end.line]-s[e.piece.end.line-1]-1}:{line:e.piece.end.line,column:e.piece.end.column-1};const r=e.piece.length-1,o=e.piece.lineFeedCnt-1;e.piece=new _e(e.piece.bufferIndex,e.piece.start,n,o,r),ae(this,e,-1,-1),0===e.piece.length&&i.push(e);let a={line:t.piece.start.line+1,column:0};const h=t.piece.length-1,l=this.getLineFeedCnt(t.piece.bufferIndex,a,t.piece.end);t.piece=new _e(t.piece.bufferIndex,a,t.piece.end,l,h),ae(this,t,-1,-1),0===t.piece.length&&i.push(t);let u=this.createNewPieces("\r\n");this.rbInsertRight(e,u[0]);for(let c=0;c<i.length;c++)re(this,i[c])}adjustCarriageReturnFromNext(e,t){if(this.shouldCheckCRLF()&&this.endWithCR(e)){let n=t.next();if(this.startWithLF(n)){if(e+="\n",1===n.piece.length)re(this,n);else{const e=n.piece,t={line:e.start.line+1,column:0},i=e.length-1,s=this.getLineFeedCnt(e.bufferIndex,t,e.end);n.piece=new _e(e.bufferIndex,t,e.end,s,i),ae(this,n,-1,-1)}return!0}}return!1}iterate(e,t){if(e===Q)return t(Q);let n=this.iterate(e.left,t);return n?t(e)&&this.iterate(e.right,t):n}getNodeContent(e){if(e===Q)return"";let t,n=this._buffers[e.piece.bufferIndex],i=e.piece,s=this.offsetInBuffer(i.bufferIndex,i.start),r=this.offsetInBuffer(i.bufferIndex,i.end);return t=n.buffer.substring(s,r),t}getPieceContent(e){let t=this._buffers[e.bufferIndex],n=this.offsetInBuffer(e.bufferIndex,e.start),i=this.offsetInBuffer(e.bufferIndex,e.end),s=t.buffer.substring(n,i);return s}rbInsertRight(e,t){let n=new Y(t,1);n.left=Q,n.right=Q,n.parent=Q,n.size_left=0,n.lf_left=0;let i=this.root;if(i===Q)this.root=n,n.color=0;else if(e.right===Q)e.right=n,n.parent=e;else{let t=Z(e.right);t.left=n,n.parent=t}return oe(this,n),n}rbInsertLeft(e,t){let n=new Y(t,1);if(n.left=Q,n.right=Q,n.parent=Q,n.size_left=0,n.lf_left=0,this.root===Q)this.root=n,n.color=0;else if(e.left===Q)e.left=n,n.parent=e;else{let t=X(e.left);t.right=n,n.parent=t}return oe(this,n),n}}var Le=n("8407"),ke=n("8c64");class we extends r["a"]{constructor(e,t,n,i,r,o,a){super(),this._onDidChangeContent=this._register(new s["b"]),this._BOM=t,this._mightContainNonBasicASCII=!o,this._mightContainRTL=i,this._mightContainUnusualLineTerminators=r,this._pieceTree=new be(e,n,a)}mightContainRTL(){return this._mightContainRTL}mightContainUnusualLineTerminators(){return this._mightContainUnusualLineTerminators}resetMightContainUnusualLineTerminators(){this._mightContainUnusualLineTerminators=!1}mightContainNonBasicASCII(){return this._mightContainNonBasicASCII}getBOM(){return this._BOM}getEOL(){return this._pieceTree.getEOL()}createSnapshot(e){return this._pieceTree.createSnapshot(e?this._BOM:"")}getOffsetAt(e,t){return this._pieceTree.getOffsetAt(e,t)}getPositionAt(e){return this._pieceTree.getPositionAt(e)}getRangeAt(e,t){let n=e+t;const i=this.getPositionAt(e),s=this.getPositionAt(n);return new u["a"](i.lineNumber,i.column,s.lineNumber,s.column)}getValueInRange(e,t=0){if(e.isEmpty())return"";const n=this._getEndOfLine(t);return this._pieceTree.getValueInRange(e,n)}getValueLengthInRange(e,t=0){if(e.isEmpty())return 0;if(e.startLineNumber===e.endLineNumber)return e.endColumn-e.startColumn;let n=this.getOffsetAt(e.startLineNumber,e.startColumn),i=this.getOffsetAt(e.endLineNumber,e.endColumn);return i-n}getCharacterCountInRange(e,t=0){if(this._mightContainNonBasicASCII){let n=0;const i=e.startLineNumber,s=e.endLineNumber;for(let t=i;t<=s;t++){const r=this.getLineContent(t),a=t===i?e.startColumn-1:0,h=t===s?e.endColumn-1:r.length;for(let e=a;e<h;e++)o["E"](r.charCodeAt(e))?(n+=1,e+=1):n+=1}return n+=this._getEndOfLine(t).length*(s-i),n}return this.getValueLengthInRange(e,t)}getLength(){return this._pieceTree.getLength()}getLineCount(){return this._pieceTree.getLineCount()}getLinesContent(){return this._pieceTree.getLinesContent()}getLineContent(e){return this._pieceTree.getLineContent(e)}getLineCharCode(e,t){return this._pieceTree.getLineCharCode(e,t)}getLineLength(e){return this._pieceTree.getLineLength(e)}getLineFirstNonWhitespaceColumn(e){const t=o["u"](this.getLineContent(e));return-1===t?0:t+1}getLineLastNonWhitespaceColumn(e){const t=o["I"](this.getLineContent(e));return-1===t?0:t+2}_getEndOfLine(e){switch(e){case 1:return"\n";case 2:return"\r\n";case 0:return this.getEOL();default:throw new Error("Unknown EOL preference")}}setEOL(e){this._pieceTree.setEOL(e)}applyEdits(e,t,n){let i=this._mightContainRTL,s=this._mightContainUnusualLineTerminators,r=this._mightContainNonBasicASCII,a=!0,h=[];for(let d=0;d<e.length;d++){let t=e[d];a&&t._isTracked&&(a=!1);let n=t.range;if(t.text){let e=!0;r||(e=!o["A"](t.text),r=e),!i&&e&&(i=o["m"](t.text)),!s&&e&&(s=o["n"](t.text))}let l="",u=0,c=0,f=0;if(t.text){let e;[u,c,f,e]=Object(Le["f"])(t.text);const n=this.getEOL(),i="\r\n"===n?2:1;l=0===e||e===i?t.text:t.text.replace(/\r\n|\r|\n/g,n)}h[d]={sortIndex:d,identifier:t.identifier||null,range:n,rangeOffset:this.getOffsetAt(n.startLineNumber,n.startColumn),rangeLength:this.getValueLengthInRange(n),text:l,eolCount:u,firstLineLength:c,lastLineLength:f,forceMoveMarkers:Boolean(t.forceMoveMarkers),isAutoWhitespaceEdit:t.isAutoWhitespaceEdit||!1}}h.sort(we._sortOpsAscending);let l=!1;for(let o=0,d=h.length-1;o<d;o++){let e=h[o].range.getEndPosition(),t=h[o+1].range.getStartPosition();if(t.isBeforeOrEqual(e)){if(t.isBefore(e))throw new Error("Overlapping ranges are not allowed!");l=!0}}a&&(h=this._reduceOperations(h));let u=n||t?we._getInverseEditRanges(h):[],c=[];if(t)for(let d=0;d<h.length;d++){let e=h[d],t=u[d];if(e.isAutoWhitespaceEdit&&e.range.isEmpty())for(let n=t.startLineNumber;n<=t.endLineNumber;n++){let i="";n===t.startLineNumber&&(i=this.getLineContent(e.range.startLineNumber),-1!==o["u"](i))||c.push({lineNumber:n,oldContent:i})}}let f=null;if(n){let e=0;f=[];for(let t=0;t<h.length;t++){const n=h[t],i=u[t],s=this.getValueInRange(n.range),r=n.rangeOffset+e;e+=n.text.length-s.length,f[t]={sortIndex:n.sortIndex,identifier:n.identifier,range:i,text:s,textChange:new ke["a"](n.rangeOffset,s,r,n.text)}}l||f.sort((e,t)=>e.sortIndex-t.sortIndex)}this._mightContainRTL=i,this._mightContainUnusualLineTerminators=s,this._mightContainNonBasicASCII=r;const g=this._doApplyEdits(h);let _=null;if(t&&c.length>0){c.sort((e,t)=>t.lineNumber-e.lineNumber),_=[];for(let e=0,t=c.length;e<t;e++){let t=c[e].lineNumber;if(e>0&&c[e-1].lineNumber===t)continue;let n=c[e].oldContent,i=this.getLineContent(t);0!==i.length&&i!==n&&-1===o["u"](i)&&_.push(t)}}return this._onDidChangeContent.fire(),new d["a"](f,g,_)}_reduceOperations(e){return e.length<1e3?e:[this._toSingleEditOperation(e)]}_toSingleEditOperation(e){let t=!1;const n=e[0].range,i=e[e.length-1].range,s=new u["a"](n.startLineNumber,n.startColumn,i.endLineNumber,i.endColumn);let r=n.startLineNumber,o=n.startColumn;const a=[];for(let f=0,g=e.length;f<g;f++){const n=e[f],i=n.range;t=t||n.forceMoveMarkers,a.push(this.getValueInRange(new u["a"](r,o,i.startLineNumber,i.startColumn))),n.text.length>0&&a.push(n.text),r=i.endLineNumber,o=i.endColumn}const h=a.join(""),[l,c,d]=Object(Le["f"])(h);return{sortIndex:0,identifier:e[0].identifier,range:s,rangeOffset:this.getOffsetAt(s.startLineNumber,s.startColumn),rangeLength:this.getValueLengthInRange(s,0),text:h,eolCount:l,firstLineLength:c,lastLineLength:d,forceMoveMarkers:t,isAutoWhitespaceEdit:!1}}_doApplyEdits(e){e.sort(we._sortOpsDescending);let t=[];for(let n=0;n<e.length;n++){let i=e[n];const s=i.range.startLineNumber,r=i.range.startColumn,o=i.range.endLineNumber,a=i.range.endColumn;if(s===o&&r===a&&0===i.text.length)continue;i.text?(this._pieceTree.delete(i.rangeOffset,i.rangeLength),this._pieceTree.insert(i.rangeOffset,i.text,!0)):this._pieceTree.delete(i.rangeOffset,i.rangeLength);const h=new u["a"](s,r,o,a);t.push({range:h,rangeLength:i.rangeLength,text:i.text,rangeOffset:i.rangeOffset,forceMoveMarkers:i.forceMoveMarkers})}return t}findMatchesLineByLine(e,t,n,i){return this._pieceTree.findMatchesLineByLine(e,t,n,i)}static _getInverseEditRanges(e){let t=[],n=0,i=0,s=null;for(let r=0,o=e.length;r<o;r++){let o,a,h,l=e[r];if(s?s.range.endLineNumber===l.range.startLineNumber?(o=n,a=i+(l.range.startColumn-s.range.endColumn)):(o=n+(l.range.startLineNumber-s.range.endLineNumber),a=l.range.startColumn):(o=l.range.startLineNumber,a=l.range.startColumn),l.text.length>0){const e=l.eolCount+1;h=1===e?new u["a"](o,a,o,a+l.firstLineLength):new u["a"](o,a,o+e-1,l.lastLineLength+1)}else h=new u["a"](o,a,o,a);n=h.endLineNumber,i=h.endColumn,t.push(h),s=l}return t}static _sortOpsAscending(e,t){let n=u["a"].compareRangesUsingEnds(e.range,t.range);return 0===n?e.sortIndex-t.sortIndex:n}static _sortOpsDescending(e,t){let n=u["a"].compareRangesUsingEnds(e.range,t.range);return 0===n?t.sortIndex-e.sortIndex:-n}}class xe{constructor(e,t,n,i,s,r,o,a,h){this._chunks=e,this._bom=t,this._cr=n,this._lf=i,this._crlf=s,this._containsRTL=r,this._containsUnusualLineTerminators=o,this._isBasicASCII=a,this._normalizeEOL=h}_getEOL(e){const t=this._cr+this._lf+this._crlf,n=this._cr+this._crlf;return 0===t?1===e?"\n":"\r\n":n>t/2?"\r\n":"\n"}create(e){const t=this._getEOL(e);let n=this._chunks;if(this._normalizeEOL&&("\r\n"===t&&(this._cr>0||this._lf>0)||"\n"===t&&(this._cr>0||this._crlf>0)))for(let s=0,r=n.length;s<r;s++){let e=n[s].buffer.replace(/\r\n|\r|\n/g,t),i=fe(e);n[s]=new pe(e,i)}const i=new we(n,this._bom,t,this._containsRTL,this._containsUnusualLineTerminators,this._isBasicASCII,this._normalizeEOL);return{textBuffer:i,disposable:i}}}class Ie{constructor(){this.chunks=[],this.BOM="",this._hasPreviousChar=!1,this._previousChar=0,this._tmpLineStarts=[],this.cr=0,this.lf=0,this.crlf=0,this.containsRTL=!1,this.containsUnusualLineTerminators=!1,this.isBasicASCII=!0}acceptChunk(e){if(0===e.length)return;0===this.chunks.length&&o["S"](e)&&(this.BOM=o["b"],e=e.substr(1));const t=e.charCodeAt(e.length-1);13===t||t>=55296&&t<=56319?(this._acceptChunk1(e.substr(0,e.length-1),!1),this._hasPreviousChar=!0,this._previousChar=t):(this._acceptChunk1(e,!1),this._hasPreviousChar=!1,this._previousChar=t)}_acceptChunk1(e,t){(t||0!==e.length)&&(this._hasPreviousChar?this._acceptChunk2(String.fromCharCode(this._previousChar)+e):this._acceptChunk2(e))}_acceptChunk2(e){const t=ge(this._tmpLineStarts,e);this.chunks.push(new pe(e,t.lineStarts)),this.cr+=t.cr,this.lf+=t.lf,this.crlf+=t.crlf,this.isBasicASCII&&(this.isBasicASCII=t.isBasicASCII),this.isBasicASCII||this.containsRTL||(this.containsRTL=o["m"](e)),this.isBasicASCII||this.containsUnusualLineTerminators||(this.containsUnusualLineTerminators=o["n"](e))}finish(e=!0){return this._finish(),new xe(this.chunks,this.BOM,this.cr,this.lf,this.crlf,this.containsRTL,this.containsUnusualLineTerminators,this.isBasicASCII,e)}_finish(){if(0===this.chunks.length&&this._acceptChunk1("",!0),this._hasPreviousChar){this._hasPreviousChar=!1;let e=this.chunks[this.chunks.length-1];e.buffer+=String.fromCharCode(this._previousChar);let t=fe(e.buffer);e.lineStarts=t,13===this._previousChar&&this.cr++}}}var Ne=n("1aa3"),Se=n("1c57"),Te=n("3f16"),ve=n("2b64"),Oe=n("7606"),Ee=n("5e04"),De=n("de9c");class Ae{constructor(){this._beginState=[],this._valid=[],this._len=0,this._invalidLineStartIndex=0}_reset(e){this._beginState=[],this._valid=[],this._len=0,this._invalidLineStartIndex=0,e&&this._setBeginState(0,e)}flush(e){this._reset(e)}get invalidLineStartIndex(){return this._invalidLineStartIndex}_invalidateLine(e){e<this._len&&(this._valid[e]=!1),e<this._invalidLineStartIndex&&(this._invalidLineStartIndex=e)}_isValid(e){return e<this._len&&this._valid[e]}getBeginState(e){return e<this._len?this._beginState[e]:null}_ensureLine(e){while(e>=this._len)this._beginState[this._len]=null,this._valid[this._len]=!1,this._len++}_deleteLines(e,t){0!==t&&(e+t>this._len&&(t=this._len-e),this._beginState.splice(e,t),this._valid.splice(e,t),this._len-=t)}_insertLines(e,t){if(0===t)return;let n=[],i=[];for(let s=0;s<t;s++)n[s]=null,i[s]=!1;this._beginState=Se["b"](this._beginState,e,n),this._valid=Se["b"](this._valid,e,i),this._len+=t}_setValid(e,t){this._ensureLine(e),this._valid[e]=t}_setBeginState(e,t){this._ensureLine(e),this._beginState[e]=t}setEndState(e,t,n){if(this._setValid(t,!0),this._invalidLineStartIndex=t+1,t===e-1)return;const i=this.getBeginState(t+1);if(null===i||!n.equals(i))return this._setBeginState(t+1,n),void this._invalidateLine(t+1);let s=t+1;while(s<e){if(!this._isValid(s))break;s++}this._invalidLineStartIndex=s}setFakeTokens(e){this._setValid(e,!1)}applyEdits(e,t){const n=e.endLineNumber-e.startLineNumber,i=t,s=Math.min(n,i);for(let r=s;r>=0;r--)this._invalidateLine(e.startLineNumber+r-1);this._acceptDeleteRange(e),this._acceptInsertText(new l["a"](e.startLineNumber,e.startColumn),t)}_acceptDeleteRange(e){const t=e.startLineNumber-1;t>=this._len||this._deleteLines(e.startLineNumber,e.endLineNumber-e.startLineNumber)}_acceptInsertText(e,t){const n=e.lineNumber-1;n>=this._len||this._insertLines(e.lineNumber,t)}}class Re extends r["a"]{constructor(e){super(),this._isDisposed=!1,this._textModel=e,this._tokenizationStateStore=new Ae,this._tokenizationSupport=null,this._register(ve["F"].onDidChange(e=>{const t=this._textModel.getLanguageIdentifier();-1!==e.changedLanguages.indexOf(t.language)&&(this._resetTokenizationState(),this._textModel.clearTokens())})),this._register(this._textModel.onDidChangeContentFast(e=>{if(e.isFlush)this._resetTokenizationState();else{for(let t=0,n=e.changes.length;t<n;t++){const n=e.changes[t],[i]=Object(Le["f"])(n.text);this._tokenizationStateStore.applyEdits(n.range,i)}this._beginBackgroundTokenization()}})),this._register(this._textModel.onDidChangeAttached(()=>{this._beginBackgroundTokenization()})),this._register(this._textModel.onDidChangeLanguage(()=>{this._resetTokenizationState(),this._textModel.clearTokens()})),this._resetTokenizationState()}dispose(){this._isDisposed=!0,super.dispose()}_resetTokenizationState(){const[e,t]=Me(this._textModel);this._tokenizationSupport=e,this._tokenizationStateStore.flush(t),this._beginBackgroundTokenization()}_beginBackgroundTokenization(){this._textModel.isAttachedToEditor()&&this._hasLinesToTokenize()&&De["j"](()=>{this._isDisposed||this._revalidateTokensNow()})}_revalidateTokensNow(){const e=this._textModel.getLineCount(),t=1,n=new Le["b"],i=Ee["a"].create(!1);let s=-1;while(this._hasLinesToTokenize()){if(i.elapsed()>t)break;if(s=this._tokenizeOneInvalidLine(n),s>=e)break}this._beginBackgroundTokenization(),this._textModel.setTokens(n.tokens,s>=e)}tokenizeViewport(e,t){const n=new Le["b"];this._tokenizeViewport(n,e,t),this._textModel.setTokens(n.tokens)}reset(){this._resetTokenizationState(),this._textModel.clearTokens()}forceTokenization(e){const t=new Le["b"];this._updateTokensUntilLine(t,e),this._textModel.setTokens(t.tokens)}isCheapToTokenize(e){if(!this._tokenizationSupport)return!0;const t=this._tokenizationStateStore.invalidLineStartIndex+1;return!(e>t)&&(e<t||this._textModel.getLineLength(e)<2048)}_hasLinesToTokenize(){return!!this._tokenizationSupport&&this._tokenizationStateStore.invalidLineStartIndex<this._textModel.getLineCount()}_tokenizeOneInvalidLine(e){if(!this._hasLinesToTokenize())return this._textModel.getLineCount()+1;const t=this._tokenizationStateStore.invalidLineStartIndex+1;return this._updateTokensUntilLine(e,t),t}_updateTokensUntilLine(e,t){if(!this._tokenizationSupport)return;const n=this._textModel.getLanguageIdentifier(),i=this._textModel.getLineCount(),s=t-1;for(let r=this._tokenizationStateStore.invalidLineStartIndex;r<=s;r++){const t=this._textModel.getLineContent(r+1),s=this._tokenizationStateStore.getBeginState(r),o=Be(n,this._tokenizationSupport,t,!0,s);e.add(r+1,o.tokens),this._tokenizationStateStore.setEndState(i,r,o.endState),r=this._tokenizationStateStore.invalidLineStartIndex-1}}_tokenizeViewport(e,t,n){if(!this._tokenizationSupport)return;if(n<=this._tokenizationStateStore.invalidLineStartIndex)return;if(t<=this._tokenizationStateStore.invalidLineStartIndex)return void this._updateTokensUntilLine(e,n);let i=this._textModel.getLineFirstNonWhitespaceColumn(t),s=[],r=null;for(let h=t-1;i>0&&h>=1;h--){let e=this._textModel.getLineFirstNonWhitespaceColumn(h);if(0!==e&&e<i){if(r=this._tokenizationStateStore.getBeginState(h-1),r)break;s.push(this._textModel.getLineContent(h)),i=e}}r||(r=this._tokenizationSupport.getInitialState());const o=this._textModel.getLanguageIdentifier();let a=r;for(let h=s.length-1;h>=0;h--){let e=Be(o,this._tokenizationSupport,s[h],!1,a);a=e.endState}for(let h=t;h<=n;h++){let t=this._textModel.getLineContent(h),n=Be(o,this._tokenizationSupport,t,!0,a);e.add(h,n.tokens),this._tokenizationStateStore.setFakeTokens(h-1),a=n.endState}}}function Me(e){const t=e.getLanguageIdentifier();let n=e.isTooLargeForTokenization()?null:ve["F"].get(t.language),s=null;if(n)try{s=n.getInitialState()}catch(r){Object(i["f"])(r),n=null}return[n,s]}function Be(e,t,n,s,r){let o=null;if(t)try{o=t.tokenize2(n,s,r.clone(),0)}catch(a){Object(i["f"])(a)}return o||(o=Object(Oe["e"])(e.id,n,r,0)),Te["a"].convertToEndOffset(o.tokens,n.length),o}var ye=n("6d2d"),ze=n("31eb"),Pe=n("6e9e"),Fe=n("3f78"),Ve=n("85cf");const We=new Array;class je{constructor(e,t){this.items=e,this.additionalItems=t}static create(e,t){if(e<=128&&0===t.length){let n=je.cache[e];return n||(n=new je(e,t),je.cache[e]=n),n}return new je(e,t)}static getEmpty(){return this.empty}add(e,t){const n=t.getKey(e);let i=n>>5;if(0===i){const e=1<<n|this.items;return e===this.items?this:je.create(e,this.additionalItems)}i--;const s=this.additionalItems.slice(0);while(s.length<i)s.push(0);return s[i]|=1<<(31&n),je.create(this.items,s)}has(e,t){const n=t.getKey(e);let i=n>>5;return 0===i?0!==(this.items&1<<n):(i--,0!==((this.additionalItems[i]||0)&1<<(31&n)))}merge(e){const t=this.items|e.items;if(this.additionalItems===We&&e.additionalItems===We)return t===this.items?this:t===e.items?e:je.create(t,We);const n=new Array;for(let i=0;i<Math.max(this.additionalItems.length,e.additionalItems.length);i++){const t=this.additionalItems[i]||0,s=e.additionalItems[i]||0;n.push(t|s)}return je.create(t,n)}intersects(e){if(0!==(this.items&e.items))return!0;for(let t=0;t<Math.min(this.additionalItems.length,e.additionalItems.length);t++)if(0!==(this.additionalItems[t]&e.additionalItems[t]))return!0;return!1}}je.cache=new Array(129),je.empty=je.create(0,We);class Ue{constructor(){this.items=new Map}getKey(e){let t=this.items.get(e);return void 0===t&&(t=this.items.size,this.items.set(e,t)),t}}var He=n("35bf"),$e=n("662c");class qe{constructor(e,t){this.lineCount=e,this.columnCount=t}toString(){return`${this.lineCount},${this.columnCount}`}}function Ge(e,t,n,i){return e!==n?Qe(n-e,i):Qe(0,i-t)}const Ke=0;function Je(e){return 0===e}const Ye=Math.pow(2,26);function Qe(e,t){return e*Ye+t}function Ze(e){const t=e,n=Math.floor(t/Ye),i=t-n*Ye;return new qe(n,i)}function Xe(e){return Math.floor(e/Ye)}function et(e){return e}function tt(e,t){return t<Ye?e+t:e-e%Ye+t}function nt(e,t){const n=e,i=t,s=i-n;if(s<=0)return Ke;const r=Math.floor(n/Ye),o=Math.floor(i/Ye),a=i-o*Ye;if(r===o){const e=n-r*Ye;return Qe(0,a-e)}return Qe(o-r,a)}function it(e,t){return e<t}function st(e,t){return e<=t}function rt(e,t){return e>=t}function ot(e){return Qe(e.lineNumber-1,e.column-1)}function at(e,t){const n=e,i=Math.floor(n/Ye),s=n-i*Ye,r=t,o=Math.floor(r/Ye),a=r-o*Ye;return new u["a"](i+1,s+1,o+1,a+1)}function ht(e){const t=Object(o["Q"])(e);return Qe(t.length-1,t[t.length-1].length)}function lt(e){return e}class ut{constructor(e,t,n){this.startOffset=e,this.endOffset=t,this.newLength=n}}class ct{constructor(e,t){this.documentLength=t,this.nextEditIdx=0,this.deltaOldToNewLineCount=0,this.deltaOldToNewColumnCount=0,this.deltaLineIdxInOld=-1,this.edits=e.map(e=>dt.from(e))}getOffsetBeforeChange(e){return this.adjustNextEdit(e),this.translateCurToOld(e)}getDistanceToNextChange(e){this.adjustNextEdit(e);const t=this.edits[this.nextEditIdx],n=t?this.translateOldToCur(t.offsetObj):this.documentLength;return nt(e,n)}translateOldToCur(e){return e.lineCount===this.deltaLineIdxInOld?Qe(e.lineCount+this.deltaOldToNewLineCount,e.columnCount+this.deltaOldToNewColumnCount):Qe(e.lineCount+this.deltaOldToNewLineCount,e.columnCount)}translateCurToOld(e){const t=Ze(e);return t.lineCount-this.deltaOldToNewLineCount===this.deltaLineIdxInOld?Qe(t.lineCount-this.deltaOldToNewLineCount,t.columnCount-this.deltaOldToNewColumnCount):Qe(t.lineCount-this.deltaOldToNewLineCount,t.columnCount)}adjustNextEdit(e){while(this.nextEditIdx<this.edits.length){const t=this.edits[this.nextEditIdx],n=this.translateOldToCur(t.endOffsetAfterObj);if(!st(n,e))break;{this.nextEditIdx++;const e=Ze(n),i=Ze(this.translateOldToCur(t.endOffsetBeforeObj)),s=e.lineCount-i.lineCount;this.deltaOldToNewLineCount+=s;const r=this.deltaLineIdxInOld===t.endOffsetBeforeObj.lineCount?this.deltaOldToNewColumnCount:0,o=e.columnCount-i.columnCount;this.deltaOldToNewColumnCount=r+o,this.deltaLineIdxInOld=t.endOffsetBeforeObj.lineCount}}}}class dt{constructor(e,t,n){this.endOffsetBeforeObj=Ze(t),this.endOffsetAfterObj=Ze(tt(e,n)),this.offsetObj=Ze(e)}static from(e){return new dt(e.startOffset,e.endOffset,e.newLength)}}class ft{constructor(e){this._length=e}get length(){return this._length}}class gt extends ft{constructor(e,t,n,i){super(e),this.category=t,this.children=n,this.unopenedBrackets=i}static create(e,t,n,i){const s=_t(t,n,i),r=new Array(1);return r[0]=t,n&&r.push(n),i&&r.push(i),new gt(s,e,r,n?n.unopenedBrackets:je.getEmpty())}get kind(){return 2}get listHeight(){return 0}canBeReused(e,t){return null!==this.closingBracket&&!e.intersects(this.unopenedBrackets)}get closingBracket(){return this.children.length<=1?null:1===this.children[1].kind?this.children[1]||null:this.children[2]||null}clone(){return new gt(this.length,this.category,mt(this.children),this.unopenedBrackets)}}function _t(e,t,n){let i=e.length;return t&&(i=tt(i,t.length)),n&&(i=tt(i,n.length)),i}class pt extends ft{constructor(e,t,n,i){super(e),this.listHeight=t,this._items=n,this._unopenedBrackets=i}static create(e){if(0===e.length)return new pt(Ke,0,e,je.getEmpty());{let t=e[0].length,n=e[0].unopenedBrackets;for(let i=1;i<e.length;i++)t=tt(t,e[i].length),n=n.merge(e[i].unopenedBrackets);return new pt(t,e[0].listHeight+1,e,n)}}get kind(){return 4}get children(){return this._items}get unopenedBrackets(){return this._unopenedBrackets}canBeReused(e,t){if(0===this._items.length)return!0;if(e.intersects(this.unopenedBrackets))return!1;let n=this;while(n.children.length>0&&4===n.kind)n=Object(Se["t"])(n.children);return n.canBeReused(e,t)}clone(){return new pt(this.length,this.listHeight,mt(this._items),this.unopenedBrackets)}handleChildrenChanged(){const e=this._items;if(0===e.length)return;let t=e[0].length,n=e[0].unopenedBrackets;for(let i=1;i<e.length;i++)t=tt(t,e[i].length),n=n.merge(e[i].unopenedBrackets);this._length=t,this._unopenedBrackets=n}append(e){const t=this._append(e);return t?pt.create([this,t]):this}_append(e){if(e.listHeight===this.listHeight)return e;const t=this._items[this._items.length-1],n=4===t.kind?t._append(e):e;if(n){if(this._items.length>=3){const e=this._items.pop();return this.handleChildrenChanged(),pt.create([e,n])}return this._items.push(n),void this.handleChildrenChanged()}this.handleChildrenChanged()}prepend(e){const t=this._prepend(e);return t?pt.create([t,this]):this}_prepend(e){if(e.listHeight===this.listHeight)return e;if(4!==this.kind)throw new Error("unexpected");const t=this._items[0],n=4===t.kind?t._prepend(e):e;if(n){if(this._items.length>=3){const e=this._items.shift();return this.handleChildrenChanged(),pt.create([n,e])}return this._items.unshift(n),void this.handleChildrenChanged()}this.handleChildrenChanged()}}function mt(e){const t=new Array(e.length);for(let n=0;n<e.length;n++)t[n]=e[n].clone();return t}const Ct=[];class bt extends ft{get kind(){return 0}get listHeight(){return 0}get children(){return Ct}get unopenedBrackets(){return je.getEmpty()}canBeReused(e,t){return!t}clone(){return this}}class Lt extends ft{constructor(e){super(e)}static create(e){const t=lt(e),n=Lt.cacheByLength.get(t);if(n)return n;const i=new Lt(e);return Lt.cacheByLength.set(t,i),i}get kind(){return 1}get listHeight(){return 0}get children(){return Ct}get unopenedBrackets(){return je.getEmpty()}canBeReused(e,t){return!1}clone(){return this}}Lt.cacheByLength=new Map;class kt extends ft{constructor(e,t,n){super(t),this.unopenedBrackets=je.getEmpty().add(e,n)}get kind(){return 3}get listHeight(){return 0}get children(){return Ct}canBeReused(e,t){return!e.intersects(this.unopenedBrackets)}clone(){return this}}class wt{constructor(e,t,n,i,s){this.length=e,this.kind=t,this.category=n,this.languageId=i,this.astNode=s}}class xt{constructor(e,t){this.textModel=e,this.bracketTokens=t,this.reader=new It(this.textModel,this.bracketTokens),this._offset=Ke,this.didPeek=!1,this.peeked=null,this.textBufferLineCount=e.getLineCount(),this.textBufferLastLineLength=e.getLineLength(this.textBufferLineCount)}get offset(){return this._offset}get length(){return Qe(this.textBufferLineCount,this.textBufferLastLineLength)}skip(e){this.didPeek=!1,this._offset=tt(this._offset,e);const t=Ze(this._offset);this.reader.setPosition(t.lineCount,t.columnCount)}read(){let e;return this.peeked?(this.didPeek=!1,e=this.peeked):e=this.reader.read(),e&&(this._offset=tt(this._offset,e.length)),e}peek(){return this.didPeek||(this.peeked=this.reader.read(),this.didPeek=!0),this.peeked}}class It{constructor(e,t){this.textModel=e,this.bracketTokens=t,this.lineIdx=0,this.line=null,this.lineCharOffset=0,this.lineTokens=null,this.lineTokenOffset=0,this.peekedToken=null,this.textBufferLineCount=e.getLineCount(),this.textBufferLastLineLength=e.getLineLength(this.textBufferLineCount)}setPosition(e,t){e===this.lineIdx?(this.lineCharOffset=t,this.lineTokenOffset=0===this.lineCharOffset?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset)):(this.lineIdx=e,this.lineCharOffset=t,this.line=null),this.peekedToken=null}read(){if(this.peekedToken){const e=this.peekedToken;return this.peekedToken=null,this.lineCharOffset+=et(e.length),e}if(this.lineIdx>this.textBufferLineCount-1||this.lineIdx===this.textBufferLineCount-1&&this.lineCharOffset>=this.textBufferLastLineLength)return null;null===this.line&&(this.lineTokens=this.textModel.getLineTokens(this.lineIdx+1),this.line=this.lineTokens.getLineContent(),this.lineTokenOffset=0===this.lineCharOffset?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset));const e=this.lineIdx,t=this.lineCharOffset;let n=0;while(n<1e3){const i=this.lineTokens,s=i.getCount();let r=null;if(this.lineTokenOffset<s){let o=i.getMetadata(this.lineTokenOffset);while(this.lineTokenOffset+1<s&&o===i.getMetadata(this.lineTokenOffset+1))this.lineTokenOffset++;const a=0===ve["E"].getTokenType(o),h=i.getEndOffset(this.lineTokenOffset);if(a&&h!==this.lineCharOffset){const e=i.getLanguageId(this.lineTokenOffset),t=this.line.substring(this.lineCharOffset,h),n=this.bracketTokens.getSingleLanguageBracketTokens(e),s=n.regExpGlobal;if(s){s.lastIndex=0;const e=s.exec(t);e&&(r=n.getToken(e[0]),r&&(this.lineCharOffset+=e.index))}}if(n+=h-this.lineCharOffset,r){if(e!==this.lineIdx||t!==this.lineCharOffset){this.peekedToken=r;break}return this.lineCharOffset+=et(r.length),r}this.lineTokenOffset++,this.lineCharOffset=h}else{if(this.lineIdx===this.textBufferLineCount-1)break;this.lineIdx++,this.lineTokens=this.textModel.getLineTokens(this.lineIdx+1),this.lineTokenOffset=0,this.line=this.lineTokens.getLineContent(),this.lineCharOffset=0,n++}}const i=Ge(e,t,this.lineIdx,this.lineCharOffset);return new wt(i,0,-1,-1,new bt(i))}}class Nt{constructor(e,t){this.text=e,this._offset=Ke,this.idx=0;const n=t.getRegExpStr(),i=n?new RegExp(t.getRegExpStr()+"|\n","g"):null,s=[];let r,o=0,a=0,h=0,l=0;const u=new Array;for(let f=0;f<60;f++)u.push(new wt(Qe(0,f),0,-1,-1,new bt(Qe(0,f))));const c=new Array;for(let f=0;f<60;f++)c.push(new wt(Qe(1,f),0,-1,-1,new bt(Qe(1,f))));if(i){i.lastIndex=0;while(null!==(r=i.exec(e))){const e=r.index,n=r[0];if("\n"===n)o++,a=e+1;else{if(h!==e){let t;if(l===o){const n=e-h;if(n<u.length)t=u[n];else{const e=Qe(0,n);t=new wt(e,0,-1,-1,new bt(e))}}else{const n=o-l,i=e-a;if(1===n&&i<c.length)t=c[i];else{const e=Qe(n,i);t=new wt(e,0,-1,-1,new bt(e))}}s.push(t)}s.push(t.getToken(n)),h=e+n.length,l=o}}}const d=e.length;if(h!==d){const e=l===o?Qe(0,d-h):Qe(o-l,d-a);s.push(new wt(e,0,-1,-1,new bt(e)))}this.length=Qe(o,d-a),this.tokens=s}get offset(){return this._offset}read(){return this.tokens[this.idx++]||null}peek(){return this.tokens[this.idx]||null}skip(e){throw new i["a"]}}class St{constructor(){this.hasRegExp=!1,this._regExpGlobal=null,this.map=new Map}static createFromLanguage(e,t){const n=[...ze["a"].getColorizedBracketPairs(e)],i=new St;let s=0;for(const r of n)i.addBracket(e,r[0],1,s),i.addBracket(e,r[1],2,s),s++;for(const r of t)s++,i.addBracket(e,r[0],1,s),i.addBracket(e,r[1],2,s);return i}addBracket(e,t,n,i){const s=Qe(0,t.length);this.map.set(t,new wt(s,n,1e3*e+i,e,Lt.create(s)))}getRegExpStr(){if(this.isEmpty)return null;{const e=[...this.map.keys()];return e.sort(),e.reverse(),e.map(e=>Object(o["t"])(e)).join("|")}}get regExpGlobal(){if(!this.hasRegExp){const e=this.getRegExpStr();this._regExpGlobal=e?new RegExp(e,"g"):null,this.hasRegExp=!0}return this._regExpGlobal}getToken(e){return this.map.get(e)}get isEmpty(){return 0===this.map.size}}class Tt{constructor(e){this.customBracketPairs=e,this.languageIdToBracketTokens=new Map}didLanguageChange(e){const t=this.languageIdToBracketTokens.get(e);if(!t)return!1;const n=St.createFromLanguage(e,this.customBracketPairs).getRegExpStr();return t.getRegExpStr()!==n}getSingleLanguageBracketTokens(e){let t=this.languageIdToBracketTokens.get(e);return t||(t=St.createFromLanguage(e,this.customBracketPairs),this.languageIdToBracketTokens.set(e,t)),t}}function vt(e){return 0===e.length?null:1===e.length?e[0]:Ot(e)?Et(e):At(e)}function Ot(e){const t=e[0].listHeight;for(const n of e)if(n.listHeight!==t)return!1;return!0}function Et(e){let t=e.length;while(t>1){const n=t>>1,i=new Array(n);for(let s=0;s<n;s++){const n=s<<1;i[s]=pt.create(e.slice(n,n+3===t?t:n+2))}t=n,e=i}return e[0]}function Dt(e,t){return Math.abs(e.listHeight-t.listHeight)}function At(e){let t=e[0],n=e[1];for(let s=2;s<e.length;s++){const i=e[s];Dt(t,n)<=Dt(n,i)?(t=Rt(t,n),n=i):n=Rt(n,i)}const i=Rt(t,n);return i}function Rt(e,t){return e.listHeight===t.listHeight?pt.create([e,t]):e.listHeight>t.listHeight?e.append(t):t.prepend(e)}class Mt{constructor(e){this.lastOffset=Ke,this.nextNodes=[e],this.offsets=[Ke],this.idxs=[]}readLongestNodeAt(e,t){if(it(e,this.lastOffset))throw new Error("Invalid offset");this.lastOffset=e;while(1){const n=Bt(this.nextNodes);if(!n)return;const i=Bt(this.offsets);if(it(e,i))return;if(it(i,e))tt(i,n.length)<=e?this.nextNodeAfterCurrent():n.children.length>0?(this.nextNodes.push(n.children[0]),this.offsets.push(i),this.idxs.push(0)):this.nextNodeAfterCurrent();else{if(t(n))return this.nextNodeAfterCurrent(),n;if(0===n.children.length)return void this.nextNodeAfterCurrent();this.nextNodes.push(n.children[0]),this.offsets.push(i),this.idxs.push(0)}}}nextNodeAfterCurrent(){while(1){const e=Bt(this.offsets),t=Bt(this.nextNodes);if(this.nextNodes.pop(),this.offsets.pop(),0===this.idxs.length)break;const n=Bt(this.nextNodes);this.idxs[this.idxs.length-1]++;const i=this.idxs[this.idxs.length-1];if(i<n.children.length){this.nextNodes.push(n.children[i]),this.offsets.push(tt(e,t.length));break}this.idxs.pop()}}}function Bt(e){return e.length>0?e[e.length-1]:void 0}function yt(e,t,n,i){const s=new zt(e,t,n,i);return s.parseDocument()}class zt{constructor(e,t,n,i){this.tokenizer=e,this.denseKeyProvider=i,this._itemsConstructed=0,this._itemsFromCache=0,this.oldNodeReader=n?new Mt(n):void 0,this.positionMapper=new ct(t,e.length)}parseDocument(){this._itemsConstructed=0,this._itemsFromCache=0;let e=this.parseList(je.getEmpty());return e||(e=pt.create([])),e}parseList(e){const t=new Array;while(1){const n=this.tokenizer.peek();if(!n||2===n.kind&&e.has(n.category,this.denseKeyProvider))break;const i=this.parseChild(e);4===i.kind&&0===i.children.length||t.push(i)}const n=vt(t);return n}parseChild(e){if(this.oldNodeReader){const t=this.positionMapper.getDistanceToNextChange(this.tokenizer.offset);if(!Je(t)){const n=this.oldNodeReader.readLongestNodeAt(this.positionMapper.getOffsetBeforeChange(this.tokenizer.offset),n=>{if(!st(n.length,t))return!1;const i=Xe(n.length)===Xe(t),s=n.canBeReused(e,i);return s});if(n)return this._itemsFromCache++,this.tokenizer.skip(n.length),n}}this._itemsConstructed++;const t=this.tokenizer.read();switch(t.kind){case 2:return new kt(t.category,t.length,this.denseKeyProvider);case 0:return t.astNode;case 1:const n=e.add(t.category,this.denseKeyProvider),i=this.parseList(n),s=this.tokenizer.peek();return s&&2===s.kind&&s.category===t.category?(this.tokenizer.read(),gt.create(t.category,t.astNode,i,s.astNode)):gt.create(t.category,t.astNode,i,null);default:throw new Error("unexpected")}}}class Pt extends r["a"]{constructor(e){super(),this.textModel=e,this.didChangeDecorationsEmitter=new s["b"],this.cache=this._register(new r["d"]),this._register(ze["a"].onDidChange(e=>{var t;(null===(t=this.cache.value)||void 0===t?void 0:t.object.didLanguageChange(e.languageIdentifier.id))&&(this.cache.clear(),this.updateCache())})),this._register(e.onDidChangeOptions(e=>{this.cache.clear(),this.updateCache()})),this._register(e.onDidChangeAttached(()=>{this.updateCache()}))}get isDocumentSupported(){const e=5e6;return this.textModel.getValueLength()<=e}updateCache(){const e=this.textModel.getOptions().bracketPairColorizationOptions;if(this.textModel.isAttachedToEditor()&&this.isDocumentSupported&&e.enabled){if(!this.cache.value){const e=new r["b"];this.cache.value=Ft(e.add(new Vt(this.textModel)),e),e.add(this.cache.value.object.onDidChangeDecorations(e=>this.didChangeDecorationsEmitter.fire(e))),this.didChangeDecorationsEmitter.fire()}}else this.cache.clear(),this.didChangeDecorationsEmitter.fire()}handleContentChanged(e){var t;null===(t=this.cache.value)||void 0===t||t.object.handleContentChanged(e)}getDecorationsInRange(e,t,n){var i;return void 0===t?[]:(null===(i=this.cache.value)||void 0===i?void 0:i.object.getDecorationsInRange(e,t,n))||[]}getAllDecorations(e,t){var n;return void 0===e?[]:(null===(n=this.cache.value)||void 0===n?void 0:n.object.getAllDecorations(e,t))||[]}onDidChangeDecorations(e){return this.didChangeDecorationsEmitter.event(e)}}function Ft(e,t){return{object:e,dispose:()=>null===t||void 0===t?void 0:t.dispose()}}class Vt extends r["a"]{constructor(e){if(super(),this.textModel=e,this.didChangeDecorationsEmitter=new s["b"],this.colorProvider=new Ut,this.brackets=new Tt([]),this.denseKeyProvider=new Ue,this.onDidChangeDecorations=this.didChangeDecorationsEmitter.event,this._register(e.onBackgroundTokenizationStateChanged(()=>{if(2===e.backgroundTokenizationState){const e=void 0===this.initialAstWithoutTokens;this.initialAstWithoutTokens=void 0,e||this.didChangeDecorationsEmitter.fire()}})),this._register(e.onDidChangeTokens(({ranges:e})=>{const t=e.map(e=>new ut(Qe(e.fromLineNumber-1,0),Qe(e.toLineNumber,0),Qe(e.toLineNumber-e.fromLineNumber+1,0)));this.astWithTokens=this.parseDocumentFromTextBuffer(t,this.astWithTokens),this.initialAstWithoutTokens||this.didChangeDecorationsEmitter.fire()})),0===e.backgroundTokenizationState){const e=this.brackets.getSingleLanguageBracketTokens(this.textModel.getLanguageIdentifier().id),t=new Nt(this.textModel.getValue(),e);this.initialAstWithoutTokens=yt(t,[],void 0,this.denseKeyProvider),this.astWithTokens=this.initialAstWithoutTokens.clone()}else 2===e.backgroundTokenizationState?(this.initialAstWithoutTokens=void 0,this.astWithTokens=this.parseDocumentFromTextBuffer([],void 0)):1===e.backgroundTokenizationState&&(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer([],void 0),this.astWithTokens=this.initialAstWithoutTokens.clone())}didLanguageChange(e){return this.brackets.didLanguageChange(e)}handleContentChanged(e){const t=e.changes.map(e=>{const t=u["a"].lift(e.range);return new ut(ot(t.getStartPosition()),ot(t.getEndPosition()),ht(e.text))}).reverse();this.astWithTokens=this.parseDocumentFromTextBuffer(t,this.astWithTokens),this.initialAstWithoutTokens&&(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer(t,this.initialAstWithoutTokens))}parseDocumentFromTextBuffer(e,t){const n=!1,i=n?null===t||void 0===t?void 0:t.clone():t,s=new xt(this.textModel,this.brackets),r=yt(s,e,i,this.denseKeyProvider);return r}getBracketsInRange(e){const t=Qe(e.startLineNumber-1,e.startColumn-1),n=Qe(e.endLineNumber-1,e.endColumn-1),i=new Array,s=this.initialAstWithoutTokens||this.astWithTokens;return Wt(s,Ke,s.length,t,n,i),i}getDecorationsInRange(e,t,n){const i=new Array,s=this.getBracketsInRange(e);for(const r of s)i.push({id:"bracket"+r.hash(),options:{description:"BracketPairColorization",inlineClassName:this.colorProvider.getInlineClassName(r)},ownerId:0,range:r.range});return i}getAllDecorations(e,t){return this.getDecorationsInRange(new u["a"](1,1,this.textModel.getLineCount(),1),e,t)}}function Wt(e,t,n,i,s,r,o=0){if(1===e.kind){const e=at(t,n);r.push(new jt(e,o-1,!1))}else if(3===e.kind){const e=at(t,n);r.push(new jt(e,o-1,!0))}else{2===e.kind&&o++;for(const a of e.children)n=tt(t,a.length),st(t,s)&&rt(n,i)&&Wt(a,t,n,i,s,r,o),t=n}}class jt{constructor(e,t,n){this.range=e,this.level=t,this.isInvalid=n}hash(){return`${this.range.toString()}-${this.level}`}}class Ut{constructor(){this.unexpectedClosingBracketClassName="unexpected-closing-bracket"}getInlineClassName(e){return e.isInvalid?this.unexpectedClosingBracketClassName:this.getInlineClassNameOfLevel(e.level)}getInlineClassNameOfLevel(e){return"bracket-highlighting-"+e%30}}function Ht(){return new Ie}function $t(e){const t=Ht();return t.acceptChunk(e),t.finish()}function qt(e,t){const n="string"===typeof e?$t(e):e;return n.create(t)}Object($e["f"])((e,t)=>{const n=[He["c"],He["d"],He["e"],He["f"],He["g"],He["h"]],i=new Ut;t.addRule(`.monaco-editor .${i.unexpectedClosingBracketClassName} { color: ${e.getColor(He["i"])}; }`);let s=n.map(t=>e.getColor(t)).filter(e=>!!e).filter(e=>!e.isTransparent());for(let r=0;r<30;r++){const e=s[r%s.length];t.addRule(`.monaco-editor .${i.getInlineClassNameOfLevel(r)} { color: ${e}; }`)}});let Gt=0;const Kt=999,Jt=1e4;class Yt{constructor(e){this._source=e,this._eos=!1}read(){if(this._eos)return null;let e=[],t=0,n=0;do{let i=this._source.read();if(null===i)return this._eos=!0,0===t?null:e.join("");if(i.length>0&&(e[t++]=i,n+=i.length),n>=65536)return e.join("")}while(1)}}const Qt=()=>{throw new Error("Invalid change accessor")};class Zt{constructor(){this._searchCanceledBrand=void 0}}function Xt(e){return e instanceof Zt?null:e}Zt.INSTANCE=new Zt;class en extends r["a"]{constructor(e,t,n,i=null,r){super(),this._onWillDispose=this._register(new s["b"]),this.onWillDispose=this._onWillDispose.event,this._onDidChangeDecorations=this._register(new gn(e=>this.handleBeforeFireDecorationsChangedEvent(e))),this.onDidChangeDecorations=this._onDidChangeDecorations.event,this._onDidChangeLanguage=this._register(new s["b"]),this.onDidChangeLanguage=this._onDidChangeLanguage.event,this._onDidChangeLanguageConfiguration=this._register(new s["b"]),this.onDidChangeLanguageConfiguration=this._onDidChangeLanguageConfiguration.event,this._onDidChangeTokens=this._register(new s["b"]),this.onDidChangeTokens=this._onDidChangeTokens.event,this._onDidChangeOptions=this._register(new s["b"]),this.onDidChangeOptions=this._onDidChangeOptions.event,this._onDidChangeAttached=this._register(new s["b"]),this.onDidChangeAttached=this._onDidChangeAttached.event,this._onDidChangeContentOrInjectedText=this._register(new s["b"]),this.onDidChangeContentOrInjectedText=this._onDidChangeContentOrInjectedText.event,this._eventEmitter=this._register(new _n),this._backgroundTokenizationState=0,this._onBackgroundTokenizationStateChanged=this._register(new s["b"]),this.onBackgroundTokenizationStateChanged=this._onBackgroundTokenizationStateChanged.event,this._register(this._eventEmitter.fastEvent(e=>{this._onDidChangeContentOrInjectedText.fire(e.rawContentChangedEvent)})),Gt++,this.id="$model"+Gt,this.isForSimpleWidget=t.isForSimpleWidget,this._associatedResource="undefined"===typeof i||null===i?a["a"].parse("inmemory://model/"+Gt):i,this._undoRedoService=r,this._attachedEditorCount=0;const{textBuffer:h,disposable:l}=qt(e,t.defaultEOL);this._buffer=h,this._bufferDisposable=l,this._options=en.resolveOptions(this._buffer,t);const c=this._buffer.getLineCount(),d=this._buffer.getValueLengthInRange(new u["a"](1,1,c,this._buffer.getLineLength(c)+1),0);t.largeFileOptimizations?this._isTooLargeForTokenization=d>en.LARGE_FILE_SIZE_THRESHOLD||c>en.LARGE_FILE_LINE_COUNT_THRESHOLD:this._isTooLargeForTokenization=!1,this._isTooLargeForSyncing=d>en.MODEL_SYNC_LIMIT,this._versionId=1,this._alternativeVersionId=1,this._initialUndoRedoSnapshot=null,this._isDisposed=!1,this._isDisposing=!1,this._languageIdentifier=n||Oe["a"],this._languageRegistryListener=ze["a"].onDidChange(e=>{e.languageIdentifier.id===this._languageIdentifier.id&&this._onDidChangeLanguageConfiguration.fire({})}),this._instanceId=o["P"](Gt),this._lastDecorationId=0,this._decorations=Object.create(null),this._decorationsTree=new rn,this._commandManager=new f["a"](this,r),this._isUndoing=!1,this._isRedoing=!1,this._trimAutoWhitespaceLines=null,this._tokens=new Le["d"],this._tokens2=new Le["e"],this._tokenization=new Re(this),this._bracketPairColorizer=this._register(new Pt(this)),this._decorationProvider=this._bracketPairColorizer,this._register(this._decorationProvider.onDidChangeDecorations(()=>{this._onDidChangeDecorations.beginDeferredEmit(),this._onDidChangeDecorations.fire(),this._onDidChangeDecorations.endDeferredEmit()}))}static resolveOptions(e,t){if(t.detectIndentation){const n=p(e,t.tabSize,t.insertSpaces);return new d["e"]({tabSize:n.tabSize,indentSize:n.tabSize,insertSpaces:n.insertSpaces,trimAutoWhitespace:t.trimAutoWhitespace,defaultEOL:t.defaultEOL,bracketPairColorizationOptions:t.bracketPairColorizationOptions})}return new d["e"]({tabSize:t.tabSize,indentSize:t.indentSize,insertSpaces:t.insertSpaces,trimAutoWhitespace:t.trimAutoWhitespace,defaultEOL:t.defaultEOL,bracketPairColorizationOptions:t.bracketPairColorizationOptions})}onDidChangeContentFast(e){return this._eventEmitter.fastEvent(t=>e(t.contentChangedEvent))}onDidChangeContent(e){return this._eventEmitter.slowEvent(t=>e(t.contentChangedEvent))}get backgroundTokenizationState(){return this._backgroundTokenizationState}setBackgroundTokenizationState(e){this._backgroundTokenizationState!==e&&(this._backgroundTokenizationState=e,this._onBackgroundTokenizationStateChanged.fire())}dispose(){this._isDisposing=!0,this._onWillDispose.fire(),this._languageRegistryListener.dispose(),this._tokenization.dispose(),this._isDisposed=!0,super.dispose(),this._bufferDisposable.dispose(),this._isDisposing=!1;const e=new we([],"","\n",!1,!1,!0,!0);e.dispose(),this._buffer=e}_assertNotDisposed(){if(this._isDisposed)throw new Error("Model is disposed!")}_emitContentChangedEvent(e,t){this._bracketPairColorizer.handleContentChanged(t),this._isDisposing||this._eventEmitter.fire(new Ne["a"](e,t))}setValue(e){if(this._assertNotDisposed(),null===e)return;const{textBuffer:t,disposable:n}=qt(e,this._options.defaultEOL);this._setValueFromTextBuffer(t,n)}_createContentChanged2(e,t,n,i,s,r,o){return{changes:[{range:e,rangeOffset:t,rangeLength:n,text:i}],eol:this._buffer.getEOL(),versionId:this.getVersionId(),isUndoing:s,isRedoing:r,isFlush:o}}_setValueFromTextBuffer(e,t){this._assertNotDisposed();const n=this.getFullModelRange(),i=this.getValueLengthInRange(n),s=this.getLineCount(),r=this.getLineMaxColumn(s);this._buffer=e,this._bufferDisposable.dispose(),this._bufferDisposable=t,this._increaseVersionId(),this._tokens.flush(),this._tokens2.flush(),this._decorations=Object.create(null),this._decorationsTree=new rn,this._commandManager.clear(),this._trimAutoWhitespaceLines=null,this._emitContentChangedEvent(new Ne["d"]([new Ne["f"]],this._versionId,!1,!1),this._createContentChanged2(new u["a"](1,1,s,r),0,i,this.getValue(),!1,!1,!0))}setEOL(e){this._assertNotDisposed();const t=1===e?"\r\n":"\n";if(this._buffer.getEOL()===t)return;const n=this.getFullModelRange(),i=this.getValueLengthInRange(n),s=this.getLineCount(),r=this.getLineMaxColumn(s);this._onBeforeEOLChange(),this._buffer.setEOL(t),this._increaseVersionId(),this._onAfterEOLChange(),this._emitContentChangedEvent(new Ne["d"]([new Ne["e"]],this._versionId,!1,!1),this._createContentChanged2(new u["a"](1,1,s,r),0,i,this.getValue(),!1,!1,!1))}_onBeforeEOLChange(){this._decorationsTree.ensureAllNodesHaveRanges(this)}_onAfterEOLChange(){const e=this.getVersionId(),t=this._decorationsTree.collectNodesPostOrder();for(let n=0,i=t.length;n<i;n++){const i=t[n],s=i.range,r=i.cachedAbsoluteStart-i.start,o=this._buffer.getOffsetAt(s.startLineNumber,s.startColumn),a=this._buffer.getOffsetAt(s.endLineNumber,s.endColumn);i.cachedAbsoluteStart=o,i.cachedAbsoluteEnd=a,i.cachedVersionId=e,i.start=o-r,i.end=a-r,G(i)}}onBeforeAttached(){this._attachedEditorCount++,1===this._attachedEditorCount&&this._onDidChangeAttached.fire(void 0)}onBeforeDetached(){this._attachedEditorCount--,0===this._attachedEditorCount&&this._onDidChangeAttached.fire(void 0)}isAttachedToEditor(){return this._attachedEditorCount>0}getAttachedEditorCount(){return this._attachedEditorCount}isTooLargeForSyncing(){return this._isTooLargeForSyncing}isTooLargeForTokenization(){return this._isTooLargeForTokenization}isDisposed(){return this._isDisposed}isDominatedByLongLines(){if(this._assertNotDisposed(),this.isTooLargeForTokenization())return!1;let e=0,t=0;const n=this._buffer.getLineCount();for(let i=1;i<=n;i++){const n=this._buffer.getLineLength(i);n>=Jt?t+=n:e+=n}return t>e}get uri(){return this._associatedResource}getOptions(){return this._assertNotDisposed(),this._options}getFormattingOptions(){return{tabSize:this._options.indentSize,insertSpaces:this._options.insertSpaces}}updateOptions(e){this._assertNotDisposed();let t="undefined"!==typeof e.tabSize?e.tabSize:this._options.tabSize,n="undefined"!==typeof e.indentSize?e.indentSize:this._options.indentSize,i="undefined"!==typeof e.insertSpaces?e.insertSpaces:this._options.insertSpaces,s="undefined"!==typeof e.trimAutoWhitespace?e.trimAutoWhitespace:this._options.trimAutoWhitespace,r="undefined"!==typeof e.bracketColorizationOptions?e.bracketColorizationOptions:this._options.bracketPairColorizationOptions,o=new d["e"]({tabSize:t,indentSize:n,insertSpaces:i,defaultEOL:this._options.defaultEOL,trimAutoWhitespace:s,bracketPairColorizationOptions:r});if(this._options.equals(o))return;let a=this._options.createChangeEvent(o);this._options=o,this._onDidChangeOptions.fire(a)}detectIndentation(e,t){this._assertNotDisposed();let n=p(this._buffer,t,e);this.updateOptions({insertSpaces:n.insertSpaces,tabSize:n.tabSize,indentSize:n.tabSize})}static _normalizeIndentationFromWhitespace(e,t,n){let i=0;for(let r=0;r<e.length;r++)"\t"===e.charAt(r)?i+=t:i++;let s="";if(!n){let e=Math.floor(i/t);i%=t;for(let t=0;t<e;t++)s+="\t"}for(let r=0;r<i;r++)s+=" ";return s}static normalizeIndentation(e,t,n){let i=o["u"](e);return-1===i&&(i=e.length),en._normalizeIndentationFromWhitespace(e.substring(0,i),t,n)+e.substring(i)}normalizeIndentation(e){return this._assertNotDisposed(),en.normalizeIndentation(e,this._options.indentSize,this._options.insertSpaces)}getVersionId(){return this._assertNotDisposed(),this._versionId}mightContainRTL(){return this._buffer.mightContainRTL()}mightContainUnusualLineTerminators(){return this._buffer.mightContainUnusualLineTerminators()}removeUnusualLineTerminators(e=null){const t=this.findMatches(o["a"].source,!1,!0,!1,null,!1,1073741824);this._buffer.resetMightContainUnusualLineTerminators(),this.pushEditOperations(e,t.map(e=>({range:e.range,text:null})),()=>null)}mightContainNonBasicASCII(){return this._buffer.mightContainNonBasicASCII()}getAlternativeVersionId(){return this._assertNotDisposed(),this._alternativeVersionId}getInitialUndoRedoSnapshot(){return this._assertNotDisposed(),this._initialUndoRedoSnapshot}getOffsetAt(e){this._assertNotDisposed();let t=this._validatePosition(e.lineNumber,e.column,0);return this._buffer.getOffsetAt(t.lineNumber,t.column)}getPositionAt(e){this._assertNotDisposed();let t=Math.min(this._buffer.getLength(),Math.max(0,e));return this._buffer.getPositionAt(t)}_increaseVersionId(){this._versionId=this._versionId+1,this._alternativeVersionId=this._versionId}_overwriteVersionId(e){this._versionId=e}_overwriteAlternativeVersionId(e){this._alternativeVersionId=e}_overwriteInitialUndoRedoSnapshot(e){this._initialUndoRedoSnapshot=e}getValue(e,t=!1){this._assertNotDisposed();const n=this.getFullModelRange(),i=this.getValueInRange(n,e);return t?this._buffer.getBOM()+i:i}createSnapshot(e=!1){return new Yt(this._buffer.createSnapshot(e))}getValueLength(e,t=!1){this._assertNotDisposed();const n=this.getFullModelRange(),i=this.getValueLengthInRange(n,e);return t?this._buffer.getBOM().length+i:i}getValueInRange(e,t=0){return this._assertNotDisposed(),this._buffer.getValueInRange(this.validateRange(e),t)}getValueLengthInRange(e,t=0){return this._assertNotDisposed(),this._buffer.getValueLengthInRange(this.validateRange(e),t)}getCharacterCountInRange(e,t=0){return this._assertNotDisposed(),this._buffer.getCharacterCountInRange(this.validateRange(e),t)}getLineCount(){return this._assertNotDisposed(),this._buffer.getLineCount()}getLineContent(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new Error("Illegal value for lineNumber");return this._buffer.getLineContent(e)}getLineLength(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new Error("Illegal value for lineNumber");return this._buffer.getLineLength(e)}getLinesContent(){return this._assertNotDisposed(),this._buffer.getLinesContent()}getEOL(){return this._assertNotDisposed(),this._buffer.getEOL()}getEndOfLineSequence(){return this._assertNotDisposed(),"\n"===this._buffer.getEOL()?0:1}getLineMinColumn(e){return this._assertNotDisposed(),1}getLineMaxColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new Error("Illegal value for lineNumber");return this._buffer.getLineLength(e)+1}getLineFirstNonWhitespaceColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new Error("Illegal value for lineNumber");return this._buffer.getLineFirstNonWhitespaceColumn(e)}getLineLastNonWhitespaceColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new Error("Illegal value for lineNumber");return this._buffer.getLineLastNonWhitespaceColumn(e)}_validateRangeRelaxedNoAllocations(e){const t=this._buffer.getLineCount(),n=e.startLineNumber,i=e.startColumn;let s=Math.floor("number"!==typeof n||isNaN(n)?1:n),r=Math.floor("number"!==typeof i||isNaN(i)?1:i);if(s<1)s=1,r=1;else if(s>t)s=t,r=this.getLineMaxColumn(s);else if(r<=1)r=1;else{const e=this.getLineMaxColumn(s);r>=e&&(r=e)}const o=e.endLineNumber,a=e.endColumn;let h=Math.floor("number"!==typeof o||isNaN(o)?1:o),l=Math.floor("number"!==typeof a||isNaN(a)?1:a);if(h<1)h=1,l=1;else if(h>t)h=t,l=this.getLineMaxColumn(h);else if(l<=1)l=1;else{const e=this.getLineMaxColumn(h);l>=e&&(l=e)}return n===s&&i===r&&o===h&&a===l&&e instanceof u["a"]&&!(e instanceof c["a"])?e:new u["a"](s,r,h,l)}_isValidPosition(e,t,n){if("number"!==typeof e||"number"!==typeof t)return!1;if(isNaN(e)||isNaN(t))return!1;if(e<1||t<1)return!1;if((0|e)!==e||(0|t)!==t)return!1;const i=this._buffer.getLineCount();if(e>i)return!1;if(1===t)return!0;const s=this.getLineMaxColumn(e);if(t>s)return!1;if(1===n){const n=this._buffer.getLineCharCode(e,t-2);if(o["E"](n))return!1}return!0}_validatePosition(e,t,n){const i=Math.floor("number"!==typeof e||isNaN(e)?1:e),s=Math.floor("number"!==typeof t||isNaN(t)?1:t),r=this._buffer.getLineCount();if(i<1)return new l["a"](1,1);if(i>r)return new l["a"](r,this.getLineMaxColumn(r));if(s<=1)return new l["a"](i,1);const a=this.getLineMaxColumn(i);if(s>=a)return new l["a"](i,a);if(1===n){const e=this._buffer.getLineCharCode(i,s-2);if(o["E"](e))return new l["a"](i,s-1)}return new l["a"](i,s)}validatePosition(e){const t=1;return this._assertNotDisposed(),e instanceof l["a"]&&this._isValidPosition(e.lineNumber,e.column,t)?e:this._validatePosition(e.lineNumber,e.column,t)}_isValidRange(e,t){const n=e.startLineNumber,i=e.startColumn,s=e.endLineNumber,r=e.endColumn;if(!this._isValidPosition(n,i,0))return!1;if(!this._isValidPosition(s,r,0))return!1;if(1===t){const e=i>1?this._buffer.getLineCharCode(n,i-2):0,t=r>1&&r<=this._buffer.getLineLength(s)?this._buffer.getLineCharCode(s,r-2):0,a=o["E"](e),h=o["E"](t);return!a&&!h}return!0}validateRange(e){const t=1;if(this._assertNotDisposed(),e instanceof u["a"]&&!(e instanceof c["a"])&&this._isValidRange(e,t))return e;const n=this._validatePosition(e.startLineNumber,e.startColumn,0),i=this._validatePosition(e.endLineNumber,e.endColumn,0),s=n.lineNumber,r=n.column,a=i.lineNumber,h=i.column;if(1===t){const e=r>1?this._buffer.getLineCharCode(s,r-2):0,t=h>1&&h<=this._buffer.getLineLength(a)?this._buffer.getLineCharCode(a,h-2):0,n=o["E"](e),i=o["E"](t);return n||i?s===a&&r===h?new u["a"](s,r-1,a,h-1):n&&i?new u["a"](s,r-1,a,h+1):n?new u["a"](s,r-1,a,h):new u["a"](s,r,a,h+1):new u["a"](s,r,a,h)}return new u["a"](s,r,a,h)}modifyPosition(e,t){this._assertNotDisposed();let n=this.getOffsetAt(e)+t;return this.getPositionAt(Math.min(this._buffer.getLength(),Math.max(0,n)))}getFullModelRange(){this._assertNotDisposed();const e=this.getLineCount();return new u["a"](1,1,e,this.getLineMaxColumn(e))}findMatchesLineByLine(e,t,n,i){return this._buffer.findMatchesLineByLine(e,t,n,i)}findMatches(e,t,n,i,s,r,o=Kt){this._assertNotDisposed();let a=null;null!==t&&(Array.isArray(t)||(t=[t]),t.every(e=>u["a"].isIRange(e))&&(a=t.map(e=>this.validateRange(e)))),null===a&&(a=[this.getFullModelRange()]),a=a.sort((e,t)=>e.startLineNumber-t.startLineNumber||e.startColumn-t.startColumn);const h=[];let l;if(h.push(a.reduce((e,t)=>u["a"].areIntersecting(e,t)?e.plusRange(t):(h.push(e),t))),!n&&e.indexOf("\n")<0){const t=new le["a"](e,n,i,s),a=t.parseSearchRequest();if(!a)return[];l=e=>this.findMatchesLineByLine(e,a,r,o)}else l=t=>le["c"].findMatches(this,new le["a"](e,n,i,s),t,r,o);return h.map(l).reduce((e,t)=>e.concat(t),[])}findNextMatch(e,t,n,i,s,r){this._assertNotDisposed();const o=this.validatePosition(t);if(!n&&e.indexOf("\n")<0){const t=new le["a"](e,n,i,s),a=t.parseSearchRequest();if(!a)return null;const h=this.getLineCount();let l=new u["a"](o.lineNumber,o.column,h,this.getLineMaxColumn(h)),c=this.findMatchesLineByLine(l,a,r,1);return le["c"].findNextMatch(this,new le["a"](e,n,i,s),o,r),c.length>0?c[0]:(l=new u["a"](1,1,o.lineNumber,this.getLineMaxColumn(o.lineNumber)),c=this.findMatchesLineByLine(l,a,r,1),c.length>0?c[0]:null)}return le["c"].findNextMatch(this,new le["a"](e,n,i,s),o,r)}findPreviousMatch(e,t,n,i,s,r){this._assertNotDisposed();const o=this.validatePosition(t);return le["c"].findPreviousMatch(this,new le["a"](e,n,i,s),o,r)}pushStackElement(){this._commandManager.pushStackElement()}popStackElement(){this._commandManager.popStackElement()}pushEOL(e){const t="\n"===this.getEOL()?0:1;if(t!==e)try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),null===this._initialUndoRedoSnapshot&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEOL(e)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_validateEditOperation(e){return e instanceof d["f"]?e:new d["f"](e.identifier||null,this.validateRange(e.range),e.text,e.forceMoveMarkers||!1,e.isAutoWhitespaceEdit||!1,e._isTracked||!1)}_validateEditOperations(e){const t=[];for(let n=0,i=e.length;n<i;n++)t[n]=this._validateEditOperation(e[n]);return t}pushEditOperations(e,t,n){try{return this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._pushEditOperations(e,this._validateEditOperations(t),n)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_pushEditOperations(e,t,n){if(this._options.trimAutoWhitespace&&this._trimAutoWhitespaceLines){let n=t.map(e=>({range:this.validateRange(e.range),text:e.text})),i=!0;if(e)for(let t=0,s=e.length;t<s;t++){let s=e[t],r=!1;for(let e=0,t=n.length;e<t;e++){let t=n[e].range,i=t.startLineNumber>s.endLineNumber,o=s.startLineNumber>t.endLineNumber;if(!i&&!o){r=!0;break}}if(!r){i=!1;break}}if(i)for(let e=0,s=this._trimAutoWhitespaceLines.length;e<s;e++){let i=this._trimAutoWhitespaceLines[e],s=this.getLineMaxColumn(i),r=!0;for(let e=0,t=n.length;e<t;e++){let t=n[e].range,o=n[e].text;if(!(i<t.startLineNumber||i>t.endLineNumber)&&(!(i===t.startLineNumber&&t.startColumn===s&&t.isEmpty()&&o&&o.length>0&&"\n"===o.charAt(0))&&!(i===t.startLineNumber&&1===t.startColumn&&t.isEmpty()&&o&&o.length>0&&"\n"===o.charAt(o.length-1)))){r=!1;break}}if(r){const e=new u["a"](i,1,i,s);t.push(new d["f"](null,e,null,!1,!1,!1))}}this._trimAutoWhitespaceLines=null}return null===this._initialUndoRedoSnapshot&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEditOperation(e,t,n)}_applyUndo(e,t,n,i){const s=e.map(e=>{const t=this.getPositionAt(e.newPosition),n=this.getPositionAt(e.newEnd);return{range:new u["a"](t.lineNumber,t.column,n.lineNumber,n.column),text:e.oldText}});this._applyUndoRedoEdits(s,t,!0,!1,n,i)}_applyRedo(e,t,n,i){const s=e.map(e=>{const t=this.getPositionAt(e.oldPosition),n=this.getPositionAt(e.oldEnd);return{range:new u["a"](t.lineNumber,t.column,n.lineNumber,n.column),text:e.newText}});this._applyUndoRedoEdits(s,t,!1,!0,n,i)}_applyUndoRedoEdits(e,t,n,i,s,r){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._isUndoing=n,this._isRedoing=i,this.applyEdits(e,!1),this.setEOL(t),this._overwriteAlternativeVersionId(s)}finally{this._isUndoing=!1,this._isRedoing=!1,this._eventEmitter.endDeferredEmit(r),this._onDidChangeDecorations.endDeferredEmit()}}applyEdits(e,t=!1){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit();const n=this._validateEditOperations(e);return this._doApplyEdits(n,t)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_doApplyEdits(e,t){const n=this._buffer.getLineCount(),i=this._buffer.applyEdits(e,this._options.trimAutoWhitespace,t),s=this._buffer.getLineCount(),r=i.changes;if(this._trimAutoWhitespaceLines=i.trimAutoWhitespaceLineNumbers,0!==r.length){for(let n=0,i=r.length;n<i;n++){const e=r[n],[t,i,s]=Object(Le["f"])(e.text);this._tokens.acceptEdit(e.range,t,i),this._tokens2.acceptEdit(e.range,t,i,s,e.text.length>0?e.text.charCodeAt(0):0),this._decorationsTree.acceptReplace(e.rangeOffset,e.rangeLength,e.text.length,e.forceMoveMarkers)}let e=[];this._increaseVersionId();let t=n;for(let n=0,i=r.length;n<i;n++){const i=r[n],[o]=Object(Le["f"])(i.text);this._onDidChangeDecorations.fire();const a=i.range.startLineNumber,h=i.range.endLineNumber,u=h-a,c=o,d=Math.min(u,c),f=c-u,g=s-t-f+a,_=g,p=g+c,m=this._decorationsTree.getInjectedTextInInterval(this,this.getOffsetAt(new l["a"](_,1)),this.getOffsetAt(new l["a"](p,this.getLineMaxColumn(p))),0),C=Ne["b"].fromDecorations(m),b=new Se["a"](C);for(let t=d;t>=0;t--){const n=a+t,i=g+t;b.takeFromEndWhile(e=>e.lineNumber>i);const s=b.takeFromEndWhile(e=>e.lineNumber===i);e.push(new Ne["g"](n,this.getLineContent(i),s))}if(d<u){const t=a+d;e.push(new Ne["h"](t+1,h))}if(d<c){const n=new Se["a"](C),i=a+d,r=c-d,o=s-t-r+i+1;let h=[],l=[];for(let e=0;e<r;e++){let t=o+e;l[e]=this.getLineContent(t),n.takeWhile(e=>e.lineNumber<t),h[e]=n.takeWhile(e=>e.lineNumber===t)}e.push(new Ne["i"](i+1,a+c,l,h))}t+=f}this._emitContentChangedEvent(new Ne["d"](e,this.getVersionId(),this._isUndoing,this._isRedoing),{changes:r,eol:this._buffer.getEOL(),versionId:this.getVersionId(),isUndoing:this._isUndoing,isRedoing:this._isRedoing,isFlush:!1})}return null===i.reverseEdits?void 0:i.reverseEdits}undo(){return this._undoRedoService.undo(this.uri)}canUndo(){return this._undoRedoService.canUndo(this.uri)}redo(){return this._undoRedoService.redo(this.uri)}canRedo(){return this._undoRedoService.canRedo(this.uri)}handleBeforeFireDecorationsChangedEvent(e){if(null===e||0===e.size)return;const t=[...e],n=t.map(e=>new Ne["g"](e,this.getLineContent(e),this._getInjectedTextInLine(e)));this._onDidChangeContentOrInjectedText.fire(new Ne["c"](n))}changeDecorations(e,t=0){this._assertNotDisposed();try{return this._onDidChangeDecorations.beginDeferredEmit(),this._changeDecorations(t,e)}finally{this._onDidChangeDecorations.endDeferredEmit()}}_changeDecorations(e,t){let n={addDecoration:(t,n)=>this._deltaDecorationsImpl(e,[],[{range:t,options:n}])[0],changeDecoration:(e,t)=>{this._changeDecorationImpl(e,t)},changeDecorationOptions:(e,t)=>{this._changeDecorationOptionsImpl(e,fn(t))},removeDecoration:t=>{this._deltaDecorationsImpl(e,[t],[])},deltaDecorations:(t,n)=>0===t.length&&0===n.length?[]:this._deltaDecorationsImpl(e,t,n)},s=null;try{s=t(n)}catch(r){Object(i["f"])(r)}return n.addDecoration=Qt,n.changeDecoration=Qt,n.changeDecorationOptions=Qt,n.removeDecoration=Qt,n.deltaDecorations=Qt,s}deltaDecorations(e,t,n=0){if(this._assertNotDisposed(),e||(e=[]),0===e.length&&0===t.length)return[];try{return this._onDidChangeDecorations.beginDeferredEmit(),this._deltaDecorationsImpl(n,e,t)}finally{this._onDidChangeDecorations.endDeferredEmit()}}_getTrackedRange(e){return this.getDecorationRange(e)}_setTrackedRange(e,t,n){const i=e?this._decorations[e]:null;if(!i)return t?this._deltaDecorationsImpl(0,[],[{range:t,options:dn[n]}])[0]:null;if(!t)return this._decorationsTree.delete(i),delete this._decorations[i.id],null;const s=this._validateRangeRelaxedNoAllocations(t),r=this._buffer.getOffsetAt(s.startLineNumber,s.startColumn),o=this._buffer.getOffsetAt(s.endLineNumber,s.endColumn);return this._decorationsTree.delete(i),i.reset(this.getVersionId(),r,o,s),i.setOptions(dn[n]),this._decorationsTree.insert(i),i.id}removeAllDecorationsWithOwnerId(e){if(this._isDisposed)return;const t=this._decorationsTree.collectNodesFromOwner(e);for(let n=0,i=t.length;n<i;n++){const e=t[n];this._decorationsTree.delete(e),delete this._decorations[e.id]}}getDecorationOptions(e){const t=this._decorations[e];return t?t.options:null}getDecorationRange(e){const t=this._decorations[e];return t?this._decorationsTree.getNodeRange(this,t):null}getLineDecorations(e,t=0,n=!1){return e<1||e>this.getLineCount()?[]:this.getLinesDecorations(e,e,t,n)}getLinesDecorations(e,t,n=0,i=!1){let s=this.getLineCount(),r=Math.min(s,Math.max(1,e)),o=Math.min(s,Math.max(1,t)),a=this.getLineMaxColumn(o);const h=new u["a"](r,1,o,a),l=this._getDecorationsInRange(h,n,i);return l.push(...this._decorationProvider.getDecorationsInRange(h,n,i)),l}getDecorationsInRange(e,t=0,n=!1){let i=this.validateRange(e);const s=this._getDecorationsInRange(i,t,n);return s.push(...this._decorationProvider.getDecorationsInRange(i,t,n)),s}getOverviewRulerDecorations(e=0,t=!1){return this._decorationsTree.getAll(this,e,t,!0)}getInjectedTextDecorations(e=0){return this._decorationsTree.getAllInjectedText(this,e)}_getInjectedTextInLine(e){const t=this._buffer.getOffsetAt(e,1),n=t+this._buffer.getLineLength(e),i=this._decorationsTree.getInjectedTextInInterval(this,t,n,0);return Ne["b"].fromDecorations(i).filter(t=>t.lineNumber===e)}getAllDecorations(e=0,t=!1){const n=this._decorationsTree.getAll(this,e,t,!1);return n.push(...this._decorationProvider.getAllDecorations(e,t)),n}_getDecorationsInRange(e,t,n){const i=this._buffer.getOffsetAt(e.startLineNumber,e.startColumn),s=this._buffer.getOffsetAt(e.endLineNumber,e.endColumn);return this._decorationsTree.getAllInInterval(this,i,s,t,n)}getRangeAt(e,t){return this._buffer.getRangeAt(e,t-e)}_changeDecorationImpl(e,t){const n=this._decorations[e];if(!n)return;if(n.options.after){const t=this.getDecorationRange(e);this._onDidChangeDecorations.recordLineAffectedByInjectedText(t.endLineNumber)}if(n.options.before){const t=this.getDecorationRange(e);this._onDidChangeDecorations.recordLineAffectedByInjectedText(t.startLineNumber)}const i=this._validateRangeRelaxedNoAllocations(t),s=this._buffer.getOffsetAt(i.startLineNumber,i.startColumn),r=this._buffer.getOffsetAt(i.endLineNumber,i.endColumn);this._decorationsTree.delete(n),n.reset(this.getVersionId(),s,r,i),this._decorationsTree.insert(n),this._onDidChangeDecorations.checkAffectedAndFire(n.options),n.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(i.endLineNumber),n.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(i.startLineNumber)}_changeDecorationOptionsImpl(e,t){const n=this._decorations[e];if(!n)return;const i=!(!n.options.overviewRuler||!n.options.overviewRuler.color),s=!(!t.overviewRuler||!t.overviewRuler.color);if(this._onDidChangeDecorations.checkAffectedAndFire(n.options),this._onDidChangeDecorations.checkAffectedAndFire(t),n.options.after||t.after){const e=this._decorationsTree.getNodeRange(this,n);this._onDidChangeDecorations.recordLineAffectedByInjectedText(e.endLineNumber)}if(n.options.before||t.before){const e=this._decorationsTree.getNodeRange(this,n);this._onDidChangeDecorations.recordLineAffectedByInjectedText(e.startLineNumber)}i!==s?(this._decorationsTree.delete(n),n.setOptions(t),this._decorationsTree.insert(n)):n.setOptions(t)}_deltaDecorationsImpl(e,t,n){const i=this.getVersionId(),s=t.length;let r=0;const o=n.length;let a=0,h=new Array(o);while(r<s||a<o){let l=null;if(r<s){do{l=this._decorations[t[r++]]}while(!l&&r<s);if(l){if(l.options.after){const e=this._decorationsTree.getNodeRange(this,l);this._onDidChangeDecorations.recordLineAffectedByInjectedText(e.endLineNumber)}if(l.options.before){const e=this._decorationsTree.getNodeRange(this,l);this._onDidChangeDecorations.recordLineAffectedByInjectedText(e.startLineNumber)}this._decorationsTree.delete(l),this._onDidChangeDecorations.checkAffectedAndFire(l.options)}}if(a<o){if(!l){const e=++this._lastDecorationId,t=`${this._instanceId};${e}`;l=new T(t,0,0),this._decorations[t]=l}const t=n[a],s=this._validateRangeRelaxedNoAllocations(t.range),r=fn(t.options),o=this._buffer.getOffsetAt(s.startLineNumber,s.startColumn),u=this._buffer.getOffsetAt(s.endLineNumber,s.endColumn);l.ownerId=e,l.reset(i,o,u,s),l.setOptions(r),l.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(s.endLineNumber),l.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(s.startLineNumber),this._onDidChangeDecorations.checkAffectedAndFire(r),this._decorationsTree.insert(l),h[a]=l.id,a++}else l&&delete this._decorations[l.id]}return h}setTokens(e,t=!1){if(0!==e.length){let t=[];for(let n=0,i=e.length;n<i;n++){const i=e[n];let s=0,r=0,o=!1;for(let e=0,t=i.tokens.length;e<t;e++){const t=i.startLineNumber+e;if(o)this._tokens.setTokens(this._languageIdentifier.id,t-1,this._buffer.getLineLength(t),i.tokens[e],!1),r=t;else{const n=this._tokens.setTokens(this._languageIdentifier.id,t-1,this._buffer.getLineLength(t),i.tokens[e],!0);n&&(o=!0,s=t,r=t)}}o&&t.push({fromLineNumber:s,toLineNumber:r})}t.length>0&&this._emitModelTokensChangedEvent({tokenizationSupportChanged:!1,semanticTokensApplied:!1,ranges:t})}this.setBackgroundTokenizationState(t?2:1)}setSemanticTokens(e,t){this._tokens2.set(e,t),this._emitModelTokensChangedEvent({tokenizationSupportChanged:!1,semanticTokensApplied:null!==e,ranges:[{fromLineNumber:1,toLineNumber:this.getLineCount()}]})}hasCompleteSemanticTokens(){return this._tokens2.isComplete()}hasSomeSemanticTokens(){return!this._tokens2.isEmpty()}setPartialSemanticTokens(e,t){if(this.hasCompleteSemanticTokens())return;const n=this._tokens2.setPartial(e,t);this._emitModelTokensChangedEvent({tokenizationSupportChanged:!1,semanticTokensApplied:!0,ranges:[{fromLineNumber:n.startLineNumber,toLineNumber:n.endLineNumber}]})}tokenizeViewport(e,t){e=Math.max(1,e),t=Math.min(this._buffer.getLineCount(),t),this._tokenization.tokenizeViewport(e,t)}clearTokens(){this._tokens.flush(),this._emitModelTokensChangedEvent({tokenizationSupportChanged:!0,semanticTokensApplied:!1,ranges:[{fromLineNumber:1,toLineNumber:this._buffer.getLineCount()}]})}_emitModelTokensChangedEvent(e){this._isDisposing||this._onDidChangeTokens.fire(e)}resetTokenization(){this._tokenization.reset()}forceTokenization(e){if(e<1||e>this.getLineCount())throw new Error("Illegal value for lineNumber");this._tokenization.forceTokenization(e)}isCheapToTokenize(e){return this._tokenization.isCheapToTokenize(e)}tokenizeIfCheap(e){this.isCheapToTokenize(e)&&this.forceTokenization(e)}getLineTokens(e){if(e<1||e>this.getLineCount())throw new Error("Illegal value for lineNumber");return this._getLineTokens(e)}_getLineTokens(e){const t=this.getLineContent(e),n=this._tokens.getTokens(this._languageIdentifier.id,e-1,t);return this._tokens2.addSemanticTokens(e,n)}getLanguageIdentifier(){return this._languageIdentifier}getModeId(){return this._languageIdentifier.language}setMode(e){if(this._languageIdentifier.id===e.id)return;let t={oldLanguage:this._languageIdentifier.language,newLanguage:e.language};this._languageIdentifier=e,this._onDidChangeLanguage.fire(t),this._onDidChangeLanguageConfiguration.fire({})}getLanguageIdAtPosition(e,t){const n=this.validatePosition(new l["a"](e,t)),i=this.getLineTokens(n.lineNumber);return i.getLanguageId(i.findTokenIndexAtOffset(n.column-1))}getWordAtPosition(e){this._assertNotDisposed();const t=this.validatePosition(e),n=this.getLineContent(t.lineNumber),i=this._getLineTokens(t.lineNumber),s=i.findTokenIndexAtOffset(t.column-1),[r,o]=en._findLanguageBoundaries(i,s),a=Object(ye["d"])(t.column,ze["a"].getWordDefinition(i.getLanguageId(s)),n.substring(r,o),r);if(a&&a.startColumn<=e.column&&e.column<=a.endColumn)return a;if(s>0&&r===t.column-1){const[r,o]=en._findLanguageBoundaries(i,s-1),a=Object(ye["d"])(t.column,ze["a"].getWordDefinition(i.getLanguageId(s-1)),n.substring(r,o),r);if(a&&a.startColumn<=e.column&&e.column<=a.endColumn)return a}return null}static _findLanguageBoundaries(e,t){const n=e.getLanguageId(t);let i=0;for(let r=t;r>=0&&e.getLanguageId(r)===n;r--)i=e.getStartOffset(r);let s=e.getLineContent().length;for(let r=t,o=e.getCount();r<o&&e.getLanguageId(r)===n;r++)s=e.getEndOffset(r);return[i,s]}getWordUntilPosition(e){const t=this.getWordAtPosition(e);return t?{word:t.word.substr(0,e.column-t.startColumn),startColumn:t.startColumn,endColumn:e.column}:{word:"",startColumn:e.column,endColumn:e.column}}findMatchingBracketUp(e,t){let n=e.toLowerCase(),i=this.validatePosition(t),s=this._getLineTokens(i.lineNumber),r=s.getLanguageId(s.findTokenIndexAtOffset(i.column-1)),o=ze["a"].getBracketsSupport(r);if(!o)return null;let a=o.textIsBracket[n];return a?Xt(this._findMatchingBracketUp(a,i,null)):null}matchBracket(e){return this._matchBracket(this.validatePosition(e))}_establishBracketSearchOffsets(e,t,n,i){const s=t.getCount(),r=t.getLanguageId(i);let o=Math.max(0,e.column-1-n.maxBracketLength);for(let h=i-1;h>=0;h--){const e=t.getEndOffset(h);if(e<=o)break;if(Object(Pe["b"])(t.getStandardTokenType(h))||t.getLanguageId(h)!==r){o=e;break}}let a=Math.min(t.getLineContent().length,e.column-1+n.maxBracketLength);for(let h=i+1;h<s;h++){const e=t.getStartOffset(h);if(e>=a)break;if(Object(Pe["b"])(t.getStandardTokenType(h))||t.getLanguageId(h)!==r){a=e;break}}return{searchStartOffset:o,searchEndOffset:a}}_matchBracket(e){const t=e.lineNumber,n=this._getLineTokens(t),i=this._buffer.getLineContent(t),s=n.findTokenIndexAtOffset(e.column-1);if(s<0)return null;const r=ze["a"].getBracketsSupport(n.getLanguageId(s));if(r&&!Object(Pe["b"])(n.getStandardTokenType(s))){let{searchStartOffset:o,searchEndOffset:a}=this._establishBracketSearchOffsets(e,n,r,s),h=null;while(1){const n=Fe["a"].findNextBracketInRange(r.forwardRegex,t,i,o,a);if(!n)break;if(n.startColumn<=e.column&&e.column<=n.endColumn){const e=i.substring(n.startColumn-1,n.endColumn-1).toLowerCase(),t=this._matchFoundBracket(n,r.textIsBracket[e],r.textIsOpenBracket[e],null);if(t){if(t instanceof Zt)return null;h=t}}o=n.endColumn-1}if(h)return h}if(s>0&&n.getStartOffset(s)===e.column-1){const r=s-1,o=ze["a"].getBracketsSupport(n.getLanguageId(r));if(o&&!Object(Pe["b"])(n.getStandardTokenType(r))){let{searchStartOffset:s,searchEndOffset:a}=this._establishBracketSearchOffsets(e,n,o,r);const h=Fe["a"].findPrevBracketInRange(o.reversedRegex,t,i,s,a);if(h&&h.startColumn<=e.column&&e.column<=h.endColumn){const e=i.substring(h.startColumn-1,h.endColumn-1).toLowerCase(),t=this._matchFoundBracket(h,o.textIsBracket[e],o.textIsOpenBracket[e],null);if(t)return t instanceof Zt?null:t}}}return null}_matchFoundBracket(e,t,n,i){if(!t)return null;const s=n?this._findMatchingBracketDown(t,e.getEndPosition(),i):this._findMatchingBracketUp(t,e.getStartPosition(),i);return s?s instanceof Zt?s:[e,s]:null}_findMatchingBracketUp(e,t,n){const i=e.languageIdentifier.id,s=e.reversedRegex;let r=-1,o=0;const a=(t,i,a,h)=>{while(1){if(n&&++o%100===0&&!n())return Zt.INSTANCE;const l=Fe["a"].findPrevBracketInRange(s,t,i,a,h);if(!l)break;const u=i.substring(l.startColumn-1,l.endColumn-1).toLowerCase();if(e.isOpen(u)?r++:e.isClose(u)&&r--,0===r)return l;h=l.startColumn-1}return null};for(let h=t.lineNumber;h>=1;h--){const e=this._getLineTokens(h),n=e.getCount(),s=this._buffer.getLineContent(h);let r=n-1,o=s.length,l=s.length;h===t.lineNumber&&(r=e.findTokenIndexAtOffset(t.column-1),o=t.column-1,l=t.column-1);let u=!0;for(;r>=0;r--){const t=e.getLanguageId(r)===i&&!Object(Pe["b"])(e.getStandardTokenType(r));if(t)u?o=e.getStartOffset(r):(o=e.getStartOffset(r),l=e.getEndOffset(r));else if(u&&o!==l){const e=a(h,s,o,l);if(e)return e}u=t}if(u&&o!==l){const e=a(h,s,o,l);if(e)return e}}return null}_findMatchingBracketDown(e,t,n){const i=e.languageIdentifier.id,s=e.forwardRegex;let r=1,o=0;const a=(t,i,a,h)=>{while(1){if(n&&++o%100===0&&!n())return Zt.INSTANCE;const l=Fe["a"].findNextBracketInRange(s,t,i,a,h);if(!l)break;const u=i.substring(l.startColumn-1,l.endColumn-1).toLowerCase();if(e.isOpen(u)?r++:e.isClose(u)&&r--,0===r)return l;a=l.endColumn-1}return null},h=this.getLineCount();for(let l=t.lineNumber;l<=h;l++){const e=this._getLineTokens(l),n=e.getCount(),s=this._buffer.getLineContent(l);let r=0,o=0,h=0;l===t.lineNumber&&(r=e.findTokenIndexAtOffset(t.column-1),o=t.column-1,h=t.column-1);let u=!0;for(;r<n;r++){const t=e.getLanguageId(r)===i&&!Object(Pe["b"])(e.getStandardTokenType(r));if(t)u||(o=e.getStartOffset(r)),h=e.getEndOffset(r);else if(u&&o!==h){const e=a(l,s,o,h);if(e)return e}u=t}if(u&&o!==h){const e=a(l,s,o,h);if(e)return e}}return null}findPrevBracket(e){const t=this.validatePosition(e);let n=-1,i=null;for(let s=t.lineNumber;s>=1;s--){const e=this._getLineTokens(s),r=e.getCount(),o=this._buffer.getLineContent(s);let a=r-1,h=o.length,l=o.length;if(s===t.lineNumber){a=e.findTokenIndexAtOffset(t.column-1),h=t.column-1,l=t.column-1;const s=e.getLanguageId(a);n!==s&&(n=s,i=ze["a"].getBracketsSupport(n))}let u=!0;for(;a>=0;a--){const t=e.getLanguageId(a);if(n!==t){if(i&&u&&h!==l){const e=Fe["a"].findPrevBracketInRange(i.reversedRegex,s,o,h,l);if(e)return this._toFoundBracket(i,e);u=!1}n=t,i=ze["a"].getBracketsSupport(n)}const r=!!i&&!Object(Pe["b"])(e.getStandardTokenType(a));if(r)u?h=e.getStartOffset(a):(h=e.getStartOffset(a),l=e.getEndOffset(a));else if(i&&u&&h!==l){const e=Fe["a"].findPrevBracketInRange(i.reversedRegex,s,o,h,l);if(e)return this._toFoundBracket(i,e)}u=r}if(i&&u&&h!==l){const e=Fe["a"].findPrevBracketInRange(i.reversedRegex,s,o,h,l);if(e)return this._toFoundBracket(i,e)}}return null}findNextBracket(e){const t=this.validatePosition(e),n=this.getLineCount();let i=-1,s=null;for(let r=t.lineNumber;r<=n;r++){const e=this._getLineTokens(r),n=e.getCount(),o=this._buffer.getLineContent(r);let a=0,h=0,l=0;if(r===t.lineNumber){a=e.findTokenIndexAtOffset(t.column-1),h=t.column-1,l=t.column-1;const n=e.getLanguageId(a);i!==n&&(i=n,s=ze["a"].getBracketsSupport(i))}let u=!0;for(;a<n;a++){const t=e.getLanguageId(a);if(i!==t){if(s&&u&&h!==l){const e=Fe["a"].findNextBracketInRange(s.forwardRegex,r,o,h,l);if(e)return this._toFoundBracket(s,e);u=!1}i=t,s=ze["a"].getBracketsSupport(i)}const n=!!s&&!Object(Pe["b"])(e.getStandardTokenType(a));if(n)u||(h=e.getStartOffset(a)),l=e.getEndOffset(a);else if(s&&u&&h!==l){const e=Fe["a"].findNextBracketInRange(s.forwardRegex,r,o,h,l);if(e)return this._toFoundBracket(s,e)}u=n}if(s&&u&&h!==l){const e=Fe["a"].findNextBracketInRange(s.forwardRegex,r,o,h,l);if(e)return this._toFoundBracket(s,e)}}return null}findEnclosingBrackets(e,t){let n;if("undefined"===typeof t)n=null;else{const e=Date.now();n=()=>Date.now()-e<=t}const i=this.validatePosition(e),s=this.getLineCount(),r=new Map;let o=[];const a=(e,t)=>{if(!r.has(e)){let n=[];for(let e=0,i=t?t.brackets.length:0;e<i;e++)n[e]=0;r.set(e,n)}o=r.get(e)};let h=0;const l=(e,t,i,s,r)=>{while(1){if(n&&++h%100===0&&!n())return Zt.INSTANCE;const a=Fe["a"].findNextBracketInRange(e.forwardRegex,t,i,s,r);if(!a)break;const l=i.substring(a.startColumn-1,a.endColumn-1).toLowerCase(),u=e.textIsBracket[l];if(u&&(u.isOpen(l)?o[u.index]++:u.isClose(l)&&o[u.index]--,-1===o[u.index]))return this._matchFoundBracket(a,u,!1,n);s=a.endColumn-1}return null};let u=-1,c=null;for(let d=i.lineNumber;d<=s;d++){const e=this._getLineTokens(d),t=e.getCount(),n=this._buffer.getLineContent(d);let s=0,r=0,o=0;if(d===i.lineNumber){s=e.findTokenIndexAtOffset(i.column-1),r=i.column-1,o=i.column-1;const t=e.getLanguageId(s);u!==t&&(u=t,c=ze["a"].getBracketsSupport(u),a(u,c))}let h=!0;for(;s<t;s++){const t=e.getLanguageId(s);if(u!==t){if(c&&h&&r!==o){const e=l(c,d,n,r,o);if(e)return Xt(e);h=!1}u=t,c=ze["a"].getBracketsSupport(u),a(u,c)}const i=!!c&&!Object(Pe["b"])(e.getStandardTokenType(s));if(i)h||(r=e.getStartOffset(s)),o=e.getEndOffset(s);else if(c&&h&&r!==o){const e=l(c,d,n,r,o);if(e)return Xt(e)}h=i}if(c&&h&&r!==o){const e=l(c,d,n,r,o);if(e)return Xt(e)}}return null}_toFoundBracket(e,t){if(!t)return null;let n=this.getValueInRange(t);n=n.toLowerCase();let i=e.textIsBracket[n];return i?{range:t,open:i.open,close:i.close,isOpen:e.textIsOpenBracket[n]}:null}static computeIndentLevel(e,t){let n=0,i=0,s=e.length;while(i<s){let s=e.charCodeAt(i);if(32===s)n++;else{if(9!==s)break;n=n-n%t+t}i++}return i===s?-1:n}_computeIndentLevel(e){return en.computeIndentLevel(this._buffer.getLineContent(e+1),this._options.tabSize)}getActiveIndentGuide(e,t,n){this._assertNotDisposed();const i=this.getLineCount();if(e<1||e>i)throw new Error("Illegal value for lineNumber");const s=ze["a"].getFoldingRules(this._languageIdentifier.id),r=Boolean(s&&s.offSide);let o=-2,a=-1,h=-2,l=-1;const u=e=>{if(-1!==o&&(-2===o||o>e-1)){o=-1,a=-1;for(let t=e-2;t>=0;t--){let e=this._computeIndentLevel(t);if(e>=0){o=t,a=e;break}}}if(-2===h){h=-1,l=-1;for(let t=e;t<i;t++){let e=this._computeIndentLevel(t);if(e>=0){h=t,l=e;break}}}};let c=-2,d=-1,f=-2,g=-1;const _=e=>{if(-2===c){c=-1,d=-1;for(let t=e-2;t>=0;t--){let e=this._computeIndentLevel(t);if(e>=0){c=t,d=e;break}}}if(-1!==f&&(-2===f||f<e-1)){f=-1,g=-1;for(let t=e;t<i;t++){let e=this._computeIndentLevel(t);if(e>=0){f=t,g=e;break}}}};let p=0,m=!0,C=0,b=!0,L=0,k=0;for(let w=0;m||b;w++){const s=e-w,o=e+w;w>1&&(s<1||s<t)&&(m=!1),w>1&&(o>i||o>n)&&(b=!1),w>5e4&&(m=!1,b=!1);let f=-1;if(m){const e=this._computeIndentLevel(s-1);e>=0?(h=s-1,l=e,f=Math.ceil(e/this._options.indentSize)):(u(s),f=this._getIndentLevelForWhitespaceLine(r,a,l))}let x=-1;if(b){const e=this._computeIndentLevel(o-1);e>=0?(c=o-1,d=e,x=Math.ceil(e/this._options.indentSize)):(_(o),x=this._getIndentLevelForWhitespaceLine(r,d,g))}if(0!==w){if(1===w){if(o<=i&&x>=0&&k+1===x){m=!1,p=o,C=o,L=x;continue}if(s>=1&&f>=0&&f-1===k){b=!1,p=s,C=s,L=f;continue}if(p=e,C=e,L=k,0===L)return{startLineNumber:p,endLineNumber:C,indent:L}}m&&(f>=L?p=s:m=!1),b&&(x>=L?C=o:b=!1)}else k=f}return{startLineNumber:p,endLineNumber:C,indent:L}}getLinesIndentGuides(e,t){this._assertNotDisposed();const n=this.getLineCount();if(e<1||e>n)throw new Error("Illegal value for startLineNumber");if(t<1||t>n)throw new Error("Illegal value for endLineNumber");const i=ze["a"].getFoldingRules(this._languageIdentifier.id),s=Boolean(i&&i.offSide);let r=new Array(t-e+1),o=-2,a=-1,h=-2,l=-1;for(let u=e;u<=t;u++){let t=u-e;const i=this._computeIndentLevel(u-1);if(i>=0)o=u-1,a=i,r[t]=Math.ceil(i/this._options.indentSize);else{if(-2===o){o=-1,a=-1;for(let e=u-2;e>=0;e--){let t=this._computeIndentLevel(e);if(t>=0){o=e,a=t;break}}}if(-1!==h&&(-2===h||h<u-1)){h=-1,l=-1;for(let e=u;e<n;e++){let t=this._computeIndentLevel(e);if(t>=0){h=e,l=t;break}}}r[t]=this._getIndentLevelForWhitespaceLine(s,a,l)}}return r}_getIndentLevelForWhitespaceLine(e,t,n){return-1===t||-1===n?0:t<n?1+Math.floor(t/this._options.indentSize):t===n||e?Math.ceil(n/this._options.indentSize):1+Math.floor(n/this._options.indentSize)}normalizePosition(e,t){return e}getLineIndentColumn(e){return tn(this.getLineContent(e))+1}}function tn(e){let t=0;for(const n of e){if(" "!==n&&"\t"!==n)break;t++}return t}function nn(e){return!(!e.options.overviewRuler||!e.options.overviewRuler.color)}function sn(e){return!!e.options.after||!!e.options.before}en.MODEL_SYNC_LIMIT=52428800,en.LARGE_FILE_SIZE_THRESHOLD=20971520,en.LARGE_FILE_LINE_COUNT_THRESHOLD=3e5,en.DEFAULT_CREATION_OPTIONS={isForSimpleWidget:!1,tabSize:h["d"].tabSize,indentSize:h["d"].indentSize,insertSpaces:h["d"].insertSpaces,detectIndentation:!1,defaultEOL:1,trimAutoWhitespace:h["d"].trimAutoWhitespace,largeFileOptimizations:h["d"].largeFileOptimizations,bracketPairColorizationOptions:h["d"].bracketPairColorizationOptions};class rn{constructor(){this._decorationsTree0=new O,this._decorationsTree1=new O,this._injectedTextDecorationsTree=new O}ensureAllNodesHaveRanges(e){this.getAll(e,0,!1,!1)}_ensureNodesHaveRanges(e,t){for(const n of t)null===n.range&&(n.range=e.getRangeAt(n.cachedAbsoluteStart,n.cachedAbsoluteEnd));return t}getAllInInterval(e,t,n,i,s){const r=e.getVersionId(),o=this._intervalSearch(t,n,i,s,r);return this._ensureNodesHaveRanges(e,o)}_intervalSearch(e,t,n,i,s){const r=this._decorationsTree0.intervalSearch(e,t,n,i,s),o=this._decorationsTree1.intervalSearch(e,t,n,i,s),a=this._injectedTextDecorationsTree.intervalSearch(e,t,n,i,s);return r.concat(o).concat(a)}getInjectedTextInInterval(e,t,n,i){const s=e.getVersionId(),r=this._injectedTextDecorationsTree.intervalSearch(t,n,i,!1,s);return this._ensureNodesHaveRanges(e,r)}getAllInjectedText(e,t){const n=e.getVersionId(),i=this._injectedTextDecorationsTree.search(t,!1,n);return this._ensureNodesHaveRanges(e,i)}getAll(e,t,n,i){const s=e.getVersionId(),r=this._search(t,n,i,s);return this._ensureNodesHaveRanges(e,r)}_search(e,t,n,i){if(n)return this._decorationsTree1.search(e,t,i);{const n=this._decorationsTree0.search(e,t,i),s=this._decorationsTree1.search(e,t,i),r=this._injectedTextDecorationsTree.search(e,t,i);return n.concat(s).concat(r)}}collectNodesFromOwner(e){const t=this._decorationsTree0.collectNodesFromOwner(e),n=this._decorationsTree1.collectNodesFromOwner(e),i=this._injectedTextDecorationsTree.collectNodesFromOwner(e);return t.concat(n).concat(i)}collectNodesPostOrder(){const e=this._decorationsTree0.collectNodesPostOrder(),t=this._decorationsTree1.collectNodesPostOrder(),n=this._injectedTextDecorationsTree.collectNodesPostOrder();return e.concat(t).concat(n)}insert(e){sn(e)?this._injectedTextDecorationsTree.insert(e):nn(e)?this._decorationsTree1.insert(e):this._decorationsTree0.insert(e)}delete(e){sn(e)?this._injectedTextDecorationsTree.delete(e):nn(e)?this._decorationsTree1.delete(e):this._decorationsTree0.delete(e)}getNodeRange(e,t){const n=e.getVersionId();return t.cachedVersionId!==n&&this._resolveNode(t,n),null===t.range&&(t.range=e.getRangeAt(t.cachedAbsoluteStart,t.cachedAbsoluteEnd)),t.range}_resolveNode(e,t){sn(e)?this._injectedTextDecorationsTree.resolveNode(e,t):nn(e)?this._decorationsTree1.resolveNode(e,t):this._decorationsTree0.resolveNode(e,t)}acceptReplace(e,t,n,i){this._decorationsTree0.acceptReplace(e,t,n,i),this._decorationsTree1.acceptReplace(e,t,n,i),this._injectedTextDecorationsTree.acceptReplace(e,t,n,i)}}function on(e){return e.replace(/[^a-z0-9\-_]/gi," ")}class an{constructor(e){this.color=e.color||"",this.darkColor=e.darkColor||""}}class hn extends an{constructor(e){super(e),this._resolvedColor=null,this.position="number"===typeof e.position?e.position:d["d"].Center}getColor(e){return this._resolvedColor||("light"!==e.type&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,e):this._resolvedColor=this._resolveColor(this.color,e)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=null}_resolveColor(e,t){if("string"===typeof e)return e;let n=e?t.getColor(e.id):null;return n?n.toString():""}}class ln extends an{constructor(e){super(e),this.position=e.position}getColor(e){return this._resolvedColor||("light"!==e.type&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,e):this._resolvedColor=this._resolveColor(this.color,e)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=void 0}_resolveColor(e,t){return"string"===typeof e?Ve["a"].fromHex(e):t.getColor(e.id)}}class un{constructor(e){this.content=e.content||"",this.inlineClassName=e.inlineClassName||null,this.inlineClassNameAffectsLetterSpacing=e.inlineClassNameAffectsLetterSpacing||!1}static from(e){return e instanceof un?e:new un(e)}}class cn{constructor(e){this.description=e.description,this.stickiness=e.stickiness||0,this.zIndex=e.zIndex||0,this.className=e.className?on(e.className):null,this.hoverMessage=e.hoverMessage||null,this.glyphMarginHoverMessage=e.glyphMarginHoverMessage||null,this.isWholeLine=e.isWholeLine||!1,this.showIfCollapsed=e.showIfCollapsed||!1,this.collapseOnReplaceEdit=e.collapseOnReplaceEdit||!1,this.overviewRuler=e.overviewRuler?new hn(e.overviewRuler):null,this.minimap=e.minimap?new ln(e.minimap):null,this.glyphMarginClassName=e.glyphMarginClassName?on(e.glyphMarginClassName):null,this.linesDecorationsClassName=e.linesDecorationsClassName?on(e.linesDecorationsClassName):null,this.firstLineDecorationClassName=e.firstLineDecorationClassName?on(e.firstLineDecorationClassName):null,this.marginClassName=e.marginClassName?on(e.marginClassName):null,this.inlineClassName=e.inlineClassName?on(e.inlineClassName):null,this.inlineClassNameAffectsLetterSpacing=e.inlineClassNameAffectsLetterSpacing||!1,this.beforeContentClassName=e.beforeContentClassName?on(e.beforeContentClassName):null,this.afterContentClassName=e.afterContentClassName?on(e.afterContentClassName):null,this.after=e.after?un.from(e.after):null,this.before=e.before?un.from(e.before):null}static register(e){return new cn(e)}static createDynamic(e){return new cn(e)}}cn.EMPTY=cn.register({description:"empty"});const dn=[cn.register({description:"tracked-range-always-grows-when-typing-at-edges",stickiness:0}),cn.register({description:"tracked-range-never-grows-when-typing-at-edges",stickiness:1}),cn.register({description:"tracked-range-grows-only-when-typing-before",stickiness:2}),cn.register({description:"tracked-range-grows-only-when-typing-after",stickiness:3})];function fn(e){return e instanceof cn?e:cn.createDynamic(e)}class gn extends r["a"]{constructor(e){super(),this.handleBeforeFire=e,this._actual=this._register(new s["b"]),this.event=this._actual.event,this._affectedInjectedTextLines=null,this._deferredCnt=0,this._shouldFire=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(){var e;if(this._deferredCnt--,0===this._deferredCnt){if(this._shouldFire){this.handleBeforeFire(this._affectedInjectedTextLines);const e={affectsMinimap:this._affectsMinimap,affectsOverviewRuler:this._affectsOverviewRuler};this._shouldFire=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._actual.fire(e)}null===(e=this._affectedInjectedTextLines)||void 0===e||e.clear(),this._affectedInjectedTextLines=null}}recordLineAffectedByInjectedText(e){this._affectedInjectedTextLines||(this._affectedInjectedTextLines=new Set),this._affectedInjectedTextLines.add(e)}checkAffectedAndFire(e){this._affectsMinimap||(this._affectsMinimap=!(!e.minimap||!e.minimap.position)),this._affectsOverviewRuler||(this._affectsOverviewRuler=!(!e.overviewRuler||!e.overviewRuler.color)),this._shouldFire=!0}fire(){this._affectsMinimap=!0,this._affectsOverviewRuler=!0,this._shouldFire=!0}}class _n extends r["a"]{constructor(){super(),this._fastEmitter=this._register(new s["b"]),this.fastEvent=this._fastEmitter.event,this._slowEmitter=this._register(new s["b"]),this.slowEvent=this._slowEmitter.event,this._deferredCnt=0,this._deferredEvent=null}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(e=null){if(this._deferredCnt--,0===this._deferredCnt&&null!==this._deferredEvent){this._deferredEvent.rawContentChangedEvent.resultingSelection=e;const t=this._deferredEvent;this._deferredEvent=null,this._fastEmitter.fire(t),this._slowEmitter.fire(t)}}fire(e){this._deferredCnt>0?this._deferredEvent?this._deferredEvent=this._deferredEvent.merge(e):this._deferredEvent=e:(this._fastEmitter.fire(e),this._slowEmitter.fire(e))}}}}]);