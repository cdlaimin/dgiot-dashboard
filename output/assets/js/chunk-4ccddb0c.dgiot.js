/*!
 *  build: 杭州数蛙科技有限公司 
 *  copyright: dgiot-dashboard 
 *  author: h7ml(h7ml@qq.com) 
 *  time: Mon Nov 15 2021 09:40:37 GMT+0000 (Coordinated Universal Time)
 */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4ccddb0c"],{"0076":function(e,t,a){e.exports={"menu-color":"rgba(255,255,255,.95)","menu-color-active":"rgba(255,255,255,.95)","menu-background":"#282c34","column-second-menu-background":"#fff"}},"00b2":function(e,t,a){"use strict";a("397d")},"059e":function(e,t,a){e.exports={"menu-color":"rgba(255,255,255,.95)","menu-color-active":"rgba(255,255,255,.95)","menu-background":"#282c34","column-second-menu-background":"#fff"}},"0907":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"roles dgiot-container"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:14,xs:8}},[a("div",{staticClass:"rightTable"},[a("div",{staticClass:"search"},[a("vab-query-form",{staticStyle:{"margin-top":"20px"}},[a("vab-query-form-top-panel",[a("el-form",{attrs:{inline:!0,"label-width":"100px",model:e.queryForm},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",{attrs:{label:e.$translateTitle("user.department")}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},on:{"visible-change":function(t){return e.change(t)}},model:{value:e.queryForm.workGroupName,callback:function(t){e.$set(e.queryForm,"workGroupName",t)},expression:"queryForm.workGroupName"}},[a("el-option",{staticStyle:{height:"auto",padding:"0"},attrs:{value:e.treeDataValue}},[a("el-tree",{ref:"workGroup",staticClass:"workGroup",attrs:{data:e.roleTree,"default-expand-all":"","expand-on-click-node":!1,"node-key":"index",props:e.roleProps},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.node,r=t.data;return a("div",{staticClass:"custom-tree-node"},[a("span",{class:{selected:r.objectId==e.curDepartmentId},on:{click:function(t){return e.handleNodeClick(r)}}},[e._v(" "+e._s(n.label)+" ")]),a("span",[a("i",{staticClass:"el-icon-circle-plus-outline",attrs:{title:e.$translateTitle("product.addrole")},on:{click:function(t){return e.setDialogRole(r)}}})])])}}])})],1)],1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("user.rolename")}},[a("el-input",{attrs:{clearable:"",placeholder:e.$translateTitle("user.rolename"),size:"mini"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),a("el-form-item",[a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{icon:"el-icon-search",size:"mini",type:"primary"},on:{click:function(t){return e.getRolesList(0)}}},[e._v(" "+e._s(e.$translateTitle("developer.search"))+" ")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.getRolesList()}}},[e._v(" "+e._s(e.$translateTitle("product.allroles"))+" ")])],1)],1)],1)],1)],1),a("div",{staticClass:"tableroles",staticStyle:{"margin-top":"20px"}},[a("el-table",{staticStyle:{width:"100%","text-align":"center"},attrs:{data:e.roleList,height:e.tableHeight,"highlight-current-row":"","row-class-name":e.tableRowClassName,"row-style":e.selectedHighlight,size:"small"},on:{"row-click":e.getDetailmenu}},[a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("user.rolename")},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(n.name))])]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("user.Remarks")},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(n.alias))])]}}])}),a("el-table-column",{attrs:{align:"center",label:"ID"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(n.objectId))])]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("developer.operation")},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-dropdown",{attrs:{size:"mini","split-button":"",type:"primary"},on:{click:function(t){return e.exportRolerole(n)}}},[a("span",{staticClass:"el-dropdown-link"},[e._v(" "+e._s(e.$translateTitle("product.modify"))+" ")]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{icon:"el-icon-document"},nativeOn:{click:function(t){return e.exportRoletemp(n)}}},[e._v(" "+e._s(e.$translateTitle("product.savetemplate"))+" ")]),a("el-dropdown-item",{attrs:{icon:"el-icon-delete",size:"mini"},nativeOn:{click:function(t){return e.handleDelete(n)}}},[e._v(" "+e._s(e.$translateTitle("task.Delete"))+" ")])],1)],1)]}}])})],1),a("div",{staticClass:"rightPagination"},[a("el-pagination",{attrs:{layout:"prev, pager, next",total:e.total},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1)],1)])]),a("el-col",{attrs:{span:10,xs:16}},[a("div",{staticClass:"rolefooter"},[a("div",{staticClass:"footerleft"},[a("p",{staticClass:"top"},[a("span",{staticClass:"svg-container"},[a("vab-icon",{attrs:{icon:"role_group"}})],1),a("span",[e._v(" "+e._s(e.$translateTitle("user.assignroles1"))+" ")])]),a("div",{staticClass:"rolecontrol"},[a("div",[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.expand("permissionTree","isExpand")}}},[e.isExpand?a("span",[e._v(e._s(e.$translateTitle("button.fold")))]):a("span",[e._v(" "+e._s(e.$translateTitle("button.Unfold"))+" ")])]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.checkAll("permissionTree","permissionTreeData")}}},[e._v(" "+e._s(e.$translateTitle("button.select all"))+" ")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.inverse("permissionTree","permissionTreeData")}}},[e._v(" "+e._s(e.$translateTitle("button.Reverse election"))+" ")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.checkNot("permissionTree")}}},[e._v(" "+e._s(e.$translateTitle("button.unselect all"))+" ")])],1),a("el-tree",{ref:"permissionTree",attrs:{accordion:"","check-on-click-node":"",data:e.permissionTreeData,"default-checked-keys":e.rolePermissonList,"default-expand-all":e.isExpand,"default-props":"","expand-on-click-node":!1,"node-key":"objectId","show-checkbox":""},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.node;return a("span",{staticClass:"custom-tree-node"},[a("span",[e._v(e._s(n.label))])])}}])},[a("span",[a("i",{staticClass:"el-icon-circle-plus-outline",attrs:{title:e.$translateTitle("product.addrole")},on:{click:function(t){return e.setDialogRole(e.data)}}})])])],1)]),a("div",{staticClass:"footerright"},[a("p",{staticClass:"top"},[a("span",{staticClass:"svg-container"},[a("vab-icon",{attrs:{icon:"menu_group"}})],1),a("span",[e._v(" "+e._s(e.$translateTitle("user.assignmenu"))+" ")])]),a("div",[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.expand("menusTree","menuExpand")}}},[e.menuExpand?a("span",[e._v(e._s(e.$translateTitle("button.fold")))]):a("span",[e._v(" "+e._s(e.$translateTitle("button.Unfold"))+" ")])]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.checkAll("menusTree","menuTreeData")}}},[e._v(" "+e._s(e.$translateTitle("button.select all"))+" ")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.inverse("menusTree","menuTreeData")}}},[e._v(" "+e._s(e.$translateTitle("button.Reverse election"))+" ")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.checkNot("menusTree")}}},[e._v(" "+e._s(e.$translateTitle("button.unselect all"))+" ")])],1),a("div",{staticClass:"menucontrol",staticStyle:{"margin-top":"0px"}},[a("el-tree",{ref:"menusTree",attrs:{accordion:"","check-on-click-node":"",data:e.menuTreeData,"default-checked-keys":e.roleMenuList,"default-expand-all":e.menuExpand,"default-props":"","expand-on-click-node":!1,"node-key":"objectId","show-checkbox":""},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.node,r=t.data;return a("span",{staticClass:"custom-tree-node"},[e._v(" "+e._s(r.title?r.title:n.label)+" ")])}}])})],1)])])])],1),a("a-modal",{attrs:{footer:null,title:e.$translateTitle("product.addrole"),visible:e.centerDialogRole},on:{cancel:e.closeDialogRole}},[a("addroles",{key:e.$moment().unix(),ref:"addRoleRef",attrs:{"dept-data":e.deptData}})],1),a("el-dialog",{attrs:{"append-to-body":!0,title:e.$translateTitle("developer.add"),visible:e.dialogVisible,width:"50%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-table",{ref:"multipleTable",staticStyle:{width:"100%","text-align":"center"},attrs:{data:e.tableDataroles,height:e.tableHeight},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("user.name")},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(n.name))])]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("user.Remarks")},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(n.desc))])]}}])}),a("el-table-column",{attrs:{align:"center",label:"ID"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(n.objectId))])]}}])})],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.centerDialogVisible=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.addacl.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1)],1),a("el-dialog",{attrs:{"append-to-body":!0,title:e.$translateTitle("developer.edit"),visible:e.roleEdit},on:{"update:visible":function(t){e.roleEdit=t}}},[a("el-form",{attrs:{model:e.form}},[a("el-form-item",{attrs:{label:e.$translateTitle("user.rolename"),"label-width":e.formLabelWidth}},[a("el-input",{staticStyle:{width:"300px"},attrs:{autocomplete:"off",disabled:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("user.Remarks"),"label-width":e.formLabelWidth}},[a("el-input",{staticStyle:{width:"300px"},attrs:{autocomplete:"off"},model:{value:e.form.alias,callback:function(t){e.$set(e.form,"alias",t)},expression:"form.alias"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("developer.describe"),"label-width":e.formLabelWidth}},[a("el-input",{staticStyle:{width:"300px"},attrs:{autocomplete:"off",rows:2,type:"textarea"},model:{value:e.form.desc,callback:function(t){e.$set(e.form,"desc",t)},expression:"form.desc"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.roleEdit=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.updaterole.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1)],1)],1)},r=[],s=a("fb07"),i=a("e97b"),o=a("d0d7"),l=a.n(o),c=(a("04d6"),a("a0e0"),a("3dec"),a("9c6a"),a("c4bc"),a("16b8"),a("d6a4"),a("5da95")),u=a("5880"),d=a("3858"),p=a("bc35"),m={name:"Role",data:function(){return{tableHeight:this.$baseTableHeight(2),isExpand:!1,menuExpand:!1,curDepartmentId:"",formLabelWidth:"120px",roleEdit:!1,form:{name:"",alias:"",desc:""},data:[],dialogVisible:!1,multipleSelection:[],search:"",total:0,pagesize:10,start:0,roleList:[],tableDataroles:[],centerDialogVisible:!1,editroleid:"",currentSelectIndex:null,roleProps:{children:"children",label:"name"},treeDataValue:"",queryForm:{account:"",searchDate:"",pageNo:1,pageSize:20,workGroupName:"",workGroupTreeShow:!1,access_token:""},checkMenus:[],checkRoles:[],dataMenus:[],menusTreeloading:!1,permissionTreeloading:!1,roleMenuList:[],dataPermissions:[],rolePermissonList:[],loadingService:{},roleItem:[],centerDialogRole:!1,deptData:{}}},computed:Object(i["a"])(Object(i["a"])({roleTree:{get:function(){return this.$store.state.user.roleTree},set:function(e){return this.setRoleTree(e)}}},Object(u["mapGetters"])({Menu:"user/Menu",Permission:"user/Permission"})),{},{permissionTreeData:function(){var e=JSON.parse(JSON.stringify(this.dataPermissions));return e.filter((function(t){var a=e.filter((function(e){return t.objectId==e.parentId}));return a.length>0&&(t.children=a),0==t.parentId}))},menuTreeData:function(){var e=JSON.parse(JSON.stringify(this.dataMenus)),t=e.filter((function(t){t.title=t.meta&&t.meta.title?t.meta.title:"";var a=e.filter((function(e){return t.objectId==e.parentId}));return a.length>0&&(t.children=a),0==t.parentId}));return t}}),components:{addroles:d["default"]},mounted:function(){var e=this;this.getRoletree(),this.getRoleschema(),this.getMenu(),this.getRolesList(),this.$baseEventBus.$on("dialogHide",(function(){e.centerDialogRole=!1,e.getMenu()}))},methods:Object(i["a"])(Object(i["a"])({expand:function(e,t){this[t]=!this[t];var a=this.$refs[e].store._getAllNodes();for(var n in a)a[n].expanded=this[t]},checkAll:function(e,t){this.$refs[e].setCheckedNodes(this[t])},inverse:function(e,t){var a=this.$refs[e],n=a.getCheckedNodes(!0,!0);this.batchSelect(this[t],a,!0,n)},checkNot:function(e){this.$refs[e].setCheckedKeys([])},batchSelect:function(e,t,a,n){"undefined"!=typeof e&&e.forEach((function(e){t.setChecked(e,a,!0)})),"undefined"!=typeof n&&n.forEach((function(e){t.setChecked(e,!a,!0)}))}},Object(u["mapMutations"])({setRoleTree:"user/setRoleTree"})),{},{getRoletree:function(){var e=this;return Object(s["a"])(l.a.mark((function t(){var a,n,r;return l.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(p["Roletree"])();case 2:a=t.sent,n=a.results,r=void 0===n?[]:n,e.setRoleTree(r);case 6:case"end":return t.stop()}}),t)})))()},change:function(e){e&&$(".el-tree").css({height:"300px",display:"block","overflow-x":"auto"})},getMenu:function(){var e=this;if(this.menusTreeloading=!0,this.data=[],this.dataMenus=[],this.Menu){var t=this.Menu;t.map((function(t){var a={};a.label=t.name,a.meta=t.meta,a.objectId=t.objectId,a.parentId=t.parent.objectId,a.createtime=new Date(t.createdAt).toLocaleDateString(),e.data.push(a),e.dataMenus.push(a)})),this.handleNodeClick(this.roleTree[0])}this.menusTreeloading=!1},diguiquchu:function(e,t,a,n){var r=this;t.map((function(t){t.key==a&&t.children.length>0?(n.push(a),r.diguiquchu(e,t.children,a,n)):t.key!=a&&t.children.length>0&&r.diguiquchu(e,t.children,a,n)}))},add:function(){this.$router.push({path:"roles/editroles",query:{insert:0}})},handleSelectionChange:function(e){this.multipleSelection=e},addacl:function(){this.$get_object("_Role",this.objectId).then((function(e){}))},handleClose:function(){this.dialogVisible=!1},handleDelete:function(e){var t=this;return Object(s["a"])(l.a.mark((function a(){var n,r,s;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n={name:e.name},a.next=3,Object(c["queryRoledepartment"])(n);case 3:if(r=a.sent,s=r.users,!(s.length>0)){a.next=10;break}return t.$message({type:"warning",message:"请先删除该角色下的用户"}),a.abrupt("return");case 10:t.$confirm(t.$translateTitle("user.This operation will permanently delete this role, do you want to continue?"),t.$translateTitle("user.prompt"),{confirmButtonText:t.$translateTitle("developer.determine"),cancelButtonText:t.$translateTitle("developer.cancel"),type:"warning"}).then((function(){t.delConfirm(e.objectId)})).catch((function(){}));case 11:case"end":return a.stop()}}),a)})))()},delConfirm:function(e){var t=this;return Object(s["a"])(l.a.mark((function a(){var n;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(c["delRole"])(e);case 2:n=a.sent,n&&(t.$message.success("".concat(t.$translateTitle("user.successfully deleted"))),t.getRolesList(),t.getRoletree(),t.getMenu());case 4:case"end":return a.stop()}}),a)})))()},addmenu:function(e){this.rolename=e.attributes.name,this.getMenu(),this.getRoletree()},tableRowClassName:function(e){var t=e.row,a=e.rowIndex;t.index=a},selectedHighlight:function(e){e.row;var t=e.rowIndex;if(this.currentSelectIndex===t)return{color:"#409EFF","font-weight":"bold"}},getDetailmenu:function(e,t,a,n){var r=this;return Object(s["a"])(l.a.mark((function a(){var n,s,i,o,u,d;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!t||"操作"!=t.label){a.next=2;break}return a.abrupt("return");case 2:return r.loadingService=r.$loading({lock:!0,text:r.$translateTitle("developer.Data is loading")+"...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.6)"}),r.currentSelectIndex=e.index,a.next=6,Object(c["roleMenu"])(e.name);case 6:n=a.sent,s=n.menus,i=n.rules,o=n.roles,u=n.users,d=n.objectId,r.roleItem={menus:s,rules:i,users:u,roles:o,objectId:d},r.loadingService.close(),s&&i?(r.checkMenus=s,r.checkRoles=i,r.doSetChecked()):r.$message({type:"warning",message:"获取角色菜单失败"});case 15:case"end":return a.stop()}}),a)})))()},doSetChecked:function(){var e=this;this.roleMenuList=[],this.rolePermissonList=[],this.Menu.map((function(t){e.checkMenus.map((function(a){t.name==a.name&&e.roleMenuList.push(t.objectId)}))})),this.$refs.menusTree.setCheckedKeys(this.roleMenuList),this.Permission.map((function(t){e.checkRoles.map((function(a){t.name===a.name&&e.rolePermissonList.push(t.objectId)}))})),this.$refs.permissionTree.setCheckedKeys(this.rolePermissonList)},getRolesList:function(e,t){var a=this;return Object(s["a"])(l.a.mark((function n(){var r,s,i,o,u,d;return l.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return 0==e&&(a.start=0),r={},t&&"admin"!=t.name&&(r.objectId=t.objectId),s=a.$loading({background:"rgba(0, 0, 0, 0.5)"}),i={skip:a.start,limit:a.pagesize,order:"-createdAt",where:r,count:"objectId"},n.next=7,Object(c["queryRole"])(i);case 7:o=n.sent,u=o.results,d=o.count,u&&(s.close(),a.roleList=u,a.total=d);case 11:case"end":return n.stop()}}),n)})))()},handleSizeChange:function(e){this.pagesize=e,this.getRolesList()},handleCurrentChange:function(e){this.start=Number(e-1)*Number(this.pagesize),this.getRolesList()},handleCheckChange:function(e,t){},getRoleschema:function(){var e=this;if(this.permissionTreeloading=!0,this.dataPermissions=[],this.Permission){var t=this.Permission;t.map((function(t){var a={};a.label=t.alias,a.alias=t.name,a.objectId=t.objectId,a.parentId=t.parent.objectId,a.createtime=new Date(t.createdAt).toLocaleDateString(),e.dataPermissions.push(a)}))}this.permissionTreeloading=!1},getCheckedKeys:function(e,t,a){var n=[];return r(e,!1),n;function r(e,s){for(var i=[],o=0;o<e.length;o++){var l=e[o];i[o]=!1,l.children&&(i[o]=!!r(l.children,!0)||i[o],i[o]&&n.push(l));for(var c=0;c<t.length;c++)if(l[a]==t[c]){i[o]=!0,-1==n.indexOf(l[a])&&n.push(l);break}}if(s)return-1!=i.indexOf(!0)}},exportRolerole:function(e){var t=this;return Object(s["a"])(l.a.mark((function a(){var n,r,s,i,o,u,d,p;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(n=[],r=t.getCheckedKeys(t.menuTreeData,t.$refs.menusTree.getCheckedKeys(),"objectId"),s=[],i=[],o=[],u=t.$refs.permissionTree.getCheckedNodes(),d=t.roleItem.roles,p=t.roleItem.users,p&&d){a.next=11;break}return t.$message.error("".concat(t.$translateTitle("user.The correct role permissions and menus are not selected"))),a.abrupt("return",!1);case 11:if(p.forEach((function(e){s.push(e.username)})),d.forEach((function(e){i.push(e.name)})),!r||!u){a.next=20;break}return r.forEach((function(e){n.push(e.label)})),u.forEach((function(e){o.push(e.alias)})),a.next=18,Object(c["saveRole"])({objectId:t.roleItem.objectId,name:e.name,alias:e.alias,desc:e.desc,rules:_.uniq(o),menus:_.uniq(n),roles:_.uniq(i),users:_.uniq(s)}).then((function(e){e?t.$message.success("".concat(t.$translateTitle("user.Role information updated successfully"))):t.$message.error("".concat(t.$translateTitle("user.Role information updated failed")))})).catch((function(e){t.$message.error("".concat(t.$translateTitle("user.Role information updated successfully"))+"".concat(e))}));case 18:a.next=21;break;case 20:t.$message.info("".concat(t.$translateTitle("user.Please select the menu list and permission list")));case 21:case"end":return a.stop()}}),a)})))()},exportRoletemp:function(e){var t=this;return Object(s["a"])(l.a.mark((function a(){var n;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(c["saveRoletemp"])(e.name);case 2:n=a.sent,n&&t.$message.success("".concat(t.$translateTitle("user.Save the template successfully")));case 4:case"end":return a.stop()}}),a)})))()},updaterole:function(){var e=this,t={alias:this.form.alias,desc:this.form.desc};this.$update_object(this.editroleid,t).then((function(t){e.$message.success("".concat(e.$translateTitle("user.update completed"))),e.roleEdit=!1,e.getRolesList()}))},handleNodeClick:function(e){this.treeDataValue=e.label,this.queryForm.workGroupName=e.label,$(".workGroup").css({height:"0px",display:"none","overflow-x":"auto"}),$(".el-select-dropdown").css({display:"none"}),this.curDepartmentId=e.objectId,this.currentSelectIndex=null,this.getRolesList(0,e)},appendChildTree:function(e){},renderContent:function(e,t){var a=this,n=t.node,r=t.data;t.store;return e("span",{class:"custom-tree-node"},[e("span",[n.label]),e("span",[e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(){return a.appendChildTree(r)}}},[e("i",{class:"el-icon-plus"})])])])},setDialogRole:function(e){this.deptData=e,this.centerDialogRole=!0},closeDialogRole:function(){this.centerDialogRole=!1,this.getRoletree()}})},f=m,h=(a("5a27"),a("bb1d"),a("bdd7")),g=Object(h["a"])(f,n,r,!1,null,"5ca0039e",null);t["default"]=g.exports},"0c99":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"login-container"},[a("div",{staticClass:"loginbanner"},[a("el-form",{ref:"ruleForm2",staticClass:"login-form",attrs:{"label-width":"100px",model:e.ruleForm2,rules:e.rules2,"status-icon":""}},[a("div",{staticClass:"logo"},[a("img",{staticStyle:{width:"80px",height:"80px"},attrs:{alt:"logo",src:e.logosrc}}),a("p",[e._v(e._s(e.title))])]),a("el-form-item",{attrs:{prop:"phone"}},[a("span",{staticClass:"svg-container"},[a("vab-icon",{attrs:{icon:"user"}})],1),a("el-input",{attrs:{"auto-complete":"on",clearable:"",maxlength:11,name:"phone",placeholder:"请输入手机号",type:"text"},model:{value:e.ruleForm2.phone,callback:function(t){e.$set(e.ruleForm2,"phone",t)},expression:"ruleForm2.phone"}})],1),a("el-form-item",{attrs:{prop:"password",required:""}},[a("span",{staticClass:"svg-container"},[a("vab-icon",{attrs:{icon:"password"}})],1),a("el-input",{attrs:{"auto-complete":"on",name:"password",placeholder:"请输入密码",type:e.pwdType},model:{value:e.ruleForm2.password,callback:function(t){e.$set(e.ruleForm2,"password",t)},expression:"ruleForm2.password"}}),a("span",{staticClass:"show-pwd",on:{click:e.showPwd}},[a("vab-icon",{attrs:{icon:"eye"}})],1)],1),a("el-form-item",{attrs:{prop:"checkPass",required:""}},[a("span",{staticClass:"svg-container"},[a("vab-icon",{attrs:{icon:"password"}})],1),a("el-input",{attrs:{"auto-complete":"on",placeholder:"请再次输入密码",type:e.pwdType},model:{value:e.ruleForm2.checkPass,callback:function(t){e.$set(e.ruleForm2,"checkPass",t)},expression:"ruleForm2.checkPass"}}),a("span",{staticClass:"show-pwd",on:{click:e.showPwd}},[a("vab-icon",{attrs:{icon:"eye"}})],1)],1),a("el-form-item",{staticStyle:{"margin-top":"50px"}},[a("el-button",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],staticStyle:{width:"100%","letter-spacing":"10px"},attrs:{"element-loading-background":"rgba(0, 0, 0, 0.5)","element-loading-spinner":"el-icon-loading","element-loading-text":"正在初始化环境,请稍后",type:"primary"},on:{click:function(t){return e.submitForm("ruleForm2")}}},[e._v(" 立即注册 ")])],1),a("div",{staticClass:"hasuser"},[a("span",{staticStyle:{"font-size":"14px",color:"#409eff",cursor:"pointer"},on:{click:e.login}},[e._v(" 已有账号登陆 ")])])],1)],1)])},r=[],s=(a("1d17"),a("37c6"),a("3dec"),a("4656"),a("be65")),i=a.n(s),o=a("f43e").Base64,l={data:function(){var e=this,t=function(e,t,a){""===t?a(new Error("请输入密码")):(/^\w{8,20}/.test(t)||a(new Error("密码长度为8-20位")),a())},a=function(t,a,n){""===a?n(new Error("请再次输入密码")):a!==e.ruleForm2.password?n(new Error("两次输入密码不一致!")):n()};return{fullscreenLoading:!1,time:60,sendMsgDisabled:!1,logosrc:"",title:"",ruleForm2:{account:"",phone:"",username:"",password:"",email:"",checkPass:"",roles:""},pwdType:"password",protype:"",rules2:{account:[{required:!0,message:"请输入账号",trigger:"blur"},{min:1,max:10,message:"长度在 1到 10 个字符",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{validator:function(e,t,a){var n=/^1[3-9]\d{9}$/;n.test(t)?a():a(new Error("手机号码格式不正确！"))},trigger:"blur"}],password:[{validator:t,trigger:"blur",required:!0}],checkPass:[{validator:a,trigger:"blur",required:!0}],username:[{required:!0,message:"请输入姓名",trigger:"blur"},{min:2,max:5,message:"姓名格式不正确",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]}],roles:[{required:!0,message:"请选择平台",trigger:"change"}]}}},mounted:function(){this.protype=sessionStorage.getItem("roletype"),this.title=sessionStorage.getItem("product_title"),this.logosrc=sessionStorage.getItem("imgsrc")},methods:{showPwd:function(){"password"===this.pwdType?this.pwdType="":this.pwdType="password"},login:function(){this.$router.push({path:"/login"})},submitForm:function(e){var t=this,a=/^1[3-9]\d{9}$/;this.$refs[e].validate((function(e){if(!e)return t.$message({message:"信息错误",type:"error"}),!1;var n=new Parse.User;n.set("username",t.ruleForm2.phone.toString()),n.set("password",t.ruleForm2.password),a.test(t.ruleForm2.phone)?n.set("phone",t.ruleForm2.phone.toString()):n.set("phone",""),t.fullscreenLoading=!0,n.set("productId",t.protype);new Parse.ACL;n.save().then((function(e){i.a.set("sessionToken",e.attributes.sessionToken),t.$router.push({path:"/phonelogin",query:{phone:o.encode(t.ruleForm2.phone),action:"register"}}),t.fullscreenLoading=!1})).catch((function(e){202==e.code?t.$message({message:"用户名已存在",type:"error"}):t.$message({message:e.message,type:"error"}),t.fullscreenLoading=!1}))}))},send:function(){var e=this;e.sendMsgDisabled=!0;var t=window.setInterval((function(){e.time--<=0&&(e.time=60,e.sendMsgDisabled=!1,window.clearInterval(t))}),1e3)}}},c=l,u=(a("b9867"),a("5f52"),a("00b2"),a("bdd7")),d=Object(u["a"])(c,n,r,!1,null,"20530bb6",null);t["default"]=d.exports},1227:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"appmarage appmarage-container"},[a("div",{staticClass:"header"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.checkupdateall}},[e._v(" "+e._s(e.$translateTitle("plugins.checkupdate"))+" ")])],1),a("div",{staticClass:"block",staticStyle:{"margin-top":"10px"}},[a("el-table",{staticStyle:{width:"100%","text-align":"center"},attrs:{data:e.tableData.slice((e.start-1)*e.length,e.start*e.length),height:e.height}},[a("el-table-column",{attrs:{align:"center",label:"App"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",{style:{color:1==n.active?"green":"red"}},[e._v(" "+e._s(n.app)+" ")])]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("plugins.version"),prop:"version",sortable:""}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("developer.describe"),prop:"desc",sortable:""}}),a("el-table-column",{attrs:{align:"right",label:e.$translateTitle("developer.operation")},scopedSlots:e._u([{key:"header",fn:function(t){return[a("el-input",{attrs:{placeholder:e.$translateTitle("plugins.enterappsearch"),size:"mini"},on:{change:e.changevalue},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]}},{key:"default",fn:function(t){var n=t.row;return[0==n.active?a("el-button",{attrs:{plain:"",size:"small",type:"info"},on:{click:function(t){return e.startup(n.app)}}},[a("div",{staticStyle:{display:"inline-block",width:"10px",height:"10px","margin-right":"10px",background:"#00cc33","border-radius":"50%"}}),e._v(" "+e._s(e.$translateTitle("plugins.start"))+" ")]):e._e(),1==n.active?a("el-button",{attrs:{plain:"",size:"small",type:"info"},on:{click:function(t){return e.stopup(n.app)}}},[a("div",{staticStyle:{display:"inline-block",width:"10px",height:"10px","margin-right":"10px",background:"#a94442","border-radius":"50%"}}),e._v(" "+e._s(e.$translateTitle("plugins.stop"))+" ")]):e._e(),a("el-button",{attrs:{plain:"",size:"small",type:"info"},on:{click:function(t){return e.checkupdate(n.app)}}},[e._v(" "+e._s(e.$translateTitle("plugins.checkupdate"))+" ")])]}}])})],1)],1),a("div",{staticClass:"block"},[a("el-pagination",{staticStyle:{"margin-top":"30px"},attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper","page-size":e.length,"page-sizes":[10,25,50,100],total:e.total},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1),a("el-dialog",{attrs:{"append-to-body":!0,"before-close":e.handleClose,title:e.$translateTitle("plugins.modulelist"),visible:e.dialogVisible,width:"40%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",[a("el-table",{staticStyle:{width:"100%","margin-top":"20px","text-align":"center"},attrs:{data:e.tableData1.slice((e.start1-1)*e.length1,e.start1*e.length1),height:"300"}},[a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("plugins.modulename"),prop:"path",sortable:""}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("plugins.ischange"),prop:"is_changed",sortable:""}})],1),a("div",{staticClass:"block"},[a("el-pagination",{staticStyle:{"margin-top":"30px"},attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper","page-size":e.length1,"page-sizes":[10,25,50,100],total:e.total1},on:{"current-change":e.handleCurrentChange1,"size-change":e.handleSizeChange1}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticStyle:{float:"left"},on:{click:function(t){e.dialogVisible=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),a("el-button",{staticStyle:{float:"right"},attrs:{type:"primary"},nativeOn:{click:function(t){return e.reupload.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1)])],1)},r=[],s=(a("1d17"),a("df0e"),a("a0e0"),a("3dec"),a("f764"),a("5662"),a("c4bc"),a("bb22")),i=[],o=[],l={data:function(){return{height:this.$baseTableHeight(0)-15,tableData:[],total:0,start:1,length:10,node:null,dialogVisible:!1,start1:1,length1:10,total1:0,tableData1:[],app:"",version:"",searchvalue:"",search:""}},computed:{},mounted:function(){this.getInformation()},methods:{handleSizeChange:function(e){this.start=1,this.length=e},handleCurrentChange:function(e){this.start=e},handleSizeChange1:function(e){this.start1=1,this.length1=e},handleCurrentChange1:function(e){this.start1=e},getInformation:function(){var e=this;Object(s["Getapp"])(this.node,this.start,this.length).then((function(t){t&&(e.tableData=t.apps,i=t.apps,e.total=t.recordsTotal)})).catch((function(t){e.$message({type:"error",message:t.error})}))},handleClose:function(){this.dialogVisible=!1},changevalue:function(){var e=this;""==this.search&&(this.tableData=i),this.tableData=this.tableData.filter((function(t){return!e.search||t.app.toLowerCase().includes(e.search.toLowerCase())}))},changedialog:function(){var e=this;""==this.searchvalue&&(this.tableData1=o),this.tableData1=tableData1.filter((function(t){return!e.searchvalue||t.path.toLowerCase().includes(searchvalue.toLowerCase())}))},checkupdate:function(e){var t=this;this.tableData1=[],this.searchvalue="",this.dialogVisible=!0,this.app=e,this.total1=0,Object(s["Getmodule"])(e).then((function(e){e&&(e.map((function(e){0==e.is_changed?e.is_changed="false":e.is_changed="true"})),t.tableData1=e,o=e,t.total1=e.length)}))},checkupdateall:function(){var e=this;this.searchvalue="",this.dialogVisible=!0,this.tableData1=[],this.total1=0,this.app="",Object(s["Getmodule"])("changed").then((function(t){t&&(t.map((function(e){0==e.is_changed?e.is_changed="false":e.is_changed="true"})),e.tableData1=t,o=t,e.total1=t.length)}))},startup:function(e){var t=this;Object(s["Getstart"])(e).then((function(e){e&&(t.$message({message:"启动成功",type:"success"}),t.getInformation())})).catch((function(e){}))},stopup:function(e){var t=this;Object(s["Getstop"])(e).then((function(e){e&&(t.$message({message:"停止成功",type:"success"}),t.getInformation())})).catch((function(e){}))},reupload:function(){var e=this;""==this.app?Object(s["GetReload"])("all").then((function(t){t&&(0==t.length?e.$message({message:"当前无更新",type:"warning"}):e.$message({message:"已更新模块"+t,type:"success"}))})):Object(s["GetReload"])(this.app).then((function(t){t&&(0==t.length?e.$message({message:"当前无更新",type:"warning"}):e.$message({message:"已更新模块"+t,type:"success"}),e.app)}))}}},c=l,u=a("bdd7"),d=Object(u["a"])(c,n,r,!1,null,null,null);t["default"]=d.exports},"1c12":function(e,t,a){"use strict";a("1e74")},"1e74":function(e,t,a){},3710:function(e,t,a){"use strict";a("b8b3")},3858:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"role-box"},[a("el-form",{ref:"roleFormObj",attrs:{"label-width":"80px",loading:e.isloading,model:e.roleFormObj,rules:e.roleFormRules}},[e.isStructures?e._e():a("el-form-item",{attrs:{label:"父及部门",prop:"ParentId"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择Parent"},on:{change:function(t){return e.handleChangeDeptId(t)}},model:{value:e.roleFormObj.ParentId,callback:function(t){e.$set(e.roleFormObj,"ParentId",t)},expression:"roleFormObj.ParentId"}},e._l(e.roleList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,title:e.name+":"+e.desc,value:e.objectId}})})),1)],1),a("el-form-item",{attrs:{label:"部门",prop:"depname"}},[a("el-input",{staticStyle:{width:"75%"},attrs:{placeholder:"请输入部门名称"},model:{value:e.roleFormObj.depname,callback:function(t){e.$set(e.roleFormObj,"depname",t)},expression:"roleFormObj.depname"}}),a("span",{staticStyle:{float:"right","font-size":"14px",color:"#8492a6"}},[0==e.insert||1==e.insert?a("el-button",{attrs:{type:"success"},on:{click:function(t){return e.addroles("roleFormObj")}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")]):e._e()],1)],1),a("el-form-item",{attrs:{label:"岗位",prop:"dictvalue"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:e.clearFlag,placeholder:"请选择角色模版"},model:{value:e.roleFormObj.dictvalue,callback:function(t){e.$set(e.roleFormObj,"dictvalue",t)},expression:"roleFormObj.dictvalue"}},e._l(e.Option.dictOption,(function(e,t){return a("el-option",{key:t,attrs:{change:"changeOption('dict',item.name)",value:e.key}})})),1)],1),e.isStructures?e._e():a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.roleFormObj.description,callback:function(t){e.$set(e.roleFormObj,"description",t)},expression:"roleFormObj.description"}})],1),e.isStructures?e._e():a("el-form-item",{staticClass:"el_btn"},[a("el-button",{attrs:{type:"warning"},nativeOn:{click:function(t){return e.resetFrom()}}},[e._v("重置")]),0==e.insert||1==e.insert?a("el-button",{attrs:{type:"success"},on:{click:function(t){return e.addroles("roleFormObj")}}},[e._v(" 确定 ")]):e._e()],1)],1)],1)])},r=[],s=a("fb07"),i=a("d0d7"),o=a.n(i),l=(a("3dec"),a("9c6a"),a("16b8"),a("c4bc"),a("80ab"),a("a98c"),a("e0e9")),c=a("5da95"),u={props:{deptData:{type:Object,default:function(){},required:!0},isStructures:{type:Boolean,required:!1,default:!1}},data:function(){return{isloading:"",treeModu:[],treeprops:{value:"name",label:"name"},defaultProps:{children:"children",label:"label"},originrole:[],needdelarr:[],parentrole:[],deptLevel:0,userid:"",roleId:"",insert:"",Option:{deptvalue:"",deptOption:[],dictvalue:"",dictOption:[],objectId:0,ParentId:0},clearFlag:!0,roleFormObj:{parentId:"",name:"",phoneNum:"",mail:"",department:"",gender:"男",role:"",description:"",type:[],list:[],defaultProps:{children:"children",label:"label"},dictvalue:""},roleFormRules:{name:[{required:!0,message:"请输入角色名",trigger:"blur"},{min:2,max:10,message:"长度在 2 到 10 个字符",trigger:"blur"}],depname:[{required:!0,message:"请选择部门",trigger:"blur"}],dictvalue:[{required:!0,message:"请选择岗位",trigger:"change"}],ParentId:[{required:!0,message:"请选择部门父级",trigger:"blur"}]},roleList:[],deptInfo:{}}},computed:{},mounted:function(){var e,t=this;this.searchAllOption(),null!==(e=this.deptData)&&void 0!==e&&e.objectId&&(this.isloading=this.$baseLoading(3),this.getData(this.deptData),setTimeout((function(){t.isloading.close()}),1500))},methods:{handleChangeDeptId:function(e){var t=this;this.roleList.forEach((function(a){a.objectId==e&&(t.deptLevel=a.level,t.searchAllOption())}))},getData:function(e){this.deptInfo=e,this.deptLevel=e.level,this.roleFormObj.ParentId=this.deptInfo.objectId,this.searchAllOption()},changeOption:function(e,t){var a=this;switch(e){case"tree":this.Option.deptvalue=this.$refs["cascaderAddr"].currentLabels[1];var n=this.$refs["cascaderAddr"].options;n.forEach((function(e){a.$refs["cascaderAddr"].currentLabels[0]===e.name&&(a.Option.objectId=e.children[0].objectId),a.Option.ParentId=e.objectId}));break;case"dict":this.Option.dictvalue=t;break}},searchAllOption:function(){var e=this;return Object(s["a"])(o.a.mark((function t(){var a,n,r,s,i,u;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(l["queryDict"])({where:{"data.level":{$gt:e.deptLevel},type:"roletemp"}});case 2:return a=t.sent,n=a.results,null!==n&&void 0!==n&&n.length&&(e.Option.dictOption=n,e.roleFormObj.dictvalue=n[0].key),t.next=7,Object(c["queryRole"])({});case 7:r=t.sent,s=r.results,i=void 0===s?[]:s,u=[],null!==i&&void 0!==i&&i.length?(i.forEach((function(e,t){var a={};a.ParentId=e.ParentId,a.name=e.name,a.objectId=e.objectId,a.org_type=e.org_type,a.desc=e.desc,a.level=e.level,a.createdAt=e.createdAt,u.push(a)})),e.roleList=u,e.Option.deptOption=i):(e.roleList=[],e.$message("部门列表获取失败"),e.Option.deptOption=[]);case 12:case"end":return t.stop()}}),t)})))()},resetFrom:function(){var e=this;this.roleFormObj={name:"",phoneNum:"",duty:"",gender:"男",role:"",description:"",alias:""},this.Option.deptvalue="",this.Option.dictvalue="",this.Option.objectId=0,this.Option.ParentId=0,this.treeModu=[],setTimeout((function(){e.searchAllOption()}),1e3)},diguiquchu:function(e,t,a,n){var r=this;t.map((function(t){t.key==a&&t.children.length>0?(n.push(a),r.diguiquchu(e,t.children,a,n)):t.key!=a&&t.children.length>0&&r.diguiquchu(e,t.children,a,n)}))},addroles:function(e){var t=this;this.$refs[e].validate(function(){var e=Object(s["a"])(o.a.mark((function e(a){var n,r,s,i,l;return o.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!a){e.next=14;break}return s={depname:t.roleFormObj.depname,desc:null!==(n=t.roleFormObj.description)&&void 0!==n&&n.length?t.roleFormObj.description:t.roleFormObj.depname+t.roleFormObj.name,name:null!==(r=t.roleFormObj.name)&&void 0!==r&&r.length?t.roleFormObj.name:t.roleFormObj.depname,parent:t.roleFormObj.ParentId,tempname:t.roleFormObj.dictvalue},e.prev=2,e.next=5,Object(c["addRoles"])(s);case 5:l=e.sent,null!==l&&void 0!==l&&null!==(i=l.createdAt)&&void 0!==i&&i.length?(t.$message({message:"新增成功",type:"success"}),t.$baseEventBus.$emit("dialogHide"),t.$baseEventBus.$emit("dialogHide2",l.objectId)):t.$message({message:"角色添加出錯".concat(l),type:"error"}),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](2),t.$message({message:"角色添加出錯".concat(e.t0),type:"error"});case 12:e.next=15;break;case 14:return e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}())},getdetail:function(){this.insert=this.$route.query.insert,this.roleId=this.$route.query.roleId}}},d=u,p=(a("437c"),a("bdd7")),m=Object(p["a"])(d,n,r,!1,null,"89518ca2",null);t["default"]=m.exports},"397d":function(e,t,a){},"39a2":function(e,t,a){"use strict";a("ffca")},"437c":function(e,t,a){"use strict";a("443c")},"443c":function(e,t,a){},"44a4":function(e,t,a){"use strict";a("63c7")},"4b65":function(e){e.exports=JSON.parse('{"PersonAuthtication":{"userphone":"Number","joblicense":"String","suggestion":"String","positional_titles":"String","professional":"String","education":"String","auditDate":"Number","start_time":"Number","ukey":"String","name":"String","graduate_institutions":"String","training_experience":"String","practitioners_experience":"String","working_seniority":"String","addr":"Array","status":"String","contraryimageUrl":"String","birthday":"Number","frontimageUrl":"String","job":"String","identity":"String","unumber":"String","politic_status":"String","department":"Pointer"}}')},"4cf9":function(e,t,a){"use strict";a("ec98")},"4f20":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{"append-to-body":!0,"close-on-click-modal":!1,title:e.title,visible:e.dialogFormVisible,width:"70%"},on:{"update:visible":function(t){e.dialogFormVisible=t},close:e.close},scopedSlots:e._u([{key:"footer",fn:function(){return[a("el-button",{on:{click:e.close}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.save.apply(null,arguments)}}},[e._v("确 定")])]},proxy:!0}])},[a("vab-input",{ref:"uploadFinish",attrs:{params:e.inputParams},on:{fileInfo:e.fileInfo,files:e.files}}),a("el-collapse",{model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[a("el-collapse-item",{attrs:{name:"1",title:"菜单参数配置项"}},[a("menu-collapse")],1)],1),a("el-form",{ref:"form",staticStyle:{"margin-top":"20px"},attrs:{inline:!0,"label-width":"100px",model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{label:"name",prop:"name"}},[a("el-input",{attrs:{disabled:"编辑菜单"==e.title,readonly:"编辑菜单"==e.title},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}},[a("template",{slot:"prepend"},[a("vab-icon",{attrs:{icon:"pages-line"}})],1)],2)],1),a("el-form-item",{attrs:{label:"路径",prop:"url"}},[a("el-input",{model:{value:e.form.url,callback:function(t){e.$set(e.form,"url",t)},expression:"form.url"}},[a("template",{slot:"prepend"},[a("vab-icon",{attrs:{icon:"route-fill"}})],1)],2)],1),a("el-form-item",{attrs:{label:"vue文件路径",prop:"meta.component"}},[a("el-input",{model:{value:e.form.meta.component,callback:function(t){e.$set(e.form.meta,"component",t)},expression:"form.meta.component"}},[a("template",{slot:"prepend"},[a("vab-icon",{attrs:{icon:"vuejs-fill"}})],1)],2)],1),a("el-form-item",{attrs:{label:"重定向",prop:"redirect"}},[a("el-input",{model:{value:e.form.meta.redirect,callback:function(t){e.$set(e.form.meta,"redirect",t)},expression:"form.meta.redirect"}},[a("template",{slot:"prepend"},[a("vab-icon",{attrs:{icon:"infrared-thermometer-fill"}})],1)],2)],1),a("el-form-item",{attrs:{label:"标题",prop:"meta.title"}},[a("el-input",{model:{value:e.form.meta.title,callback:function(t){e.$set(e.form.meta,"title",t)},expression:"form.meta.title"}},[a("template",{slot:"prepend"},[a("vab-icon",{attrs:{icon:"article-line"}})],1)],2)],1),a("el-form-item",{attrs:{label:"icon图标",prop:"meta.icon"}},[a("el-input",{staticStyle:{cursor:"pointer"},attrs:{"suffix-icon":"el-icon-upload2"},nativeOn:{click:function(t){return e.uploadIcon(e.form)}},model:{value:e.form.meta.icon,callback:function(t){e.$set(e.form.meta,"icon",t)},expression:"form.meta.icon"}},[a("el-popover",{attrs:{slot:"prepend","popper-class":"icon-selector-popper",size:"mini",trigger:"hover",width:"292"},slot:"prepend",scopedSlots:e._u([{key:"reference",fn:function(){return[e.form.meta.icon&&e.form.meta.icon.includes("dgiot")?a("el-image",{staticStyle:{width:"16px",height:"16px"},attrs:{src:e.$FileServe+e.form.meta.icon}},[a("img",{staticStyle:{width:"16px",height:"16px"},attrs:{slot:"error",src:e.$FileServe+e.form.meta.icon,title:e.$FileServe+e.form.meta.icon},slot:"error"})]):a("vab-icon",{attrs:{icon:e.form.meta.icon}})]},proxy:!0}])},[a("vab-icon-selector",{on:{"handle-icon":e.handleIcon}})],1)],1)],1),a("el-form-item",{attrs:{label:"badge",prop:"badge"}},[a("el-input",{model:{value:e.form.meta.badge,callback:function(t){e.$set(e.form.meta,"badge",t)},expression:"form.meta.badge"}},[a("template",{slot:"prepend"},[a("vab-icon",{attrs:{icon:"notification-badge-fill"}})],1)],2)],1),a("el-form-item",{attrs:{label:"隐藏",prop:"hidden",title:"隐藏后将不在菜单列表中展示，但是可以被访问"}},[a("el-switch",{model:{value:e.form.meta.hidden,callback:function(t){e.$set(e.form.meta,"hidden",t)},expression:"form.meta.hidden"}})],1),a("el-form-item",{attrs:{label:"固定",prop:"noClosable",title:"除首页外,其他页面不建议选择此项"}},[a("el-switch",{model:{value:e.form.meta.noClosable,callback:function(t){e.$set(e.form.meta,"noClosable",t)},expression:"form.meta.noClosable"}})],1),a("el-form-item",{attrs:{label:"无缓存",prop:"noKeepAlive",title:"开启后该页面的数据将不被缓存"}},[a("el-switch",{model:{value:e.form.meta.noKeepAlive,callback:function(t){e.$set(e.form.meta,"noKeepAlive",t)},expression:"form.meta.noKeepAlive"}})],1),a("el-form-item",{attrs:{label:"排序",prop:"orderBy"}},[a("el-input-number",{attrs:{label:"描述文字"},model:{value:e.form.orderBy,callback:function(t){e.$set(e.form,"orderBy",e._n(t))},expression:"form.orderBy"}})],1)],1)],1)},r=[],s=a("fb07"),i=a("e97b"),o=a("d0d7"),l=a.n(o),c=(a("3dec"),a("9c6a"),a("f1e1"),a("16b8"),a("d6a4"),a("d528")),u=a("bc35"),d=a("8405"),p=a("9883"),m=a("5880"),f={name:"MenuManagementEdit",components:{VabIconSelector:c["default"],menuCollapse:d["default"]},data:function(){return{router:p["default"],visible:!1,inputParams:{},cascadervalue:[],jsonModel:{hidden:!0,menuHidden:!1,alwaysShow:!0,name:"Demo",meta:{title:"title",roles:{role:["admin","..."],ability:["READ","WRITE","DELETE"],mode:"allOf"},remixIcon:"",icon:"",isCustomSvgIcon:!1,isCustomSvg:!1,noKeepAlive:!0,affix:!0,noCLosable:!0,badge:"New",tabHidden:!0,activeMenu:"",dot:!1,dynamicNewTab:!1},children:[]},activeNames:["0"],menuid:"",form:{orderBy:100,name:"",url:"",meta:{icon:"",component:"",title:""}},rules:{name:[{type:"string",required:!0,message:"name,用做页面缓存,首字母大写,不可重复",trigger:"blur"},{type:"string",message:"name类型为string",trigger:"blur"},{type:"string",pattern:/^[A-Z][A-z0-9]*$/,message:"首字母请修改为大写",trigger:"blur"}],url:[{type:"string",required:!0,trigger:"blur",message:"路径地址,将展示在浏览器地址栏中"}],"meta.component":[{required:!0,trigger:"blur",message:"vue文件路径,一般为@views/下的文件路径"}],"meta.title":[{required:!0,trigger:"blur",message:"标题,展示在侧边栏菜单列表和顶部菜单列表"}],"meta.icon":[{required:!0,trigger:"blur",message:"图标，展示在侧边栏菜单列表和顶部菜单列表"}],orderBy:[{type:"number",required:!0,trigger:"blur",message:"排序层级,决定页面的排序"}]},title:"",dialogFormVisible:!1}},computed:Object(i["a"])({},Object(m["mapGetters"])({ObjectId:"user/objectId"})),mounted:function(){p["default"].forEach((function(e){var t;e.title=e.meta.title,null!==e&&void 0!==e&&null!==(t=e.children)&&void 0!==t&&t.length&&e.children.forEach((function(e){e.title=e.meta.title}))}))},methods:{uploadIcon:function(e){this.$refs["uploadFinish"].$refs.uploader.dispatchEvent(new MouseEvent("click")),this.inputParams={file:"",scene:"app",path:"user/profile/",filename:"".concat(this.ObjectId,"_").concat(this.form.name)}},fileInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:img,t=e.path,a=void 0===t?"":t;this.form.meta.icon=a},files:function(e){this.inputParams.filename="".concat(this.ObjectId,"_").concat(this.form.name),this.inputParams.file=e},handleChange:function(e){var t=this.$refs["menuCascader"].getCheckedNodes();this.form=t[0].data},handleIcon:function(e){this.form.meta.icon=e},showEdit:function(e,t){this.title="addChildMenu"==t?"新增子菜单":"one"==t?"新增一级菜单":"编辑菜单","addChildMenu"==t?(this.form={orderBy:10*e.orderBy+1,name:"",url:e.url,meta:{icon:"home-3-fill",component:"",redirect:"",title:"",badge:"",hidden:!1,alwaysShow:!1,isCustomSvg:!1,noClosable:!1,noKeepAlive:!1,tabHidden:!1}},this.menuid=e.objectId):this.form="editMenu"==t?e:{orderBy:e.orderBy,name:"",url:"",meta:{icon:"home-3-fill",component:"",redirect:"",title:"",badge:"",hidden:!1,alwaysShow:!1,isCustomSvg:!1,noClosable:!1,noKeepAlive:!1,tabHidden:!1}},this.dialogFormVisible=!0},close:function(){this.menuid="",this.dialogFormVisible=!1},save:function(){var e=this;this.$refs["form"].validate(function(){var t=Object(s["a"])(l.a.mark((function t(a){return l.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:a&&(e.form.objectId?e._putMenu(e.form.objectId,e.form):e._addMenu(e.form));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},_putMenu:function(e,t){var a=this;return Object(s["a"])(l.a.mark((function n(){var r,s,i;return l.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r={url:t.url,name:t.name,icon:t.icon,orderBy:t.orderBy,meta:t.meta},n.next=3,Object(u["putMenu"])(e,r);case 3:s=n.sent,i=s.updatedAt,i&&a.closeDialog();case 6:case"end":return n.stop()}}),n)})))()},closeDialog:function(){this.menuid="",this.$emit("fetch-data"),this.$refs["form"].resetFields(),this.dialogFormVisible=!1,this.form=this.$options.data().form},_addMenu:function(e){var t=this;return Object(s["a"])(l.a.mark((function a(){var n,r,s,i;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(n="*",r="role:admin",s={},s[n]={read:!0,write:!0},s[r]={read:!0,write:!0},i={ACL:s,meta:e.meta,name:e.name,parent:{objectId:"0",__type:"Pointer",className:"Menu"},url:e.url,icon:e.meta.icon,orderBy:Number(e.orderBy)},""!=t.menuid){a.next=15;break}return i.parent.objectId="0",a.next=10,Object(u["postMenu"])(i);case 10:a.sent,t.$message({message:"新增成功",type:"success"}),t.closeDialog(),a.next=21;break;case 15:return i.parent.objectId=t.menuid,a.next=18,Object(u["postMenu"])(i);case 18:a.sent,t.$message({message:"新增成功",type:"success"}),t.closeDialog();case 21:case"end":return a.stop()}}),a)})))()}}},h=f,g=a("bdd7"),b=Object(g["a"])(h,n,r,!1,null,null,null);t["default"]=b.exports},"4f6a0":function(e,t,a){},"50da6":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"structure dgiot-container"},[a("div",{staticClass:"adduserDiadlog"},[a("a-drawer",{directives:[{name:"loading",rawName:"v-loading",value:e.isloading,expression:"isloading"}],attrs:{"element-loading-background":"rgba(0, 0, 0, 0.8)","element-loading-spinner":"el-icon-loading","element-loading-text":e.$translateTitle("developer.Waitingtoreturn"),title:e.$translateTitle("user.newusers"),visible:e.adduserDiadlog,width:"600px"},on:{"update:visible":function(t){e.adduserDiadlog=t},close:function(t){e.adduserDiadlog=!e.adduserDiadlog}}},[a("el-form",{ref:"userInfoFormRef",staticClass:"demo-ruleForm",attrs:{"label-width":"160px",model:e.userInfoForm,rules:e.userFormRules,"status-icon":""}},[a("el-form-item",{attrs:{label:e.$translateTitle("developer.departmentselection"),prop:"departmentid"}},[a("el-select",{staticStyle:{width:"75%"},attrs:{placeholder:e.$translateTitle("product.selectdepartment")},model:{value:e.userInfoForm.departmentid,callback:function(t){e.$set(e.userInfoForm,"departmentid",t)},expression:"userInfoForm.departmentid"}},e._l(e.deptOption,(function(e){return a("el-option",{key:e.objectId,attrs:{label:e.name,title:e.name+":"+e.desc,value:e.objectId}})})),1),a("span",{staticStyle:{float:"right","font-size":"14px",color:"#8492a6"}},[a("a-button",{attrs:{type:"danger"},on:{click:function(t){e.centerDialogRole=!e.centerDialogRole}}},[e._v(" "+e._s(e.$translateTitle("user.new group"))+" ")])],1)],1),e.centerDialogRole?a("el-form-item",{attrs:{"label-width":"78px"}},[a("addroles",{ref:"addRoleRef",attrs:{"dept-data":e.deptOption[0],"is-structures":e.isStructures}})],1):e._e(),a("el-form-item",{attrs:{label:e.$translateTitle("user.name1"),prop:"nick"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:e.$translateTitle("product.eqwords")},model:{value:e.userInfoForm.nick,callback:function(t){e.$set(e.userInfoForm,"nick",t)},expression:"userInfoForm.nick"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("product.phone"),prop:"phone",width:85}},[a("el-input",{attrs:{"auto-complete":"off",maxlength:11,placeholder:e.$translateTitle("product.enterphonenumber")},model:{value:e.userInfoForm.phone,callback:function(t){e.$set(e.userInfoForm,"phone",t)},expression:"userInfoForm.phone"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("user.email"),prop:"email"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:e.$translateTitle("product.enteremail")},model:{value:e.userInfoForm.email,callback:function(t){e.$set(e.userInfoForm,"email",t)},expression:"userInfoForm.email"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("user.account"),prop:"account"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:e.$translateTitle("product.enteraccount")},model:{value:e.userInfoForm.account,callback:function(t){e.$set(e.userInfoForm,"account",t)},expression:"userInfoForm.account"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("developer.password"),prop:"password"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:e.$translateTitle("product.entermmzh")},model:{value:e.userInfoForm.password,callback:function(t){e.$set(e.userInfoForm,"password",t)},expression:"userInfoForm.password"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("developer.confirmpassword"),prop:"checkPass"}},[a("el-input",{attrs:{"auto-complete":"off",placeholder:e.$translateTitle("product.enterpwa")},model:{value:e.userInfoForm.checkPass,callback:function(t){e.$set(e.userInfoForm,"checkPass",t)},expression:"userInfoForm.checkPass"}})],1)],1),a("div",{style:{position:"absolute",bottom:0,width:"100%",borderTop:"1px solid #e8e8e8",padding:"10px 16px",left:40,textAlign:"center",background:"#fff",borderRadius:"0 0 4px 4px"}},[a("el-button",{attrs:{disabled:e.centerDialogRole},on:{click:function(t){e.adduserDiadlog=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),a("el-button",{attrs:{disabled:e.centerDialogRole,type:"primary"},on:{click:e.addUser}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1)],1)],1),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{lg:24,md:24,sm:24,xl:24,xs:24}},[a("div",{staticClass:"tabContent"},[a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:24}},[a("vab-query-form",{staticStyle:{"margin-top":"20px"}},[a("vab-query-form-top-panel",[a("el-form",{attrs:{inline:!0,"label-width":"auto",model:e.queryForm},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",{attrs:{label:e.$translateTitle("user.department")}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},on:{"visible-change":function(t){return e.change(t)}},model:{value:e.queryForm.workGroupName,callback:function(t){e.$set(e.queryForm,"workGroupName",t)},expression:"queryForm.workGroupName"}},[a("el-option",{staticStyle:{height:"auto",padding:"0"},attrs:{value:e.treeDataValue}},[a("el-tree",{key:e.upKey,ref:"workGroup",attrs:{data:e.deptTreeData,"default-expand-all":"","expand-on-click-node":!1,"node-key":"index",props:e.roleProps},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.node,r=t.data;return a("div",{staticClass:"custom-tree-node"},[a("span",{class:{selected:r.objectId==e.curDepartmentId},on:{click:function(t){return e.handleNodeClick(r,n)}}},[e._v(" "+e._s(n.label)+" ")]),a("span",[a("i",{staticClass:"el-icon-circle-plus-outline",attrs:{title:e.$translateTitle("developer.adduser")},on:{click:function(t){return e.addItemUser(r)}}})])])}}])})],1)],1)],1)],1)],1)],1),a("div",{staticClass:"elTable"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.pictLoading,expression:"pictLoading"}],staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:e.tableFilterData,height:e.tableHeight}},[a("el-table-column",{attrs:{label:e.$translateTitle("user.username")},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("div",[e._v(e._s(n.username))])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("user.phonenumber")},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("div",[e._v(e._s(n.phone))])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("user.email"),"show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("div",[e._v(e._s(n.email))])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("user.department")},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("div",[e._v(" "+e._s(n.departmentname||e.departmentname)+" ")])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("user.createdtime"),"show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(" "+e._s(new Date(n.createdAt).toLocaleDateString())+" ")])]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("developer.operation"),width:"400"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-button",{attrs:{disabled:n.objectId!==e.objectId,size:"small",type:"success"},on:{click:function(t){return e.handleEditor(n)}}},[e._v(" "+e._s(e.$translateTitle("developer.edit"))+" ")]),a("el-button",{attrs:{disabled:!e.curDepartmentId,size:"small",type:"danger"},on:{click:function(t){return e.handleDetele(n)}}},[e._v(" "+e._s(e.$translateTitle("developer.delete"))+" ")])]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("user.Disable")+e.$translateTitle("user.account"),width:"140px"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-tooltip",{attrs:{content:e.$translateTitle("user.Current state")+n.emailVerified?e.$translateTitle("user.Enable"):e.$translateTitle("user.Disable"),placement:"top"}},[a("el-switch",{attrs:{"active-color":"#13ce66","active-text":e.$translateTitle("user.Enable"),"inactive-color":"#ff4949","inactive-text":e.$translateTitle("user.Disable")},on:{change:function(t){return e.disableRow(n.objectId,n.emailVerified)}},model:{value:n.emailVerified,callback:function(t){e.$set(n,"emailVerified",t)},expression:"row.emailVerified"}})],1)]}}])})],1)],1)],1)],1)],1)]),a("el-dialog",{attrs:{"append-to-body":!0,"close-on-click-modal":!1,title:e.$translateTitle("user.assignroles"),visible:e.roleacl},on:{"update:visible":function(t){e.roleacl=t}}},[a("el-table",{ref:"multipleTable",attrs:{data:e.rolelist,height:e.tableHeight,size:"mini"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("user.name")},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(n.alias))])]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("developer.describe")},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(n.desc))])]}}])}),a("el-table-column",{attrs:{align:"center",label:"ID"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(n.objectId))])]}}])})],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.roleacl=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.adduseracl.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1)],1)],1)],1)},r=[],s=a("fb07"),i=a("e97b"),o=a("d0d7"),l=a.n(o),c=(a("1d17"),a("37c6"),a("d6a4"),a("16b8"),a("c4bc"),a("f764"),a("5662"),a("3dec"),a("0c40"),a("79da"),a("a0e0"),a("3858")),u=a("adc7"),d=a("5880"),p=a("8665"),m=a("5da95"),f=a("bc35"),h={components:{addroles:c["default"]},data:function(){var e=this,t=function(e,t,a){""===t?a(new Error("请输入密码")):(/^\w{4,10}$/.test(t)||a(new Error("密码长度必须大于4位")),a())},a=function(t,a,n){""===a?n(new Error("请再次输入密码")):a!==e.userInfoForm.password?n(new Error("两次输入密码不一致!")):n()};return{tableHeight:this.$baseTableHeight(0)-20,isloading:!1,isStructures:!0,upKey:Number(moment().unix()),isEvent:!1,depobjectId:"",centerDialogRole:!1,deptData:{},roleProps:{children:"children",label:"name"},treeDataValue:"",queryForm:{account:"",searchDate:"",pageNo:1,pageSize:20,workGroupName:"",workGroupTreeShow:!1,access_token:""},departmentObj:[],departmentname:"",curDepartmentId:"",deptTreeData:[],deptOption:[],departmentidFlag:"false",height:document.documentElement.clientHeight-180+"px;",delLoading:!1,sup_this:this,loading:!1,deptName:"",depts:[],deptId:null,structure:[],defaultProps:{children:"children",label:"name"},data:[],elTreedefaultProps:{children:"children",label:"name"},dataforuser:[],total:0,query:{value:"",type:"",enabled:""},tableData:[],pagesize:10,start:0,departmentid:[],userlist:[],rolelist:[],userId:"",roleacl:!1,multipleSelection:[],userrolelist:[],tempData:[],roleData:[],adduserDiadlog:!1,userInfoForm:{account:"",phone:"",nick:"",password:"",email:"",checkPass:"",departmentid:[]},userFormRules:{account:[{required:!0,message:"请输入账号名",trigger:"blur"}],phone:[{required:!1,message:"请输入手机号",trigger:"blur"},{validator:function(e,t,a){var n=/^1[34578]\d{9}$/;t?n.test(t)?a():a(new Error("手机号码格式不正确！")):a()},trigger:"blur"}],password:[{validator:t,trigger:"blur",required:!0}],checkPass:[{validator:a,trigger:"blur",required:!0}],departmentid:[{required:!0,message:"请选择部门",trigger:"blur"}],nick:[{required:!0,message:"请输入昵称",trigger:"blur"},{min:2,max:7,message:"昵称格式不正确",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]}]},treeprops:{value:"objectId",label:"name"},pictLoading:!1}},computed:Object(i["a"])(Object(i["a"])({roleTree:{get:function(){return this.$store.state.user.roleTree},set:function(e){return this.setRoleTree(e)}}},Object(d["mapGetters"])({title:"settings/title",objectId:"user/objectId"})),{},{tableFilterData:function(){return this.tempData}}),mounted:function(){var e=this;this.isEvent=!1,this.searchAllOption(),this.userFordepartment(),this.$baseEventBus.$on("dialogHide2",(function(t){null!==t&&void 0!==t&&t.length&&(e.depobjectId=t,e.isEvent=!0),e.$nextTick((function(){e.centerDialogRole=!1,e.getRoletree()}))}))},methods:Object(i["a"])(Object(i["a"])({},Object(d["mapMutations"])({setRoleTree:"user/setRoleTree"})),{},{getRoletree:function(){var e=this;return Object(s["a"])(l.a.mark((function t(){var a,n,r;return l.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.upKey++,t.next=3,Object(f["Roletree"])();case 3:a=t.sent,n=a.results,r=void 0===n?[]:n,e.setRoleTree(r),e.deptTreeData=r,e.isloading=!0,setTimeout((function(){e.isEvent&&e.$query_object("_Role",{limit:1,where:{objectId:e.depobjectId}}).then((function(t){var a;null!==(a=t.results)&&void 0!==a&&a.length&&(e.addItemUser(t.results[0]),e.departmentname=t.results[0].name,e.curDepartmentId=t.results[0].objectId,e.treeDataValue=t.results[0].label,e.queryForm.workGroupName=t.results[0].label)})).catch((function(e){})),e.isloading=!1}),1500);case 10:case"end":return t.stop()}}),t)})))()},closeDialogRole:function(){this.centerDialogRole=!1},addGroup:function(e){},addItemUser:function(e){this.deptOption=[],this.departmentObj=e,this.deptOption.push(e),this.adduserDiadlog=!0,this.userInfoForm.departmentid=e.objectId},change:function(e){e&&$(".el-tree").css({height:"300px",display:"block","overflow-x":"auto"})},addUser:function(){var e=this;this.$refs["userInfoFormRef"].validate(function(){var t=Object(s["a"])(l.a.mark((function t(a){var n,r,s,i;return l.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a){t.next=3;break}return e.$message({message:"用户信息不完整",type:"danger"}),t.abrupt("return",!1);case 3:return t.next=5,Object(p["getUser"])("Klht7ERlYn");case 5:return n=t.sent,r=n.tag,e.$delete(r,"wechat"),s={username:e.userInfoForm.account,nick:e.userInfoForm.nick,password:e.userInfoForm.password,phone:e.userInfoForm.phone,email:e.userInfoForm.email,department:e.userInfoForm.departmentid,emailVerified:!0,tag:r},t.next=11,Object(p["EmployeesHired"])(s);case 11:i=t.sent,i?(e.$message({message:"用户添加成功！",type:"success"}),e.adduserDiadlog=!1,e.handleNodeClick(e.departmentObj)):e.$message("添加失败");case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},editorrole:function(e){var t=this;return Object(s["a"])(l.a.mark((function a(){var n,r,s,i,o;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n={order:"createdAt",where:{users:{className:"_User",__type:"Pointer"}}},t.rolelist=[],t.userrolelist=[],t.userId=e,a.next=6,t.$query_object("_User",{limit:1,where:{objectId:t.userId}});case 6:return r=a.sent,s=r.results,s.length&&(n.where.users.objectId=s[0].objectId),a.next=11,t.$query_object("_Role",n);case 11:i=a.sent,o=i.results,t.rolelist=o,o.length&&(o.map((function(e,a){t.userId==e.objectId&&(t.$refs.multipleTable.toggleRowSelection(t.rolelist[a],!0),t.userrolelist.push(e.objectId))})),t.roleacl=!0);case 15:case"end":return a.stop()}}),a)})))()},seleItem:function(e,t,a){e.map((function(e){t.includes(e)||a.push(e)})),t.map((function(t){e.includes(t)||a.push(t)})),this.userRolereset(a)},userRolereset:function(e){var t=this;u["Promise"].all([e.map((function(e){t.testroles(e)}))]).then((function(e){0!=e.length&&(t.$message({type:"success",message:"分配成功"}),t.roleacl=!1)}))},testroles:function(e){},adduseracl:function(){this.seleItem(this.userrolelist,this.multipleSelection,[])},handleSelectionChange:function(e){var t=this;this.multipleSelection=[],e.map((function(e){t.multipleSelection.push(e.id)}))},handleEditor:function(e){this.$router.push({path:"/roles/edituser",query:{id:e.objectId}})},disableRow:function(e,t){var a=this,n="enable";n=t?"enable":"disable";var r={userid:e,action:n};Object(p["disableuser"])(r).then((function(e){void 0!=e?t?a.$message({type:"success",message:"启用成功!"}):a.$message({type:"success",message:"禁用成功!"}):(a.userFordepartment(),t?a.$message({type:"error",message:"权限不足,启用失败!"}):a.$message({type:"error",message:"权限不足,禁用失败!"}))}))},handleDetele:function(e){var t=this;this.$confirm("此操作将永久删除此用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(l.a.mark((function a(){var n,r;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n={department:t.curDepartmentId,username:e.username},a.next=3,Object(p["EmployeeTurnover"])(n);case 3:r=a.sent,r&&(t.$message({type:"success",message:"删除成功!"}),t.handleNodeClick({name:t.departmentname}));case 5:case"end":return a.stop()}}),a)}))))},handleSizeChange:function(e){this.pagesize=e,this.userFordepartment()},handleCurrentChange:function(e){this.start=Number(e-1)*Number(this.pagesize),this.userFordepartment()},userFordepartment:function(e){var t=this;return Object(s["a"])(l.a.mark((function a(){var n,r,s;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.pictLoading=!0,t.tempData=[],0==e?t.start=0:t.query.value="",n={limit:t.pagesize,skip:t.start,where:{},count:"objectId"},a.next=6,Object(p["queryUser"])(n);case 6:r=a.sent,s=r.results,s?(t.query.value?t.tempData=s.filter((function(e){return-1!=e.username.indexOf(t.query.value)})):t.tempData=s,t.pictLoading=!1):t.pictLoading=!1,t.total=t.tempData.length;case 10:case"end":return a.stop()}}),a)})))()},handleNodeClick:function(e){var t=this;return Object(s["a"])(l.a.mark((function a(){var n,r,s;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.treeDataValue=e.label,t.queryForm.workGroupName=e.label,t.departmentname=e.name,t.curDepartmentId=e.objectId,t.tempData=[],t.pictLoading=!0,n={name:e.name},a.next=9,Object(m["queryRoledepartment"])(n);case 9:r=a.sent,s=r.users,s?(t.tempData=s.filter((function(e){return-1==e.username.indexOf("user_for_")})),t.pictLoading=!1,t.total=t.tempData.length):(t.pictLoading=!1,t.total=0);case 12:case"end":return a.stop()}}),a)})))()},searchAllOption:function(){this.deptTreeData=this.roleTree,this.userFordepartment()}})},g=h,b=(a("95f2"),a("39a2"),a("bdd7")),v=Object(b["a"])(g,n,r,!1,null,"6fce9ab6",null);t["default"]=v.exports},"59d6":function(e,t,a){"use strict";a("8135")},"5a27":function(e,t,a){"use strict";a("8282")},"5f52":function(e,t,a){"use strict";a("4f6a0")},"63c7":function(e,t,a){},"6d7c":function(e,t,a){"use strict";a("cbcb")},"706e":function(e,t,a){e.exports={"menu-color":"rgba(255,255,255,.95)","menu-color-active":"rgba(255,255,255,.95)","menu-background":"#282c34","column-second-menu-background":"#fff"}},"7cc2":function(e,t,a){},"7dd9":function(e,t,a){},"7e79":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"nodelist"},[a("div",{staticClass:"operation"},[a("el-button",{attrs:{icon:"el-icon-search",type:"primary"}}),a("el-button",{attrs:{icon:"el-icon-delete",type:"danger"}}),a("el-button",{attrs:{icon:"el-icon-date",type:"danger"}})],1)])},r=[],s={data:function(){return{}},mounted:function(){},methods:{}},i=s,o=(a("9aed"),a("bdd7")),l=Object(o["a"])(i,n,r,!1,null,"c5fc2152",null);t["default"]=l.exports},8135:function(e,t,a){},8282:function(e,t,a){},8405:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},r=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{staticClass:"language-json"},[a("code",[a("span",{staticClass:"token punctuation"},[e._v("{")]),e._v("\n  "),a("span",{staticClass:"token property"},[e._v('"hidden"')]),a("span",{staticClass:"token operator"},[e._v(":")]),e._v(" "),a("span",{staticClass:"token boolean"},[e._v("true")]),a("span",{staticClass:"token punctuation"},[e._v(",")]),e._v(" "),a("span",{staticClass:"token comment"},[e._v("//是否显示在菜单中显示隐藏路由（默认值：false）")]),e._v("\n  "),a("span",{staticClass:"token property"},[e._v('"menuHidden"')]),a("span",{staticClass:"token operator"},[e._v(":")]),e._v(" "),a("span",{staticClass:"token boolean"},[e._v("false")]),a("span",{staticClass:"token punctuation"},[e._v(",")]),e._v(" "),a("span",{staticClass:"token comment"},[e._v("//是否显示在菜单中显示隐藏一级路由（默认值：false，除分栏布局有效）")]),e._v("\n  "),a("span",{staticClass:"token property"},[e._v('"alwaysShow"')]),a("span",{staticClass:"token operator"},[e._v(":")]),e._v(" "),a("span",{staticClass:"token boolean"},[e._v("true")]),a("span",{staticClass:"token punctuation"},[e._v(",")]),e._v(" "),a("span",{staticClass:"token comment"},[e._v("//当只有一级子路由时是否显示父路由是否显示在菜单中显示路由（默认值：false）")]),e._v("\n  "),a("span",{staticClass:"token property"},[e._v('"name"')]),a("span",{staticClass:"token operator"},[e._v(":")]),e._v(" "),a("span",{staticClass:"token string"},[e._v('"Demo"')]),a("span",{staticClass:"token punctuation"},[e._v(",")]),e._v(" "),a("span",{staticClass:"token comment"},[e._v("//首字母大写，一定要与vue文件的name对应起来，用于noKeepAlive缓存控制（该项特别重要）")]),e._v("\n  "),a("span",{staticClass:"token property"},[e._v('"meta"')]),a("span",{staticClass:"token operator"},[e._v(":")]),e._v(" "),a("span",{staticClass:"token punctuation"},[e._v("{")]),e._v("\n    "),a("span",{staticClass:"token property"},[e._v('"title"')]),a("span",{staticClass:"token operator"},[e._v(":")]),e._v(" "),a("span",{staticClass:"token string"},[e._v('"title"')]),a("span",{staticClass:"token punctuation"},[e._v(",")]),e._v(" "),a("span",{staticClass:"token comment"},[e._v("//菜单、面包屑、多标签页显示的名称")]),e._v("\n    "),a("span",{staticClass:"token property"},[e._v('"roles"')]),a("span",{staticClass:"token operator"},[e._v(":")]),e._v(" "),a("span",{staticClass:"token punctuation"},[e._v("[")]),a("span",{staticClass:"token string"},[e._v('"admin"')]),a("span",{staticClass:"token punctuation"},[e._v(",")]),e._v(" "),a("span",{staticClass:"token string"},[e._v('"..."')]),a("span",{staticClass:"token punctuation"},[e._v("]")]),a("span",{staticClass:"token punctuation"},[e._v(",")]),e._v(" "),a("span",{staticClass:"token comment"},[e._v("//当config/settings.js中rolesControl配置开启时，用于控制角色（简写）")]),e._v("\n    "),a("span",{staticClass:"token property"},[e._v('"roles"')]),a("span",{staticClass:"token operator"},[e._v(":")]),e._v(" "),a("span",{staticClass:"token punctuation"},[e._v("{")]),e._v("\n      "),a("span",{staticClass:"token comment"},[e._v("//当config/settings.js中rolesControl配置开启时，用于控制角色（全写）")]),e._v("\n      "),a("span",{staticClass:"token property"},[e._v('"role"')]),a("span",{staticClass:"token operator"},[e._v(":")]),e._v(" "),a("span",{staticClass:"token punctuation"},[e._v("[")]),a("span",{staticClass:"token string"},[e._v('"admin"')]),a("span",{staticClass:"token punctuation"},[e._v(",")]),e._v(" "),a("span",{staticClass:"token string"},[e._v('"..."')]),a("span",{staticClass:"token punctuation"},[e._v("]")]),a("span",{staticClass:"token punctuation"},[e._v(",")]),e._v("\n      "),a("span",{staticClass:"token property"},[e._v('"ability"')]),a("span",{staticClass:"token operator"},[e._v(":")]),e._v(" "),a("span",{staticClass:"token punctuation"},[e._v("[")]),a("span",{staticClass:"token string"},[e._v('"READ"')]),a("span",{staticClass:"token punctuation"},[e._v(",")]),e._v(" "),a("span",{staticClass:"token string"},[e._v('"WRITE"')]),a("span",{staticClass:"token punctuation"},[e._v(",")]),e._v(" "),a("span",{staticClass:"token string"},[e._v('"DELETE"')]),a("span",{staticClass:"token punctuation"},[e._v("]")]),a("span",{staticClass:"token punctuation"},[e._v(",")]),e._v(" "),a("span",{staticClass:"token comment"},[e._v('//ability: ["READ","WRITE"],')]),e._v("\n      "),a("span",{staticClass:"token property"},[e._v('"mode"')]),a("span",{staticClass:"token operator"},[e._v(":")]),e._v(" "),a("span",{staticClass:"token string"},[e._v('"allOf"')]),e._v(" "),a("span",{staticClass:"token comment"},[e._v("//allOf: 数组内所有角色都拥有，返回True oneOf: 数组内拥有任一角色，返回True(等价第1种数据) except: 不拥有数组内任一角色，返回True(取反)")]),e._v("\n    "),a("span",{staticClass:"token punctuation"},[e._v("}")]),a("span",{staticClass:"token punctuation"},[e._v(",")]),e._v("\n    "),a("span",{staticClass:"token property"},[e._v('"remixIcon"')]),a("span",{staticClass:"token operator"},[e._v(":")]),e._v(" "),a("span",{staticClass:"token string"},[e._v('""')]),a("span",{staticClass:"token punctuation"},[e._v(",")]),e._v(" "),a("span",{staticClass:"token comment"},[e._v("//旧版remix图标")]),e._v("\n    "),a("span",{staticClass:"token property"},[e._v('"icon"')]),a("span",{staticClass:"token operator"},[e._v(":")]),e._v(" "),a("span",{staticClass:"token string"},[e._v('""')]),a("span",{staticClass:"token punctuation"},[e._v(",")]),e._v(" "),a("span",{staticClass:"token comment"},[e._v("//新版")]),e._v("\n    "),a("span",{staticClass:"token property"},[e._v('"isCustomSvgIcon"')]),a("span",{staticClass:"token operator"},[e._v(":")]),e._v(" "),a("span",{staticClass:"token boolean"},[e._v("false")]),a("span",{staticClass:"token punctuation"},[e._v(",")]),e._v(" "),a("span",{staticClass:"token comment"},[e._v("//旧版，是否是自定义svg图标（默认值：false，如果设置true，那么需要把你的svg拷贝到icon/remixIcon下，然后remixIcon字段配置上你的图标名）")]),e._v("\n    "),a("span",{staticClass:"token property"},[e._v('"isCustomSvg"')]),a("span",{staticClass:"token operator"},[e._v(":")]),e._v(" "),a("span",{staticClass:"token boolean"},[e._v("false")]),a("span",{staticClass:"token punctuation"},[e._v(",")]),e._v(" "),a("span",{staticClass:"token comment"},[e._v("//新版，是否是自定义svg图标（默认值：false，如果设置true，那么需要把你的svg拷贝到icon/remixIcon下，然后remixIcon字段配置上你的图标名）")]),e._v("\n    "),a("span",{staticClass:"token property"},[e._v('"noKeepAlive"')]),a("span",{staticClass:"token operator"},[e._v(":")]),e._v(" "),a("span",{staticClass:"token boolean"},[e._v("true")]),a("span",{staticClass:"token punctuation"},[e._v(",")]),e._v(" "),a("span",{staticClass:"token comment"},[e._v("//当前路由是否不缓存（默认值：false）")]),e._v("\n    "),a("span",{staticClass:"token property"},[e._v('"affix"')]),a("span",{staticClass:"token operator"},[e._v(":")]),e._v(" "),a("span",{staticClass:"token boolean"},[e._v("true")]),a("span",{staticClass:"token punctuation"},[e._v(",")]),e._v(" "),a("span",{staticClass:"token comment"},[e._v("//当前路由是否固定多标签页（旧版）")]),e._v("\n    "),a("span",{staticClass:"token property"},[e._v('"noCLosable"')]),a("span",{staticClass:"token operator"},[e._v(":")]),e._v(" "),a("span",{staticClass:"token boolean"},[e._v("true")]),a("span",{staticClass:"token punctuation"},[e._v(",")]),e._v(" "),a("span",{staticClass:"token comment"},[e._v("//当前路由是否可关闭多标签页，同上（新版）")]),e._v("\n    "),a("span",{staticClass:"token property"},[e._v('"badge"')]),a("span",{staticClass:"token operator"},[e._v(":")]),e._v(" "),a("span",{staticClass:"token string"},[e._v('"New"')]),a("span",{staticClass:"token punctuation"},[e._v(",")]),e._v(" "),a("span",{staticClass:"token comment"},[e._v("//badge小标签（只支持子级）")]),e._v("\n    "),a("span",{staticClass:"token property"},[e._v('"tabHidden"')]),a("span",{staticClass:"token operator"},[e._v(":")]),e._v(" "),a("span",{staticClass:"token boolean"},[e._v("true")]),a("span",{staticClass:"token punctuation"},[e._v(",")]),e._v(" "),a("span",{staticClass:"token comment"},[e._v("//当前路由是否不显示多标签页")]),e._v("\n    "),a("span",{staticClass:"token property"},[e._v('"activeMenu"')]),a("span",{staticClass:"token operator"},[e._v(":")]),e._v(" "),a("span",{staticClass:"token string"},[e._v('""')]),a("span",{staticClass:"token punctuation"},[e._v(",")]),e._v(" "),a("span",{staticClass:"token comment"},[e._v("//高亮指定菜单")]),e._v("\n    "),a("span",{staticClass:"token property"},[e._v('"dot"')]),a("span",{staticClass:"token operator"},[e._v(":")]),e._v(" "),a("span",{staticClass:"token boolean"},[e._v("false")]),a("span",{staticClass:"token punctuation"},[e._v(",")]),e._v(" "),a("span",{staticClass:"token comment"},[e._v("//小圆点")]),e._v("\n    "),a("span",{staticClass:"token property"},[e._v('"dynamicNewTab"')]),a("span",{staticClass:"token operator"},[e._v(":")]),e._v(" "),a("span",{staticClass:"token boolean"},[e._v("false")]),e._v(" "),a("span",{staticClass:"token comment"},[e._v("// 动态传参路由是否新开标签页")]),e._v("\n  "),a("span",{staticClass:"token punctuation"},[e._v("}")]),a("span",{staticClass:"token punctuation"},[e._v(",")]),e._v("\n  "),a("span",{staticClass:"token property"},[e._v('"children"')]),a("span",{staticClass:"token operator"},[e._v(":")]),e._v(" "),a("span",{staticClass:"token punctuation"},[e._v("[")]),a("span",{staticClass:"token punctuation"},[e._v("]")]),e._v("\n"),a("span",{staticClass:"token punctuation"},[e._v("}")]),e._v("\n")])])])}],s={name:"MenuCollapse"},i=s,o=(a("44a4"),a("bdd7")),l=Object(o["a"])(i,n,r,!1,null,"160603e2",null);t["default"]=l.exports},"8de9":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"rolescontrol dgiot-container"},[a("div",{staticClass:"search"},[a("el-input",{staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:e.$translateTitle("concentrator.input")},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{icon:"el-icon-search",type:"primary"},on:{click:function(t){return e.getcontrolrole({name:e.search})}}},[e._v(" "+e._s(e.$translateTitle("developer.search"))+" ")]),a("el-button",{attrs:{disabled:"",icon:"el-icon-plus",type:"primary"},on:{click:e.addcontrol}},[e._v(" "+e._s(e.$translateTitle("developer.add"))+" ")])],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{border:"",data:e.treeData,"default-expand-all":"",height:e.tableHeight,"row-key":"objectId",size:"mini","tree-props":{children:"children",hasChildren:"hasChildren"}}},[a("el-table-column",{attrs:{align:"center","class-name":"isCheck","show-overflow-tooltip":"",type:"index",width:"55"}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("equipment.name"),"show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(" "+e._s(n.name)+" ")])]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.alias"),"show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(" "+e._s(n.alias)+" ")])]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("user.createdtime"),"show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(n.createtime))])]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("task.Operation"),"show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-button",{attrs:{icon:"el-icon-edit",size:"mini",type:"success"},on:{click:function(t){return e.handleEdit(n)}}},[e._v(" "+e._s(e.$translateTitle("developer.edit"))+" ")]),a("el-button",{attrs:{disabled:"",icon:"el-icon-delete",size:"mini",type:"danger"},on:{click:function(t){return e.handleDelete(n)}}},[e._v(" "+e._s(e.$translateTitle("developer.delete"))+" ")])]}}])})],1),a("vab-Pagination",{directives:[{name:"show",rawName:"v-show",value:e.count,expression:"count"}],attrs:{limit:e.queryForm.pageSize,page:e.queryForm.pageNo,total:e.count},on:{"update:limit":function(t){return e.$set(e.queryForm,"pageSize",t)},"update:page":function(t){return e.$set(e.queryForm,"pageNo",t)},pagination:e.getcontrolrole}}),a("el-dialog",{attrs:{"append-to-body":!0,title:e.$translateTitle("developer.edit"),visible:e.roleEdit,width:"28%"},on:{"update:visible":function(t){e.roleEdit=t}}},[a("el-form",{attrs:{model:e.form}},[a("el-form-item",{attrs:{label:e.$translateTitle("user.name"),"label-width":e.formLabelWidth}},[a("el-input",{staticStyle:{width:"300px"},attrs:{autocomplete:"off",disabled:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("user.Remarks"),"label-width":e.formLabelWidth}},[a("el-input",{staticStyle:{width:"300px"},attrs:{autocomplete:"off"},model:{value:e.form.alias,callback:function(t){e.$set(e.form,"alias",t)},expression:"form.alias"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("developer.describe"),"label-width":e.formLabelWidth}},[a("el-input",{staticStyle:{width:"300px"},attrs:{autocomplete:"off",rows:2,type:"textarea"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.roleEdit=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.updaterole.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1)],1)],1)},r=[],s=a("fb07"),i=a("d0d7"),o=a.n(i),l=(a("04d6"),a("a0e0"),a("3dec"),a("16b8"),a("80ab"),a("a98c"),a("c4bc"),a("1ec2")),c=a("ed08"),u={components:{},data:function(){return{count:0,queryForm:{number:"",product:"",type:"",searchDate:[],limit:20,skip:0,order:"-createdAt",keys:"count(*)"},listLoading:!1,formLabelWidth:"120px",roleEdit:!1,tableHeight:this.$baseTableHeight(0),form:{name:"",alias:"",description:""},search:"",defaultExpandAll:!0,key:1,permissionid:"",columns:[{label:"Name",key:"alias",expand:!0,align:"left"},{label:"Alias",key:"name",width:200,align:"center"},{label:"Created time",key:"scope"},{label:"Operation",key:"operation"}],data:[]}},computed:{treeData:function(){var e=JSON.parse(JSON.stringify(this.data));return e.filter((function(t){var a=e.filter((function(e){return t.objectId==e.parent}));return a.length>0&&(t.children=a),0==t.parent}))}},mounted:function(){this.getcontrolrole({})},methods:{handleEdit:function(e){var t=this;return Object(s["a"])(o.a.mark((function a(){var n;return o.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.permissionid=e.objectId,a.next=3,Object(l["getPermission"])(e.objectId);case 3:n=a.sent,t.form.name=n.name,t.form.description=n.description,t.form.alias=n.alias,t.roleEdit=!0;case 8:case"end":return a.stop()}}),a)})))()},handleDelete:function(e){},addcontrol:function(){},getcontrolrole:function(e){var t=this;return Object(s["a"])(o.a.mark((function a(){var n,r,s;return o.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.listLoading=!0,t.data=[],a.next=4,Object(l["queryPermission"])({count:"*",limit:e.limit?e.limit:t.queryForm.limit,order:t.queryForm.order,skip:e.skip?e.skip:t.queryForm.skip,where:{name:e.name?{$regex:e.name}:{$ne:null}}});case 4:n=a.sent,r=n.results,s=n.count,t.listLoading=!1,r?r.map((function(e){var a={};a.name=e.name,a.alias=e.alias,a.objectId=e.objectId,a.parent=e.parent.objectId,a.createtime=Object(c["utc2beijing"])(e.createdAt),t.data.push(a),t.count=s})):t.data=[];case 9:case"end":return a.stop()}}),a)})))()},updaterole:function(){var e=this;return Object(s["a"])(o.a.mark((function t(){var a;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(l["putPermission"])(e.permissionid,{alias:e.form.alias,description:e.form.description});case 2:a=t.sent,a&&e.$message({type:"success",message:"更新成功"}),e.roleEdit=!1;case 5:case"end":return t.stop()}}),t)})))()}}},d=u,p=(a("3710"),a("bdd7")),m=Object(p["a"])(d,n,r,!1,null,"7006d43b",null);t["default"]=m.exports},9223:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"resourcechannel resourcechannel-container"},[a("div",{staticClass:"firsttable"},[a("vab-input",{ref:"uploadFinish",attrs:{params:e.inputParams},on:{fileInfo:e.fileInfo,files:e.files}}),a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.fileParams,size:"small"}},[a("el-form-item",{attrs:{label:e.$translateTitle("application.scene")}},[a("el-input",{model:{value:e.fileParams.scene,callback:function(t){e.$set(e.fileParams,"scene",t)},expression:"fileParams.scene"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("developer.path")}},[a("el-input",{attrs:{placeholder:e.$translateTitle("application.pathdescription")},model:{value:e.fileParams.path,callback:function(t){e.$set(e.fileParams,"path",t)},expression:"fileParams.path"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.uploadCkick()}}},[e._v(" "+e._s(e.$translateTitle("application.uploadfile"))+" ")])],1)],1),a("el-breadcrumb",{attrs:{separator:"/"}},[e._l(e.filebreadcrumb,(function(t,n){return[a("el-breadcrumb-item",{key:n,nativeOn:{click:function(a){return e.breadcrumbClick(t)}}},[e._v(" "+e._s(t.name)+" ")])]}))],2),a("h5"),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"tableRef",staticStyle:{width:"100%"},attrs:{"cell-style":{"text-align":"center"},data:e.filelist,"header-cell-style":{"text-align":"center"}},on:{"row-click":e.fileclick}},[a("el-table-column",{attrs:{label:e.$translateTitle("developer.filename"),prop:"name","show-overflow-tooltip":"",sortable:""}}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.filesize"),prop:"name","show-overflow-tooltip":"",sortable:"",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[n.is_dir?a("span",[e._v(e._s("-"))]):a("span",[e._v(e._s(Math.round(n.size/1024)+"kb"))])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.filemtime"),prop:"name","show-overflow-tooltip":"",sortable:"",width:"260"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(" "+e._s(e.$moment(1e3*n.mtime).format("YYYY-MM-DD HH:mm:ss"))+" ")])]}}])}),a("el-table-column",{attrs:{fixed:"right",label:e.$translateTitle("developer.operation"),width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[n.is_dir?e._e():a("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return t.stopPropagation(),e.get_fileinfo(n)}}},[e._v(" "+e._s(e.$translateTitle("application.detail"))+" ")]),n.is_dir?e._e():a("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return t.stopPropagation(),e.download_file(n)}}},[e._v(" "+e._s(e.$translateTitle("application.preview"))+" ")]),n.is_dir?e._e():a("el-button",{attrs:{slot:"reference",size:"mini",type:"danger"},nativeOn:{click:function(t){return t.stopPropagation(),e.delete_file(n)}},slot:"reference"},[e._v(" "+e._s(e.$translateTitle("developer.delete"))+" ")])]}}])})],1),a("el-dialog",{attrs:{model:e.detailinfo,title:"文件信息",visible:e.detailView,width:"30%"},on:{"update:visible":function(t){e.detailView=t}}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.ViewLoading,expression:"ViewLoading"}]},[a("el-form-item",{attrs:{label:"名称","label-width":"200"}},[a("span",[e._v(e._s(e.detailinfo.rename))])]),a("el-form-item",{attrs:{label:"路径","label-width":"200"}},[a("span",[e._v(e._s(e.detailinfo.path))])]),a("el-form-item",{attrs:{label:"url","label-width":"200"}},[a("span",[e._v(e._s(e.detailinfo.url))])]),a("el-form-item",{attrs:{label:"MD5","label-width":"200"}},[a("span",[e._v(e._s(e.detailinfo.md5))])]),a("el-form-item",{attrs:{label:"场景","label-width":"200"}},[a("span",[e._v(e._s(e.detailinfo.scene))])]),a("el-form-item",{attrs:{label:"大小","label-width":"200"}},[a("span",[e._v(e._s(Math.round(e.detailinfo.size/1024)+"kb"))])]),a("el-form-item",{attrs:{label:"日期","label-width":"200"}},[a("span",[e._v(" "+e._s(e.$moment(1e3*e.detailinfo.timeStamp).format("YYYY-MM-DD HH:mm:ss"))+" ")])])],1)],1)],1)])},r=[],s=(a("16b8"),a("e170"),a("3dec"),a("4656"),a("1ae2")),i={data:function(){return{filelist:[],filebreadcrumb:[{name:"全部文件",path:"dgiot_file",is_dir:!0}],fileParams:{scene:"app"},inputParams:{},parentfile:"dgiot_file",listLoading:!1,ViewLoading:!1,detailView:!1,detailinfo:{}}},watch:{},mounted:function(){this.get_filelist(this.parentfile)},methods:{breadcrumbClick:function(e){if("全部文件"==e.name)this.filebreadcrumb=[{name:"全部文件",path:"dgiot_file"}],this.get_filelist(e.path);else{if(e.child)for(var t=0;t<this.filebreadcrumb.length;t++)this.filebreadcrumb[t].path==e.child.path&&this.filebreadcrumb.splice(t,1);this.get_filelist(e.path+"/"+e.name)}},fileclick:function(e){if(e.is_dir){this.get_filelist(e.path+"/"+e.name);var t=this.filebreadcrumb.length-1,a="child";this.filebreadcrumb[t][a]=e,this.filebreadcrumb.push(e)}else window.open(this.$FileServe+"/"+e.path+"/"+e.name)},uploadCkick:function(){this.loading=!0,this.$refs["uploadFinish"].$refs.uploader.dispatchEvent(new MouseEvent("click")),this.inputParams={file:"",scene:this.fileParams.scene?this.fileParams.scene:"default",path:this.fileParams.path?this.fileParams.path:"default",filename:moment(new Date).valueOf().toString()}},fileInfo:function(e){this.listLoading=!0,e.url?(this.$message({type:"success",message:"上传成功"}),this.get_filelist(this.parentfile)):this.$message({type:"error",message:"上传失败"}),this.listLoading=!1},files:function(e){this.inputParams.filename=e.name,this.inputParams.file=e},get_filelist:function(e){var t=this;this.listLoading=!0,Object(s["list_dir"])(e).then((function(e){"ok"==e.status?t.filelist=e.data:t.filelist=[],t.listLoading=!1}))},get_fileinfo:function(e){var t=this;this.detailView=!0,this.ViewLoading=!0,Object(s["file_info"])("files/"+e.path+"/"+e.name).then((function(a){t.detailinfo=a.data,t.detailinfo.url=t.$FileServe+"/"+e.path+"/"+e.name,t.ViewLoading=!1}))},delete_file:function(e){var t=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(s["delete_file"])("files/"+e.path+"/"+e.name).then((function(a){"ok"==a.status?(t.$message({type:"success",message:"删除成功"}),t.get_filelist(e.path)):t.$message({type:"error",message:a.message})})).catch((function(){t.$message({type:"error",message:"删除失败"})}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},download_file:function(e){window.open(this.$FileServe+"/"+e.path+"/"+e.name)}}},o=i,l=(a("b9b9"),a("b250"),a("bdd7")),c=Object(l["a"])(o,n,r,!1,null,"5412c986",null);t["default"]=c.exports},9559:function(e,t,a){},"95f2":function(e,t,a){"use strict";a("a044")},"9aed":function(e,t,a){"use strict";a("7dd9")},"9bde":function(t,a,n){"use strict";n.r(a);var r,s,i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"things-parse"},[a("el-dialog",{attrs:{"append-to-body":!0,title:e.$translateTitle("product.newapi"),visible:e.apiDialog,width:"30%"},on:{"update:visible":function(t){e.apiDialog=t}}},[a("el-form",{ref:"formLabelAlign",attrs:{"label-position":"left","label-width":"170px",model:e.formLabelAlign,rules:e.rules,size:"mini"}},[a("el-form-item",{attrs:{label:e.$translateTitle("plugins.modulename"),prop:"name"}},[a("el-input",{model:{value:e.formLabelAlign.name,callback:function(t){e.$set(e.formLabelAlign,"name",t)},expression:"formLabelAlign.name"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("plugins.programinglanguage"),prop:"language"}},[a("el-select",{attrs:{placeholder:e.$translateTitle("resource.zoneofaction")},model:{value:e.formLabelAlign.language,callback:function(t){e.$set(e.formLabelAlign,"language",t)},expression:"formLabelAlign.language"}},e._l(e.formLabelAlign.languageList,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.submitFormApi("formLabelAlign")}}},[e._v(" "+e._s(e.$translateTitle("developer.create"))+" ")]),a("el-button",{attrs:{size:"mini"},on:{click:function(t){e.apiDialog=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")])],1)],1),a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:7}},[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.addApi.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("product.newapi"))+" ")]),a("el-table",{ref:"singleTable",staticStyle:{width:"100%"},attrs:{data:e.AllDict,"highlight-current-row":""},on:{"current-change":e.handleCurrentChange}},[a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("rule.Type"),width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(n.type))])]}}])}),a("el-table-column",{attrs:{align:"center",label:"mod","show-overflow-tooltip":!0,width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(n.mod))])]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("task.Operation")},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-button",{attrs:{size:"mini",title:e.$translateTitle("rule.testnewequipment")},on:{click:function(t){return e.handleTest(e.scope.$index,n.type,n.mod)}}},[a("vab-icon",{attrs:{icon:"bug-line"}})],1),a("el-button",{attrs:{size:"mini",title:e.$translateTitle("product.pub"),type:"primary"},on:{click:function(t){return e.handleRelease(e.scope.$index,n.type,n.mod)}}},[a("vab-icon",{attrs:{icon:"run-line"}})],1),a("el-button",{attrs:{size:"mini",title:e.$translateTitle("equipment.Offtheshelf"),type:"danger"},on:{click:function(t){return e.handleDelete(e.scope.$index,n.type,n.mod)}}},[a("vab-icon",{attrs:{icon:"delete-bin-2-fill"}})],1)]}}])})],1)],1),a("el-col",{attrs:{span:17}},[a("div",{staticClass:"protolheader"},[a("el-tabs",{attrs:{size:"mini"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:e.$translateTitle("product.Design"),name:"design"}},[a("VabJsonEditor",{ref:"jsonEdit",model:{value:e.itemSwagger,callback:function(t){e.itemSwagger=t},expression:"itemSwagger"}})],1),a("el-tab-pane",{attrs:{label:e.$translateTitle("product.code"),name:"code"}},[a("el-form",{ref:"thingsParseModel",attrs:{inline:!0,model:e.thingsParseModel,rules:e.thingsParseRules}}),a("div",[a("div",{staticStyle:{background:"#ffffff"}},[a("label",{attrs:{id:"plug-name"}})]),a("pre",{staticClass:"ace_editor",staticStyle:{"min-height":"480px","margin-bottom":"0"},attrs:{id:"editor"}},[a("textarea",{staticClass:"ace_text-input"})]),a("div",{staticStyle:{background:"#ffffff"}},[a("label",{attrs:{id:"plug-name"}})]),a("div",{staticStyle:{padding:"5px","margin-right":"80px",color:"#c2be9e",background:"#272822","border-top":"1px solid #dddddd"}},[a("span",[e._v(e._s(e.$translateTitle("product.controloutput")))])]),a("pre",{staticClass:"ace_editor",staticStyle:{"min-height":"200px","margin-top":"0","margin-bottom":"0"},attrs:{id:"editor2"}},[a("textarea",{staticClass:"ace_text-input"})])])],1),a("el-tab-pane",{attrs:{label:e.$translateTitle("rule.Test"),name:"swagger"}},[a("iframe",{attrs:{height:"700vh",src:e.swaggerPath,width:"100%"}})])],1)],1)])],1)],1)},o=[],l=n("fb07"),c=n("d0d7"),u=n.n(c),d=(n("1d17"),n("37c6"),n("e170"),n("16b8"),n("c4bc"),n("a0e0"),n("3dec"),n("f1e1"),n("0c40"),n("79da"),n("98da"),n("e0e9")),p=n("1285"),m=n("89e8"),f=n("4d2d"),h=n("bb22"),g="",b="",v={name:"ThingsParse",components:{},props:{},data:function(){var e=function(e,t,a){var n=/[0-9a-zA-Z]/;n.test(t)?a():a(new Error("协议名称由数字和字母组合"))};return{fullscreenLoading:!1,rules:{name:[{required:!0,validator:e,trigger:"blur"}],language:[{required:!0,message:"请选择编程语言",trigger:"change"}]},labelPosition:"right",formLabelAlign:{languageList:["python","java","ruby"],language:"python",name:"",region:"",type:""},apiDialog:!1,activeName:"design",itemSwagger:{},currentRow:null,AllDict:[],productName:"",form:{Productname:"",ProductKey:"",ProductAll:0},swaggerPath:"http://prod.iotn2n.com/swagger/#/",decoderstart:0,decodertotal:0,decoderlength:10,protolchannel:[],productdetail:{},thingsParseModel:{name:"",version:"",desc:"",resource:!1},thingsParseRules:{name:[{required:!0,message:"请输入协议名称",trigger:"blur"},{validator:e,trigger:"blur"}]},dialogTableVisible:!1,gridData:[],protoldialog:!1}},computed:{tableFilterData:function(){return null}},mounted:function(){s=ace.edit("editor2"),s.session.setMode("ace/mode/python"),s.setTheme("ace/theme/monokai"),s.setReadOnly(!0),s.setOptions({enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0}),this.getAllDict(),this.setPath(),this.$route.query.activeName&&(this.activeName=this.$route.query.activeName)},methods:{setPath:function(){this.swaggerPath=location.origin+"/swagger/#/"},handleDelete:function(e,t,a){var n=this;this.$confirm("确认要下架该api吗？").then(function(){var r=Object(l["a"])(u.a.mark((function r(s){var i;return u.a.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,Object(f["delExproto"])({type:t,mod:a,version:"debug"});case 2:i=r.sent,i&&n.AllDict.splice(e,1);case 4:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()).catch((function(e){}))},handleTest:function(e,t,a){var n=this;return Object(l["a"])(u.a.mark((function e(){var i,o,l;return u.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i={code:Base64.encode(r.getValue()),mod:a,swagger:JSON.parse(n.itemSwagger),type:t},e.next=3,Object(f["putExproto"])(i);case 3:o=e.sent,l=o.results,l?(s.setValue(Base64.decode(l)),n.$message({showClose:!0,message:"调测api成功",type:"success"})):n.$message.error("api有错误,请检查");case 6:case"end":return e.stop()}}),e)})))()},handleRelease:function(e,t,a){var n=this;return Object(l["a"])(u.a.mark((function e(){var s,i;return u.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s={code:Base64.encode(r.getValue()),mod:a,swagger:JSON.parse(n.itemSwagger),type:t},e.next=3,Object(f["postExproto"])(s);case 3:i=e.sent,i?n.$message({showClose:!0,message:"发布api成功",type:"success"}):n.$message.error("api有错误,请检查");case 5:case"end":return e.stop()}}),e)})))()},addApi:function(){this.apiDialog=!0},submitFormApi:function(t){var a=this;this.$refs[t].validate(function(){var t=Object(l["a"])(u.a.mark((function t(n){var r,s,i;return u.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r={python:"IyBjb2Rpbmc9dXRmOAppbXBvcnQgb3MKCmRlZiBwb3N0KGFyZ3Msc2Vzc2lvbixlbnYpOgogICAgI2JvZHkgPSBqc29uLmxvYWRzKGJhc2U2NC5iNjRkZWNvZGUoYXJncykuZGVjb2RlKCJ1dGYtOCIpKQogICAgI3ByaW50KGJvZHkpCiAgICAjc3RyYm9keSA9ICd7fScuZm9ybWF0KGJvZHkpCiAgICAjZW5ib2R5ID0gIGJhc2U2NC5iNjRlbmNvZGUoc3RyYm9keS5lbmNvZGUoJ3V0Zi04JykpCiAgICAjcHJpbnQoZW5ib2R5KQogICAgI3N0YXRlID0ganNvbi5sb2FkcyhiYXNlNjQuYjY0ZGVjb2RlKGVudikuZGVjb2RlKCJ1dGYtOCIpKQogICAgI3ByaW50KHN0YXRlKQogICAgIyByZXN0dXJsID0gc3RhdGVbJ3JvbGVzJ11bMF1bJ3RhZyddWydhcHBjb25maWcnXVsncmVzdCddCiAgICAjIHByaW50KHJlc3R1cmwpCiAgICAjIHMuaGVhZGVycy51cGRhdGUoeyJzZXNzaW9uVG9rZW4iOiBzZXNzaW9uLCAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nfSkKICAgICMgcnQgPSBzLmdldCgne30vY2xhc3Nlcy9EZXZpY2U/b3JkZXI9Y3JlYXRlZEF0JmxpbWl0PTEwJnNraXA9MCcuZm9ybWF0KHJlc3R1cmwpLAogICAgIyAgICAgICAgICAgICAgcGFyYW1zPXsnb3JkZXInOiAnY3JlYXRlZEF0JywgfSkKICAgICMgZm9yIHJvdyBpbiAocnQuanNvbigpWydyZXN1bHRzJ10pOgogICAgIyAgICAgcHJpbnQocm93KQogICAgcHJpbnQoYXJncykKICAgIHByaW50KHNlc3Npb24pCiAgICBwcmludChlbnYpCiAgICByZXR1cm4gYXJncwoKZGVmIG1haW4oKToKICAgICN7Im5hbWUiOiJzaHV3YSJ9CiAgICBhcmd2cyA9ICdleUp1WVcxbElqb2ljMmgxZDJFaWZRPT0nCiAgICByZXR1cm4gIHBvc3QoYXJndnMsICdzZXNzaW9uJywnZW52JykKCmRlZiBleGl0KCk6CiAgICBvcy5fZXhpdCgwKQoKaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoKICAgIG1haW4oKQ==",java:"",ruby:""},"/python_"+a.formLabelAlign.name,s={code:r[a.formLabelAlign.language],mod:a.formLabelAlign.name,swagger:{definitions:{},paths:{"/python_hello":{post:{description:"Python测试API",parameters:[{description:"生成报告",in:"body",name:"data",required:!0,schema:{properties:{name:{description:"姓名",example:"shuwa",required:!0,type:"string"}},type:"object"}}],responses:{200:{description:"Returns operation status"},400:{description:"Bad Request"},401:{description:"Unauthorized"},403:{description:"Forbidden"},500:{description:"Server Internal error"}},summary:"Python测试API",tags:["EXPROTO"]}}},tags:[{description:"扩展编程",name:"EXPROTO"}]},type:a.formLabelAlign.language},!n){t.next=8;break}return t.next=6,Object(f["getExproto"])(s);case 6:i=t.sent,i?(a.apiDialog=!1,a.$message({type:"success",message:"新增api成功"}),a.getAllDict()):a.$message({type:"error",message:"新增api失败"+e});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},handleCurrentChange:function(e){var t=e.swagger,a=void 0===t?{}:t;this.itemSwagger=a,r=ace.edit("editor"),r.session.setMode("ace/mode/python"),r.setTheme("ace/theme/monokai"),r.setOptions({enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0}),r.setValue(Base64.decode(e.code)),r.gotoLine(r.session.getLength())},toggle:function(e){},getAllDict:function(){var e=this;return Object(l["a"])(u.a.mark((function t(){var a,n;return u.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(f["getExproto"])({type:"python",mod:"all",version:"debug"});case 2:a=t.sent,n=a.results,n&&(e.AllDict=n,e.AllDict.length&&e.handleCurrentChange(n[0]));case 5:case"end":return t.stop()}}),t)})))()},Industry:function(){var e=this;return Object(l["a"])(u.a.mark((function t(){var a,n,r;return u.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.option=[],a={limit:1e3,where:{"data.key":"category"}},t.next=4,Object(d["queryDict"])(a);case 4:n=t.sent,r=n.results,r.map((function(t){var a={};a.value=t.type,a.label=t.data.CategoryName,a.id=t.data.Id,a.parentid=t.data.SuperId,e.option.push(a)}));case 7:case"end":return t.stop()}}),t)})))()},getProDetail:function(e){var t=this;this.productId=e,r=ace.edit("editor"),r.session.setMode("ace/mode/erlang"),r.setTheme("ace/theme/monokai"),r.setOptions({enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0}),this.$get_object("Product",e).then((function(e){if(e){for(var a in t.productName=e.name,e)t.productdetail[a]=e[a];t.option.map((function(e){t.productdetail.category==e.value&&(t.productdetail.category=e.label)})),t.productdetail.createdAt=t.utc2beijing(e.createdAt),t.productdetail.id=e.id,t.dynamicReg=e.dynamicReg,t.productdetail.isshow=0,t.form.Productname=e.name,t.ProductSecret=e.productSecret,t.form.Productkey=t.productId,t.productimg=e.icon,e.decoder?(b=e.decoder.code,t.thingsParseModel.name=e.decoder.name,t.thingsParseModel.version=e.decoder.version,t.thingsParseModel.desc=e.decoder.desc):b="JSUlLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQolJSUgQGNvcHlyaWdodCAoQykgMjAxOCwgPHNodXdhPgolJSUgQGRvYwolJSUg5Y2P6K6u6Kej5p6QRGVtbwolJSUgQGVuZAolJSUgQ3JlYXRlZCA6IDA4LiDljYHkuIDmnIggMjAxOCAxNDo0OQolJSUtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi1tb2R1bGUoc2h1d2FfZGVtb19kZWNvZGVyKS4KLWF1dGhvcigic2h1d2EiKS4KLWRlZmluZShNU0dfVFlQRSwgPDwiREVNTyI+PikuCi1wcm90b2NvbChbPDwiREVNTyI+Pl0pLgoKLWV4cG9ydChbcGFyc2VfZnJhbWUvMiwgdG9fZnJhbWUvMV0pLgoKCnBhcnNlX2ZyYW1lKEJ1ZmYsIE9wdHMpIC0+CiAgICBwYXJzZV9mcmFtZShCdWZmLCBbXSwgT3B0cykuCgoKcGFyc2VfZnJhbWUoPDw+PiwgQWNjLCBfT3B0cykgLT4KICAgIHs8PD4+LCBBY2N9OwpwYXJzZV9mcmFtZSg8PDE2IzY4LCBSZXN0L2JpbmFyeT4+ID0gQmluLCBBY2MsIF9PcHRzKSB3aGVuIGJ5dGVfc2l6ZShSZXN0KSA9PCA2IC0+CiAgICB7QmluLCBBY2N9OwpwYXJzZV9mcmFtZSg8PDE2IzY4LCBMZW46MTYvbGl0dGxlLWludGVnZXIsIExlbjoxNi9saXR0bGUtaW50ZWdlciwgMTYjNjgsIFJlc3QvYmluYXJ5Pj4gPSBCaW4sIEFjYywgT3B0cykgLT4KICAgIGNhc2UgYnl0ZV9zaXplKFJlc3QpIC0gMiA+PSBMZW4gb2YKICAgICAgICB0cnVlIC0+CiAgICAgICAgICAgIGNhc2UgUmVzdCBvZgogICAgICAgICAgICAgICAgPDxVc2VyWm9uZTpMZW4vYnl0ZXMsIENyYzo4LCAxNiMxNiwgUmVzdDEvYmluYXJ5Pj4gLT4KICAgICAgICAgICAgICAgICAgICBBY2MxID0KICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBzaHV3YV91dGlsczpnZXRfcGFyaXR5KFVzZXJab25lKSA9Oj0gQ3JjIG9mCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnVlIC0+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRnJhbWUgPSAjewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8PCJtc2d0eXBlIj4+ID0+ID9NU0dfVFlQRSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPDwiZGF0YSI+PiA9PiBVc2VyWm9uZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQWNjICsrIFtGcmFtZV07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWxzZSAtPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFjYwogICAgICAgICAgICAgICAgICAgICAgICBlbmQsCiAgICAgICAgICAgICAgICAgICAgcGFyc2VfZnJhbWUoUmVzdDEsIEFjYzEsIE9wdHMpOwogICAgICAgICAgICAgICAgXyAtPgogICAgICAgICAgICAgICAgICAgIHBhcnNlX2ZyYW1lKFJlc3QsIEFjYywgT3B0cykKICAgICAgICAgICAgZW5kOwogICAgICAgIGZhbHNlIC0+CiAgICAgICAgICAgIHtCaW4sIEFjY30KICAgIGVuZDsKcGFyc2VfZnJhbWUoPDxfOjgsIFJlc3QvYmluYXJ5Pj4sIEFjYywgT3B0cykgLT4KICAgIHBhcnNlX2ZyYW1lKFJlc3QsIEFjYywgT3B0cykuCgoKJSUg57uE6KOF5oiQ5bCB5YyFLCDlj4LmlbDkuLpNYXDlvaLlvI8KdG9fZnJhbWUoI3s8PCJtc2d0eXBlIj4+IDo9ID9NU0dfVFlQRX0gPSBGcmFtZSkgLT4KICAgIFBheWxvYWQgPSB0ZXJtX3RvX2JpbmFyeShGcmFtZSksCiAgICA8PDE2IzAzLCBQYXlsb2FkL2JpbmFyeSwgMTYjMjM+Pi4=",t.productdetail.thing||(t.productdetail.thing={properties:[]}),t.wmxData=t.productdetail.thing.properties.filter((function(e){return e.name&&e.dataType})),r.setValue(Base64.decode(b)),r.gotoLine(r.session.getLength()),t.queryDeviceCount(t.productId)}}))},queryDeviceCount:function(e){var t=this;return Object(l["a"])(u.a.mark((function a(){return u.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(p["getDeviceCountByProduct"])(e);case 2:t.form.ProductAll=a.sent;case 3:case"end":return a.stop()}}),a)})))()},editordata:function(e){this.thingsParseModel.name=e.attributes.data.name,this.thingsParseModel.version=e.attributes.data.version,this.thingsParseModel.desc=e.attributes.data.desc,this.thingsParseModel.resource=e.attributes.data.enable,r.setValue(Base64.decode(e.attributes.data.code)),this.dialogTableVisible=!1},getAllunit:function(){var e=this;return Object(l["a"])(u.a.mark((function t(){var a,n;return u.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.allunit=[],t.next=3,Object(d["getAllunit"])("unit",100);case 3:a=t.sent,n=a.results,e.allunit=n.concat([]),e.allunit.unshift({data:{Name:"无",Symbol:""}});case 7:case"end":return t.stop()}}),t)})))()},subAce:function(e,t){var a=this;this.$refs[e].validate((function(n){if(n){var i={name:e.name,version:e.version,code:Base64.encode(r.getValue()),desc:e.desc},o={decoder:i};a.$update_object("Product",a.productId,o).then((function(e){0==a.issub&&(a.$message({type:"success",message:"保存成功"}),1==t&&(g+="保存成功",s.setValue(g))),a.issub=!0})).catch((function(e){}))}else a.$message({type:"warning",message:"输入格式有误"})}))},subAce1:function(e){var t=this;this.$refs[e].validate((function(e){if(e){var a={where:{"data.name":t.formInline.name,"data.version":t.formInline.version}};t.$query_object("Dict",a).then((function(e){e.results&&e.results.length>=1?t.$message("此协议版本已存在"):t.$get_object("Product",t.productId).then((function(e){if(e){var a={name:t.formInline.name,version:t.formInline.version,code:Base64.encode(r.getValue()),desc:t.formInline.desc},n={key:t.formInline.name+":"+t.formInline.version,type:"decoder",data:a,ACL:e.ACL};t.$create_object("Dict",n).then((function(e){e.error?t.$message({type:"error",message:e.error}):t.$message({type:"success",message:"保存到公共协议库成功"})})).catch((function(e){}))}}))})).catch((function(e){}))}else t.$message({type:"warning",message:"输入格式有误"})}))},decoderSizeChange:function(e){this.decoder.length=e,this.chaxun()},devicerCurrentChange:function(e){this.decoderstart=(e-1)*this.decoderlength,this.chaxun()},updateAllChannel:function(){var e=this;if(0==this.multipleSelection.length)this.protoldialog=!1;else{var t=[];this.multipleSelection.map((function(e){t.push(new Promise((function(t,a){return Object(h["subupadte"])(e.id,"update").then((function(e){e&&t(e)})).catch((function(e){a(e)}))})))})),Promise.all(t).then((function(t){e.$message({message:"热加载成功",type:"success"}),t.length==e.multipleSelection.length&&(e.protoldialog=!1)})).catch((function(t){e.$message({message:t,type:"error"})}))}},handleSelectionChange:function(e){this.multipleSelection=e},utc2beijing:function(e){var t=new Date(+new Date(e)+288e5).toISOString().replace(/T/g," ").replace(/\.[\d]{3}Z/,"");return t},getChannelEnable:function(e,t){return 1==e.row.attributes.isEnable?"green_active":"red_active"},deletedata:function(e){var t=this;this.$del_object("Dict",e).then((function(e){e&&(t.$message("成功删除"),t.chaxun())})).catch((function(e){}))},updatesubdialog:function(){var e=this;return Object(l["a"])(u.a.mark((function t(){var a,n;return u.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.protoldialog=!0,a="1",n={__type:"Pointer",className:"Product",objectId:e.productId},Object(m["getChannelCountByProduct"])(e.channellength,e.channelstart,n,a).then((function(t){e.protolchannel=t.results,e.$refs.multipleTable.toggleAllSelection()})).catch((function(t){e.$baseMessage("请求出错",t.error,3e3)}));case 4:case"end":return t.stop()}}),t)})))()},chaxun:function(){var e=this,t={count:"objectId",skip:this.decoderstart,limit:this.decoderlength,where:{type:"decoder"}};this.dialogTableVisible=!0,this.$query_object("Dict",t).then((function(t){t&&(e.decodertotal=t.count,e.gridData=t.results)})).catch((function(e){}))},protol:function(){var e=this,t="";Object(h["Compile"])(Base64.encode(r.getValue())).then((function(a){a&&(e.$message({type:"success",message:"编译成功"}),t="编译成功"+a.mod+"\r\n",e.warningeditror=a.warnings,e.warningeditror.map((function(e){t+=e+"\r\n"})),g+=t,s.setValue(g))})).catch((function(a){e.warningeditror=a.error,e.warningeditror.map((function(e){t+=e+"\r\n"})),g+=t,s.setValue(g)}))}}},y=v,_=(n("4cf9"),n("bdd7")),k=Object(_["a"])(y,i,o,!1,null,null,null);a["default"]=k.exports},"9ce3":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"menu dgiot-container"},[n("el-row",[n("el-col",{attrs:{lg:24,md:24,sm:2244,xl:24,xs:24}},[n("vab-query-form",[n("vab-query-form-top-panel",{attrs:{span:12}},[n("div",{staticClass:"search"},[n("el-button",{attrs:{icon:"el-icon-s-tools",size:"mini",type:"primary"},on:{click:function(t){return e.toggleExpandAll(e.isdefaultExpandAll)}}},[e._v(" "+e._s(e.$translateTitle("product.Expandcollapsemenu"))+" ")]),n("el-button",{attrs:{icon:"el-icon-plus",size:"mini",type:"info"},on:{click:function(t){return e.handleEdit({},"one")}}},[e._v(" "+e._s(e.$translateTitle("product.Newfirstlevelmenu"))+" ")]),n("el-button",{attrs:{icon:"el-icon-upload",size:"mini",type:"success"},on:{click:function(t){return e.centerUploadBox("Importmenu")}}},[e._v(" "+e._s(e.$translateTitle("product.Importmenu"))+" ")]),n("el-button",{attrs:{icon:"el-icon-upload",size:"mini",type:"warning"},on:{click:function(t){return e.centerUploadBox("Export")}}},[e._v(" "+e._s(e.$translateTitle("product.Export menu"))+" ")]),n("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"inputer",attrs:{id:"fileExport",type:"file",value:"上传菜单"},on:{change:e.handleFileChange}})],1)])],1),e.refreshTable?n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{border:"",data:e.treeData,"default-expand-all":e.isdefaultExpandAll,"default-sort":{prop:"order",order:"ascending"},height:e.tableHeight,"row-key":"objectId",size:"mini","tree-props":{children:"children",hasChildren:"hasChildren"}},scopedSlots:e._u([{key:"empty",fn:function(){return[n("el-image",{staticClass:"vab-data-empty",attrs:{src:a("c2ad")}})]},proxy:!0}],null,!1,3274295994)},[n("el-table-column",{attrs:{align:"center",fixed:"",label:e.$translateTitle("product.title"),width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("span",[e._v(" "+e._s(a.meta.title)+" ")])]}}],null,!1,1074967671)}),n("el-table-column",{attrs:{align:"center",label:e.$translateTitle("user.name"),prop:"name"}}),n("el-table-column",{attrs:{align:"center",label:e.$translateTitle("developer.path"),prop:"url","show-overflow-tooltip":"",width:"220"}}),n("el-table-column",{attrs:{align:"center",label:e.$translateTitle("menu.sort"),prop:"orderBy",sortable:""}}),n("el-table-column",{attrs:{align:"center",label:"vue "+e.$translateTitle("developer.filepath"),"show-overflow-tooltip":"",width:"400"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("span",[e._v(" "+e._s(a.meta.component)+" ")])]}}],null,!1,1940007160)}),n("el-table-column",{attrs:{align:"center",label:e.$translateTitle("developer.redirect"),"show-overflow-tooltip":"",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("span",[e._v(" "+e._s(a.meta.redirect)+" ")])]}}],null,!1,2214697965)}),n("el-table-column",{attrs:{align:"center",label:e.$translateTitle("task.Advancedconfiguration"),"show-overflow-tooltip":"",width:200},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("el-popover",{attrs:{placement:"top",trigger:"hover"}},[n("p",[e._v(" "+e._s(e.$translateTitle("product.Hideornot")+":")+" "),n("el-tag",{attrs:{title:e.$translateTitle("product.Hideornot"),type:"success"}},[e._v(" "+e._s(a.meta.hidden?e.$translateTitle("product.yes"):e.$translateTitle("product.no"))+" ")])],1),n("p",[e._v(" "+e._s(e.$translateTitle("product.Whetherthecurrentroutecanclosemultipletabs")+":")+" "),a.meta?n("el-tag",{attrs:{title:e.$translateTitle("product.Whetherthecurrentroutecanclosemultipletabs"),type:"info"}},[e._v(" "+e._s(a.meta.noClosable?e.$translateTitle("product.yes"):e.$translateTitle("product.no"))+" ")]):e._e()],1),n("p",[e._v(" "+e._s(e.$translateTitle("product.Nocache")+":")+" "),a.meta?n("el-tag",{attrs:{title:e.$translateTitle("product.Nocache")}},[e._v(" "+e._s(a.meta.noKeepAlive?e.$translateTitle("product.yes"):e.$translateTitle("product.no"))+" ")]):e._e()],1),n("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[n("el-tag",{attrs:{size:"medium"}},[a.meta.icon?n("vab-icon",{attrs:{icon:a.meta.icon}}):e._e()],1)],1)])]}}],null,!1,3320074286)}),n("el-table-column",{attrs:{align:"center",fixed:"right",label:e.$translateTitle("developer.operation"),width:"220px"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("el-button",{attrs:{icon:"el-icon-plus",size:"mini",title:e.$translateTitle("menu.childrenmenu"),type:"primary"},on:{click:function(t){return e.handleEdit(a,"addChildMenu")}}}),n("el-button",{attrs:{icon:"el-icon-edit",size:"mini",title:e.$translateTitle("developer.edit"),type:"success"},on:{click:function(t){return e.handleEdit(a,"editMenu")}}}),n("el-button",{attrs:{icon:"el-icon-delete",size:"mini",title:e.$translateTitle("developer.delete")+a.meta.title,type:"danger"},on:{click:function(t){return e.handleDelete(a)}}})]}}],null,!1,1290176477)})],1):e._e()],1)],1),n("edit",{ref:"edit",on:{"fetch-data":e.fetchData}})],1)},r=[],s=a("fb07"),i=a("d0d7"),o=a.n(i),l=(a("04d6"),a("a0e0"),a("3dec"),a("c4bc"),a("16b8"),a("1d17"),a("37c6"),a("1c6f"),a("3de5"),a("f1e1"),a("4f20")),c=a("ed08"),u=a("bc35"),d=a("0af3"),p={name:"TreeTableDemo",components:{Edit:l["default"]},data:function(){return{tableHeight:this.$baseTableHeight(0)+46,refreshTable:"false",isdefaultExpandAll:!1,MenuForm:{name:"",url:"",roles:[],number:"",fathername:[]},list:[],listLoading:!0,data:[],defaultProps:{children:"children",label:"label"},props:{value:"objectId",label:"name",children:"children"},options:[],formLabelWidth:"120px",defaultExpandAll:!0,showCheckbox:!0,key:1,columns:[{label:"Menu name",key:"name",expand:!0,align:"left"},{label:"Menu path",key:"url",width:200,expand:!0,align:"center"},{label:"Navigation",key:"showtopmenu",expand:!0,align:"center"},{label:"Index",key:"number",expand:!0,width:100},{label:"Icon",key:"icon",expand:!0,width:100},{label:"Created time",key:"createtime",align:"center"},{label:"Operation",key:"operation",width:400}],search:"",dialogVisible:!1,tableData:[],form:{name:"",resource:"菜单",topname:"",menuroad:"",iconfont:"",number:""},parent:"",current:"",parentmenu:[{id:"0",attributes:{name:"顶级菜单"}}],originacl:[],menuid:"",originmenuurl:[],isaddmenu:!0,file:"",inputDOM:"",size:"",formData:""}},computed:{treeData:function(){var e=JSON.parse(JSON.stringify(this.data)),t=[];return t=e.filter((function(t){var a=e.filter((function(e){return t.objectId==e.parent}));return a.length>0&&(t.children=a),0==t.parent&&(t.parent="0"),0==t.parent})),t}},watch:{showCheckbox:function(e){e?this.columns.unshift({label:"Checkbox",checkbox:!0}):this.columns.shift(),this.reset()}},mounted:function(){this.fetchData(),this.originmenuurl=[],this.getoriginmenu(this.$router.options.routes),this.getRole()},methods:{toggleExpandAll:function(e){var t=this;this.refreshTable=!1,this.isdefaultExpandAll=!e,this.$nextTick((function(){t.refreshTable=!0}))},handleNodeClick:function(){this.fetchData()},getRole:function(){var e=this;Object(u["queryMenu"])({}).then((function(t){t.results.map((function(t){var a={};a.objectId=t.objectId,a.alias=t.alias,a.name=t.name,e.options.push(a)}))}))},SelectTopmenu:function(e){},getoriginmenu:function(e){var t=this;e.map((function(e){if(!e.hidden&&e.path){if("/"!=e.path){var a={};a.path=e.path,a.name=e.name,t.originmenuurl.push(a)}e.children&&t.getoriginmenu(e.children)}}))},centerUploadBox:function(e){"Importmenu"==e?this.$refs.inputer.click():this.exportMenu()},exportMenu:function(){var e=this;return Object(s["a"])(o.a.mark((function t(){var a,n;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.$baseColorfullLoading(2),t.prev=1,t.next=4,Object(d["ExportParse"])("Menu",{});case 4:n=t.sent,a.close(),e.$convertRes2Blob(n),t.next=13;break;case 9:t.prev=9,t.t0=t["catch"](1),a.close(),e.$message.error("".concat(t.t0));case 13:a.close();case 14:case"end":return t.stop()}}),t,null,[[1,9]])})))()},handleFileChange:function(e){var t=this;return Object(s["a"])(o.a.mark((function e(){var a;return o.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.inputDOM=t.$refs.inputer,/\.zip$/.test(t.inputDOM.files[0].name)){e.next=6;break}return t.$message({type:"warning",message:"仅支持zip文件"}),e.abrupt("return",!1);case 6:return t.file=t.inputDOM.files[0],a=t.$baseColorfullLoading(3),e.prev=8,e.next=11,Object(d["ImportParse"])("Menu",t.file);case 11:e.sent,a.close(),t.$message.success(""),t.$message({type:"success",message:"菜单导入成功"}),setTimeout((function(){t.file="",t.inputDOM="",t.size="",t.formData="",t.fetchData()}),1500),e.next=23;break;case 18:e.prev=18,e.t0=e["catch"](8),a.close(),t.$message({type:"error",message:"菜单导入失败"+e.t0}),t.$message.error("".concat(e.t0));case 23:a.close();case 24:case"end":return e.stop()}}),e,null,[[8,18]])})))()},reset:function(){++this.key},click:function(e){var t=e.row,a=Object.keys(t).map((function(e){return"<p>".concat(e,": ").concat(t[e],"</p>")})).join("");this.$notify({title:"Success",dangerouslyUseHTMLString:!0,message:a,type:"success"})},getParent:function(e,t,a){var n=this;return e.map((function(r){r.objectId==t?(a.push(r.objectId),n.getParent(e,r.parent,a)):0==r.parent&&r.objectId==t&&a.push(r.objectId)})),a.length>=1&&0!=a[0]&&a.unshift("0"),a},handleDelete:function(e){var t=this;e.children?this.$message({type:"warning",message:"请先删除此菜单中的子菜单!"}):this.$del_object("Menu",e.objectId).then((function(e){e.error?t.$message({type:"error",message:"删除失败!"}):(t.$message({type:"success",message:"删除成功!"}),t.fetchData())}))},searchvalue:function(){},handleClose:function(){this.dialogVisible=!1},handleEdit:function(e,t){this.$refs["edit"].showEdit(e,t)},fetchData:function(){var e=this;return Object(s["a"])(o.a.mark((function t(){var a,n;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.data=[],e.listLoading=!0,t.next=4,Object(u["queryMenu"])({});case 4:a=t.sent,n=a.results,n.map((function(t){var a=t.meta,n=void 0===a?{}:a,r=t.name,s=t.objectId,i=t.icon,o=t.parent,l=t.createdAt,u=t.orderBy,d=t.url,p={};p.name=r,p.meta=n,p.objectId=s,p.icon=i,p.parent=o.objectId,p.createtime=Object(c["utc2beijing"])(l),p.orderBy=u,p.url=d,e.data.push(p)})),e.listLoading=!1;case 8:case"end":return t.stop()}}),t)})))()}}},m=p,f=(a("6d7c"),a("bdd7")),h=Object(f["a"])(m,n,r,!1,null,"6af1774e",null);t["default"]=h.exports},a044:function(e,t,a){},a129:function(e,t,a){"use strict";a("059e")},a12c:function(e,t,a){"use strict";a("d621")},aaa8:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"departmentforuser"},[e._v("岗位管理")])},r=[],s={data:function(){return{}},mounted:function(){},methods:{}},i=s,o=a("bdd7"),l=Object(o["a"])(i,n,r,!1,null,"290543ff",null);t["default"]=l.exports},ac2f:function(e,t,a){"use strict";a("7cc2")},b250:function(e,t,a){"use strict";a("9559")},b8b3:function(e,t,a){},b9867:function(e,t,a){"use strict";a("706e")},b9b9:function(e,t,a){"use strict";a("0076")},bb1d:function(e,t,a){"use strict";a("e6b5")},c0a3:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"modules"},[a("el-dialog",{attrs:{"append-to-body":!0,title:"修改物模型",visible:e.edit_module,width:"17%"},on:{"update:visible":function(t){e.edit_module=t}}},[a("el-form",{ref:"editForm",staticClass:"demo-editForm",attrs:{"label-width":"100px",model:e.editForm,rules:e.rules}},[a("el-form-item",{attrs:{label:"产品名称",prop:"name"}},[a("el-input",{model:{value:e.editForm.name,callback:function(t){e.$set(e.editForm,"name",t)},expression:"editForm.name"}})],1),a("el-form-item",{attrs:{label:"产品类型",prop:"devType"}},[a("el-input",{model:{value:e.editForm.devType,callback:function(t){e.$set(e.editForm,"devType",t)},expression:"editForm.devType"}})],1),a("el-form-item",{attrs:{label:"所属分类",prop:"category"}},[a("el-cascader",{attrs:{options:e.categoryListOptions},model:{value:e.editForm.category,callback:function(t){e.$set(e.editForm,"category",t)},expression:"editForm.category"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.editPostForm("editForm")}}},[e._v(" 修改 ")]),a("el-button",{on:{click:function(t){return e.resetForm("editForm")}}},[e._v("重置")])],1)],1),a("el-dialog",{attrs:{"append-to-body":!0,title:"新增物模型",visible:e.add_module,width:"17%"},on:{"update:visible":function(t){e.add_module=t}}},[a("el-form",{ref:"moduleForm",staticClass:"demo-moduleForm",attrs:{"label-width":"100px",model:e.moduleForm,rules:e.rules}},[a("el-form-item",{attrs:{label:"产品名称",prop:"name"}},[a("el-input",{model:{value:e.moduleForm.name,callback:function(t){e.$set(e.moduleForm,"name",t)},expression:"moduleForm.name"}})],1),a("el-form-item",{attrs:{label:"产品类型",prop:"devType"}},[a("el-input",{model:{value:e.moduleForm.devType,callback:function(t){e.$set(e.moduleForm,"devType",t)},expression:"moduleForm.devType"}})],1),a("el-form-item",{attrs:{label:"所属分类",prop:"category"}},[a("el-cascader",{attrs:{options:e.categoryListOptions},model:{value:e.moduleForm.category,callback:function(t){e.$set(e.moduleForm,"category",t)},expression:"moduleForm.category"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.submitForm("moduleForm")}}},[e._v(" 立即创建 ")]),a("el-button",{on:{click:function(t){return e.resetForm("moduleForm")}}},[e._v("重置")])],1)],1),a("header",[a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:20}},[a("el-button",{attrs:{icon:"el-icon-plus",size:"mini",type:"primary"},on:{click:function(t){e.add_module=!0}}},[e._v(" 新增 ")])],1),a("el-col",{attrs:{span:4}},[a("el-input",{attrs:{placeholder:"请输入产品名称",size:"mini"},model:{value:e.searchText,callback:function(t){e.searchText=t},expression:"searchText"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search",size:"mini",type:"primary"},on:{click:function(t){return e.searchModule(e.searchText)}},slot:"append"},[e._v(" 搜索 ")])],1)],1)],1)],1),a("center",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.pictLoading,expression:"pictLoading"}],staticStyle:{width:"100%","min-height":"583px"},attrs:{data:e.tableData.filter((function(t){return!e.search||t.name.toLowerCase().includes(e.search.toLowerCase())})),"element-loading-background":"rgba(0, 0, 0, 0.5)","element-loading-spinner":"el-icon-loading","element-loading-text":"数据正在加载中","max-height":"583"}},[a("el-table-column",{attrs:{label:"objectId",prop:"objectId"}}),a("el-table-column",{attrs:{label:"产品名称"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.data.name)+" ")]}}])}),a("el-table-column",{attrs:{label:"产品类型"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.data.devType)+" ")]}}])}),a("el-table-column",{attrs:{label:"key",prop:"key"}}),a("el-table-column",{attrs:{label:"所属分类"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.data.category)+" ")]}}])}),a("el-table-column",{attrs:{align:"right"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("el-input",{attrs:{placeholder:"输入关键字搜索",size:"mini"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]}},{key:"default",fn:function(t){var n=t.row;return[a("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.handleEdit(n.$index,n)}}},[e._v(" 修改 ")]),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleDelete(n.$index,n.tableData)}}},[e._v(" 删除 ")])]}}])})],1)],1),a("footer",[a("el-pagination",{attrs:{"current-page":e.currentPage,layout:"total, sizes, prev, pager, next, jumper","page-size":10,"page-sizes":[10,20,50,100],total:e.pageTotal},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1),e._v(" Parse ")],1)},r=[],s=a("fb07"),i=(a("04d6"),a("a0e0"),a("3dec"),a("c4bc"),a("16b8"),a("e170"),a("d0d7")),o=a.n(i),l=a("e0e9"),c=a("7212"),u=a("7497"),d={name:"Modules",components:{},data:function(){return{productObj:[],pictLoading:!1,categoryListOptions:[],limit:10,skip:0,add_module:!1,edit_module:!1,searchText:"",hashkey:"",categoryList:[],infoData:"物模型管理",currentPage:1,pageTotal:0,tableData:[],search:"",editForm:{name:"物模型管理",devType:"物模型管理",category:"",type:"Product"},moduleForm:{name:"物模型管理",devType:"物模型管理",category:"",type:"Product"},rules:{name:[{required:!0,message:"请输入产品名称",trigger:"blur"}],devType:[{required:!0,message:"请输入产品类型",trigger:"blur"}],category:[{required:!0,message:"请选择模型所属分类",trigger:"blur"}]}}},computed:{},mounted:function(){this.searchModule(""),this.Industry()},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){},methods:{getProduct:function(){var e=this;return Object(s["a"])(o.a.mark((function t(){var a,n;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(c["queryProduct"])();case 2:a=t.sent,n=a.results,n&&(e.productObj=n);case 5:case"end":return t.stop()}}),t)})))()},treeData:function(e){var t=JSON.parse(JSON.stringify(e));return t.filter((function(e){var a=t.filter((function(t){return e.id==t.parentid}));return a.length>0&&(e.children=a),0==e.parentid}))},Industry:function(){var e=this;this.categoryList=[],this.getProduct();var t={limit:10,where:{"data.key":"category"}};this.$query_object("Dict",t).then((function(t){t.results&&(t.results.map((function(t){var a={};a.value=t.type,a.label=t.data.CategoryName,a.id=t.data.Id,a.parentid=t.data.SuperId,e.categoryList.push(a)})),e.categoryListOptions=e.treeData(e.categoryList))})).catch((function(e){}))},blackDict:function(e,t,a){var n=this;return Object(s["a"])(o.a.mark((function r(){var s,i;return o.a.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return s={data:t,key:e,type:a},r.next=3,Object(l["postDict"])(s);case 3:i=r.sent,i?(n.$message({type:"success",message:"新建物模型成功"}),n.add_module=!1,n.searchModule("")):n.$message({type:"error",message:"新建物模型失败"});case 5:case"end":return r.stop()}}),r)})))()},submitForm:function(e){var t=this;this.$refs[e].validate(function(){var e=Object(s["a"])(o.a.mark((function e(a){var n,r,s,i;return o.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!a){e.next=8;break}return n={category:t.moduleForm.category[0],devType:t.moduleForm.devType,name:t.moduleForm.name},e.next=4,Object(u["getHashClass"])("Product",n);case 4:r=e.sent,s=r.objectId,i=r.code,200==i&&t.blackDict(s,n,t.moduleForm.type);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},resetForm:function(e){this.$refs[e].resetFields()},searchModule:function(e){var t=this;return Object(s["a"])(o.a.mark((function a(){var n,r,s,i,c;return o.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.pictLoading=!0,n=e.length?{order:"-createdAt",count:"objectId",limit:t.limit,skip:t.skip,where:{type:"Module",key:{$regex:"".concat(e)}}}:{order:"-createdAt",count:"objectId",limit:t.limit,skip:t.skip,where:{type:"Product"}},a.next=4,Object(l["getDictCount"])(n);case 4:r=a.sent,s=r.results,i=r.count,c=void 0===i?0:i,t.pictLoading=!1,s&&(t.tableData=s,t.pageTotal=c);case 10:case"end":return a.stop()}}),a)})))()},handleSizeChange:function(e){this.limit=e,this.searchModule(this.searchText)},handleCurrentChange:function(e){this.skip=this.limit*(e-1),this.searchModule(this.searchText)},handleEdit:function(e,t){this.edit_module=!0,this.editForm=t.data},editPostForm:function(e){},handleDelete:function(e,t,a){var n=this;return Object(s["a"])(o.a.mark((function r(){var s;return o.a.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,Object(l["delDict"])(t.objectId);case 2:s=r.sent,s?(a.splice(e,1),n.$message({type:"success",message:"删除成功"})):n.$message({type:"error",message:"删除失败"});case 4:case"end":return r.stop()}}),r)})))()}}},p=d,m=(a("1c12"),a("bdd7")),f=Object(m["a"])(p,n,r,!1,null,"52c3d06e",null);t["default"]=f.exports},cbcb:function(e,t,a){},cc5a:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"license"},[a("div",{staticClass:"licenseleft"},[a("el-row",[a("el-col",{attrs:{span:12}},[0==e.isend?a("img",{attrs:{alt:"",src:e.originimgsrc,srcset:""}}):e._e(),1==e.isend?a("img",{attrs:{alt:"",src:e.originimgsrc,srcset:""}}):e._e()]),a("el-col",{attrs:{span:12}},[0==e.isend?a("div",{staticClass:"originupdate"},[a("p",[e._v("部署配置")]),a("span",[e._v("请完成配置后进行部署")])]):e._e()])],1),a("el-row",{staticStyle:{"margin-top":"50px"}},[a("el-col",{staticClass:"originupdate",attrs:{span:12}},[a("p",[e._v("当前时间:")]),a("span",[e._v(e._s(e.updatetime))])]),a("el-col",{staticClass:"originupdate",attrs:{span:12}},[a("p",[e._v("服务器状态")]),0==e.isarrange?a("span",[e._v("未部署")]):a("span",[e._v("部署完成")])])],1)],1),a("div",{staticClass:"licenseright"},[a("div",{staticClass:"righttop"},[a("p",{staticStyle:{"font-size":"20px"}},[e._v("部署进度")]),a("el-steps",{attrs:{active:e.active,"finish-status":"success"}},[a("el-step",{attrs:{title:"基础服务部署"}}),a("el-step",{attrs:{title:"数据库部署"}}),a("el-step",{attrs:{title:"完成"}})],1)],1),a("div",{staticClass:"rightcenter"},[a("p",{staticStyle:{"font-size":"20px",color:"#67c23a"}},[e._v("机器信息")]),a("el-form",{ref:"form",attrs:{"label-width":"140px",model:e.configdata}},[a("el-form-item",{attrs:{label:"用户名:"}},[a("span",[e._v(e._s(e.configdata.hostName))])]),a("el-form-item",{attrs:{label:"计算机信息:"}},[a("span",[e._v(e._s(e.configdata.computerConfig))])]),a("el-form-item",{attrs:{label:"IP地址(公):"}},[a("span",[e._v(e._s(e.configdata.wlanIp))])]),a("el-form-item",{attrs:{label:"IP地址(私):"}},[a("span",[e._v(e._s(e.configdata.natIP))])]),a("el-form-item",{attrs:{label:"授权状态:"}},[a("span",[e._v(e._s(e.configdata.computerAuth))])]),a("el-form-item",{attrs:{label:"服务器连接状态:"}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:e.value2,callback:function(t){e.value2=t},expression:"value2"}})],1),a("el-form-item",{attrs:{label:"数据库是否部署:"}},[1==e.configdata.dbInstalled?a("span",[e._v("是")]):a("span",[e._v("否")])]),a("el-form-item",{attrs:{label:"机器码:"}},[a("span",[e._v(e._s(e.configdata.computerKey))])]),a("el-form-item",{attrs:{label:"数据中心地址:"}},[a("el-input",{attrs:{placeholder:"请输入数据中心地址"},model:{value:e.configdata.infomation,callback:function(t){e.$set(e.configdata,"infomation",t)},expression:"configdata.infomation"}})],1),a("el-form-item",{attrs:{label:"授权码:"}},[a("el-input",{attrs:{placeholder:"请输入授权码"},model:{value:e.configdata.authorizenumber,callback:function(t){e.$set(e.configdata,"authorizenumber",t)},expression:"configdata.authorizenumber"}})],1),a("el-form-item",{attrs:{label:"服务版本:"}},[a("el-select",{attrs:{placeholder:"请输入服务版本"},model:{value:e.configdata.standard,callback:function(t){e.$set(e.configdata,"standard",t)},expression:"configdata.standard"}},[a("el-option",{attrs:{label:"标准版",value:"standard"}}),a("el-option",{attrs:{label:"企业版",value:"enterprise"}}),a("el-option",{attrs:{label:"旗舰版",value:"ultimate"}})],1)],1),a("el-form-item",[e.dbinstall?a("el-button",{staticStyle:{"margin-right":"100px"},attrs:{type:"success"},on:{click:e.uploadHub}},[e._v(" 部 署 ")]):a("el-button",{staticStyle:{"margin-right":"100px"},attrs:{type:"success"},on:{click:e.uploadDb}},[e._v(" 数据库部署 ")]),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.update.apply(null,arguments)}}},[e._v("刷新")])],1)],1)],1)])])},r=[],s=a("1c4e"),i=a("be65"),o=a.n(i),l={data:function(){return{value2:!1,isarrange:!1,isend:!1,timer:null,updatetime:"",active:1,authorizenumber:"",dbinstall:!0,configdata:{computerAuth:"",natIP:"",wlanIp:"",computerKey:"",computerConfig:"",hostName:"",infomation:"localhost",standard:"standard",authorizenumber:"",dbInstalled:""},standard:"standard"}},mounted:function(){window.clearInterval(this.timer),this.timeUpdate(),this.getHardInfo(),o.a.get("authorizenumber")?this.configdata.authorizenumber=o.a.get("authorizenumber"):this.configdata.authorizenumber=""},beforeDestroy:function(){window.clearInterval(this.timer),this.timer=null},methods:{nowtime:function(){var e=Date.parse(new Date),t=new Date(e),a=t.getFullYear()+"-",n=(t.getMonth()+1<=10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-",r=(t.getDate()+1<=10?"0"+t.getDate():t.getDate())+" ",s=(t.getHours()+1<=10?"0"+t.getHours():t.getHours())+":",i=(t.getMinutes()+1<=10?"0"+t.getMinutes():t.getMinutes())+":",o=t.getSeconds()+1<=10?"0"+t.getSeconds():t.getSeconds();this.updatetime=a+n+r+s+i+o},timeUpdate:function(){var e=this;e.timer=window.setInterval((function(){e.nowtime()}),1e3)},getHardInfo:function(){var e=this;Object(s["hardInfo"])().then((function(t){e.configdata.computerAuth=t.computerAuth,e.configdata.natIP=t.natIP,e.configdata.wlanIp=t.wlanIp,e.configdata.computerKey=t.computerKey,e.configdata.hostName=t.hostName,e.configdata.computerConfig=t.computerConfig,e.configdata.dbInstalled=t.dbInstalled,e.value2=t.serverHealth}))},uploadHub:function(){var e=this;""!=this.configdata.infomation?""!=this.configdata.authorizenumber?Object(s["iotHub"])(this.configdata.standard,this.configdata.authorizenumber,this.configdata.infomation).then((function(t){if(1==t.result)e.active=3,e.$router.push("/login");else{if("license_failed"==t.status)return void e.$message("授权码错误，请重新填写");if("server_disconnected"==t.status)return void e.$message("服务器未连接");"database_uninstalled"==t.status&&(e.active=2,e.$message("服务器部署完成，请完成下一步数据库部署"),e.dbinstall=!1,o.a.set("authorizenumber",e.configdata.authorizenumber))}})):this.$message("请填写授权码"):this.$message("请填写数据中心地址")},uploadDb:function(){}}},c=l,u=(a("ac2f"),a("bdd7")),d=Object(u["a"])(c,n,r,!1,null,"2b5a2dfa",null);t["default"]=d.exports},d621:function(e,t,a){},e332:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"department department-container"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("el-table",{attrs:{border:"",data:e.roletempList,"highlight-current-row":"","row-class-name":e.tableRowClassName,"row-style":e.selectedHighlight,size:"small"},on:{"row-click":e.getDetailmenu}},[a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("user.name")},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(n.data.name))]),a("span",[e._v("( "+e._s(n.key)+" )")])]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("developer.operation"),width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return t.stopPropagation(),e.exportRoletemp(n)}}},[e._v(" "+e._s(e.$translateTitle("equipment.Updatetemplate"))+" ")]),a("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(t){return t.stopPropagation(),e.handleDelete(e.scope.$index,n.roletempList)}}},[e._v(" "+e._s(e.$translateTitle("task.Delete"))+" ")])]}}])})],1)],1),a("el-col",{attrs:{span:9}},[a("el-col",{attrs:{span:12}},[a("div",{staticClass:"footerleft"},[a("p",{staticClass:"top"},[a("span",{staticClass:"svg-container"},[a("vab-icon",{attrs:{icon:"role_group"}})],1),a("span",[e._v(" "+e._s(e.$translateTitle("user.assignroles1"))+" ")])]),a("div",[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.expand("permissionTree","isExpand")}}},[e.isExpand?a("span",[e._v(e._s(e.$translateTitle("button.fold")))]):a("span",[e._v(" "+e._s(e.$translateTitle("button.Unfold"))+" ")])]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.checkAll("permissionTree","permissionTreeData")}}},[e._v(" "+e._s(e.$translateTitle("button.select all"))+" ")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.inverse("permissionTree","permissionTreeData")}}},[e._v(" "+e._s(e.$translateTitle("button.Reverse election"))+" ")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.checkNot("permissionTree")}}},[e._v(" "+e._s(e.$translateTitle("button.unselect all"))+" ")])],1),a("div",{staticClass:"rolecontrol"},[a("el-tree",{ref:"permissionTree",attrs:{accordion:"","check-on-click-node":"",data:e.permissionTreeData,"default-checked-keys":e.rolePermissonList,"default-expand-all":e.isExpand,"default-props":"","expand-on-click-node":!1,"node-key":"name","show-checkbox":""},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.node;return a("span",{staticClass:"custom-tree-node"},[a("span",[e._v(e._s(n.label))])])}}])})],1)])]),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"footerright"},[a("p",{staticClass:"top"},[a("span",{staticClass:"svg-container"},[a("vab-icon",{attrs:{icon:"menu_group"}})],1),a("span",[e._v(" "+e._s(e.$translateTitle("user.assignmenu"))+" ")])]),a("div",[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.expand("menusTree","menuExpand")}}},[e.menuExpand?a("span",[e._v(e._s(e.$translateTitle("button.fold")))]):a("span",[e._v(" "+e._s(e.$translateTitle("button.Unfold"))+" ")])]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.checkAll("menusTree","menuTreeData")}}},[e._v(" "+e._s(e.$translateTitle("button.select all"))+" ")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.inverse("menusTree","menuTreeData")}}},[e._v(" "+e._s(e.$translateTitle("button.Reverse election"))+" ")]),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.checkNot("menusTree")}}},[e._v(" "+e._s(e.$translateTitle("button.unselect all"))+" ")])],1),a("div",{staticClass:"menucontrol"},[a("el-tree",{ref:"menusTree",attrs:{accordion:"","check-on-click-node":"",data:e.menuTreeData,"default-checked-keys":e.roleMenuList,"default-expand-all":e.menuExpand,"default-props":"","expand-on-click-node":!1,"node-key":"objectId","show-checkbox":""},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.node,r=t.data;return a("span",{staticClass:"custom-tree-node"},[e._v(" "+e._s(r.title?r.title:n.label)+" ")])}}])})],1)])])],1),a("el-col",{attrs:{span:9}},[a("div",{staticClass:"footerleft2"},[a("p",{staticClass:"top"},[a("span",{staticClass:"svg-container"},[a("vab-icon",{attrs:{icon:"role_group"}})],1),a("span",[e._v(" "+e._s(e.$translateTitle("user.labelinformation"))+" ")])])]),a("div",{staticClass:"tags"},[a("el-form",{ref:"form",attrs:{"label-width":"170px",model:e.form,rules:e.Rule}},[a("el-form-item",{attrs:{label:e.$translateTitle("application.Accesskey")}},[a("el-input",{staticStyle:{width:"80%"},attrs:{readonly:""},model:{value:e.form.secret,callback:function(t){e.$set(e.form,"secret",t)},expression:"form.secret"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-refresh-right"},on:{click:e.handleClickRefresh},slot:"append"})],1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("application.tokeneffectivetime")}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placheholder:e.$translateTitle("product.enterapptime"),type:"number"},model:{value:e.form.expires,callback:function(t){e.$set(e.form,"expires",t)},expression:"form.expires"}}),a("span",{staticStyle:{"margin-left":"5px"}},[e._v(" "+e._s(e.$translateTitle("task.Seconds"))+" ")])],1),a("el-form-item",{attrs:{label:e.$translateTitle("product.Wordpreviewserver")}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placheholder:e.$translateTitle("product.enter1")+e.$translateTitle("product.Wordpreviewserver")},model:{value:e.form.wordpreview,callback:function(t){e.$set(e.form,"wordpreview",t)},expression:"form.wordpreview"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("product.Wordproductionserver")}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placheholder:e.$translateTitle("product.enter1")+e.$translateTitle("product.Wordproductionserver")},model:{value:e.form.wordproduct,callback:function(t){e.$set(e.form,"wordproduct",t)},expression:"form.wordproduct"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("application.fileresources"),prop:"file"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placheholder:e.$translateTitle("product.enter1")+"url"},model:{value:e.form.file,callback:function(t){e.$set(e.form,"file",t)},expression:"form.file"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("application.Configurationresources"),prop:"topo"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placheholder:e.$translateTitle("product.enter1")+"url"},model:{value:e.form.topo,callback:function(t){e.$set(e.form,"topo",t)},expression:"form.topo"}})],1),a("el-form-item",{attrs:{label:"Graphql API",prop:"graphql"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placheholder:e.$translateTitle("product.enter1")+"url"},model:{value:e.form.graphql,callback:function(t){e.$set(e.form,"graphql",t)},expression:"form.graphql"}})],1),a("el-form-item",{attrs:{label:"Restful API",prop:"rest"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placheholder:e.$translateTitle("product.enter1")+"url"},model:{value:e.form.rest,callback:function(t){e.$set(e.form,"rest",t)},expression:"form.rest"}})],1),a("el-form-item",{attrs:{label:"home"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placheholder:e.$translateTitle("product.enter1")+e.$translateTitle("developer.path")},model:{value:e.form.home,callback:function(t){e.$set(e.form,"home",t)},expression:"form.home"}})],1)],1)],1)])],1)],1)},r=[],s=a("4490"),i=a("fb07"),o=a("d0d7"),l=a.n(o),c=(a("1d17"),a("37c6"),a("a0e0"),a("3dec"),a("9c6a"),a("04d6"),a("d6a4"),a("c4bc"),a("16b8"),a("0efa"),a("0c40"),a("79da"),a("e170"),a("e0e9")),u=a("1ec2"),d=a("bc35"),p={name:"Department",components:{},data:function(){var e=function(e,t,a){var n=/^(((ht|f)tps?):\/\/)?[\w-]+(\.[\w-]+)+([\w.,@?^=%&:/~+#-]*[\w@?^=%&/~+#-])?$/;""===t||null===t?a(new Error("请输入url地址")):n.test(t)?a():a(new Error("请输入正确的url地址"))};return{Rule:{desc:[{required:!0,message:"请输入应用名称",trigger:"blur"},{validator:function(e,t,a){0===t.length?a(new Error("应用名称不能为空")):a()}}],file:[{trigger:"blur",validator:e}],topo:[{trigger:"blur",validator:e}],graphql:[{trigger:"blur",validator:e}],rest:[{trigger:"blur",validator:e}]},form:{file:"http://127.0.0.1:1250/shapes/upload",rest:"http://127.0.0.1:5080/iotapi",topo:"http://127.0.0.1:1350/",expires:18e3,wordpreview:"http://pump.iotn2n.com:8012",wordproduct:"http://pump.iotn2n.com/",graphql:"http://127.0.0.1:5080/graphql",secret:"RTc3MDk4MTgxNjAzMTc1MTUxMDY0",home:"E:/shuwa/4.1.0/shuwa_data_center/datacenter/file/files"},isExpand:!1,menuExpand:!1,roletempList:[],dataMenus:[],roleMenuList:[],dataPermissions:[],rolePermissonList:[]}},computed:{permissionTreeData:function(){var e=this;return this.dataPermissions.filter((function(t){var a=[];return e.dataPermissions.forEach((function(e){t.objectId==e.parentId&&a.push(e)})),a.length>0&&(t.children=a),0==t.parentId}))},menuTreeData:function(){var e=JSON.parse(JSON.stringify(this.dataMenus));return e.filter((function(t){t.title=t.meta&&t.meta.title?t.meta.title:"";var a=e.filter((function(e){return t.objectId==e.parentId}));return a.length>0&&(t.children=a),0==t.parentId}))}},mounted:function(){this.gettable(),this.getMenu(),this.getRoleschema()},methods:{expand:function(e,t){this[t]=!this[t];var a=this.$refs[e].store._getAllNodes();for(var n in a)a[n].expanded=this[t]},checkAll:function(e,t){this.$refs[e].setCheckedNodes(this[t])},inverse:function(e,t){var a=this.$refs[e],n=a.getCheckedNodes(!0,!0);this.batchSelect(this[t],a,!0,n)},checkNot:function(e){this.$refs[e].setCheckedKeys([])},batchSelect:function(e,t,a,n){"undefined"!=typeof e&&e.forEach((function(e){t.setChecked(e,a,!0)})),"undefined"!=typeof n&&n.forEach((function(e){t.setChecked(e,!a,!0)}))},handleClickRefresh:function(){var e=Math.ceil(25*Math.random());this.form.secret=Base64.encode(String.fromCharCode(65+e)+Math.ceil(1e7*Math.random())+Number(new Date))},getMenu:function(){var e=this;return Object(i["a"])(l.a.mark((function t(){var a,n;return l.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.data=[],e.dataMenus=[],t.next=4,Object(d["queryMenu"])({});case 4:a=t.sent,n=a.results,n&&(e.menuListRes=n,n.map((function(t){var a={};a.label=t.name,a.meta=t.meta,a.objectId=t.objectId,a.parentId=t.parent.objectId,a.createtime=new Date(t.createdAt).toLocaleDateString(),e.data.push(a),e.dataMenus.push(a)})));case 7:case"end":return t.stop()}}),t)})))()},gettable:function(){var e=this;return Object(i["a"])(l.a.mark((function t(){var a,n;return l.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(c["queryDict"])({where:{type:"roletemp"}});case 2:a=t.sent,n=a.results,n&&(e.roletempList=n);case 5:case"end":return t.stop()}}),t)})))()},getRoleschema:function(){var e=this;return Object(i["a"])(l.a.mark((function t(){var a,n;return l.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.dataPermissions=[],t.next=3,Object(u["queryPermission"])({});case 3:a=t.sent,n=a.results,n&&(e.permissionListRes=n,n.map((function(t){var a={};a.label=t.alias,a.name=t.name,a.objectId=t.objectId,a.parentId=t.parent.objectId,a.createtime=new Date(t.createdAt).toLocaleDateString(),e.dataPermissions.push(a)})));case 6:case"end":return t.stop()}}),t)})))()},tableRowClassName:function(e){var t=e.row,a=e.rowIndex;t.index=a},selectedHighlight:function(e){e.row;var t=e.rowIndex;if(this.currentSelectIndex===t)return{color:"#409EFF","font-weight":"bold"}},getDetailmenu:function(e,t,a,n){e.data.tag&&e.data.tag.appconfig?this.form=e.data.tag.appconfig:this.handleClickRefresh(),t&&"操作"==t.label||(this.currentSelectIndex=e.index,this.doSetChecked(e.data.menus,e.data.rules))},doSetChecked:function(e,t){var a=this;this.roleMenuList=[],this.rolePermissonList=[];var n=[];this.menuListRes.map((function(t){e.map((function(e){t.name==e&&a.roleMenuList.push(t.objectId)}))})),this.$refs.menusTree.setCheckedKeys(this.roleMenuList),this.permissionListRes.map((function(e){t.map((function(t){e.name==t&&n.push(e.name)}))})),this.rolePermissonList=Object(s["a"])(new Set(n)),this.$refs.permissionTree.setCheckedKeys(this.rolePermissonList)},handleDelete:function(e,t,a){var n=this;return Object(i["a"])(l.a.mark((function r(){var s;return l.a.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,Object(c["delDict"])(t.objectId);case 2:s=r.sent,s?(n.$message({type:"success",message:"删除成功"}),a.splice(e,1)):n.$message({type:"error",message:"删除失败"});case 4:case"end":return r.stop()}}),r)})))()},exportRoletemp:function(e){var t=this;this.$confirm("确定要更新吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(i["a"])(l.a.mark((function a(){var n,r,s,i,o,u,d;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(n=[],r=[],s=t.$refs.menusTree.getCheckedNodes(),i=t.$refs.permissionTree.getCheckedNodes(),!(s&&i&&s.length>0&&i.length>0)){a.next=9;break}s.forEach((function(e){r.push(e.label)})),i.forEach((function(e){n.push(e.name)})),a.next=11;break;case 9:return t.$message({mesaage:"数据为空"}),a.abrupt("return");case 11:return o=e.data,e.data.tag||(o.tag={}),o["tag"].appconfig=t.form,o.menus=r,o.rules=n,u=t.$loading({background:"rgba(0, 0, 0, 0.5)"}),a.next=19,Object(c["putDict"])(e.objectId,{data:o});case 19:d=a.sent,d?(u.close(),d&&t.$message({message:"更新成功"})):(u.close(),t.$message({message:"更新失败"}));case 21:case"end":return a.stop()}}),a)})))).catch((function(e){}))}}},m=p,f=(a("a12c"),a("a129"),a("bdd7")),h=Object(f["a"])(m,n,r,!1,null,"5fbc5d2c",null);t["default"]=h.exports},e6b5:function(e,t,a){e.exports={"menu-color":"rgba(255,255,255,.95)","menu-color-active":"rgba(255,255,255,.95)","menu-background":"#282c34","column-second-menu-background":"#fff"}},ec98:function(e,t,a){e.exports={"menu-color":"rgba(255,255,255,.95)","menu-color-active":"rgba(255,255,255,.95)","menu-background":"#282c34","column-second-menu-background":"#fff"}},f5e4:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"edituser"},[a("div",{staticClass:"admin",staticStyle:{"margin-bottom":"20px"}},[e._v(" "+e._s(e.$translateTitle("developer.edituser"))+" ")]),a("el-form",{ref:"ruleForm2",staticClass:"demo-ruleForm",attrs:{"label-width":"100px",model:e.ruleForm2,"status-icon":""}},[a("el-form-item",{attrs:{label:e.$translateTitle("user.account"),prop:"account"}},[a("el-input",{attrs:{placeholder:e.$translateTitle("product.enteraccount")},model:{value:e.ruleForm2.account,callback:function(t){e.$set(e.ruleForm2,"account",t)},expression:"ruleForm2.account"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("product.phone"),prop:"phone"}},[a("el-input",{attrs:{maxlength:11,placeholder:e.$translateTitle("product.enterphonenumber")},model:{value:e.ruleForm2.phone,callback:function(t){e.$set(e.ruleForm2,"phone",t)},expression:"ruleForm2.phone"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("user.email"),prop:"email"}},[a("el-input",{attrs:{placeholder:e.$translateTitle("product.enteremail")},model:{value:e.ruleForm2.email,callback:function(t){e.$set(e.ruleForm2,"email",t)},expression:"ruleForm2.email"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("user.name1"),prop:"username"}},[a("el-input",{attrs:{maxlength:5,placeholder:e.$translateTitle("product.eqwords1")},model:{value:e.ruleForm2.username,callback:function(t){e.$set(e.ruleForm2,"username",t)},expression:"ruleForm2.username"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("developer.departmentselection")}},[a("el-cascader",{staticStyle:{width:"600px"},attrs:{"auto-complete":"off","change-on-select":"",options:e.data,placeholder:e.$translateTitle("product.selectdepartment"),props:e.treeprops,"show-all-levels":!1},model:{value:e.ruleForm2.departmentid,callback:function(t){e.$set(e.ruleForm2,"departmentid",t)},expression:"ruleForm2.departmentid"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.submit_edituser(e.ruleForm2)}}},[e._v(" "+e._s(e.$translateTitle("product.preservation"))+" ")])],1)],1)],1)},r=[],s=a("fb07"),i=(a("3dec"),a("9c6a"),a("d0d7")),o=a.n(i),l=a("8665"),c=a("5da95"),u={data:function(){return{data:[],treeprops:{value:"objectId",label:"name"},ruleForm2:{account:"",phone:"",username:"",password:"",email:"",checkPass:"",departmentid:[]},id:""}},computed:{},mounted:function(){this.editUser()},methods:{submit_edituser:function(e){var t=this;return Object(s["a"])(o.a.mark((function e(){var a,n;return o.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={username:t.ruleForm2.account,nick:t.ruleForm2.username,phone:t.ruleForm2.phone,email:t.ruleForm2.email,emailVerified:!0},e.next=3,Object(l["putUser"])(t.$route.query.id,a);case 3:n=e.sent,n?t.$message({message:"更改成功",type:"success"}):t.$message({type:"error",message:"修改用户失败"});case 5:case"end":return e.stop()}}),e)})))()},editUser:function(){var e=this;Object(l["getUser"])(this.$route.query.id).then((function(t){e.ruleForm2.username=t.nick,e.ruleForm2.phone=t.phone,e.ruleForm2.account=t.username,e.ruleForm2.email=t.email,e.getDepartment()})).catch((function(t){e.$message({type:"error",message:"用户详情获取失败"})}))},getDepartment:function(){var e=this;Object(c["roletree"])().then((function(t){var a=t.results;a.forEach((function(e){})),e.data=t.results})).catch((function(t){e.$message("部门列表获取失败"),e.data=[]}))}}},d=u,p=(a("59d6"),a("bdd7")),m=Object(p["a"])(d,n,r,!1,null,"ad6447d4",null);t["default"]=m.exports},ffca:function(e,t,a){}}]);