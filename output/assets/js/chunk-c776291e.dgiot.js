/*!
 *  build: 杭州数蛙科技有限公司 
 *  copyright: dgiot-Dashboard 
 *  author: h7ml(h7ml@qq.com) 
 *  time: Wed Nov 17 2021 03:58:09 GMT+0000 (Coordinated Universal Time)
 */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c776291e"],{"0b48":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"log log-container"},[a("el-dialog",{attrs:{"append-to-body":!0,"before-close":e.handleClose,title:e.$translateTitle("node.joincluster"),visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("span",[e._v(e._s(e.$translateTitle("node.nodename")))]),a("el-input",{attrs:{type:"text"},model:{value:e.form.nodename,callback:function(t){e.$set(e.form,"nodename",t)},expression:"form.nodename"}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.join.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1)],1)],1)},r=[],i=a("bb22"),s={data:function(){return{form:{nodename:""},height:this.$baseTableHeight(0)-25,tableData5:[],node:null,start:1,length:10,total:0,draw:1,search:"",dialogVisible:!1,installtion:[],selsectinstall:[{value:"info",label:"info"},{value:"error",label:"error"},{value:"warning",label:"warning"},{value:"debug",label:"debug"},{value:"mqtt",label:"mqtt"},{value:"kafka",label:"kafka"},{value:"alert",label:"alert"},{value:"critical",label:"critical"},{value:"emergency",label:"emergency"},{value:"notice",label:"notice"}]}},mounted:function(){this.Getinformation()},methods:{Getinformation:function(){var e=this;Object(i["getNode"])(this.start,this.lengt).then((function(t){t&&(e.tableData5=t.nodes,e.total=t.nodes.length)}))},handleSizeChange:function(e){this.length=e,this.start=1},handleCurrentChange:function(e){this.start=e},join:function(){var e=this;Object(i["joinNode"])("join",this.form.nodename).then((function(t){t&&(e.$message({type:"success",message:"加入成功"}),e.dialogVisible=!1,e.Getinformation())})).catch((function(t){e.$message(t.error)}))},removeNode:function(e){var t=this;Object(i["joinNode"])("leave",e.node).then((function(e){e&&(t.$message({type:"success",message:"移除成功"}),t.Getinformation())})).catch((function(e){t.$message(e.error)}))},install:function(){this.dialogVisible=!0},handleClose:function(){this.dialogVisible=!1}}},o=s,l=a("bdd7"),c=Object(l["a"])(o,n,r,!1,null,null,null);t["default"]=c.exports},"0fa6":function(e,t,a){},"1267e":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:e.className,style:{height:e.height,width:e.width}})},r=[],i=(a("f1e1"),a("ed08")),s={props:{className:{type:String,default:"chart"},width:{type:String,default:"100%"},height:{type:String,default:"370px"},autoResize:{type:Boolean,default:!0},chartData:{type:Object,required:!0,default:function(){return{expectedData:[],actualData:[],title:"1",max:0}}}},data:function(){return{chart:null,sidebarElm:null}},watch:{chartData:{deep:!0,handler:function(e){this.setOptions(e)}}},mounted:function(){var e=this,t=document.getElementsByClassName("chart")[0];t.style.width=.4*window.innerWidth-120+"px",this.initChart(),this.autoResize&&(this.__resizeHandler=Object(i["debounce"])((function(){e.chart&&(t.style.width=.4*window.innerWidth-120+"px",e.chart.resize())}),100),window.addEventListener("resize",this.__resizeHandler))},beforeDestroy:function(){this.chart&&(this.autoResize&&window.removeEventListener("resize",this.__resizeHandler),this.sidebarElm&&this.sidebarElm.removeEventListener("transitionend",this.sidebarResizeHandler),this.chart.dispose(),this.chart=null)},methods:{sidebarResizeHandler:function(e){"width"===e.propertyName&&this.__resizeHandler()},setOptions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.expectedData,a=e.actualData,n=e.title,r=e.max;this.chart.setOption({xAxis:{data:a,boundaryGap:!1,axisTick:{show:!1}},grid:{left:10,right:10,bottom:20,top:30,containLabel:!0},title:{text:n,textStyle:{color:"black"}},tooltip:{trigger:"axis",axisPointer:{type:"cross"},padding:[5,10]},yAxis:{axisTick:{show:!1}},legend:{data:["数据"]},toolbox:{feature:{dataView:{show:!0,readOnly:!1},magicType:{show:!0,type:["line","bar"]},restore:{show:!0},saveAsImage:{show:!0}}},dataZoom:[{type:"slider",show:!0,start:0,end:50,handleSize:8},{type:"inside",start:0,end:50}],visualMap:{show:!1,dimension:1,pieces:[{gte:0,lte:r,color:"green"}],outOfRange:{color:"red"}},series:[{name:"数据",itemStyle:{normal:{color:"#FF005A",lineStyle:{color:"#FF005A",width:2},areaStyle:{normal:{color:new echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#7CF5A2"},{offset:.6,color:"#7EF57C"},{offset:1,color:"#fff"}])}}}},markLine:{silent:!1,data:[{name:"告警线",yAxis:r,label:{show:"true",position:"middle",formatter:"".concat(n,"最大").concat(r)}}]},smooth:!0,type:"line",data:t,animationDuration:2800,animationEasing:"cubicInOut"}]})},initChart:function(){var e=this;setTimeout((function(){e.chart=echarts.init(e.$el,"macarons"),e.setOptions(e.chartData)}),1e3)}}},o=s,l=a("bdd7"),c=Object(l["a"])(o,n,r,!1,null,null,null);t["default"]=c.exports},1458:function(e,t,a){"use strict";a("ea2b")},"15ed":function(e,t,a){},1855:function(e,t,a){},"1ec0":function(e,t,a){"use strict";a("0fa6")},2225:function(e,t,a){},"22a5":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"mqttws"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.msg,expression:"msg"}],attrs:{id:"msg",type:"text"},domProps:{value:e.msg},on:{input:function(t){t.target.composing||(e.msg=t.target.value)}}}),a("input",{attrs:{type:"button",value:"Send"},on:{click:e.send}}),a("input",{attrs:{type:"button",value:"Start"},on:{click:e.start}}),a("input",{attrs:{type:"button",value:"Stop"},on:{click:e.stop}})])},r=[],i={name:"Mqttws",data:function(){return{host:location.hostname,port:5080,clientId:"C_"+(new Date).getTime(),userName:"test",password:"test123",keepAlive:null,cleanSession:!0,useSSL:!1,client:{},options:{},msg:"order",count:0}},created:function(){this.client=new Paho.MQTT.Client(this.host,this.port,this.clientId);var e=this.client,t=this.options={invocationContext:{host:this.host,port:this.port,path:e.path,clientId:this.clientId},timeout:5,keepAliveInterval:50,cleanSession:!1,useSSL:!1,userName:"test",password:"test123",onSuccess:function(){e.subscribe("001/in")},onFailure:function(e){}};this.client.connect(t),this.client.onConnectionLost=this.onConnectionLost,this.client.onMessageArrived=this.onMessageArrived},methods:{onConnectionLost:function(e){e.errorCode},onMessageArrived:function(e){},onConnect:function(){this.client.subscribe("001/in")},send:function(){var e=this.msg;if(e){e="{time:"+new Date+", content:"+e+", from: web console}";var t=new Paho.MQTT.Message(e);t.destinationName=this.topic,this.client.send(t),this.msg=""}},start:function(){window.tester=window.setInterval(function(){if(this.client.isConnected){var e="{time:"+new Date+", content:"+this.count+++", from: web console}",t=new Paho.MQTT.Message(e);t.destinationName=this.topic,this.client.send(t)}}.bind(this),1e3)},stop:function(){window.clearInterval(window.tester)}}},s=i,o=a("bdd7"),l=Object(o["a"])(s,n,r,!1,null,null,null);t["default"]=l.exports},2520:function(e,t,a){"use strict";a("2e91")},"27f0":function(e,t,a){"use strict";a("ec0d")},"28c4":function(e,t,a){"use strict";a("6e51")},"2b89":function(e,t,a){"use strict";a("2225")},"2b93":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"logs logs-container"},[a("a-row",{staticClass:"logs-row"},[a("a-col",{staticClass:"logs-row-tree",style:{height:Number(e.$baseTableHeight(0))+105+"px"},attrs:{lg:6,md:6,sm:24,xl:4,xs:24,xxl:4}},[e.logTree.length?a("a-tree",{staticClass:"logs-row-tree-antd",attrs:{"auto-expand-parent":!0,"block-node":!0,"default-expand-all":!0,"show-icon":!0,"show-line":!0,"tree-data":e.logTree},on:{rightClick:e.onRightClick,select:e.onSelect},scopedSlots:e._u([{key:"title",fn:function(t){var n=t.objectId,r=t.name,i=t.objectId,s=t.type;return[a("a-dropdown",{attrs:{disabled:!e.disableType.includes(s),trigger:["contextmenu"]},on:{click:function(t){return e.subLog()}},scopedSlots:e._u([{key:"overlay",fn:function(){return[a("a-menu",{key:i,attrs:{size:"mini"},on:{click:function(t){return t.target!==t.currentTarget?null:function(t){var a=t.key;return e.onContextMenuClick(n,a)}.apply(null,arguments)}}},[a("a-menu-item",[e._v(" "+e._s(e.$translateTitle("Logs.log lever"))+" "),a("el-select",{staticStyle:{width:"120px"},attrs:{size:"mini"},on:{change:e.handleChange},model:{value:e.defaultLever,callback:function(t){e.defaultLever=t},expression:"defaultLever"}},e._l(e.leverData,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1)]},proxy:!0}],null,!0)},[a("span",{attrs:{title:r}},[a("a-icon",{attrs:{slot:"icon",theme:"twoTone","two-tone-color":"#52c41a",type:"check-circle"},slot:"icon"}),e._v(" "+e._s(r)+" ")],1)])]}}],null,!1,740860110)}):e._e()],1),a("a-col",{staticClass:"logs-row-table",class:{"vab-fullscreen":e.isFullscreen},style:{height:Number(e.$baseTableHeight(0))+25+"px"},attrs:{lg:18,md:18,sm:24,xl:20,xs:24,xxl:20}},[a("a-tabs",{attrs:{"default-active-key":"editor"}},[a("a-tab-pane",{key:"editor"},[a("span",{attrs:{slot:"tab"},slot:"tab"},[a("vab-icon",{attrs:{icon:"aspect-ratio-fill"}}),e._v(" "+e._s(e.$translateTitle("Logs.console"))+" ")],1),a("vab-editor",{key:e.key,attrs:{height:e.isFullscreen?Number(e.$baseTableHeight(0))+80:Number(e.$baseTableHeight(0))+40,lang:"json","max-lines":e.isFullscreen?Number(e.$baseTableHeight(0)+80)/12:Number(e.$baseTableHeight(0)-80)/12,"min-lines":e.isFullscreen?Number(e.$baseTableHeight(0)+80)/12:Number(e.$baseTableHeight(0)-80)/12,theme:"gob"},model:{value:e.clickItem,callback:function(t){e.clickItem=t},expression:"clickItem"}})],1),a("a-tab-pane",{key:"table"},[a("span",{attrs:{slot:"tab"},slot:"tab"},[a("vab-icon",{attrs:{icon:"table-2"}}),e._v(" "+e._s(e.$translateTitle("Logs.table"))+" ")],1),a("vab-query-form",[a("vab-query-form-left-panel",[a("el-button",{staticStyle:{margin:"0 10px 10px 10px !important"},attrs:{type:"success"},on:{click:e.handleHeight}},[a("vab-icon",{attrs:{icon:e.isFullscreen?"fullscreen-exit-fill":"fullscreen-fill"}})],1),a("el-popover",{attrs:{trigger:"hover"},scopedSlots:e._u([{key:"reference",fn:function(){return[a("el-button",{staticStyle:{margin:"0 0 10px 0 !important"},attrs:{icon:"el-icon-setting",type:"primary"}},[e._v(" "+e._s(e.$translateTitle("Logs.Draggable column settings"))+" ")])]},proxy:!0}])},[a("el-checkbox-group",{model:{value:e.checkList,callback:function(t){e.checkList=t},expression:"checkList"}},[a("vue-draggable",e._b({attrs:{list:e.logcolumns}},"vue-draggable",e.dragOptions,!1),e._l(e.logcolumns,(function(t,n){return a("div",{key:t+n},[a("vab-icon",{attrs:{icon:"drag-drop-line"}}),a("el-checkbox",{attrs:{disabled:!0===t.disableCheck,label:t}},[e._v(" "+e._s(t)+" ")])],1)})),0)],1)],1)],1)],1),a("el-table",{key:e.key,ref:"dragTable",attrs:{border:"",data:e.scroketMsg.slice((e.currentPage-1)*e.pageSize,e.currentPage*e.pageSize),"default-expand-all":"",height:e.height,"highlight-current-row":"",resizable:"",size:"mini",stripe:""},scopedSlots:e._u([{key:"empty",fn:function(){return[a("vab-empty")]},proxy:!0}])},[a("el-table-column",{attrs:{align:"center",fixed:"left",label:e.$translateTitle("equipment.serialnumber"),"show-overflow-tooltip":"",width:"55"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.$index;return[e._v(" "+e._s(a+1)+" ")]}}])}),a("el-table-column",{attrs:{align:"center",fixed:"left",label:"time",prop:"time","show-overflow-tooltip":"",sortable:"",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(" "+e._s(e.$moment(Number(n.time.toString().substring(0,13))).format("YYYY-MM-DD HH:mm:ss.SSS"))+" ")])]}}])}),e._l(e.finallyColumns,(function(t,n){return a("el-table-column",{directives:[{name:"show",rawName:"v-show",value:"msg"!=t,expression:"item != 'msg'"}],key:n,attrs:{align:"center",label:t,prop:t,"show-overflow-tooltip":"",sortable:"",width:e.w80.includes(t)?80:e.Wh120.includes(t)?120:180}})})),a("el-table-column",{attrs:{align:"center",fixed:"right",label:"msg",prop:"msg","show-overflow-tooltip":"",sortable:""}})],2),a("el-pagination",{attrs:{"current-page":e.currentPage,layout:"total, sizes, prev, pager, next, jumper","page-size":e.pageSize,"page-sizes":[10,20,30,50,100],total:e.scroketMsg.length},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1)],1)],1)],1)],1)},r=[],i=a("fb07"),s=a("d0d7"),o=a.n(s),l=(a("a0e0"),a("3dec"),a("f764"),a("5662"),a("16b8"),a("04d6"),a("d292")),c={name:"RealLog",data:function(){return{logMqtt:{channeltopic:"",key:moment(new Date).valueOf()},key:moment(new Date).valueOf(),subtopic:"",topicKey:"",router:"",currentPage:1,pageSize:20,isFullscreen:!1,leverData:["debug","info","notice","warning","error","crtical","alert","emergency"],disableType:["system","app","module"],dataRef:{},defaultLever:"",queryForm:{},logTree:[],clickItem:"",height:this.$baseTableHeight(1),checkList:["pid","level","gl","mfa"],logcolumns:["topic","pid","peername","level","gl","clientid","mfa"],w80:["line","level"],Wh120:["pid","level","domain","gl"],Wh200:["time","clientid","peername"],scroketMsg:[]}},computed:{dragOptions:function(){return{animation:600,group:"description"}},finallyColumns:function(){var e=this;return this.logcolumns.filter((function(t){return e.checkList.includes(t)}))},treeQueryForm:function(){return{province:"",class:"LogLevel",filter:'{"keys":["parent","name","level","name","order","type","topic"],"where":{}}',parent:"parent"}}},watch:{},mounted:function(){this.router=this.$dgiotBus.router(this.$route.fullPath),this.getTree(this.treeQueryForm)},methods:{handleSizeChange:function(e){this.pageSize=e},handleCurrentChange:function(e){this.currentPage=e},onSelect:function(e,t){this.dataRef=t.node.dataRef,this.defaultLever=this.dataRef.level,this.subLog()},handleHeight:function(){this.isFullscreen=!this.isFullscreen,this.isFullscreen?this.height=this.$baseTableHeight(1)+120:this.height=this.$baseTableHeight(1)},onRightClick:function(e){this.clickItem="",this.dataRef=e.node.dataRef,this.defaultLever=this.dataRef.level},onContextMenuClick:function(e,t){switch(t){case"Level":break}},getTree:function(e){var t=this;return Object(i["a"])(o.a.mark((function a(){var n,r,i,s;return o.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,n=t.$baseColorfullLoading(),a.next=4,Object(l["post_tree"])(e);case 4:r=a.sent,i=r.results,s=void 0===i?[]:i,t.logTree=s,n.close(),t.$baseMessage(t.$translateTitle("alert.Data request successfully"),"success","vab-hey-message-success"),a.next=15;break;case 12:a.prev=12,a.t0=a["catch"](0),t.$baseMessage(t.$translateTitle("alert.Data request error")+"".concat(a.t0),"error","vab-hey-message-error");case 15:case"end":return a.stop()}}),a,null,[[0,12]])})))()},handleChange:function(e){var t=this;return Object(i["a"])(o.a.mark((function a(){var n,r,i,s,c;return o.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,n=t.dataRef,r=n.type,i=n.name,s=t.$baseColorfullLoading(),c={type:r,name:i,level:e},a.next=6,Object(l["putLogLevel"])(c);case 6:a.sent,t.getTree(t.treeQueryForm),s.close(),a.next=14;break;case 11:a.prev=11,a.t0=a["catch"](0),t.$baseMessage(t.$translateTitle("alert.Data request error")+"".concat(a.t0),"error","vab-hey-message-error");case 14:case"end":return a.stop()}}),a,null,[[0,11]])})))()},subLog:function(){this.clickItem="",this.scroketMsg=[],this.key=moment(new Date).valueOf(),this.dataRef.objectId&&(this.subtopic="".concat(this.dataRef.topic),this.topicKey=this.$dgiotBus.topicKey(this.router,this.subtopic),this.$dgiotBus.$emit("MqttSubscribe",{router:this.router,topic:this.subtopic,qos:0,ttl:108e5}),this.$baseMessage(this.subtopic+this.$translateTitle("websocket.subscribeSuccess"),"success",!1,"vab-hey-message-success"),this.$baseNotify(this.subtopic,"topic:","success","",5e3),this.handleMqttMsg())},handleMqttMsg:function(){var e=this;this.scroketMsg=[],this.clickItem="",this.$dgiotBus.$off(this.topicKey),this.$dgiotBus.$on(this.topicKey,(function(t){t.payload&&(e.scroketMsg.push(JSON.parse(t.payload)),e.key=moment(new Date).valueOf(),e.clickItem=JSON.stringify(e.scroketMsg,null,2))}))}}},u=c,d=(a("9523"),a("bdd7")),m=Object(d["a"])(u,n,r,!1,null,"06462890",null);t["default"]=m.exports},"2e91":function(e,t,a){},"34f5":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:e.$translateTitle("Maintenance.Work order information"),name:"first"}},[a("el-form",{ref:"form",staticClass:"create-ticker",attrs:{"label-width":"auto",model:e.form,size:"medium "}},[a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{lg:12,md:12,sm:24,xl:12,xs:24}},[a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.project")+": "}},[a("span",[e._v(e._s(e.form.info.productname))])])],1),a("el-col",{attrs:{lg:12,md:12,sm:24,xl:12,xs:24}},[a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.Equipment name")+": "}},[a("span",[e._v(e._s(e.form.info.createdname))])])],1),a("el-col",{attrs:{lg:12,md:12,sm:24,xl:12,xs:24}},[a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.Initiator")+": "}},[a("span",[e._v(e._s(e.form.info.createdname))])])],1),a("el-col",{attrs:{lg:24,md:24,sm:24,xl:24,xs:24}},[a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.Ticket description")+": "}},[a("el-input",{attrs:{placeholder:e.$translateTitle("Maintenance.Please record the processing content in detail!"),readonly:"",type:"textarea"},model:{value:e.form.info.description,callback:function(t){e.$set(e.form.info,"description",t)},expression:"form.info.description"}})],1)],1),a("el-col",{attrs:{lg:24,md:24,sm:24,xl:24,xs:24}},[a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.photo")+": "}},[a("el-carousel",{attrs:{height:"200px",interval:2e3,type:"card"}},e._l(e.form.info.photo,(function(e,t){return a("el-carousel-item",{key:t},[a("img",{staticStyle:{width:"100%",height:"100%"},attrs:{alt:e,src:e,title:e}})])})),1)],1)],1),a("el-col",{attrs:{lg:24,md:24,sm:24,xl:24,xs:24}},[a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.Processing records")+": "}},[a("el-input",{staticStyle:{margin:"0 0 10px"},attrs:{placeholder:e.$translateTitle("Maintenance.Please record the processing content in detail!"),readonly:"",size:"1",type:"textarea"},model:{value:e.form.info.step2.Remarks,callback:function(t){e.$set(e.form.info.step2,"Remarks",t)},expression:"form.info.step2.Remarks"}})],1)],1),a("el-col",{attrs:{lg:24,md:24,sm:24,xl:24,xs:24}},[a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.Evaluation description")+": "}},[a("el-input",{attrs:{placeholder:e.$translateTitle("Maintenance.Please record the processing content in detail!"),readonly:"",type:"textarea"},model:{value:e.form.info.step3.Remarks,callback:function(t){e.$set(e.form.info.step3,"Remarks",t)},expression:"form.info.step3.Remarks"}})],1)],1)],1)],1)],1),a("el-tab-pane",{staticStyle:{height:"90%","overflow-x":"hidden","overflow-y":"auto"},attrs:{label:e.$translateTitle("Maintenance.work process"),name:"second"}},[a("el-card",{attrs:{shadow:"hover"},scopedSlots:e._u([{key:"header",fn:function(){return[a("el-radio-group",{staticClass:"card-header-radio",model:{value:e.reverse,callback:function(t){e.reverse=t},expression:"reverse"}},[a("el-radio",{attrs:{label:!0}},[e._v(" "+e._s(e.$translateTitle("Maintenance.Positive order"))+" ")]),a("el-radio",{attrs:{label:!1}},[e._v(" "+e._s(e.$translateTitle("Maintenance.Reverse order"))+" ")])],1)]},proxy:!0}])},[a("el-timeline",{attrs:{reverse:e.reverse}},e._l(e.form.info.timeline,(function(t){return a("el-timeline-item",{key:t.timestamp,attrs:{placement:"top",timestamp:t.timestamp}},[a("el-card",[a("h4",[e._v(e._s(t.h4))]),a("p",[e._v(e._s(t.p))])])],1)})),1)],1)],1)],1)],1)},r=[],i={props:{detail:{type:Object,default:function(){}}},data:function(){return{reverse:!0,activeName:"first",form:this.detail}}},s=i,o=(a("a99f0"),a("bdd7")),l=Object(o["a"])(s,n,r,!1,null,"5f96f32a",null);t["default"]=l.exports},"351b":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"custom-table",staticClass:"custom-table-container",class:{"vab-fullscreen":e.isFullscreen}},[n("div",{staticClass:"components"},[n("vab-dialog",{attrs:{show:e.activePopShow},on:{"update:show":function(t){e.activePopShow=t}}},[n("h3",{attrs:{slot:"title"},slot:"title"},[e._v(" "+e._s(e.$translateTitle("cloudTest.add"))+e._s(e.$translateTitle("cloudTest.report template"))+" ")]),n("div",{staticClass:"content"},[n("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{"label-width":"100px",model:e.ruleForm,rules:e.rules}},[n("el-form-item",{attrs:{label:e.$translateTitle("cloudTest.Template name"),prop:"name"}},[n("el-input",{model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),n("el-form-item",{attrs:{label:e.$translateTitle("cloudTest.category"),prop:"category"}},[n("el-input",{model:{value:e.ruleForm.category,callback:function(t){e.$set(e.ruleForm,"category",t)},expression:"ruleForm.category"}})],1),n("el-form-item",{attrs:{label:e.$translateTitle("cloudTest.Trade Names"),prop:"factory",required:""}},[n("el-input",{model:{value:e.ruleForm.factory,callback:function(t){e.$set(e.ruleForm,"factory",t)},expression:"ruleForm.factory"}})],1),n("el-form-item",{attrs:{label:e.$translateTitle("cloudTest.Template file"),prop:"file",required:""}},[n("el-upload",{key:e.momentKey,ref:"upload",staticClass:"upload-demo",attrs:{accept:".doc,.docx",action:"string","before-upload":e.onBeforeUploadImage,"file-list":e.fileList,"http-request":e.UploadImage,limit:1,"list-type":"text","on-change":e.fileChange},model:{value:e.ruleForm.file,callback:function(t){e.$set(e.ruleForm,"file",t)},expression:"ruleForm.file"}},[n("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v(" "+e._s(e.$translateTitle("application.selectfile"))+" ")])],1)],1)],1)],1),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v(" "+e._s(e.$translateTitle("product.createnow"))+" ")]),n("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v(" "+e._s(e.$translateTitle("zetadevices.reset"))+" ")])],1)]),n("vab-dialog",{attrs:{show:e.tempPopShow},on:{"update:show":function(t){e.tempPopShow=t}}},[n("h3",{attrs:{slot:"title"},slot:"title"},[e._v(" "+e._s(e.$translateTitle("cloudTest.report template"))+" ")]),n("div",{key:e.height,staticClass:"content"},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"tableSort",attrs:{border:e.border,data:e.tempList,height:e.$baseTableHeight(3),size:e.lineHeight,stripe:e.stripe},scopedSlots:e._u([{key:"empty",fn:function(){return[n("el-image",{staticClass:"vab-data-empty",attrs:{src:a("c2ad")}})]},proxy:!0}])},[n("el-table-column",{attrs:{align:"center",label:e.$translateTitle("cloudTest.number"),"show-overflow-tooltip":"",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.$index;return[e._v(" "+e._s(a+1)+" ")]}}])}),n("el-table-column",{attrs:{align:"center",label:e.$translateTitle("cloudTest.Template name"),prop:"name","show-overflow-tooltip":"",width:"auto"}}),n("el-table-column",{attrs:{align:"center",label:e.$translateTitle("cloudTest.Template content"),width:"auto"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("el-image",{staticStyle:{width:"40px",height:"40px"},attrs:{"preview-src-list":[""+(e.$FileServe+a.icon)],src:e.$FileServe+a.icon}})]}}])}),n("el-table-column",{attrs:{align:"center",flex:"right",label:e.$translateTitle("product.Template management"),"show-overflow-tooltip":"",width:"auto"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("el-button",{attrs:{type:"success"},on:{click:function(t){return e.handlekonva(a)}}},[e._v(" "+e._s(e.$translateTitle("developer.mapping"))+" ")]),n("el-button",{attrs:{type:"warning"},on:{click:function(t){return e.handleDelete(a,1)}}},[e._v(" "+e._s(e.$translateTitle("cloudTest.delete"))+" ")])]}}])})],1)],1)])],1),n("vab-query-form",[n("vab-query-form-left-panel",[n("el-form",{ref:"form",attrs:{inline:!0,"label-width":"0",model:e.queryForm},nativeOn:{submit:function(e){e.preventDefault()}}},[n("el-form-item",[n("el-select",{attrs:{multiple:"",placeholder:e.$translateTitle("cloudTest.Please select review status")},model:{value:e.queryForm.name,callback:function(t){e.$set(e.queryForm,"name",t)},expression:"queryForm.name"}},e._l(e.options,(function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),n("el-form-item",[n("el-button",{attrs:{icon:"el-icon-search","native-type":"submit",type:"primary"},on:{click:function(t){return e.fetchData(e.queryForm)}}},[e._v(" "+e._s(e.$translateTitle("cloudTest.search"))+" ")]),n("el-button",{attrs:{icon:"el-icon-plus",type:"primary"},on:{click:e.handleAdd}},[e._v(" "+e._s(e.$translateTitle("cloudTest.add"))+" ")])],1)],1)],1),n("vab-query-form-right-panel",[n("el-button",{staticStyle:{margin:"0 10px 10px 0 !important"},attrs:{type:"primary"},on:{click:e.clickFullScreen}},[n("vab-icon",{attrs:{icon:e.isFullscreen?"fullscreen-exit-fill":"fullscreen-fill"}}),e._v(" "+e._s(e.$translateTitle("cloudTest.full screen"))+" ")],1),n("el-popover",{ref:"popover",attrs:{"popper-class":"custom-table-checkbox",trigger:"hover"},scopedSlots:e._u([{key:"reference",fn:function(){return[n("el-button",{staticStyle:{margin:"0 10px 10px 0 !important"},attrs:{type:"primary"}},[n("vab-icon",{attrs:{icon:"line-height"}}),e._v(" "+e._s(e.$translateTitle("cloudTest.size"))+" ")],1)]},proxy:!0}])},[n("el-radio-group",{model:{value:e.lineHeight,callback:function(t){e.lineHeight=t},expression:"lineHeight"}},[n("el-radio",{attrs:{label:"medium"}},[e._v(" "+e._s(e.$translateTitle("cloudTest.medium"))+" ")]),n("el-radio",{attrs:{label:"small"}},[e._v(" "+e._s(e.$translateTitle("cloudTest.small"))+" ")]),n("el-radio",{attrs:{label:"mini"}},[e._v(" "+e._s(e.$translateTitle("cloudTest.mini"))+" ")])],1)],1),n("el-popover",{attrs:{"popper-class":"custom-table-checkbox",trigger:"hover"},scopedSlots:e._u([{key:"reference",fn:function(){return[n("el-button",{staticStyle:{margin:"0 0 10px 0 !important"},attrs:{icon:"el-icon-setting",type:"primary"}},[e._v(" "+e._s(e.$translateTitle("cloudTest.Draggable column"))+" ")])]},proxy:!0}])},[n("el-checkbox-group",{model:{value:e.checkList,callback:function(t){e.checkList=t},expression:"checkList"}},[n("vab-draggable",e._b({attrs:{list:e.columns}},"vab-draggable",e.dragOptions,!1),e._l(e.columns,(function(t,a){return n("div",{key:t+a},[n("vab-icon",{attrs:{icon:"drag-drop-line"}}),n("el-checkbox",{attrs:{disabled:!0===t.disableCheck,label:t.label}},[e._v(" "+e._s(e.$translateTitle("cloudTest."+t.label))+" ")])],1)})),0)],1)],1)],1)],1),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"tableSort",attrs:{border:e.border,data:e.list,height:e.height,size:e.lineHeight,stripe:e.stripe},scopedSlots:e._u([{key:"empty",fn:function(){return[n("el-image",{staticClass:"vab-data-empty",attrs:{src:a("c2ad")}})]},proxy:!0}])},[n("el-table-column",{attrs:{align:"center",label:e.$translateTitle("cloudTest.number"),"show-overflow-tooltip":"",width:"95"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.$index;return[e._v(" "+e._s(a+1)+" ")]}}])}),e._l(e.finallyColumns,(function(t,a){return n("el-table-column",{key:a,attrs:{align:"center",label:e.$translateTitle("cloudTest."+t.label),prop:t.prop,"show-overflow-tooltip":"",sortable:t.sortable,width:t.width}})})),n("el-table-column",{attrs:{align:"center",label:e.$translateTitle("deviceLog.status"),"show-overflow-tooltip":"",width:"185"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("el-tag",{attrs:{effect:"dark",type:["success","info","warning","danger"][a.basedata.testStatus]||0}},[e._v(" "+e._s([e.$translateTitle("product.notstarted"),e.$translateTitle("product.testing"),e.$translateTitle("product.finishtest")][a.basedata.testStatus]||e.$translateTitle("product.notested"))+" ")])]}}])}),n("el-table-column",{attrs:{align:"center",label:e.$translateTitle("cloudTest.operate"),"show-overflow-tooltip":"",width:"185"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("el-button",{attrs:{type:"success"},on:{click:function(t){return e.handleManagement(a)}}},[e._v(" "+e._s(e.$translateTitle("product.Template management"))+" ")]),n("el-button",{attrs:{type:"warning"},on:{click:function(t){return e.handleDelete(a,0)}}},[e._v(" "+e._s(e.$translateTitle("cloudTest.delete"))+" ")])]}}])})],2),n("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper",page:e.queryForm.pageNo,"page-size":e.queryForm.pageSize,"page-sizes":e.queryForm.pageSizes,total:e.queryForm.total},on:{"update:page":function(t){return e.$set(e.queryForm,"pageNo",t)},"current-change":e.currentChange,"size-change":e.sizeChange}})],1)},r=[],i=a("fb07"),s=a("e97b"),o=a("d0d7"),l=a.n(o),c=(a("a0e0"),a("3dec"),a("f764"),a("5662"),a("16b8"),a("04d6"),a("79da"),a("9c6a"),a("1285")),u=a("58dd"),d=a("289a"),m=a.n(d),p=a("5880"),f={name:"TaskIndex",components:{VabDraggable:m.a},data:function(){var e=function(e,t,a){""===t?a(new Error("请上传文件")):a()};return{options:[{value:"Underreview",label:"审核中"},{value:"finishreview",label:"审核完成"}],fileList:[],momentKey:moment(new Date).valueOf(),ruleForm:{file:null,name:"",category:"",factory:"",date2:""},rules:{name:[{required:!0,message:"请输入模板名称",trigger:"blur"},{min:3,max:8,message:"长度在 3 到 8 个字符",trigger:"blur"}],category:[{required:!0,message:"请输入所属品类",trigger:"blur"},{min:3,max:8,message:"长度在 3 到 8 个字符",trigger:"blur"}],factory:[{required:!0,message:"请输入厂商名称",trigger:"blur"},{min:3,max:8,message:"长度在 3 到 8 个字符",trigger:"blur"}],file:[{validator:e,trigger:"blur"}]},activePopShow:!1,tempPopShow:!1,isFullscreen:!1,border:!0,height:this.$baseTableHeight(0)-20,stripe:!0,lineHeight:"medium",checkList:["Inspection number","mission name","Inspection template","Trade Names","Creation time","Starting time","end time"],columns:[{label:"Inspection number",width:"auto",prop:"basedata.BasicInfo.bianhao",sortable:!0,disableCheck:!0},{label:"mission name",width:"auto",prop:"name",sortable:!0},{label:"Inspection template",width:"auto",prop:"basedata.bedname",sortable:!0},{label:"Creation time",width:"auto",prop:"createdAt",sortable:!0},{label:"Starting time",width:"auto",prop:"basedata.starttime",sortable:!0},{label:"end time",width:"auto",prop:"basedata.endtime",sortable:!0}],list:[],tempList:[],listLoading:!0,layout:"total, sizes, prev, pager, next, jumper",temprow:{},queryForm:{pageSizes:[10,20,30,50],limit:10,order:"-createdAt",keys:"count(*)",total:0,skip:0,pageNo:1,pageSize:10,name:["审核中","审核完成"]}}},computed:Object(s["a"])(Object(s["a"])({},Object(p["mapGetters"])({language:"settings/language",collapse:"settings/collapse"})),{},{dragOptions:function(){return{animation:600,group:"description"}},finallyColumns:function(){var e=this;return this.columns.filter((function(t){return e.checkList.includes(t.label)}))}}),watch:{language:{deep:!0,limit:!0,handler:function(e){}}},created:function(){this.fetchData(this.queryForm)},methods:{onBeforeUploadImage:function(e){var t=["application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/msword"],a=t.includes(e.type),n=e.size/1024/1024<30;return a||this.$message.error("上传文件只能是doc/docx格式!"),n||this.$message.error("上传文件大小不能超过 30MB!"),this.momentKey=moment(new Date).valueOf(),a&&n},UploadImage:function(e){this.ruleForm.file=e.file},fileChange:function(e){this.$refs.upload.clearFiles(),this.logo=e.raw,this.fileList=[{name:e.name,url:e.url}]},submitUpload:function(){this.$refs.upload.submit()},handlePreview:function(e){},submitForm:function(e){var t=this;this.$refs[e].validate(function(){var e=Object(i["a"])(l.a.mark((function e(a){var n,r,i,s;return l.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!a){e.next=24;break}return n=new FormData,r={identifier:"inspectionReportTemp",client:t.ruleForm.factory},n.append("devType",t.ruleForm.category),n.append("name",t.ruleForm.name),n.append("config",JSON.stringify(r)),n.append("file",t.ruleForm.file),i=t.$baseColorfullLoading(1),e.prev=8,e.next=11,Object(u["postReportFile"])(n);case 11:s=e.sent,s.result,t.$message.success(t.$translateTitle("cloudTest.Template created successfully")),t.activePopShow=!1,t.fetchData(t.queryForm),e.next=21;break;case 18:e.prev=18,e.t0=e["catch"](8),t.$message.error(t.$translateTitle("cloudTest.Template creation failed"));case 21:i.close(),e.next=25;break;case 24:return e.abrupt("return",!1);case 25:case"end":return e.stop()}}),e,null,[[8,18]])})));return function(t){return e.apply(this,arguments)}}())},sizeChange:function(e){this.queryForm.limit=e,this.fetchData(this.queryForm)},currentChange:function(e){this.queryForm.skip=(e-1)*this.queryForm.limit,this.fetchData(this.queryForm)},resetForm:function(e){this.ruleForm.file=null,this.fileList=[],this.$refs[e].resetFields()},clickFullScreen:function(){this.isFullscreen=!this.isFullscreen,this.handleHeight()},handleHeight:function(){this.isFullscreen?this.height=this.$baseTableHeight(1)+210:this.height=this.$baseTableHeight(1)},handleAdd:function(){this.activePopShow=!0},handlekonva:function(e){this.$router.push({path:"/Topo",query:{productid:e.objectId,icon:e.icon,type:"Evidence"}})},handleManagement:function(e){var t=this;return Object(i["a"])(l.a.mark((function a(){var n,r,i,s,o;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.temprow=e,n={limit:50,skip:0,keys:"count(*)",where:{devType:t.temprow.devType,nodeType:0},order:"createdAt"},r=t.$baseColorfullLoading(1),a.prev=3,a.next=6,Object(c["queryDevice"])(n);case 6:i=a.sent,s=i.count,void 0===s?0:s,o=i.results,t.tempList=o,a.next=15;break;case 13:a.prev=13,a.t0=a["catch"](3);case 15:t.tempPopShow=!0,r.close();case 17:case"end":return a.stop()}}),a,null,[[3,13]])})))()},handleDelete:function(e,t){var a=this;this.$baseConfirm(this.$translateTitle("Maintenance.Are you sure you want to delete the current item"),null,Object(i["a"])(l.a.mark((function n(){return l.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,delProduct(e.objectId);case 2:if(n.sent,a.$baseMessage(a.$translateTitle("successfully deleted"),"success","vab-hey-message-success"),0!=t){n.next=9;break}return n.next=7,a.fetchData(a.queryForm);case 7:n.next=11;break;case 9:return n.next=11,a.handleManagement(a.temprow);case 11:case"end":return n.stop()}}),n)}))))},fetchData:function(e){var t=this;return Object(i["a"])(l.a.mark((function a(){var n,r,i,s,o,u,d;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n={limit:e.limit,order:e.order,skip:t.queryForm.name.length?0:e.skip,keys:e.keys,where:{"basedata.identifier":"inspectionReportTemp"}},t.listLoading=!0,r={results:[{objectId:"0ac4f9eb2f",createdAt:"2021-04-29T14:31:28.274Z",updatedAt:"2021-10-30T07:28:16.718Z",basedata:{name:"taskInfo",index:0,layer:{width:600,height:850,backColor:"#eee",backgroundImage:"",widthHeightRatio:""},client:["电动泵"],remark:"",bedaddr:"9f7c90228fff",bedname:"南方泵业台体",endtime:1618884e6,deviceid:"",reportId:"633e7fa7d6",BasicInfo:{guige:"/",pizun:"",wendu:"",beizhu:"/",daqiya:"",dengji:"/",shenhe:"",taishu:"/",xiaolv:"/",bianhao:"BB2021042-(1)",bianzhi:"",lianxidh:"",scdwAdrr:"/",wtdwAdrr:"/",chanpinxh:"/",jianceren:"",pizhunren:"",shenheren:"",chuchangbh:"/",qianfaData:"",shengchanN:"/",shiyanName:"/",chanpinName:"/",chouyangNum:"",daoyangData:"",dynamicTags:[],jianyanData:"",jianyanyiju:"",yangpinName:"管道式离心泵",chouyangAddr:"/",chouyangAdrr:"厂成品库",chouyangData:"",weituodanwei:"/",chouyangjishu:"0",yanshoudengji:"",chanpinbianhao:"/",jianyanxingzhi:"委托校验",shengchangData:"",shiyanDateTime:"",songyangdanwei:"/",jianyanbiaozhun:"/",songyangDateTime:"",yangpinzhuangtai:""},groupname:"南方泵业",starttime:16188804e5,components:[],identifier:"inspectionReportTemp",reportList:[{ACL:{"role:方威检测室":{read:!0,write:!0}},desc:"0",icon:"",name:"南方泵业管道循环泵",config:{name:"南方泵业管道循环泵",index:0,layer:{width:600,height:850,backColor:"#eee",backgroundImage:"",widthHeightRatio:""},client:["电动泵"],deviceid:"",components:[],identifier:"inspectionReportTemp"},devType:"管道循环泵",category:"Evidence",children:{__type:"Relation",className:"Product"},nodeType:1,objectId:"633e7fa7d6",createdAt:"2021-04-29T03:52:10.368Z",updatedAt:"2021-04-29T03:52:10.368Z",productSecret:"c6b084b31bfe5553c0a4a4eae76bf6e3"},{ACL:{"role:方威检测室":{read:!0,write:!0}},desc:"0",icon:"",name:"南方家用泵",config:{name:"南方家用泵",index:0,layer:{width:600,height:850,backColor:"#eee",backgroundImage:"",widthHeightRatio:""},client:"潜水泵",deviceid:"",components:[],identifier:"a28b149a-0f31-fe7d-cadc-0be47faf8a8d"},devType:"潜水泵",category:"Evidence",children:{__type:"Relation",className:"Product"},nodeType:1,objectId:"c5f31fa3a4",createdAt:"2021-01-12T12:18:59.570Z",updatedAt:"2021-01-12T12:18:59.570Z",productSecret:"productSecret"}],testStatus:2,TestSetting:{BasicSetting:{AcceptParam:{tHf:.1,tQz:.16,tp_up:.16,te_down:-.05,th_down:0,tq_down:0},dengji_test:"2U",testPrecision:"1"},FormulaSetting:{SpeedConversionFormula:"GB/t3216-2016"},ParameterSetting:{SumAverage:!1,RemoveMaxMinGetAverage:!1},StabilitySetting:{Speed:"GB/T3216-2016",FlowHeadEfficiency:"GB/T3216-2016"},QualifiedConditionsSetting:{QualifiedConditions:"GB/T3216-2016"}},verifyStatus:0,insectionName:"南方泵业管道循环泵",PrescribedPoint:{H1:"",H2:"",H3:"",Q1:"",Q2:"",Q3:"",tR:"",rpm:"",DJXL:"",NpRC:"",NpshG:"",glysG:"",point:"",glysRC:"",qishi1:"",qishi2:"",qishi3:"",temzcG:"",xiaolv1:"",xiaolv2:"",xiaolv3:"",zhougv1:"",zhougv2:"",zhougv3:"",zhendongG:"",pointDataArr:[]},SouthPrescribedPoint:{H1:"",H2:"",H3:"",Q1:"",Q2:"",Q3:"",tR:"",rpm:"",DJXL:"",NpRC:"",NpshG:"",glysG:"",point:"",glysRC:"",qishi1:"",qishi2:"",qishi3:"",temzcG:"",xiaolv1:"",xiaolv2:"",xiaolv3:"",zhougv1:"",zhougv2:"",zhougv3:"",zhendongG:"",pointDataArr:[]}},detail:{desc:"南方泵业管道循环泵检测",brand:"数蛙桌面采集网关",batchId:{batch_name:"2021429",createdtime:1619706688},devModel:"SW_WIN_CAPTURE",isEnable:!0},devaddr:"a4889298366f",ip:"",isEnable:!0,name:"南方泵业管道循环泵检测",product:{objectId:"633e7fa7d6",__type:"Pointer",className:"Product"},status:"ONLINE",ACL:{"role:方威检测室":{read:!0,write:!0}}},{objectId:"d19ed1c4c0",createdAt:"2021-01-12T12:25:15.088Z",updatedAt:"2021-04-21T03:58:48.584Z",basedata:{name:"taskInfo",remark:"",bedaddr:"9f7c90228fff",bedname:"南方泵业台体",endtime:16101576e5,reportId:"c5f31fa3a4",BasicInfo:{name:"南方泵业集团",guige:"IG40-100",pizun:"霍林",wendu:"33",beizhu:"/",daqiya:"1",dengji:"样品状态完好，适于检验",shenhe:"唐炜炜",taishu:"1",xiaolv:"76",bianhao:"2021GJW00198",bianzhi:"刘晓冬",xinghao:"6",lianxidh:"0571-86390083",scdwAdrr:"杭州市余杭区仁和街道",wtdwAdrr:"杭州市余杭区仁和街道",chanpinxh:"IG40-100",jianceren:"李少清",pizhunren:"霍林",shenheren:"唐炜炜",chuchangbh:"201217",qianfaData:"2021-01-10T16:00:00.000Z",shengchanN:"南方泵业集团",shiyanName:"王国军",chanpinName:"中开泵",chouyangNum:"1",daoyangData:"2021-01-09T16:00:00.000Z",dynamicTags:["流量计","温度计","压力变送器"],jianyanData:"2021-01-10T16:00:00.000Z",jianyanyiju:"JB/T 6878-2006、GB/T 3216-2016、GB/T 29531-2013、GB/T 29529-2013",yangpinName:"中开泵",chouyangAddr:"南方泵业集团",chouyangAdrr:"厂成品库",chouyangData:"2021-01-04T16:00:00.000Z",weituodanwei:"南方泵业集团",chouyangjishu:"10",yanshoudengji:"2B",chanpinbianhao:"2101084523",jianyanxingzhi:"委托校验",shengchangData:"2020-12-16T16:00:00.000Z",shiyanDateTime:"2021-01-10T16:00:00.000Z",songyangdanwei:"南方泵业集团",chuchangbianhao:"8",jianyanbiaozhun:"/",songyangDateTime:"2021-01-09T16:00:00.000Z",yangpinzhuangtai:"样品状态完好，适于检验"},groupname:"南方泵业",starttime:1610154e6,identifier:"inspectionReportTemp",reportList:[{ACL:{"role:方威检测室":{read:!0,write:!0}},desc:"0",icon:"",name:"南方家用泵",config:{name:"南方家用泵",index:0,layer:{width:600,height:850,backColor:"#eee",backgroundImage:"",widthHeightRatio:""},client:"潜水泵",deviceid:"",components:[],identifier:"a28b149a-0f31-fe7d-cadc-0be47faf8a8d"},devType:"潜水泵",category:"Evidence",children:{__type:"Relation",className:"Product"},nodeType:1,objectId:"c5f31fa3a4",createdAt:"2021-01-12T12:18:59.570Z",updatedAt:"2021-01-12T12:18:59.570Z",productSecret:"productSecret"}],testStatus:1,TestSetting:{BasicSetting:{AcceptParam:{tHf:.05,tQz:.08,tp_up:.08,te_down:-.05,th_down:-.05,tq_down:-.08},dengji_test:"2B",testPrecision:"2"},FormulaSetting:{SpeedConversionFormula:"GB/t3216-2016"},ParameterSetting:{SumAverage:!1,AverageNumber:"15",AcquisitionCycle:"30",RemoveMaxMinGetAverage:!1,HeightOfSubmersiblePump:"0.5",GravitationalAcceleration:"9.81"},StabilitySetting:{Speed:"GB/T3216-2016",FlowHeadEfficiency:"GB/T3216-2016"},QualifiedConditionsSetting:{QualifiedConditions:"GB/T3216-2016"}},verifyStatus:0,insectionName:"南方家用泵",PrescribedPoint:{H1:"",H2:"43",H3:"",Q1:"",Q2:"10",Q3:"",tR:"0.05",rpm:"2950",DJXL:"",NpRC:"0.01",NpshG:"2",gddxl:"72",glysG:"0.86",point:"",glysRC:"0.08",qishi1:"",qishi2:"2",qishi3:"",temzcG:"35",xiaolv1:"",xiaolv2:"72",xiaolv3:"",zhougv1:"",zhougv2:"2200",zhougv3:"",zhendongG:"4.5",pointDataArr:[]},SouthPrescribedPoint:{H1:"",H2:"43",H3:"",Q1:"",Q2:"10",Q3:"",tR:"0.05",rpm:"2950",DJXL:"",NpRC:"0.01",NpshG:"2",gddxl:"72",glysG:"0.86",point:"",glysRC:"0.08",qishi1:"",qishi2:"2",qishi3:"",temzcG:"35",xiaolv1:"",xiaolv2:"72",xiaolv3:"",zhougv1:"",zhougv2:"2200",zhougv3:"",zhendongG:"4.5",pointDataArr:[]}},detail:{desc:"南方泵业家用泵检测",brand:"数蛙桌面采集网关",batchId:{batch_name:"2021112",createdtime:1610454315},devModel:"SW_WIN_CAPTURE",isEnable:!0},devaddr:"cf4f2e4c63e2",ip:"",isEnable:!0,name:"南方泵业家用泵检测",product:{objectId:"c5f31fa3a4",__type:"Pointer",className:"Product"},status:"ONLINE",ACL:{"role:方威检测室":{read:!0,write:!0}}}]},a.next=5,Object(c["queryDevice"])(n);case 5:i=a.sent,s=i.count,o=void 0===s?0:s,u=i.results,d=void 0===u?[]:u,t.list=d.length?d:r.results,d.forEach((function(e){e.basedata.endtime=moment(e.basedata.endtime).format("YYYY-MM-DD HH:mm:ss"),e.basedata.starttime=moment(e.basedata.starttime).format("YYYY-MM-DD HH:mm:ss"),e.createdAt=moment(e.createdAt).format("YYYY-MM-DD HH:mm:ss")})),t.queryForm.total=o,t.listLoading=!1;case 14:case"end":return a.stop()}}),a)})))()}}},h=f,b=a("bdd7"),g=Object(b["a"])(h,n,r,!1,null,null,null);t["default"]=g.exports},"3b74":function(e,t,a){},"3c103":function(e,t,a){},4579:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"nodelist"},[a("div",{staticClass:"operation"},[a("el-button",{attrs:{icon:"el-icon-search",type:"primary"}}),a("el-button",{attrs:{icon:"el-icon-delete",type:"danger"}}),a("el-button",{attrs:{icon:"el-icon-date",type:"danger"}})],1)])},r=[],i={data:function(){return{}},mounted:function(){},methods:{}},s=i,o=(a("d4d8"),a("bdd7")),l=Object(o["a"])(s,n,r,!1,null,"045c1d7b",null);t["default"]=l.exports},"4a31":function(e,t,a){},"4b37":function(e,t,a){"use strict";a("93b7")},"4e73":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mycontainer"},[a("div",{staticClass:"ticker-dialog"},[a("div",{staticClass:"home_dialog"},[a("el-dialog",{attrs:{"append-to-body":!0,title:e.detail.name,visible:e.showdeviceFlag,width:"100vh"},on:{"update:visible":function(t){e.showdeviceFlag=t}}},[a("change-Step",{ref:"ChangeStep",attrs:{detail:e.detail,"show-footer":e.isfooter,"show-hard":e.ishard,step:e.step}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:0==e.detail.status&&e.isfooter,expression:"detail.status == 0 && isfooter"}],attrs:{type:"primary"},on:{click:function(t){return e.dispatch()}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.Dispatch"))+" ")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:1==e.detail.status,expression:"detail.status == 1"}],on:{click:function(t){return e.backChange(e.detail)}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.back"))+" ")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:2==e.detail.status&&e.isfooter,expression:"detail.status == 2 && isfooter"}],attrs:{type:"primary"},on:{click:function(t){return e.Reassign(e.detail)}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.Reassign"))+" ")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:2==e.detail.status&&e.isfooter,expression:"detail.status == 2 && isfooter"}],attrs:{type:"primary"},on:{click:function(t){return e.check()}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.check"))+" ")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:1==e.detail.status&&e.isfooter,expression:"detail.status == 1 && isfooter"}],attrs:{type:"primary"},on:{click:function(t){return e.dealwith()}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.deal with"))+" ")])],1)],1),a("el-dialog",{attrs:{"append-to-body":!0,title:e.$translateTitle("Maintenance.create Ticket"),visible:e.dialogFormVisible,width:"90vh"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"form",staticClass:"create-ticker",attrs:{"label-width":"auto",model:e.form,rules:e.rules,size:"medium "}},[a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.project"),prop:"product"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$translateTitle("Maintenance.Please choose the product")},on:{change:e.prodChange},model:{value:e.form.product,callback:function(t){e.$set(e.form,"product",t)},expression:"form.product"}},e._l(e._Product,(function(e,t){return a("el-option",{directives:[{name:"show",rawName:"v-show",value:0!=e.objectId,expression:"item.objectId != 0"}],key:t,attrs:{label:e.name,value:e.objectId}})})),1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.Equipment name"),prop:"name"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{disabled:!e.Device.length,placeholder:0==e.Device.length?e.$translateTitle("Maintenance.Please choose the product"):e.$translateTitle("Maintenance.Please select a device")},on:{change:e.deviceChange},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}},e._l(e.Device,(function(e,t){return a("el-option",{directives:[{name:"show",rawName:"v-show",value:e.objectId,expression:"item.objectId"}],key:t,attrs:{label:e.name,value:e.objectId}})})),1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.Ticket type"),prop:"type"}},[a("el-input",{model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.Ticket description")}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.photo")}},[a("el-upload",{attrs:{action:"#","auto-upload":!0,"http-request":e.myUpload,"list-type":"picture-card"}},[a("i",{staticClass:"el-icon-plus",attrs:{slot:"default"},slot:"default"}),e._l(e.form.photo,(function(e,t){return a("div",{key:t},[a("img",{staticClass:"el-upload-list__item-thumbnail",attrs:{alt:"",src:e.url}})])}))],2),a("el-dialog",{attrs:{"append-to-body":!0,visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("img",{attrs:{alt:"",src:e.dialogImageUrl,width:"100%"}})])],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.submitForm("form")}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.Create now"))+" ")]),a("el-button",{on:{click:function(t){return e.resetForm("form")}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.Reset"))+" ")])],1)],1)],1)]),a("vab-query-form",{staticClass:"query-form"},[a("vab-query-form-top-panel",[a("el-form",{attrs:{inline:!0,"label-width":"auto",model:e.queryForm},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.number")}},[a("el-input",{attrs:{clearable:"",placeholder:e.$translateTitle("Maintenance.Ticket number")},model:{value:e.queryForm.number,callback:function(t){e.$set(e.queryForm,"number","string"===typeof t?t.trim():t)},expression:"queryForm.number"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.projects")}},[a("el-select",{attrs:{clearable:"",placeholder:e.$translateTitle("Maintenance.project")},model:{value:e.queryForm.product,callback:function(t){e.$set(e.queryForm,"product",t)},expression:"queryForm.product"}},e._l(e._Product,(function(e,t){return a("el-option",{directives:[{name:"show",rawName:"v-show",value:0!=e.objectId,expression:"item.objectId != 0"}],key:t,attrs:{label:e.name,value:e.objectId}})})),1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.type")}},[a("el-input",{attrs:{clearable:"",placeholder:e.$translateTitle("Maintenance.Ticket type")},model:{value:e.queryForm.type,callback:function(t){e.$set(e.queryForm,"type",t)},expression:"queryForm.type"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.times")}},[a("el-date-picker",{attrs:{"end-placeholder":e.$translateTitle("Maintenance.end time"),format:"yyyy-MM-dd","start-placeholder":e.$translateTitle("Maintenance.start time"),type:"daterange","value-format":"yyyy-MM-dd"},model:{value:e.queryForm.searchDate,callback:function(t){e.$set(e.queryForm,"searchDate",t)},expression:"queryForm.searchDate"}})],1),a("el-form-item",[a("el-button",{attrs:{icon:"el-icon-search",size:"mini",type:"primary"},on:{click:e.fetchData}},[e._v(" "+e._s(e.$translateTitle("Maintenance.search"))+" ")]),a("el-button",{attrs:{disabled:!e.selectedList.length,icon:"el-icon-s-promotion",size:"mini",type:"primary"},on:{click:function(t){return e.batchExport(e.selectedList)}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.Export"))+" ")])],1)],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"tableSort",attrs:{border:"",data:e.list,height:e.height,stripe:""},on:{"selection-change":e.changeBox},scopedSlots:e._u([{key:"empty",fn:function(){return[a("vab-empty")]},proxy:!0}])},[a("el-table-column",{attrs:{align:"center","class-name":"isCheck","show-overflow-tooltip":"",type:"selection",width:"55"}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("Maintenance.Ticket number"),prop:"number","show-overflow-tooltip":"",sortable:"",width:"120"}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("Maintenance.Ticket type"),prop:"type","show-overflow-tooltip":"",sortable:""}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("Maintenance.Ticket status"),"show-overflow-tooltip":"",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(e.getStatus(a.status,a))+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("Maintenance.project"),"show-overflow-tooltip":"",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.info&&a.info.productname?a.info.productname:"")+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("Maintenance.Equipment name"),"show-overflow-tooltip":"",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.info&&a.info.devicename?a.info.devicename:"")+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("Maintenance.Initiator"),"show-overflow-tooltip":"",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.info&&a.info.createdname?a.info.createdname:"")+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("Maintenance.the starting time"),"show-overflow-tooltip":"",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(e.$moment(a.createdAt).format("YYYY-MM-DD HH:mm:ss"))+" ")]}}])}),a("el-table-column",{attrs:{align:"center",fixed:"right",label:e.$translateTitle("Maintenance.operating"),width:"220"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.showInfo(n,!0,!1)}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.View"))+" ")]),a("el-button",{attrs:{size:"mini",type:"success"},nativeOn:{click:function(t){return e.showInfo(n)}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.Dispatch"))+" ")])]}}])})],1),a("vab-Pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],attrs:{limit:e.queryForm.pageSize,page:e.queryForm.pageNo,total:e.total},on:{"update:limit":function(t){return e.$set(e.queryForm,"pageSize",t)},"update:page":function(t){return e.$set(e.queryForm,"pageNo",t)},pagination:e.fetchData}})],1)},r=[],i=a("fb07"),s=a("e97b"),o=a("d0d7"),l=a.n(o),c=(a("c4bc"),a("16b8"),a("80ab"),a("a98c"),a("3dec"),a("9c6a"),a("79da"),a("0941")),u=a("dcc6"),d=a("1285"),m=a("5880"),p=a("12674"),f=a("824b"),h={name:"DispatchTicket",components:{ChangeStep:f["default"]},data:function(){return{created:0,Assigned:0,showdeviceFlag:!1,form:{receiveuseid:"",productname:"",devicename:"",createdname:"",receiveusername:"",receiveuserphone:"",name:"",product:"",type:"",description:"",photo:[],objectId:""},dialogFormVisible:!1,fold:!1,step:1,ishard:!1,height:this.$baseTableHeight(0)-30,isfooter:!0,detail:{},AllDevice:[],selectedList:[],types:["故障维修"],Device:[],dialogImageUrl:"",dialogVisible:!1,disabled:!1,formLabelWidth:"140px",rules:{product:[{required:!0,message:"请选择所属项目",trigger:"change"}],name:[{required:!0,message:"请选择设备",trigger:"change"}],type:[{required:!0,message:"请输入工单类型",trigger:"change"}]},list:[],listLoading:!1,layout:"total, sizes, prev, pager, next, jumper",total:0,status:[{key:0,text:"Maintenance.To be assigned"},{key:1,text:"Maintenance.Assigned"},{key:2,text:"Maintenance.Processed"},{key:3,text:"Maintenance.Statement"}],queryForm:{devicename:"",statusFlag:!1,status:"",number:"",product:"",type:"",pageNo:1,pageSize:20,searchDate:[],limt:10,skip:0,order:"-createdAt",keys:"count(*)"}}},computed:Object(s["a"])(Object(s["a"])({},Object(m["mapGetters"])({_Product:"user/_Product",objectid:"user/objectId",role:"acl/role",username:"user/username"})),{},{_deviceStep:{get:function(){return this.$store.state.global._deviceStep},set:function(e){this.set_deviceStepg(e)}},aclObj:function(){var e={};return this.role.map((function(t){e["".concat("role:"+t.name)]={read:!0,write:!0}})),e}}),watch:{_deviceStep:function(e){-1==e&&(this.showdeviceFlag=!1,this.fetchData())},"queryForm.status":function(e){this.queryForm.statusFlag=""!=e}},created:function(){},mounted:function(){this.fetchData(),this.handleCreated("created")},methods:Object(s["a"])(Object(s["a"])({myUpload:function(e){var t=this,a={headers:{proxy:!0,produrl:"/",devurl:"iotapi/"}};Object(p["UploadImg"])(e.file,a).then((function(e){e.data.url&&t.form.photo.push(e.data.url)})).catch((function(e){}))},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;t.createdTicket(t.form)}))},createdTicket:function(e){var t=this;return Object(i["a"])(l.a.mark((function a(){var n,r,i;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n={},n["".concat(t.objectid)]={read:!0,write:!0},r={number:moment(new Date).unix()+"",type:e.type,ACL:_.merge(n,t.aclObj),info:{photo:e.photo,timeline:[{timestamp:moment(new Date).format("YYYY-MM-DD HH:mm:ss"),h4:"生成工单",p:"".concat(t.username,"新建工单")}],description:e.description,step1:{},step2:{},step3:{},step4:{},productid:e.product,productname:e.productname,devicename:e.devicename,deviceid:e.name,createdname:t.username,receiveusername:e.receiveusername,receiveuseid:e.receiveuseid,receiveuserphone:e.receiveuserphone},device:{objectId:e.name,__type:"Pointer",className:"Device"}},i=t.$baseColorfullLoading(),a.next=6,Object(c["create_object"])("Maintenance",r);case 6:a.sent,i.close(),t.fetchData(),t.dialogFormVisible=!1;case 10:case"end":return a.stop()}}),a)})))()},resetForm:function(e){this.$refs[e].resetFields()},changeBox:function(e){var t=this;this.selectedList=[],e.forEach((function(e){t.selectedList.push(e)}))}},Object(m["mapMutations"])({set_deviceStep:"global/set_deviceStep"})),{},{handleFold:function(){this.fold=!this.fold,this.handleHeight()},batchExport:function(e){var t=this;return Object(i["a"])(l.a.mark((function a(){var n,r;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,n={results:[]},n["results"]=e,a.next=5,Object(p["exlout"])(n);case 5:r=a.sent,t.$convertRes2Blob(r),t.$message.success(t.$translateTitle("node.export success")),a.next=13;break;case 10:a.prev=10,a.t0=a["catch"](0),t.$message.error(t.$translateTitle("node.export error")+"".concat(a.t0));case 13:case"end":return a.stop()}}),a,null,[[0,10]])})))()},handleDelete:function(e,t){var a=this,n=[];2==t?n.push({method:"DELETE",path:"/classes/Maintenance/".concat(e.objectId),body:{}}):e.forEach((function(e){n.push({method:"DELETE",path:"/classes/Maintenance/".concat(e.objectId),body:{}})})),this.$baseConfirm(this.$translateTitle("Maintenance.Are you sure you want to delete the current item"),null,Object(i["a"])(l.a.mark((function e(){return l.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(u["batch"])(n);case 2:e.sent,a.$baseMessage(a.$translateTitle("Maintenance.successfully deleted"),"success","vab-hey-message-success"),setTimeout((function(){a.fetchData()}),1500);case 5:case"end":return e.stop()}}),e)}))))},handleHeight:function(){this.fold?this.height=this.$baseTableHeight(0)-20:this.height=this.$baseTableHeight(0)-30},getStatus:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;switch(e){case 0:return this.$translateTitle("Maintenance.To be assigned");case 1:return this.$translateTitle("Maintenance.Assigned");case 2:return this.$translateTitle("Maintenance.Processed");case 3:return this.$translateTitle("Maintenance.Statement");default:return e}},showInfo:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.showdeviceFlag=!1,this.ishard=t,this.isfooter=a;var n=e.status;this.detail=e,this.set_deviceStep(n),this.step=n+1,this.showdeviceFlag=!0},handleCreated:function(e){"created"==e?this.created++:this.Assigned++,this.fetchData()},fetchData:function(){var e=arguments,t=this;return Object(i["a"])(l.a.mark((function a(){var n,r,i,s;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=e.length>0&&void 0!==e[0]?e[0]:{},r.limit||(r=t.queryForm),t.listLoading=!1,i=t.$baseColorfullLoading(),s={limit:r.limit,order:r.order,skip:r.skip,keys:r.keys,where:{status:0,"info.receiveuseid":t.Assigned%2==0?{$ne:"99"}:t.objectid,number:t.queryForm.number.length?{$regex:t.queryForm.number}:{$ne:null},"info.productid":t.queryForm.product.length?t.queryForm.product:{$ne:"99"},type:t.queryForm.type.length?{$regex:t.queryForm.type}:{$ne:null}}},null!==(n=t.queryForm.searchDate)&&void 0!==n&&n.length&&(s.where["createdAt"]={$gt:{__type:"Date",iso:t.queryForm.searchDate[0]}},s.where["updatedAt"]={$lt:{__type:"Date",iso:t.queryForm.searchDate[1]}}),a.next=8,Object(c["query_object"])("Maintenance",s).then((function(e){var a=e.results,n=void 0===a?[]:a,r=e.count,s=void 0===r?0:r;t.list=n,t.list.forEach((function(e){if(e._user="暂无",e.ACL)for(var t in e.ACL)e._user=t.substr(0)})),t.total=s,i.close()})).catch((function(e){t.$message.error("".concat(e)),i.close()}));case 8:case"end":return a.stop()}}),a)})))()},prodChange:function(e){var t=this;return Object(i["a"])(l.a.mark((function a(){var n,r,i;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.Device=[],t._Product.map((function(a){a.objectId==e&&(t.form.productname=a.name)})),t.form.name="",n={where:{product:e}},a.next=6,Object(d["queryDevice"])(n);case 6:r=a.sent,i=r.results,t.Device=i;case 9:case"end":return a.stop()}}),a)})))()},deviceChange:function(e){var t=this;this.Device.map((function(a){a.objectId==e&&(t.form.devicename=a.name)}))},dispatch:function(){this.$refs.ChangeStep.$refs.step1.dispatchUser()},backChange:function(e){var t=this;return Object(i["a"])(l.a.mark((function a(){var n,r,i,s;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=e.objectId,r=e.info,r.timeline.push({timestamp:moment(new Date).format("YYYY-MM-DD HH:mm:ss"),h4:"已回退",p:"".concat(t.username," 回退了流程")}),i={status:0,info:r},a.next=5,Object(c["update_object"])("Maintenance",n,i);case 5:s=a.sent,s.updatedAt&&t.set_deviceStep(-1);case 7:case"end":return a.stop()}}),a)})))()},Reassign:function(e){var t=this;return Object(i["a"])(l.a.mark((function a(){var n,r,i,s;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=e.objectId,r=e.info,r.timeline.push({timestamp:moment(new Date).format("YYYY-MM-DD HH:mm:ss"),h4:"已改派",p:"".concat(t.username," 改派了工单")}),i={status:0,info:r},a.next=5,Object(c["update_object"])("Maintenance",n,i);case 5:s=a.sent,s.updatedAt&&t.set_deviceStep(-1);case 7:case"end":return a.stop()}}),a)})))()},dealwith:function(){this.$refs.ChangeStep.$refs.step2.dispatchUser()},check:function(){this.$refs.ChangeStep.$refs.step3.dispatchUser()}})},b=h,g=(a("1ec0"),a("bdd7")),v=Object(g["a"])(b,n,r,!1,null,"7e278d9c",null);t["default"]=v.exports},"4f46":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:e.$translateTitle("Maintenance.Work order information"),name:"first"}},[a("el-form",{ref:"form",staticClass:"create-ticker",attrs:{"label-width":"auto",model:e.form,size:"medium "}},[a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{lg:12,md:12,sm:24,xl:12,xs:24}},[a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.project")+": "}},[a("span",[e._v(e._s(e.form.info.productname))])])],1),a("el-col",{attrs:{lg:12,md:12,sm:24,xl:12,xs:24}},[a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.Equipment name")+": "}},[a("span",[e._v(e._s(e.form.info.devicename))])])],1),a("el-col",{attrs:{lg:12,md:12,sm:24,xl:12,xs:24}},[a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.Initiator")+": "}},[a("span",[e._v(e._s(e.form.info.createdname))])])],1),a("el-col",{attrs:{lg:24,md:24,sm:24,xl:24,xs:24}},[a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.Ticket description")+": "}},[e._v(" "+e._s(e.form.info.description)+" ")])],1),a("el-col",{attrs:{lg:24,md:24,sm:24,xl:24,xs:24}},[a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.photo")+": "}},[a("el-carousel",{attrs:{height:"200px",interval:2e3,type:"card"}},e._l(e.form.info.photo,(function(e,t){return a("el-carousel-item",{key:t},[a("img",{staticStyle:{width:"100%",height:"100%"},attrs:{alt:e,src:e,title:e}})])})),1)],1)],1),e.showFooter?a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.Processing records")+": "}},[a("el-input",{attrs:{placeholder:e.$translateTitle("Maintenance.Please record the processing content in detail!"),type:"textarea"},model:{value:e.form.info.step2.Remarks,callback:function(t){e.$set(e.form.info.step2,"Remarks",t)},expression:"form.info.step2.Remarks"}})],1)],1):e._e()],1)],1)],1),a("el-tab-pane",{staticStyle:{height:"90%","overflow-x":"hidden","overflow-y":"auto"},attrs:{label:e.$translateTitle("Maintenance.work process"),name:"second"}},[a("el-card",{attrs:{shadow:"hover"},scopedSlots:e._u([{key:"header",fn:function(){return[a("el-radio-group",{staticClass:"card-header-radio",model:{value:e.reverse,callback:function(t){e.reverse=t},expression:"reverse"}},[a("el-radio",{attrs:{label:!0}},[e._v(" "+e._s(e.$translateTitle("Maintenance.Positive order"))+" ")]),a("el-radio",{attrs:{label:!1}},[e._v(" "+e._s(e.$translateTitle("Maintenance.Reverse order"))+" ")])],1)]},proxy:!0}])},[a("el-timeline",{attrs:{reverse:e.reverse}},e._l(e.form.info.timeline,(function(t){return a("el-timeline-item",{key:t.timestamp,attrs:{placement:"top",timestamp:t.timestamp}},[a("el-card",[a("h4",[e._v(e._s(t.h4))]),a("p",[e._v(e._s(t.p))])])],1)})),1)],1)],1)],1)],1)},r=[],i=a("fb07"),s=a("e97b"),o=a("d0d7"),l=a.n(o),c=(a("d6a4"),a("0941")),u=a("8665"),d=a("5880"),m={props:{detail:{type:Object,default:function(){}},step:{type:Number,default:2},showFooter:{type:Boolean,default:!1}},data:function(){return{reverse:!0,activeName:"first",form:this.detail}},computed:Object(s["a"])({},Object(d["mapGetters"])({username:"user/username"})),mounted:function(){this.featUser()},methods:Object(s["a"])(Object(s["a"])({},Object(d["mapMutations"])({set_deviceFlag:"global/set_deviceFlag",set_deviceStep:"global/set_deviceStep"})),{},{featUser:function(){var e=this;return Object(i["a"])(l.a.mark((function t(){var a,n;return l.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(u["queryUser"])({});case 2:a=t.sent,n=a.results,e.user=n;case 5:case"end":return t.stop()}}),t)})))()},dispatchUser:function(){var e=this;this.$refs["form"].validate(function(){var t=Object(i["a"])(l.a.mark((function t(a){var n,r,i,s,o;return l.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a||!e.form.info.receiveusername){t.next=10;break}return n=e.form,r=n.objectId,i=n.info,i.timeline.push({timestamp:moment(new Date).format("YYYY-MM-DD HH:mm:ss"),h4:"已处理",p:"".concat(e.username,"处理了这条工单")}),s={status:2,info:i},t.next=6,Object(c["update_object"])("Maintenance",r,s);case 6:o=t.sent,o.updatedAt&&(e.set_deviceFlag(!1),e.set_deviceStep(-1)),t.next=12;break;case 10:return e.$message.error("请选择分配人员"),t.abrupt("return",!1);case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}})},p=m,f=(a("56c8"),a("bdd7")),h=Object(f["a"])(p,n,r,!1,null,"389009b4",null);t["default"]=h.exports},"56b5":function(e,t,a){"use strict";a("be74")},"56c8":function(e,t,a){"use strict";a("3c103")},"57c9":function(e,t,a){},"623f":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"resourcechannel resourcechannel-container"},[a("div",{staticClass:"firsttable"},[a("vab-input",{ref:"uploadFinish",attrs:{params:e.inputParams},on:{fileInfo:e.fileInfo,files:e.files}}),a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.fileParams,size:"small"}},[a("el-form-item",{attrs:{label:e.$translateTitle("application.scene")}},[a("el-input",{model:{value:e.fileParams.scene,callback:function(t){e.$set(e.fileParams,"scene",t)},expression:"fileParams.scene"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("developer.path")}},[a("el-input",{attrs:{placeholder:e.$translateTitle("application.pathdescription")},model:{value:e.fileParams.path,callback:function(t){e.$set(e.fileParams,"path",t)},expression:"fileParams.path"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.uploadCkick()}}},[e._v(" "+e._s(e.$translateTitle("application.uploadfile"))+" ")])],1)],1),a("el-breadcrumb",{attrs:{separator:"/"}},[e._l(e.filebreadcrumb,(function(t,n){return[a("el-breadcrumb-item",{key:n,nativeOn:{click:function(a){return e.breadcrumbClick(t)}}},[e._v(" "+e._s(t.name)+" ")])]}))],2),a("h5"),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"tableRef",staticStyle:{width:"100%"},attrs:{"cell-style":{"text-align":"center"},data:e.filelist,"header-cell-style":{"text-align":"center"}},on:{"row-click":e.fileclick}},[a("el-table-column",{attrs:{label:e.$translateTitle("developer.filename"),prop:"name","show-overflow-tooltip":"",sortable:""}}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.filesize"),prop:"name","show-overflow-tooltip":"",sortable:"",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[n.is_dir?a("span",[e._v(e._s("-"))]):a("span",[e._v(e._s(Math.round(n.size/1024)+"kb"))])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.filemtime"),prop:"name","show-overflow-tooltip":"",sortable:"",width:"260"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(" "+e._s(e.$moment(1e3*n.mtime).format("YYYY-MM-DD HH:mm:ss"))+" ")])]}}])}),a("el-table-column",{attrs:{fixed:"right",label:e.$translateTitle("developer.operation"),width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[n.is_dir?e._e():a("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return t.stopPropagation(),e.get_fileinfo(n)}}},[e._v(" "+e._s(e.$translateTitle("application.detail"))+" ")]),n.is_dir?e._e():a("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return t.stopPropagation(),e.download_file(n)}}},[e._v(" "+e._s(e.$translateTitle("application.preview"))+" ")]),n.is_dir?e._e():a("el-button",{attrs:{slot:"reference",size:"mini",type:"danger"},nativeOn:{click:function(t){return t.stopPropagation(),e.delete_file(n)}},slot:"reference"},[e._v(" "+e._s(e.$translateTitle("developer.delete"))+" ")])]}}])})],1),a("el-dialog",{attrs:{model:e.detailinfo,title:"文件信息",visible:e.detailView,width:"30%"},on:{"update:visible":function(t){e.detailView=t}}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.ViewLoading,expression:"ViewLoading"}]},[a("el-form-item",{attrs:{label:"名称","label-width":"200"}},[a("span",[e._v(e._s(e.detailinfo.rename))])]),a("el-form-item",{attrs:{label:"路径","label-width":"200"}},[a("span",[e._v(e._s(e.detailinfo.path))])]),a("el-form-item",{attrs:{label:"url","label-width":"200"}},[a("span",[e._v(e._s(e.detailinfo.url))])]),a("el-form-item",{attrs:{label:"MD5","label-width":"200"}},[a("span",[e._v(e._s(e.detailinfo.md5))])]),a("el-form-item",{attrs:{label:"场景","label-width":"200"}},[a("span",[e._v(e._s(e.detailinfo.scene))])]),a("el-form-item",{attrs:{label:"大小","label-width":"200"}},[a("span",[e._v(e._s(Math.round(e.detailinfo.size/1024)+"kb"))])]),a("el-form-item",{attrs:{label:"日期","label-width":"200"}},[a("span",[e._v(" "+e._s(e.$moment(1e3*e.detailinfo.timeStamp).format("YYYY-MM-DD HH:mm:ss"))+" ")])])],1)],1)],1)])},r=[],i=(a("16b8"),a("e170"),a("3dec"),a("4656"),a("1ae2")),s={data:function(){return{filelist:[],filebreadcrumb:[{name:"全部文件",path:"dgiot_file",is_dir:!0}],fileParams:{scene:"app"},inputParams:{},parentfile:"dgiot_file",listLoading:!1,ViewLoading:!1,detailView:!1,detailinfo:{}}},watch:{},mounted:function(){this.get_filelist(this.parentfile)},methods:{breadcrumbClick:function(e){if("全部文件"==e.name)this.filebreadcrumb=[{name:"全部文件",path:"dgiot_file"}],this.get_filelist(e.path);else{if(e.child)for(var t=0;t<this.filebreadcrumb.length;t++)this.filebreadcrumb[t].path==e.child.path&&this.filebreadcrumb.splice(t,1);this.get_filelist(e.path+"/"+e.name)}},fileclick:function(e){if(e.is_dir){this.get_filelist(e.path+"/"+e.name);var t=this.filebreadcrumb.length-1,a="child";this.filebreadcrumb[t][a]=e,this.filebreadcrumb.push(e)}else window.open(this.$FileServe+"/"+e.path+"/"+e.name)},uploadCkick:function(){this.loading=!0,this.$refs["uploadFinish"].$refs.uploader.dispatchEvent(new MouseEvent("click")),this.inputParams={file:"",scene:this.fileParams.scene?this.fileParams.scene:"default",path:this.fileParams.path?this.fileParams.path:"default",filename:moment(new Date).valueOf().toString()}},fileInfo:function(e){this.listLoading=!0,e.url?(this.$message({type:"success",message:"上传成功"}),this.get_filelist(this.parentfile)):this.$message({type:"error",message:"上传失败"}),this.listLoading=!1},files:function(e){this.inputParams.filename=e.name,this.inputParams.file=e},get_filelist:function(e){var t=this;this.listLoading=!0,Object(i["list_dir"])(e).then((function(e){"ok"==e.status?t.filelist=e.data:t.filelist=[],t.listLoading=!1}))},get_fileinfo:function(e){var t=this;this.detailView=!0,this.ViewLoading=!0,Object(i["file_info"])("files/"+e.path+"/"+e.name).then((function(a){t.detailinfo=a.data,t.detailinfo.url=t.$FileServe+"/"+e.path+"/"+e.name,t.ViewLoading=!1}))},delete_file:function(e){var t=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(i["delete_file"])("files/"+e.path+"/"+e.name).then((function(a){"ok"==a.status?(t.$message({type:"success",message:"删除成功"}),t.get_filelist(e.path)):t.$message({type:"error",message:a.message})})).catch((function(){t.$message({type:"error",message:"删除失败"})}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},download_file:function(e){window.open(this.$FileServe+"/"+e.path+"/"+e.name)}}},o=s,l=(a("ecf4"),a("a817"),a("bdd7")),c=Object(l["a"])(o,n,r,!1,null,"2d623961",null);t["default"]=c.exports},"697bb":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mycontainer"},[a("div",{staticClass:"ticker-dialog"},[a("div",{staticClass:"home_dialog"},[a("el-dialog",{attrs:{"append-to-body":!0,title:e.detail.name,visible:e._deviceFlag,width:"100vh"},on:{"update:visible":function(t){e._deviceFlag=t}}},[a("change-info",{ref:"changeinfo",attrs:{detail:e.detail,"show-footer":e.isfooter,"show-hard":e.ishard,step:e.step}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:0==e.detail.status,expression:"detail.status == 0"}],on:{click:function(t){return e.set_deviceFlag(!1)}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:0==e.detail.status&&e.isfooter,expression:"detail.status == 0 && isfooter"}],attrs:{type:"primary"},on:{click:function(t){return e.dispatch()}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.Dispatch"))+" ")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:1==e.detail.status,expression:"detail.status == 1"}],on:{click:function(t){return e.backChange(e.detail)}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.back"))+" ")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:2==e.detail.status&&e.isfooter,expression:"detail.status == 2 && isfooter"}],attrs:{type:"primary"},on:{click:function(t){return e.Reassign(e.detail)}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.Reassign"))+" ")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:2==e.detail.status&&e.isfooter,expression:"detail.status == 2 && isfooter"}],attrs:{type:"primary"},on:{click:function(t){return e.check()}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.check"))+" ")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:1==e.detail.status&&e.isfooter,expression:"detail.status == 1 && isfooter"}],attrs:{type:"primary"},on:{click:function(t){return e.dealwith()}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.deal with"))+" ")])],1)],1),a("el-dialog",{attrs:{"append-to-body":!0,title:e.$translateTitle("Maintenance.create Ticket"),visible:e.dialogFormVisible,width:"90vh"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"form",staticClass:"create-ticker",attrs:{"label-width":"auto",model:e.form,rules:e.rules,size:"medium "}},[a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.project"),prop:"product"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$translateTitle("Maintenance.Please choose the product")},on:{change:e.prodChange},model:{value:e.form.product,callback:function(t){e.$set(e.form,"product",t)},expression:"form.product"}},e._l(e._Product,(function(e,t){return a("el-option",{directives:[{name:"show",rawName:"v-show",value:0!=e.objectId,expression:"item.objectId != 0"}],key:t,attrs:{label:e.name,value:e.objectId}})})),1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.Equipment name"),prop:"name"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{disabled:!e.Device.length,placeholder:0==e.Device.length?e.$translateTitle("Maintenance.Please choose the product"):e.$translateTitle("Maintenance.Please select a device")},on:{change:e.deviceChange},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}},e._l(e.Device,(function(e,t){return a("el-option",{directives:[{name:"show",rawName:"v-show",value:e.objectId,expression:"item.objectId"}],key:t,attrs:{label:e.name,value:e.objectId}})})),1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.Ticket type"),prop:"type"}},[a("el-input",{model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.Ticket description")}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.photo")}},[a("el-upload",{attrs:{action:"#","auto-upload":!0,"http-request":e.myUpload,"list-type":"picture-card"}},[a("i",{staticClass:"el-icon-plus",attrs:{slot:"default"},slot:"default"}),e._l(e.form.photo,(function(e,t){return a("div",{key:t},[a("img",{staticClass:"el-upload-list__item-thumbnail",attrs:{alt:"",src:e.url}})])}))],2),a("el-dialog",{attrs:{"append-to-body":!0,visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("img",{attrs:{alt:"",src:e.dialogImageUrl,width:"100%"}})])],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.submitForm("form")}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.Create now"))+" ")]),a("el-button",{on:{click:function(t){return e.resetForm("form")}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.Reset"))+" ")])],1)],1)],1)]),a("vab-query-form",{staticClass:"query-form"},[a("vab-query-form-top-panel",[a("el-form",{attrs:{inline:!0,"label-width":"auto",model:e.queryForm},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.number")}},[a("el-input",{attrs:{clearable:"",placeholder:e.$translateTitle("Maintenance.Ticket number")},model:{value:e.queryForm.number,callback:function(t){e.$set(e.queryForm,"number","string"===typeof t?t.trim():t)},expression:"queryForm.number"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.projects")}},[a("el-select",{attrs:{clearable:"",placeholder:e.$translateTitle("Maintenance.project")},model:{value:e.queryForm.product,callback:function(t){e.$set(e.queryForm,"product",t)},expression:"queryForm.product"}},e._l(e._Product,(function(e,t){return a("el-option",{directives:[{name:"show",rawName:"v-show",value:0!=e.objectId,expression:"item.objectId != 0"}],key:t,attrs:{label:e.name,value:e.objectId}})})),1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.type")}},[a("el-input",{attrs:{clearable:"",placeholder:e.$translateTitle("Maintenance.Ticket type")},model:{value:e.queryForm.type,callback:function(t){e.$set(e.queryForm,"type",t)},expression:"queryForm.type"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.times")}},[a("el-date-picker",{attrs:{"end-placeholder":e.$translateTitle("Maintenance.end time"),format:"yyyy-MM-dd","start-placeholder":e.$translateTitle("Maintenance.start time"),type:"daterange","value-format":"yyyy-MM-dd"},model:{value:e.queryForm.searchDate,callback:function(t){e.$set(e.queryForm,"searchDate",t)},expression:"queryForm.searchDate"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.status")}},[a("el-select",{attrs:{clearable:"",placeholder:e.$translateTitle("Maintenance.Ticket status")},model:{value:e.queryForm.status,callback:function(t){e.$set(e.queryForm,"status",t)},expression:"queryForm.status"}},e._l(e.status,(function(t){return a("el-option",{key:t.key,attrs:{label:e.$translateTitle(t.text),value:t.key}})})),1),a("el-button",{attrs:{icon:"el-icon-search",size:"mini",type:"primary"},on:{click:e.fetchData}},[e._v(" "+e._s(e.$translateTitle("Maintenance.search"))+" ")])],1),a("el-form-item",[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:e.handleFold}},[e.fold?a("span",[e._v(" "+e._s(e.$translateTitle("Maintenance.Unfold"))+" ")]):a("span",[e._v(e._s(e.$translateTitle("Maintenance.merge")))]),a("vab-icon",{staticClass:"vab-dropdown",class:{"vab-dropdown-active":e.fold},attrs:{icon:"arrow-up-s-line"}})],1)],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!e.fold,expression:"!fold"}]},[a("el-button",{attrs:{icon:"el-icon-circle-plus-outline",size:"mini",type:"primary"},on:{click:function(t){e.dialogFormVisible=!e.dialogFormVisible}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.create Ticket"))+" ")]),a("el-button",{attrs:{disabled:!e.selectedList.length,icon:"el-icon-s-promotion",size:"mini",type:"primary"},on:{click:function(t){return e.batchExport(e.selectedList)}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.Export"))+" ")]),a("el-button",{attrs:{disabled:!e.selectedList.length,icon:"el-icon-delete",size:"mini",type:"danger"},on:{click:function(t){return e.handleDelete(e.selectedList,1)}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.batch deletion"))+" ")])],1)],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"tableSort",attrs:{border:"",data:e.list,height:e.height,stripe:""},on:{"selection-change":e.changeBox},scopedSlots:e._u([{key:"empty",fn:function(){return[a("vab-empty")]},proxy:!0}])},[a("el-table-column",{attrs:{align:"center","class-name":"isCheck","show-overflow-tooltip":"",type:"selection",width:"55"}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("Maintenance.Ticket number"),prop:"number","show-overflow-tooltip":"",sortable:"",width:"120"}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("Maintenance.Ticket type"),prop:"type","show-overflow-tooltip":"",sortable:""}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("Maintenance.Ticket status"),"show-overflow-tooltip":"",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(e.getStatus(a.status,a))+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("Maintenance.project"),"show-overflow-tooltip":"",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.info&&a.info.productname?a.info.productname:"")+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("Maintenance.Equipment name"),"show-overflow-tooltip":"",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.info&&a.info.devicename?a.info.devicename:"")+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("Maintenance.Initiator"),"show-overflow-tooltip":"",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.info&&a.info.createdname?a.info.createdname:"")+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("Maintenance.the starting time"),"show-overflow-tooltip":"",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(e.$moment(a.createdAt).format("YYYY-MM-DD HH:mm:ss"))+" ")]}}])}),a("el-table-column",{attrs:{align:"center",fixed:"right",label:e.$translateTitle("Maintenance.operating"),width:"220"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.showInfo(n,!0,!1)}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.View"))+" ")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:1==n.status,expression:"row.status == 1"}],attrs:{size:"mini",type:"success"},on:{click:function(t){return e.showInfo(n)}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.deal with"))+" ")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:2==n.status,expression:"row.status == 2"}],attrs:{size:"mini",type:"info"},on:{click:function(t){return e.showInfo(n)}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.Evaluation"))+" ")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:3!=n.status,expression:"row.status != 3"}],attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleDelete(n,2)}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.delete"))+" ")])]}}])})],1),a("vab-Pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],attrs:{limit:e.queryForm.pageSize,page:e.queryForm.pageNo,total:e.total},on:{"update:limit":function(t){return e.$set(e.queryForm,"pageSize",t)},"update:page":function(t){return e.$set(e.queryForm,"pageNo",t)},pagination:e.fetchData}})],1)},r=[],i=a("fb07"),s=a("e97b"),o=a("d0d7"),l=a.n(o),c=(a("c4bc"),a("16b8"),a("f1e1"),a("80ab"),a("a98c"),a("3dec"),a("9c6a"),a("79da"),a("0941")),u=a("dcc6"),d=a("1285"),m=a("5880"),p=a("e915"),f=a("12674"),h={name:"MyWork",components:{ChangeInfo:p["default"]},data:function(){return{created:0,Assigned:0,form:{receiveuseid:"",productname:"",devicename:"",createdname:"",receiveusername:"",receiveuserphone:"",name:"",product:"",type:"",description:"",photo:[],objectId:""},dialogFormVisible:!1,fold:!1,step:1,ishard:!1,height:this.$baseTableHeight(0)-30,isfooter:!0,detail:{},AllDevice:[],selectedList:[],types:["故障维修"],Device:[],dialogImageUrl:"",dialogVisible:!1,disabled:!1,formLabelWidth:"140px",rules:{product:[{required:!0,message:"请选择所属项目",trigger:"change"}],name:[{required:!0,message:"请选择设备",trigger:"change"}],type:[{required:!0,message:"请输入工单类型",trigger:"change"}]},list:[],listLoading:!1,layout:"total, sizes, prev, pager, next, jumper",total:0,status:[{key:0,text:"Maintenance.To be assigned"},{key:1,text:"Maintenance.Assigned"},{key:2,text:"Maintenance.Processed"},{key:3,text:"Maintenance.Statement"}],queryForm:{devicename:"",statusFlag:!1,status:"",number:"",product:"",type:"",pageNo:1,pageSize:20,searchDate:[],limt:10,skip:0,order:"-createdAt",keys:"count(*)"}}},computed:Object(s["a"])(Object(s["a"])({},Object(m["mapGetters"])({_Product:"user/_Product",objectid:"user/objectId",role:"acl/role",username:"user/username"})),{},{_deviceFlag:{get:function(){return this.$store.state.global._deviceFlag},set:function(e){this.set_deviceFlag(e)}},aclObj:function(){var e={};return this.role.map((function(t){e["".concat("role:"+t.name)]={read:!0,write:!0}})),e}}),watch:{_deviceFlag:function(e){0==e&&this.fetchData()},"queryForm.status":function(e){this.queryForm.statusFlag=""!=e}},created:function(){},mounted:function(){this.handleCreated("created")},methods:Object(s["a"])(Object(s["a"])({myUpload:function(e){var t=this,a=e.file,n=a.name.substring(a.name.lastIndexOf(".")+1),r={file:a,path:"ticket",filename:"ticket"+"".concat(moment().format("x"),".").concat(n)};Object(f["UploadImg"])(r).then((function(e){e.data.url&&t.form.photo.push(e.data.url)})).catch((function(e){}))},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;t.createdTicket(t.form)}))},createdTicket:function(e){var t=this;return Object(i["a"])(l.a.mark((function a(){var n,r,i;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n={},n[t.objectid]={read:!0,write:!0},r={number:moment(new Date).unix()+"",type:e.type,ACL:_.merge(n,t.aclObj),info:{photo:e.photo,timeline:[{timestamp:moment(new Date).format("YYYY-MM-DD HH:mm:ss"),h4:"生成工单",p:"".concat(t.username,"新建工单")}],description:e.description,step1:{},step2:{},step3:{},step4:{},productid:e.product,productname:e.productname,devicename:e.devicename,deviceid:e.name,createdname:t.username,receiveusername:e.receiveusername,receiveuseid:e.receiveuseid,receiveuserphone:e.receiveuserphone},device:{objectId:e.name,__type:"Pointer",className:"Device"}},i=t.$baseColorfullLoading(),a.next=6,Object(c["create_object"])("Maintenance",r);case 6:a.sent,i.close(),t.fetchData(),t.dialogFormVisible=!1;case 10:case"end":return a.stop()}}),a)})))()},resetForm:function(e){this.$refs[e].resetFields()},changeBox:function(e){var t=this;this.selectedList=[],e.forEach((function(e){t.selectedList.push(e)}))}},Object(m["mapMutations"])({set_deviceFlag:"global/set_deviceFlag"})),{},{handleFold:function(){this.fold=!this.fold,this.handleHeight()},batchExport:function(e){var t=this;return Object(i["a"])(l.a.mark((function a(){var n,r;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,n={results:[]},n["results"]=e,a.next=5,Object(f["exlout"])(n);case 5:r=a.sent,t.$convertRes2Blob(r),t.$message.success(t.$translateTitle("node.export success")),a.next=13;break;case 10:a.prev=10,a.t0=a["catch"](0),t.$message.error(t.$translateTitle("node.export error")+"".concat(a.t0));case 13:case"end":return a.stop()}}),a,null,[[0,10]])})))()},handleDelete:function(e,t){var a=this,n=[];2==t?n.push({method:"DELETE",path:"/classes/Maintenance/".concat(e.objectId),body:{}}):e.forEach((function(e){n.push({method:"DELETE",path:"/classes/Maintenance/".concat(e.objectId),body:{}})})),this.$baseConfirm(this.$translateTitle("Maintenance.Are you sure you want to delete the current item"),null,Object(i["a"])(l.a.mark((function e(){return l.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(u["batch"])(n);case 2:e.sent,a.$baseMessage(a.$translateTitle("Maintenance.successfully deleted"),"success","vab-hey-message-success"),setTimeout((function(){a.fetchData()}),1500);case 5:case"end":return e.stop()}}),e)}))))},handleHeight:function(){this.fold?this.height=this.$baseTableHeight(0)-20:this.height=this.$baseTableHeight(0)-30},getStatus:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;switch(e){case 0:return this.$translateTitle("Maintenance.To be assigned");case 1:return this.$translateTitle("Maintenance.Assigned");case 2:return this.$translateTitle("Maintenance.Processed");case 3:return this.$translateTitle("Maintenance.Statement");default:return e}},showInfo:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.ishard=t,this.isfooter=a;var n=e.status,r=void 0===n?0:n;this.detail=e,this.step=r+1,this.set_deviceFlag(!0)},handleCreated:function(e){"created"==e?this.created++:this.Assigned++,this.fetchData()},fetchData:function(){var e=arguments,t=this;return Object(i["a"])(l.a.mark((function a(){var n,r,i,s;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=e.length>0&&void 0!==e[0]?e[0]:{},r.limit||(r=t.queryForm),t.listLoading=!1,i=t.$baseColorfullLoading(),s={limit:r.limit,order:r.order,skip:r.skip,keys:r.keys,where:{"info.receiveuseid":t.Assigned%2==0?{$ne:"99"}:t.objectid,number:t.queryForm.number.length?{$regex:t.queryForm.number}:{$ne:null},status:t.queryForm.statusFlag?t.queryForm.status:{$ne:9},"info.productid":t.queryForm.product.length?t.queryForm.product:{$ne:"99"},type:t.queryForm.type.length?{$regex:t.queryForm.type}:{$ne:null}}},null!==(n=t.queryForm.searchDate)&&void 0!==n&&n.length&&(s.where["createdAt"]={$gt:{__type:"Date",iso:t.queryForm.searchDate[0]}},s.where["updatedAt"]={$lt:{__type:"Date",iso:t.queryForm.searchDate[1]}}),a.next=8,Object(c["query_object"])("Maintenance",s).then((function(e){var a=e.results,n=void 0===a?[]:a,r=e.count,s=void 0===r?0:r;t.list=n,t.list.forEach((function(e){if(e._user="暂无",e.ACL)for(var t in e.ACL)e._user=t.substr(0)})),t.total=s,i.close()})).catch((function(e){t.$message.error("".concat(e)),i.close()}));case 8:case"end":return a.stop()}}),a)})))()},prodChange:function(e){var t=this;return Object(i["a"])(l.a.mark((function a(){var n,r,i;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.Device=[],t._Product.map((function(a){a.objectId==e&&(t.form.productname=a.name)})),t.form.name="",n={where:{product:e}},a.next=6,Object(d["queryDevice"])(n);case 6:r=a.sent,i=r.results,t.Device=i;case 9:case"end":return a.stop()}}),a)})))()},deviceChange:function(e){var t=this;this.Device.map((function(a){a.objectId==e&&(t.form.devicename=a.name)}))},dispatch:function(){this.$refs.changeinfo.$refs.step1.dispatchUser()},backChange:function(e){var t=this;return Object(i["a"])(l.a.mark((function a(){var n,r,i,s;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=e.objectId,r=e.info,r.timeline.push({timestamp:moment(new Date).format("YYYY-MM-DD HH:mm:ss"),h4:"已回退",p:"".concat(t.username," 回退了流程")}),i={status:0,info:r},a.next=5,Object(c["update_object"])("Maintenance",n,i);case 5:s=a.sent,s.updatedAt&&t.set_deviceFlag(!1);case 7:case"end":return a.stop()}}),a)})))()},Reassign:function(e){var t=this;return Object(i["a"])(l.a.mark((function a(){var n,r,i,s;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=e.objectId,r=e.info,r.timeline.push({timestamp:moment(new Date).format("YYYY-MM-DD HH:mm:ss"),h4:"已改派",p:"".concat(t.username," 改派了工单")}),i={status:0,info:r},a.next=5,Object(c["update_object"])("Maintenance",n,i);case 5:s=a.sent,s.updatedAt&&t.set_deviceFlag(!1);case 7:case"end":return a.stop()}}),a)})))()},dealwith:function(){this.$refs.changeinfo.$refs.step2.dispatchUser()},check:function(){this.$refs.changeinfo.$refs.step3.dispatchUser()}})},b=h,g=(a("56b5"),a("bdd7")),v=Object(g["a"])(b,n,r,!1,null,"1419d1e6",null);t["default"]=v.exports},"6bff":function(e,t,a){"use strict";a("9667e")},"6cf2":function(e,t,a){},"6e51":function(e,t,a){},"6f23":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"logs logs-container",class:{"vab-fullscreen":e.isFullscreen}},[a("vab-query-form",[a("vab-query-form-top-panel",[a("el-form",{ref:"form",attrs:{inline:!0,"label-width":"auto",model:e.queryForm},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",{staticClass:"item-time",attrs:{label:e.$translateTitle("Maintenance.times")}},[a("el-date-picker",{staticClass:"item-time-picker",attrs:{"end-placeholder":e.$translateTitle("Maintenance.end time"),format:"yyyy-MM-dd","start-placeholder":e.$translateTitle("Maintenance.start time"),type:"daterange","value-format":"yyyy-MM-dd"},model:{value:e.queryForm.searchDate,callback:function(t){e.$set(e.queryForm,"searchDate",t)},expression:"queryForm.searchDate"}})],1),a("el-form-item",[a("el-button",{attrs:{icon:"el-icon-search","native-type":"submit",type:"primary"},on:{click:function(t){return e.queryTable({})}}}),a("el-button",{staticStyle:{margin:"0 10px 10px 10px !important"},attrs:{type:"success"},on:{click:e.handleHeight}},[a("vab-icon",{attrs:{icon:e.isFullscreen?"fullscreen-exit-fill":"fullscreen-fill"}})],1),a("el-popover",{attrs:{trigger:"hover"},scopedSlots:e._u([{key:"reference",fn:function(){return[a("el-button",{staticStyle:{margin:"0 0 10px 0 !important"},attrs:{icon:"el-icon-setting",type:"primary"}},[e._v(" "+e._s(e.$translateTitle("Logs.Draggable column settings"))+" ")])]},proxy:!0}])},[a("el-checkbox-group",{model:{value:e.checkList,callback:function(t){e.checkList=t},expression:"checkList"}},[a("vue-draggable",e._b({attrs:{list:e.logcolumns}},"vue-draggable",e.dragOptions,!1),e._l(e.logcolumns,(function(t,n){return a("div",{key:t+n},[a("vab-icon",{attrs:{icon:"drag-drop-line"}}),a("el-checkbox",{attrs:{disabled:!0===t.disableCheck,label:t}},[e._v(" "+e._s(t)+" ")])],1)})),0)],1)],1)],1)],1)],1)],1),a("el-table",{key:e.finallyColumns.length+e.momentKey,ref:"dragTable",staticClass:"logs-table",attrs:{border:"",data:e.logdata,height:e.height,"highlight-current-row":"",resizable:"","row-class-name":e.tableRowClassName,size:e.size,stripe:""},scopedSlots:e._u([{key:"empty",fn:function(){return[a("vab-empty")]},proxy:!0}])},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-descriptions",{staticClass:"margin-top",attrs:{border:"",column:2,size:e.size}},e._l(t.row.body,(function(t,n,r){return a("el-descriptions-item",{directives:[{name:"show",rawName:"v-show",value:"elm"!=n,expression:"key != 'elm'"}],key:r,attrs:{label:n,"label-class-name":"my-label"}},[e._v(" "+e._s(t)+" ")])})),1)]}}])}),e._l(e.finallyColumns,(function(e,t){return a("el-table-column",{key:t,attrs:{align:"center",label:e,prop:e,"show-overflow-tooltip":"",sortable:""}})})),a("el-table-column",{attrs:{align:"center",fixed:"right",label:"msg",prop:"msg.body","show-overflow-tooltip":"",sortable:""}})],2),a("vab-Pagination",{directives:[{name:"show",rawName:"v-show",value:e.queryForm.total>0,expression:"queryForm.total > 0"}],attrs:{limit:e.queryForm.pageSize,page:e.queryForm.pageNo,total:e.queryForm.total},on:{"update:limit":function(t){return e.$set(e.queryForm,"pageSize",t)},"update:page":function(t){return e.$set(e.queryForm,"pageNo",t)},pagination:e.queryTable}})],1)},r=[],i=a("fb07"),s=a("d0d7"),o=a.n(s),l=(a("a0e0"),a("3dec"),a("f764"),a("5662"),a("e170"),a("1d17"),a("4c87"),a("9c6a"),a("d6a4"),a("4656"),a("d292")),c={name:"AccessLog",data:function(){return{size:"",isFullscreen:!1,height:this.$baseTableHeight(0),logdata:[],momentKey:moment(new Date).valueOf(),checkList:["time","username","ip","method","path","code","reason","elapsedtime"],logcolumns:["time","username","ip","method","path","code","reason","elapsedtime"],queryForm:{total:0,count:"objectId",limit:20,pageNo:1,pageSize:20,skip:0,level:"",peername:"",pid:"",mfa:"",topic:"",domain:"parse_api",searchDate:[moment().subtract("days",7).format("YYYY-MM-DD"),moment(new Date).format("YYYY-MM-DD")],order:"-createdAt",keys:"count(*)"}}},computed:{dragOptions:function(){return{animation:600,group:"description"}},finallyColumns:function(){var e=this;return this.logcolumns.filter((function(t){return e.checkList.includes(t)}))}},created:function(){},mounted:function(){this.queryTable({}),this.rowDrop(),this.columnDrop()},methods:{handleHeight:function(){this.isFullscreen=!this.isFullscreen,this.isFullscreen?this.height=this.$baseTableHeight(0)+120:this.height=this.$baseTableHeight(0),this.momentKey=moment(new Date).valueOf()},tableRowClassName:function(e){var t=e.row;return t.disabled?"disabled":""},rowDrop:function(){var e=this.$refs.dragTable.$el.querySelector(".el-table__body-wrapper tbody"),t=this;Sortable.create(e,{draggable:".el-table__row",onEnd:function(e){var a=e.newIndex,n=e.oldIndex,r=t.logdata.splice(n,1)[0];t.logdata.splice(a,0,r)}})},columnDrop:function(){var e=this,t=this.$refs.dragTable.$el.querySelector(".el-table__header-wrapper tr");e.sortable=Sortable.create(t,{animation:180,delay:0,onEnd:function(t){var a=e.finallyColumns[t.oldIndex];e.finallyColumns.splice(t.oldIndex,1),e.finallyColumns.splice(t.newIndex,0,a),e.momentKey=moment(new Date).valueOf(),setTimeout((function(){e.rowDrop(),e.columnDrop()}),1500)}})},queryTable:function(){var e=arguments,t=this;return Object(i["a"])(o.a.mark((function a(){var n,r,i,s,c,u,d,m;return o.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=e.length>0&&void 0!==e[0]?e[0]:{},n.limit||(n=t.queryForm),r=t.$baseColorfullLoading(),a.prev=3,r.close(),i={limit:n.limit,skip:n.skip,order:n.order,count:t.queryForm.count,keys:"time,msg",include:"",where:{domain:t.queryForm.domain?{$all:t.queryForm.domain.split(/,(?=(?:[^']*(?:'[^']*')?[^']*)*$)/)}:{$ne:""},createdAt:{$gte:{__type:"Date",iso:"".concat(t.queryForm.searchDate[0],"T00:00:00.000Z")},$lte:{__type:"Date",iso:"".concat(t.queryForm.searchDate[1],"T23:59:59.000Z")}}}},a.next=8,Object(l["queryLog"])(i);case 8:s=a.sent,c=s.results,u=void 0===c?[]:c,d=s.count,m=void 0===d?0:d,u.forEach((function(e,a){e.time=t.$moment(Number(e.time.toString().substring(0,13))).format("YYYY-MM-DD HH:mm:ss.SSS");var n=JSON.parse(e.msg);for(var r in n)"body"==r?e["body"]=n["body"]:e[r]=n[r]})),t.logdata=u,t.queryForm.total=m,t.$baseMessage(t.$translateTitle("alert.Data request successfully"),"success","vab-hey-message-success"),r.close(),a.next=24;break;case 20:a.prev=20,a.t0=a["catch"](3),r.close(),t.$baseMessage(t.$translateTitle("alert.Data request error")+"".concat(a.t0),"error","vab-hey-message-error");case 24:t.momentKey=moment(new Date).valueOf();case 25:case"end":return a.stop()}}),a,null,[[3,20]])})))()}}},u=c,d=(a("1458"),a("2520"),a("bdd7")),m=Object(d["a"])(u,n,r,!1,null,"7ce71150",null);t["default"]=m.exports},"715c":function(e,t,a){},"74f5":function(e,t,a){},"75ab":function(e,t,a){},"76bf":function(e,t,a){e.exports={"menu-color":"rgba(255,255,255,.95)","menu-color-active":"rgba(255,255,255,.95)","menu-background":"#282c34","column-second-menu-background":"#fff"}},"77f9":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:e.className,style:{height:e.height,width:e.width}})},r=[],i=(a("1c6f"),a("b037"),a("3dec"),a("4656"),a("ed08")),s={props:{className:{type:String,default:"chart"},width:{type:String,default:"100%"},height:{type:String,default:"350px"},autoResize:{type:Boolean,default:!0}},data:function(){return{chart:null,sidebarElm:null}},mounted:function(){var e=this;this.initChart(),this.autoResize&&(this.__resizeHandler=Object(i["debounce"])((function(){e.chart&&e.chart.resize()}),100),window.addEventListener("resize",this.__resizeHandler)),this.sidebarElm=document.getElementsByClassName("sidebar-container")[0],this.sidebarElm&&this.sidebarElm.addEventListener("transitionend",this.sidebarResizeHandler)},beforeDestroy:function(){this.chart&&(this.autoResize&&window.removeEventListener("resize",this.__resizeHandler),this.sidebarElm&&this.sidebarElm.removeEventListener("transitionend",this.sidebarResizeHandler),this.chart.dispose(),this.chart=null)},methods:{sidebarResizeHandler:function(e){"width"===e.propertyName&&this.__resizeHandler()},setOptions:function(){var e=[100,80,60,40],t=["拱墅区","余杭区","西湖区","江干区"],a=[683,523,240,234];this.chart.setOption({xAxis:{show:!1},yAxis:[{show:!0,data:t,inverse:!0,axisLine:{show:!1},splitLine:{show:!1},axisTick:{show:!1},axisLabel:{color:"black",formatter:function(e,t){return[e].join("\n")},show:!0,margin:-10,align:"left",verticalAlign:"bottom",padding:[0,0,15,0],fontSize:16,rich:{lg:{backgroundColor:"#339911",color:"green",borderRadius:10,align:"center",width:15,height:15}}}},{show:!0,inverse:!0,data:a,axisLabel:{textStyle:{fontSize:20,color:"#339911"}},axisLine:{show:!1},splitLine:{show:!1},axisTick:{show:!1}}],series:[{name:"条",type:"bar",yAxisIndex:0,data:e,barWidth:30,itemStyle:{normal:{barBorderRadius:30,color:function(e){return"#"+("00000"+(16777215*Math.random()+.5>>0).toString(16)).slice(-6)}}},label:{normal:{show:!1,position:"inside",formatter:"{c}%"}}},{name:"框",type:"bar",yAxisIndex:1,barGap:"-100%",data:[100,100,100,100],barWidth:30,itemStyle:{normal:{color:"none",borderColor:"#cccccc",margin:[10,0],borderWidth:2,barBorderRadius:15}}}]})},initChart:function(){this.chart=echarts.init(this.$el,"macarons"),this.setOptions()}}},o=s,l=a("bdd7"),c=Object(l["a"])(o,n,r,!1,null,null,null);t["default"]=c.exports},"7a52":function(e,t,a){},"7c56":function(e,t,a){"use strict";a("76bf")},"7e64":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"system-log-container"},[a("vab-query-form",[a("vab-query-form-top-panel",[a("el-form",{attrs:{inline:!0,"label-width":"60px",model:e.queryForm},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",{attrs:{label:"账号"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入账号"},model:{value:e.queryForm.account,callback:function(t){e.$set(e.queryForm,"account","string"===typeof t?t.trim():t)},expression:"queryForm.account"}})],1),a("el-form-item",{attrs:{label:"周期"}},[a("el-date-picker",{attrs:{"end-placeholder":"结束日期",format:"yyyy-MM-dd","start-placeholder":"开始日期",type:"daterange","value-format":"yyyy-MM-dd"},model:{value:e.queryForm.searchDate,callback:function(t){e.$set(e.queryForm,"searchDate",t)},expression:"queryForm.searchDate"}})],1),a("el-form-item",[a("el-button",{attrs:{icon:"el-icon-search",type:"primary"},nativeOn:{click:function(t){return e.queryData.apply(null,arguments)}}},[e._v(" 查询 ")])],1)],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.list},scopedSlots:e._u([{key:"empty",fn:function(){},proxy:!0}])},[a("el-table-column",{attrs:{align:"center",label:"日志类型",prop:"type","show-overflow-tooltip":"",width:"230px"}}),a("el-table-column",{attrs:{align:"center",label:"账号",prop:"account","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{align:"center",label:"执行结果",prop:"executeResult","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return["登录成功"===n.executeResult?a("span",[a("span",{staticClass:"vab-dot vab-dot-success"},[a("span")]),e._v(" "+e._s(n.executeResult)+" ")]):a("span",[a("span",{staticClass:"vab-dot vab-dot-error"},[a("span")]),e._v(" "+e._s(n.executeResult)+" ")])]}}])}),a("el-table-column",{attrs:{align:"center",label:"登录IP",prop:"ip"}}),a("el-table-column",{attrs:{align:"center",label:"访问时间",prop:"datetime","show-overflow-tooltip":""}})],1),a("el-pagination",{attrs:{background:"","current-page":e.queryForm.pageNo,layout:e.layout,"page-size":e.queryForm.pageSize,total:e.total},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1)},r=[],i=a("fb07"),s=a("d0d7"),o=a.n(s),l=a("8781"),c={name:"SystemLog",data:function(){return{list:[],listLoading:!0,layout:"total, sizes, prev, pager, next, jumper",total:0,queryForm:{account:"",searchDate:"",pageNo:1,pageSize:20}}},created:function(){this.fetchData()},methods:{handleSizeChange:function(e){this.queryForm.pageSize=e,this.fetchData()},handleCurrentChange:function(e){this.queryForm.pageNo=e,this.fetchData()},queryData:function(){this.queryForm.pageNo=1,this.fetchData()},fetchData:function(){var e=this;return Object(i["a"])(o.a.mark((function t(){var a,n,r,i;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.listLoading=!0,t.next=3,Object(l["getList"])(e.queryForm);case 3:a=t.sent,n=a.data,r=n.list,i=n.total,e.list=r,e.total=i,e.listLoading=!1;case 10:case"end":return t.stop()}}),t)})))()}}},u=c,d=a("bdd7"),m=Object(d["a"])(u,n,r,!1,null,null,null);t["default"]=m.exports},"824b":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.detail?a("div",{staticClass:"changeInfo"},[a("el-row",{directives:[{name:"show",rawName:"v-show",value:1==e.showHard,expression:"showHard == true"}],staticClass:"row-bg",attrs:{justify:"space-around",type:"flex"}},[a("el-col",{attrs:{span:6}},[a("div",{staticClass:"grid-content bg-purple"},[e._v(" "+e._s(e.$translateTitle("Maintenance.Ticket number"))+" : "+e._s(e.detail.number)+" ")])]),a("el-col",{attrs:{span:5}},[a("div",{staticClass:"grid-content bg-purple-light"},[e._v(" "+e._s(e.$translateTitle("Maintenance.Ticket type"))+" : "+e._s(e.detail.type)+" ")])]),a("el-col",{attrs:{span:7}},[a("div",{staticClass:"grid-content bg-purple"},[e._v(" "+e._s(e.$translateTitle("Maintenance.the starting time"))+" : "+e._s(e.$moment(e.detail.createdAt).format("YYYY-MM-DD HH:mm:ss"))+" ")])])],1),a("el-steps",{directives:[{name:"show",rawName:"v-show",value:1==e.showHard,expression:"showHard == true"}],staticClass:"steps",attrs:{active:e.step,"finish-status":"success",simple:""}},[a("el-step",{attrs:{title:e.$translateTitle("Maintenance.To be assigned")}}),a("el-step",{attrs:{title:e.$translateTitle("Maintenance.Assigned")}}),a("el-step",{attrs:{title:e.$translateTitle("Maintenance.Processed")}}),a("el-step",{attrs:{title:e.$translateTitle("Maintenance.Statement")}})],1),1===e.step?a("step1",{ref:"step1",attrs:{detail:e.detail,"show-footer":e.showFooter,"show-hard":e.showHard,step:e.step},on:{"change-step":e.handleSetStep}}):e._e(),2===e.step?a("step2",{ref:"step2",attrs:{detail:e.detail,"show-footer":e.showFooter,"show-hard":"showHard",step:e.step},on:{"change-step":e.handleSetStep}}):e._e(),3===e.step?a("step3",{ref:"step3",attrs:{detail:e.detail,"show-footer":e.showFooter,"show-hard":"showHard",step:e.step},on:{"change-step":e.handleSetStep}}):e._e(),4===e.step?a("Step4",{ref:"step4",attrs:{detail:e.detail,"show-footer":e.showFooter,"show-hard":"showHard",step:e.step},on:{"change-step":e.handleSetStep}}):e._e()],1):a("div",{staticClass:"empty"},[a("vab-empty")],1)},r=[],i=(a("d6a4"),a("f47e3")),s=a("4f46"),o=a("bacb"),l=a("34f5"),c={name:"ChangeStep",components:{Step1:i["default"],Step2:s["default"],Step3:o["default"],Step4:l["default"]},props:{detail:{type:Object,default:function(){}},showFooter:{type:Boolean,default:!1},showHard:{type:Boolean,default:!1},step:{type:Number,default:1}},data:function(){return{isStep:0}},mounted:function(){4==this.step&&(this.isStep=4)},methods:{next:function(){this.isStep++>5&&(this.isStep=0)},handleSetStep:function(e,t){t&&(this.form=Object.assign(this.form,t))}}},u=c,d=(a("83d4"),a("bdd7")),m=Object(d["a"])(u,n,r,!1,null,"6fc95888",null);t["default"]=m.exports},"829f":function(e,t,a){"use strict";a("75ab")},"83d4":function(e,t,a){"use strict";a("57c9")},"842c":function(e,t,a){"use strict";a("6cf2")},"86cf":function(e,t,a){},"93b7":function(e,t,a){},"94b8":function(e,t,a){},9523:function(e,t,a){"use strict";a("7a52")},"95f7":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"appmarage appmarage-container"},[a("div",{staticClass:"header"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.checkupdateall}},[e._v(" "+e._s(e.$translateTitle("plugins.checkupdate"))+" ")])],1),a("div",{staticClass:"block",staticStyle:{"margin-top":"10px"}},[a("el-table",{staticStyle:{width:"100%","text-align":"center"},attrs:{data:e.tableData.slice((e.start-1)*e.length,e.start*e.length),height:e.height}},[a("el-table-column",{attrs:{align:"center",label:"App"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",{style:{color:1==n.active?"green":"red"}},[e._v(" "+e._s(n.app)+" ")])]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("plugins.version"),prop:"version",sortable:""}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("developer.describe"),prop:"desc",sortable:""}}),a("el-table-column",{attrs:{align:"right",label:e.$translateTitle("developer.operation")},scopedSlots:e._u([{key:"header",fn:function(t){return[a("el-input",{attrs:{placeholder:e.$translateTitle("plugins.enterappsearch"),size:"mini"},on:{change:e.changevalue},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]}},{key:"default",fn:function(t){var n=t.row;return[0==n.active?a("el-button",{attrs:{plain:"",size:"small",type:"info"},on:{click:function(t){return e.startup(n.app)}}},[a("div",{staticStyle:{display:"inline-block",width:"10px",height:"10px","margin-right":"10px",background:"#00cc33","border-radius":"50%"}}),e._v(" "+e._s(e.$translateTitle("plugins.start"))+" ")]):e._e(),1==n.active?a("el-button",{attrs:{plain:"",size:"small",type:"info"},on:{click:function(t){return e.stopup(n.app)}}},[a("div",{staticStyle:{display:"inline-block",width:"10px",height:"10px","margin-right":"10px",background:"#a94442","border-radius":"50%"}}),e._v(" "+e._s(e.$translateTitle("plugins.stop"))+" ")]):e._e(),a("el-button",{attrs:{plain:"",size:"small",type:"info"},on:{click:function(t){return e.checkupdate(n.app)}}},[e._v(" "+e._s(e.$translateTitle("plugins.checkupdate"))+" ")])]}}])})],1)],1),a("div",{staticClass:"block"},[a("el-pagination",{staticStyle:{"margin-top":"30px"},attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper","page-size":e.length,"page-sizes":[10,25,50,100],total:e.total},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1),a("el-dialog",{attrs:{"append-to-body":!0,"before-close":e.handleClose,title:e.$translateTitle("plugins.modulelist"),visible:e.dialogVisible,width:"40%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",[a("el-table",{staticStyle:{width:"100%","margin-top":"20px","text-align":"center"},attrs:{data:e.tableData1.slice((e.start1-1)*e.length1,e.start1*e.length1),height:"300"}},[a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("plugins.modulename"),prop:"path",sortable:""}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("plugins.ischange"),prop:"is_changed",sortable:""}})],1),a("div",{staticClass:"block"},[a("el-pagination",{staticStyle:{"margin-top":"30px"},attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper","page-size":e.length1,"page-sizes":[10,25,50,100],total:e.total1},on:{"current-change":e.handleCurrentChange1,"size-change":e.handleSizeChange1}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticStyle:{float:"left"},on:{click:function(t){e.dialogVisible=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),a("el-button",{staticStyle:{float:"right"},attrs:{type:"primary"},nativeOn:{click:function(t){return e.reupload.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1)])],1)},r=[],i=(a("1d17"),a("df0e"),a("a0e0"),a("3dec"),a("f764"),a("5662"),a("c4bc"),a("bb22")),s=[],o=[],l={data:function(){return{height:this.$baseTableHeight(0)-15,tableData:[],total:0,start:1,length:10,node:null,dialogVisible:!1,start1:1,length1:10,total1:0,tableData1:[],app:"",version:"",searchvalue:"",search:""}},computed:{},mounted:function(){this.getInformation()},methods:{handleSizeChange:function(e){this.start=1,this.length=e},handleCurrentChange:function(e){this.start=e},handleSizeChange1:function(e){this.start1=1,this.length1=e},handleCurrentChange1:function(e){this.start1=e},getInformation:function(){var e=this;Object(i["Getapp"])(this.node,this.start,this.length).then((function(t){t&&(e.tableData=t.apps,s=t.apps,e.total=t.recordsTotal)})).catch((function(t){e.$message({type:"error",message:t.error})}))},handleClose:function(){this.dialogVisible=!1},changevalue:function(){var e=this;""==this.search&&(this.tableData=s),this.tableData=this.tableData.filter((function(t){return!e.search||t.app.toLowerCase().includes(e.search.toLowerCase())}))},changedialog:function(){var e=this;""==this.searchvalue&&(this.tableData1=o),this.tableData1=tableData1.filter((function(t){return!e.searchvalue||t.path.toLowerCase().includes(searchvalue.toLowerCase())}))},checkupdate:function(e){var t=this;this.tableData1=[],this.searchvalue="",this.dialogVisible=!0,this.app=e,this.total1=0,Object(i["Getmodule"])(e).then((function(e){e&&(e.map((function(e){0==e.is_changed?e.is_changed="false":e.is_changed="true"})),t.tableData1=e,o=e,t.total1=e.length)}))},checkupdateall:function(){var e=this;this.searchvalue="",this.dialogVisible=!0,this.tableData1=[],this.total1=0,this.app="",Object(i["Getmodule"])("changed").then((function(t){t&&(t.map((function(e){0==e.is_changed?e.is_changed="false":e.is_changed="true"})),e.tableData1=t,o=t,e.total1=t.length)}))},startup:function(e){var t=this;Object(i["Getstart"])(e).then((function(e){e&&(t.$message({message:"启动成功",type:"success"}),t.getInformation())})).catch((function(e){}))},stopup:function(e){var t=this;Object(i["Getstop"])(e).then((function(e){e&&(t.$message({message:"停止成功",type:"success"}),t.getInformation())})).catch((function(e){}))},reupload:function(){var e=this;""==this.app?Object(i["GetReload"])("all").then((function(t){t&&(0==t.length?e.$message({message:"当前无更新",type:"warning"}):e.$message({message:"已更新模块"+t,type:"success"}))})):Object(i["GetReload"])(this.app).then((function(t){t&&(0==t.length?e.$message({message:"当前无更新",type:"warning"}):e.$message({message:"已更新模块"+t,type:"success"}),e.app)}))}}},c=l,u=a("bdd7"),d=Object(u["a"])(c,n,r,!1,null,null,null);t["default"]=d.exports},9643:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"logs logs-container",class:{"vab-fullscreen":e.isFullscreen}},[a("vab-query-form",[a("vab-query-form-top-panel",[a("el-form",{ref:"form",attrs:{inline:!0,"label-width":"auto",model:e.queryForm},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",{staticClass:"item-time",attrs:{label:e.$translateTitle("Maintenance.times")}},[a("el-date-picker",{staticClass:"item-time-picker",attrs:{"end-placeholder":e.$translateTitle("Maintenance.end time"),format:"yyyy-MM-dd","start-placeholder":e.$translateTitle("Maintenance.start time"),type:"daterange","value-format":"yyyy-MM-dd"},model:{value:e.queryForm.searchDate,callback:function(t){e.$set(e.queryForm,"searchDate",t)},expression:"queryForm.searchDate"}})],1),a("el-form-item",{attrs:{label:"level"}},[a("el-select",{attrs:{clearable:""},model:{value:e.queryForm.level,callback:function(t){e.$set(e.queryForm,"level",t)},expression:"queryForm.level"}},e._l(e.leverData,(function(t){return a("el-option",{key:t,attrs:{label:t,value:t}},[e._v(" "+e._s(t)+" ")])})),1)],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!e.fold,expression:"!fold"}],attrs:{label:"pid"}},[a("el-input",{attrs:{clearable:""},model:{value:e.queryForm.pid,callback:function(t){e.$set(e.queryForm,"pid",t)},expression:"queryForm.pid"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!e.fold,expression:"!fold"}],attrs:{label:"domain"}},[a("el-input",{attrs:{clearable:""},model:{value:e.queryForm.domain,callback:function(t){e.$set(e.queryForm,"domain",t)},expression:"queryForm.domain"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!e.fold,expression:"!fold"}],attrs:{label:"mfa"}},[a("el-input",{attrs:{clearable:""},model:{value:e.queryForm.mfa,callback:function(t){e.$set(e.queryForm,"mfa",t)},expression:"queryForm.mfa"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!e.fold,expression:"!fold"}],attrs:{label:"clientid"}},[a("el-input",{attrs:{clearable:""},model:{value:e.queryForm.clientid,callback:function(t){e.$set(e.queryForm,"clientid",t)},expression:"queryForm.clientid"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!e.fold,expression:"!fold"}],attrs:{label:"topic"}},[a("el-input",{attrs:{clearable:""},model:{value:e.queryForm.topic,callback:function(t){e.$set(e.queryForm,"topic",t)},expression:"queryForm.topic"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!e.fold,expression:"!fold"}],attrs:{label:"peername","label-width":"80px"}},[a("el-input",{attrs:{clearable:""},model:{value:e.queryForm.peername,callback:function(t){e.$set(e.queryForm,"peername",t)},expression:"queryForm.peername"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"text"},on:{click:function(t){e.fold=!e.fold}}},[e.fold?a("span",[e._v(" "+e._s(e.$translateTitle("Maintenance.Unfold"))+" ")]):a("span",[e._v(e._s(e.$translateTitle("Maintenance.merge")))]),a("vab-icon",{staticClass:"vab-dropdown",class:{"vab-dropdown-active":e.fold},attrs:{icon:"arrow-up-s-line"}})],1),a("el-button",{attrs:{icon:"el-icon-search","native-type":"submit",type:"primary"},on:{click:function(t){return e.queryTable({})}}}),a("el-button",{staticStyle:{margin:"0 10px 10px 10px !important"},attrs:{type:"success"},on:{click:e.handleHeight}},[a("vab-icon",{attrs:{icon:e.isFullscreen?"fullscreen-exit-fill":"fullscreen-fill"}})],1),a("el-popover",{attrs:{trigger:"hover"},scopedSlots:e._u([{key:"reference",fn:function(){return[a("el-button",{staticStyle:{margin:"0 0 10px 0 !important"},attrs:{icon:"el-icon-setting",type:"primary"}},[e._v(" "+e._s(e.$translateTitle("Logs.Draggable column settings"))+" ")])]},proxy:!0}])},[a("el-checkbox-group",{model:{value:e.checkList,callback:function(t){e.checkList=t},expression:"checkList"}},[a("vue-draggable",e._b({attrs:{list:e.logcolumns}},"vue-draggable",e.dragOptions,!1),e._l(e.logcolumns,(function(t,n){return a("div",{key:t+n},[a("vab-icon",{attrs:{icon:"drag-drop-line"}}),a("el-checkbox",{attrs:{disabled:!0===t.disableCheck,label:t}},[e._v(" "+e._s(t)+" ")])],1)})),0)],1)],1)],1)],1)],1)],1),a("el-table",{key:e.finallyColumns.length+e.momentKey,ref:"dragTable",staticClass:"logs-table",attrs:{border:"",data:e.logdata,"default-expand-all":"",height:e.height,"highlight-current-row":"",resizable:"","row-class-name":e.tableRowClassName,stripe:""},scopedSlots:e._u([{key:"empty",fn:function(){return[a("vab-empty")]},proxy:!0}])},[a("el-table-column",{attrs:{align:"center",fixed:"left",label:"time",prop:"time","show-overflow-tooltip":"",sortable:"",width:"160"}}),e._l(e.finallyColumns,(function(t,n){return a("el-table-column",{key:n,attrs:{align:"center",label:t,prop:t,"show-overflow-tooltip":"",sortable:"",width:e.w80.includes(t)?80:e.Wh120.includes(t)?120:"auto"}})})),a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-descriptions",{staticClass:"margin-top",attrs:{border:"",column:2}},[a("el-descriptions-item",[a("template",{slot:"label"},[a("i",{directives:[{name:"copy",rawName:"v-copy",value:t.row.msg,expression:"props.row.msg"}],staticClass:"el-icon-copy-document"})]),e._v(" "+e._s(t.row.msg)+" ")],2)],1)]}}])})],2),a("vab-Pagination",{directives:[{name:"show",rawName:"v-show",value:e.queryForm.total>0,expression:"queryForm.total > 0"}],attrs:{limit:e.queryForm.pageSize,page:e.queryForm.pageNo,total:e.queryForm.total},on:{"update:limit":function(t){return e.$set(e.queryForm,"pageSize",t)},"update:page":function(t){return e.$set(e.queryForm,"pageNo",t)},pagination:e.queryTable}})],1)},r=[],i=a("fb07"),s=a("d0d7"),o=a.n(s),l=(a("a0e0"),a("3dec"),a("f764"),a("5662"),a("e170"),a("1d17"),a("4c87"),a("9c6a"),a("d6a4"),a("4656"),a("d292")),c={name:"HistoryLog",data:function(){return{isFullscreen:!1,height:this.$baseTableHeight(0),logdata:[],momentKey:moment(new Date).valueOf(),checkList:["pid","level","mfa","line"],logcolumns:["pid","level","domain","mfa","line","clientid","topic","peername"],fold:!0,w80:["line","level"],Wh120:["pid","domain","gl"],Wh200:["time","clientid","peername"],leverData:["debug","info","notice","warning","error","crtical","alert","emergency"],queryForm:{total:0,count:"objectId",limit:20,pageNo:1,pageSize:20,skip:0,level:"",peername:"",pid:"",mfa:"",topic:"",domain:"",searchDate:[moment().subtract("days",7).format("YYYY-MM-DD"),moment(new Date).format("YYYY-MM-DD")],order:"-createdAt",keys:"count(*)"}}},computed:{dragOptions:function(){return{animation:600,group:"description"}},finallyColumns:function(){var e=this;return this.logcolumns.filter((function(t){return e.checkList.includes(t)}))}},created:function(){},mounted:function(){this.queryTable({}),this.rowDrop(),this.columnDrop()},methods:{handleHeight:function(){this.isFullscreen=!this.isFullscreen,this.isFullscreen?this.height=this.$baseTableHeight(0)+120:this.height=this.$baseTableHeight(0),this.momentKey=moment(new Date).valueOf()},tableRowClassName:function(e){var t=e.row;return t.disabled?"disabled":""},rowDrop:function(){var e=this.$refs.dragTable.$el.querySelector(".el-table__body-wrapper tbody"),t=this;Sortable.create(e,{draggable:".el-table__row",onEnd:function(e){var a=e.newIndex,n=e.oldIndex,r=t.logdata.splice(n,1)[0];t.logdata.splice(a,0,r)}})},columnDrop:function(){var e=this,t=this.$refs.dragTable.$el.querySelector(".el-table__header-wrapper tr");e.sortable=Sortable.create(t,{animation:180,delay:0,onEnd:function(t){var a=e.finallyColumns[t.oldIndex];e.finallyColumns.splice(t.oldIndex,1),e.finallyColumns.splice(t.newIndex,0,a),e.momentKey=moment(new Date).valueOf(),setTimeout((function(){e.rowDrop(),e.columnDrop()}),1500)}})},queryTable:function(){var e=arguments,t=this;return Object(i["a"])(o.a.mark((function a(){var n,r,i,s,c,u,d,m;return o.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=e.length>0&&void 0!==e[0]?e[0]:{},n.limit||(n=t.queryForm),r=t.$baseColorfullLoading(),a.prev=3,r.close(),i={limit:n.limit,skip:n.skip,order:n.order,count:t.queryForm.count,include:"",where:{level:t.queryForm.level?t.queryForm.level:{$ne:"3333"},pid:t.queryForm.pid?{$regex:t.queryForm.pid,$options:"i"}:{$ne:"3333"},mfa:t.queryForm.mfa?{$regex:t.queryForm.mfa,$options:"i"}:{$ne:"3333"},domain:t.queryForm.domain?{$all:t.queryForm.domain.split(/,(?=(?:[^']*(?:'[^']*')?[^']*)*$)/)}:{$ne:""},topic:t.queryForm.topic?{$regex:t.queryForm.topic,$options:"i"}:{$ne:"3333"},peername:t.queryForm.peername?{$regex:t.queryForm.peername,$options:"i"}:{$ne:"3333"},clientid:t.queryForm.clientid?{$regex:t.queryForm.clientid,$options:"i"}:{$ne:"3333"},createdAt:{$gte:{__type:"Date",iso:"".concat(t.queryForm.searchDate[0],"T00:00:00.000Z")},$lte:{__type:"Date",iso:"".concat(t.queryForm.searchDate[1],"T23:59:59.000Z")}}}},a.next=8,Object(l["queryLog"])(i);case 8:s=a.sent,c=s.results,u=void 0===c?[]:c,d=s.count,m=void 0===d?0:d,u.forEach((function(e){e.time=t.$moment(Number(e.time.toString().substring(0,13))).format("YYYY-MM-DD HH:mm:ss.SSS")})),t.logdata=u,t.queryForm.total=m,t.$baseMessage(t.$translateTitle("alert.Data request successfully"),"success","vab-hey-message-success"),r.close(),a.next=24;break;case 20:a.prev=20,a.t0=a["catch"](3),r.close(),t.$baseMessage(t.$translateTitle("alert.Data request error")+"".concat(a.t0),"error","vab-hey-message-error");case 24:t.momentKey=moment(new Date).valueOf();case 25:case"end":return a.stop()}}),a,null,[[3,20]])})))()}}},u=c,d=(a("842c"),a("bdd7")),m=Object(d["a"])(u,n,r,!1,null,"1b8c13ba",null);t["default"]=m.exports},"965a":function(e,t,a){"use strict";a("b0ba")},"9667e":function(e,t,a){e.exports={"menu-color":"rgba(255,255,255,.95)","menu-color-active":"rgba(255,255,255,.95)","menu-background":"#282c34","column-second-menu-background":"#fff"}},a7cf:function(t,a,n){"use strict";n.r(a);var r,i,s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"things-parse"},[a("el-dialog",{attrs:{"append-to-body":!0,title:e.$translateTitle("product.newapi"),visible:e.apiDialog,width:"30%"},on:{"update:visible":function(t){e.apiDialog=t}}},[a("el-form",{ref:"formLabelAlign",attrs:{"label-position":"left","label-width":"170px",model:e.formLabelAlign,rules:e.rules,size:"mini"}},[a("el-form-item",{attrs:{label:e.$translateTitle("plugins.modulename"),prop:"name"}},[a("el-input",{model:{value:e.formLabelAlign.name,callback:function(t){e.$set(e.formLabelAlign,"name",t)},expression:"formLabelAlign.name"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("plugins.programinglanguage"),prop:"language"}},[a("el-select",{attrs:{placeholder:e.$translateTitle("resource.zoneofaction")},model:{value:e.formLabelAlign.language,callback:function(t){e.$set(e.formLabelAlign,"language",t)},expression:"formLabelAlign.language"}},e._l(e.formLabelAlign.languageList,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.submitFormApi("formLabelAlign")}}},[e._v(" "+e._s(e.$translateTitle("developer.create"))+" ")]),a("el-button",{attrs:{size:"mini"},on:{click:function(t){e.apiDialog=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")])],1)],1),a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:7}},[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.addApi.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("product.newapi"))+" ")]),a("el-table",{ref:"singleTable",staticStyle:{width:"100%"},attrs:{data:e.AllDict,"highlight-current-row":""},on:{"current-change":e.handleCurrentChange}},[a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("rule.Type"),width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(n.type))])]}}])}),a("el-table-column",{attrs:{align:"center",label:"mod","show-overflow-tooltip":!0,width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(n.mod))])]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("task.Operation")},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-button",{attrs:{size:"mini",title:e.$translateTitle("rule.testnewequipment")},on:{click:function(t){return e.handleTest(e.scope.$index,n.type,n.mod)}}},[a("vab-icon",{attrs:{icon:"bug-line"}})],1),a("el-button",{attrs:{size:"mini",title:e.$translateTitle("product.pub"),type:"primary"},on:{click:function(t){return e.handleRelease(e.scope.$index,n.type,n.mod)}}},[a("vab-icon",{attrs:{icon:"run-line"}})],1),a("el-button",{attrs:{size:"mini",title:e.$translateTitle("equipment.Offtheshelf"),type:"danger"},on:{click:function(t){return e.handleDelete(e.scope.$index,n.type,n.mod)}}},[a("vab-icon",{attrs:{icon:"delete-bin-2-fill"}})],1)]}}])})],1)],1),a("el-col",{attrs:{span:17}},[a("div",{staticClass:"protolheader"},[a("el-tabs",{attrs:{size:"mini"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:e.$translateTitle("product.Design"),name:"design"}},[a("VabJsonEditor",{ref:"jsonEdit",model:{value:e.itemSwagger,callback:function(t){e.itemSwagger=t},expression:"itemSwagger"}})],1),a("el-tab-pane",{attrs:{label:e.$translateTitle("product.code"),name:"code"}},[a("el-form",{ref:"thingsParseModel",attrs:{inline:!0,model:e.thingsParseModel,rules:e.thingsParseRules}}),a("div",[a("div",{staticStyle:{background:"#ffffff"}},[a("label",{attrs:{id:"plug-name"}})]),a("pre",{staticClass:"ace_editor",staticStyle:{"min-height":"480px","margin-bottom":"0"},attrs:{id:"editor"}},[a("textarea",{staticClass:"ace_text-input"})]),a("div",{staticStyle:{background:"#ffffff"}},[a("label",{attrs:{id:"plug-name"}})]),a("div",{staticStyle:{padding:"5px","margin-right":"80px",color:"#c2be9e",background:"#272822","border-top":"1px solid #dddddd"}},[a("span",[e._v(e._s(e.$translateTitle("product.controloutput")))])]),a("pre",{staticClass:"ace_editor",staticStyle:{"min-height":"200px","margin-top":"0","margin-bottom":"0"},attrs:{id:"editor2"}},[a("textarea",{staticClass:"ace_text-input"})])])],1),a("el-tab-pane",{attrs:{label:e.$translateTitle("rule.Test"),name:"swagger"}},[a("iframe",{attrs:{height:"700vh",src:e.swaggerPath,width:"100%"}})])],1)],1)])],1)],1)},o=[],l=n("fb07"),c=n("d0d7"),u=n.n(c),d=(n("1d17"),n("37c6"),n("e170"),n("16b8"),n("c4bc"),n("a0e0"),n("3dec"),n("f1e1"),n("0c40"),n("79da"),n("98da"),n("e0e9")),m=n("1285"),p=n("89e8"),f=n("4d2d"),h=n("bb22"),b="",g="",v={name:"ThingsParse",components:{},props:{},data:function(){var e=function(e,t,a){var n=/[0-9a-zA-Z]/;n.test(t)?a():a(new Error("协议名称由数字和字母组合"))};return{fullscreenLoading:!1,rules:{name:[{required:!0,validator:e,trigger:"blur"}],language:[{required:!0,message:"请选择编程语言",trigger:"change"}]},labelPosition:"right",formLabelAlign:{languageList:["python","java","ruby"],language:"python",name:"",region:"",type:""},apiDialog:!1,activeName:"design",itemSwagger:{},currentRow:null,AllDict:[],productName:"",form:{Productname:"",ProductKey:"",ProductAll:0},swaggerPath:"http://prod.iotn2n.com/swagger/#/",decoderstart:0,decodertotal:0,decoderlength:10,protolchannel:[],productdetail:{},thingsParseModel:{name:"",version:"",desc:"",resource:!1},thingsParseRules:{name:[{required:!0,message:"请输入协议名称",trigger:"blur"},{validator:e,trigger:"blur"}]},dialogTableVisible:!1,gridData:[],protoldialog:!1}},computed:{tableFilterData:function(){return null}},mounted:function(){i=ace.edit("editor2"),i.session.setMode("ace/mode/python"),i.setTheme("ace/theme/monokai"),i.setReadOnly(!0),i.setOptions({enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0}),this.getAllDict(),this.setPath(),this.$route.query.activeName&&(this.activeName=this.$route.query.activeName)},methods:{setPath:function(){this.swaggerPath=location.origin+"/swagger/#/"},handleDelete:function(e,t,a){var n=this;this.$confirm("确认要下架该api吗？").then(function(){var r=Object(l["a"])(u.a.mark((function r(i){var s;return u.a.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,Object(f["delExproto"])({type:t,mod:a,version:"debug"});case 2:s=r.sent,s&&n.AllDict.splice(e,1);case 4:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()).catch((function(e){}))},handleTest:function(e,t,a){var n=this;return Object(l["a"])(u.a.mark((function e(){var s,o,l;return u.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s={code:Base64.encode(r.getValue()),mod:a,swagger:JSON.parse(n.itemSwagger),type:t},e.next=3,Object(f["putExproto"])(s);case 3:o=e.sent,l=o.results,l?(i.setValue(Base64.decode(l)),n.$message({showClose:!0,message:"调测api成功",type:"success"})):n.$message.error("api有错误,请检查");case 6:case"end":return e.stop()}}),e)})))()},handleRelease:function(e,t,a){var n=this;return Object(l["a"])(u.a.mark((function e(){var i,s;return u.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i={code:Base64.encode(r.getValue()),mod:a,swagger:JSON.parse(n.itemSwagger),type:t},e.next=3,Object(f["postExproto"])(i);case 3:s=e.sent,s?n.$message({showClose:!0,message:"发布api成功",type:"success"}):n.$message.error("api有错误,请检查");case 5:case"end":return e.stop()}}),e)})))()},addApi:function(){this.apiDialog=!0},submitFormApi:function(t){var a=this;this.$refs[t].validate(function(){var t=Object(l["a"])(u.a.mark((function t(n){var r,i,s;return u.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r={python:"IyBjb2Rpbmc9dXRmOAppbXBvcnQgb3MKCmRlZiBwb3N0KGFyZ3Msc2Vzc2lvbixlbnYpOgogICAgI2JvZHkgPSBqc29uLmxvYWRzKGJhc2U2NC5iNjRkZWNvZGUoYXJncykuZGVjb2RlKCJ1dGYtOCIpKQogICAgI3ByaW50KGJvZHkpCiAgICAjc3RyYm9keSA9ICd7fScuZm9ybWF0KGJvZHkpCiAgICAjZW5ib2R5ID0gIGJhc2U2NC5iNjRlbmNvZGUoc3RyYm9keS5lbmNvZGUoJ3V0Zi04JykpCiAgICAjcHJpbnQoZW5ib2R5KQogICAgI3N0YXRlID0ganNvbi5sb2FkcyhiYXNlNjQuYjY0ZGVjb2RlKGVudikuZGVjb2RlKCJ1dGYtOCIpKQogICAgI3ByaW50KHN0YXRlKQogICAgIyByZXN0dXJsID0gc3RhdGVbJ3JvbGVzJ11bMF1bJ3RhZyddWydhcHBjb25maWcnXVsncmVzdCddCiAgICAjIHByaW50KHJlc3R1cmwpCiAgICAjIHMuaGVhZGVycy51cGRhdGUoeyJzZXNzaW9uVG9rZW4iOiBzZXNzaW9uLCAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nfSkKICAgICMgcnQgPSBzLmdldCgne30vY2xhc3Nlcy9EZXZpY2U/b3JkZXI9Y3JlYXRlZEF0JmxpbWl0PTEwJnNraXA9MCcuZm9ybWF0KHJlc3R1cmwpLAogICAgIyAgICAgICAgICAgICAgcGFyYW1zPXsnb3JkZXInOiAnY3JlYXRlZEF0JywgfSkKICAgICMgZm9yIHJvdyBpbiAocnQuanNvbigpWydyZXN1bHRzJ10pOgogICAgIyAgICAgcHJpbnQocm93KQogICAgcHJpbnQoYXJncykKICAgIHByaW50KHNlc3Npb24pCiAgICBwcmludChlbnYpCiAgICByZXR1cm4gYXJncwoKZGVmIG1haW4oKToKICAgICN7Im5hbWUiOiJzaHV3YSJ9CiAgICBhcmd2cyA9ICdleUp1WVcxbElqb2ljMmgxZDJFaWZRPT0nCiAgICByZXR1cm4gIHBvc3QoYXJndnMsICdzZXNzaW9uJywnZW52JykKCmRlZiBleGl0KCk6CiAgICBvcy5fZXhpdCgwKQoKaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoKICAgIG1haW4oKQ==",java:"",ruby:""},"/python_"+a.formLabelAlign.name,i={code:r[a.formLabelAlign.language],mod:a.formLabelAlign.name,swagger:{definitions:{},paths:{"/python_hello":{post:{description:"Python测试API",parameters:[{description:"生成报告",in:"body",name:"data",required:!0,schema:{properties:{name:{description:"姓名",example:"shuwa",required:!0,type:"string"}},type:"object"}}],responses:{200:{description:"Returns operation status"},400:{description:"Bad Request"},401:{description:"Unauthorized"},403:{description:"Forbidden"},500:{description:"Server Internal error"}},summary:"Python测试API",tags:["EXPROTO"]}}},tags:[{description:"扩展编程",name:"EXPROTO"}]},type:a.formLabelAlign.language},!n){t.next=8;break}return t.next=6,Object(f["getExproto"])(i);case 6:s=t.sent,s?(a.apiDialog=!1,a.$message({type:"success",message:"新增api成功"}),a.getAllDict()):a.$message({type:"error",message:"新增api失败"+e});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},handleCurrentChange:function(e){var t=e.swagger,a=void 0===t?{}:t;this.itemSwagger=a,r=ace.edit("editor"),r.session.setMode("ace/mode/python"),r.setTheme("ace/theme/monokai"),r.setOptions({enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0}),r.setValue(Base64.decode(e.code)),r.gotoLine(r.session.getLength())},toggle:function(e){},getAllDict:function(){var e=this;return Object(l["a"])(u.a.mark((function t(){var a,n;return u.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(f["getExproto"])({type:"python",mod:"all",version:"debug"});case 2:a=t.sent,n=a.results,n&&(e.AllDict=n,e.AllDict.length&&e.handleCurrentChange(n[0]));case 5:case"end":return t.stop()}}),t)})))()},Industry:function(){var e=this;return Object(l["a"])(u.a.mark((function t(){var a,n,r;return u.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.option=[],a={limit:1e3,where:{"data.key":"category"}},t.next=4,Object(d["queryDict"])(a);case 4:n=t.sent,r=n.results,r.map((function(t){var a={};a.value=t.type,a.label=t.data.CategoryName,a.id=t.data.Id,a.parentid=t.data.SuperId,e.option.push(a)}));case 7:case"end":return t.stop()}}),t)})))()},getProDetail:function(e){var t=this;this.productId=e,r=ace.edit("editor"),r.session.setMode("ace/mode/erlang"),r.setTheme("ace/theme/monokai"),r.setOptions({enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0}),this.$get_object("Product",e).then((function(e){if(e){for(var a in t.productName=e.name,e)t.productdetail[a]=e[a];t.option.map((function(e){t.productdetail.category==e.value&&(t.productdetail.category=e.label)})),t.productdetail.createdAt=t.utc2beijing(e.createdAt),t.productdetail.id=e.id,t.dynamicReg=e.dynamicReg,t.productdetail.isshow=0,t.form.Productname=e.name,t.ProductSecret=e.productSecret,t.form.Productkey=t.productId,t.productimg=e.icon,e.decoder?(g=e.decoder.code,t.thingsParseModel.name=e.decoder.name,t.thingsParseModel.version=e.decoder.version,t.thingsParseModel.desc=e.decoder.desc):g="JSUlLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQolJSUgQGNvcHlyaWdodCAoQykgMjAxOCwgPHNodXdhPgolJSUgQGRvYwolJSUg5Y2P6K6u6Kej5p6QRGVtbwolJSUgQGVuZAolJSUgQ3JlYXRlZCA6IDA4LiDljYHkuIDmnIggMjAxOCAxNDo0OQolJSUtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi1tb2R1bGUoc2h1d2FfZGVtb19kZWNvZGVyKS4KLWF1dGhvcigic2h1d2EiKS4KLWRlZmluZShNU0dfVFlQRSwgPDwiREVNTyI+PikuCi1wcm90b2NvbChbPDwiREVNTyI+Pl0pLgoKLWV4cG9ydChbcGFyc2VfZnJhbWUvMiwgdG9fZnJhbWUvMV0pLgoKCnBhcnNlX2ZyYW1lKEJ1ZmYsIE9wdHMpIC0+CiAgICBwYXJzZV9mcmFtZShCdWZmLCBbXSwgT3B0cykuCgoKcGFyc2VfZnJhbWUoPDw+PiwgQWNjLCBfT3B0cykgLT4KICAgIHs8PD4+LCBBY2N9OwpwYXJzZV9mcmFtZSg8PDE2IzY4LCBSZXN0L2JpbmFyeT4+ID0gQmluLCBBY2MsIF9PcHRzKSB3aGVuIGJ5dGVfc2l6ZShSZXN0KSA9PCA2IC0+CiAgICB7QmluLCBBY2N9OwpwYXJzZV9mcmFtZSg8PDE2IzY4LCBMZW46MTYvbGl0dGxlLWludGVnZXIsIExlbjoxNi9saXR0bGUtaW50ZWdlciwgMTYjNjgsIFJlc3QvYmluYXJ5Pj4gPSBCaW4sIEFjYywgT3B0cykgLT4KICAgIGNhc2UgYnl0ZV9zaXplKFJlc3QpIC0gMiA+PSBMZW4gb2YKICAgICAgICB0cnVlIC0+CiAgICAgICAgICAgIGNhc2UgUmVzdCBvZgogICAgICAgICAgICAgICAgPDxVc2VyWm9uZTpMZW4vYnl0ZXMsIENyYzo4LCAxNiMxNiwgUmVzdDEvYmluYXJ5Pj4gLT4KICAgICAgICAgICAgICAgICAgICBBY2MxID0KICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBzaHV3YV91dGlsczpnZXRfcGFyaXR5KFVzZXJab25lKSA9Oj0gQ3JjIG9mCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnVlIC0+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRnJhbWUgPSAjewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8PCJtc2d0eXBlIj4+ID0+ID9NU0dfVFlQRSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPDwiZGF0YSI+PiA9PiBVc2VyWm9uZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQWNjICsrIFtGcmFtZV07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWxzZSAtPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFjYwogICAgICAgICAgICAgICAgICAgICAgICBlbmQsCiAgICAgICAgICAgICAgICAgICAgcGFyc2VfZnJhbWUoUmVzdDEsIEFjYzEsIE9wdHMpOwogICAgICAgICAgICAgICAgXyAtPgogICAgICAgICAgICAgICAgICAgIHBhcnNlX2ZyYW1lKFJlc3QsIEFjYywgT3B0cykKICAgICAgICAgICAgZW5kOwogICAgICAgIGZhbHNlIC0+CiAgICAgICAgICAgIHtCaW4sIEFjY30KICAgIGVuZDsKcGFyc2VfZnJhbWUoPDxfOjgsIFJlc3QvYmluYXJ5Pj4sIEFjYywgT3B0cykgLT4KICAgIHBhcnNlX2ZyYW1lKFJlc3QsIEFjYywgT3B0cykuCgoKJSUg57uE6KOF5oiQ5bCB5YyFLCDlj4LmlbDkuLpNYXDlvaLlvI8KdG9fZnJhbWUoI3s8PCJtc2d0eXBlIj4+IDo9ID9NU0dfVFlQRX0gPSBGcmFtZSkgLT4KICAgIFBheWxvYWQgPSB0ZXJtX3RvX2JpbmFyeShGcmFtZSksCiAgICA8PDE2IzAzLCBQYXlsb2FkL2JpbmFyeSwgMTYjMjM+Pi4=",t.productdetail.thing||(t.productdetail.thing={properties:[]}),t.wmxData=t.productdetail.thing.properties.filter((function(e){return e.name&&e.dataType})),r.setValue(Base64.decode(g)),r.gotoLine(r.session.getLength()),t.queryDeviceCount(t.productId)}}))},queryDeviceCount:function(e){var t=this;return Object(l["a"])(u.a.mark((function a(){return u.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(m["getDeviceCountByProduct"])(e);case 2:t.form.ProductAll=a.sent;case 3:case"end":return a.stop()}}),a)})))()},editordata:function(e){this.thingsParseModel.name=e.attributes.data.name,this.thingsParseModel.version=e.attributes.data.version,this.thingsParseModel.desc=e.attributes.data.desc,this.thingsParseModel.resource=e.attributes.data.enable,r.setValue(Base64.decode(e.attributes.data.code)),this.dialogTableVisible=!1},getAllunit:function(){var e=this;return Object(l["a"])(u.a.mark((function t(){var a,n;return u.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.allunit=[],t.next=3,Object(d["getAllunit"])("unit",100);case 3:a=t.sent,n=a.results,e.allunit=n.concat([]),e.allunit.unshift({data:{Name:"无",Symbol:""}});case 7:case"end":return t.stop()}}),t)})))()},subAce:function(e,t){var a=this;this.$refs[e].validate((function(n){if(n){var s={name:e.name,version:e.version,code:Base64.encode(r.getValue()),desc:e.desc},o={decoder:s};a.$update_object("Product",a.productId,o).then((function(e){0==a.issub&&(a.$message({type:"success",message:"保存成功"}),1==t&&(b+="保存成功",i.setValue(b))),a.issub=!0})).catch((function(e){}))}else a.$message({type:"warning",message:"输入格式有误"})}))},subAce1:function(e){var t=this;this.$refs[e].validate((function(e){if(e){var a={where:{"data.name":t.formInline.name,"data.version":t.formInline.version}};t.$query_object("Dict",a).then((function(e){e.results&&e.results.length>=1?t.$message("此协议版本已存在"):t.$get_object("Product",t.productId).then((function(e){if(e){var a={name:t.formInline.name,version:t.formInline.version,code:Base64.encode(r.getValue()),desc:t.formInline.desc},n={key:t.formInline.name+":"+t.formInline.version,type:"decoder",data:a,ACL:e.ACL};t.$create_object("Dict",n).then((function(e){e.error?t.$message({type:"error",message:e.error}):t.$message({type:"success",message:"保存到公共协议库成功"})})).catch((function(e){}))}}))})).catch((function(e){}))}else t.$message({type:"warning",message:"输入格式有误"})}))},decoderSizeChange:function(e){this.decoder.length=e,this.chaxun()},devicerCurrentChange:function(e){this.decoderstart=(e-1)*this.decoderlength,this.chaxun()},updateAllChannel:function(){var e=this;if(0==this.multipleSelection.length)this.protoldialog=!1;else{var t=[];this.multipleSelection.map((function(e){t.push(new Promise((function(t,a){return Object(h["subupadte"])(e.id,"update").then((function(e){e&&t(e)})).catch((function(e){a(e)}))})))})),Promise.all(t).then((function(t){e.$message({message:"热加载成功",type:"success"}),t.length==e.multipleSelection.length&&(e.protoldialog=!1)})).catch((function(t){e.$message({message:t,type:"error"})}))}},handleSelectionChange:function(e){this.multipleSelection=e},utc2beijing:function(e){var t=new Date(+new Date(e)+288e5).toISOString().replace(/T/g," ").replace(/\.[\d]{3}Z/,"");return t},getChannelEnable:function(e,t){return 1==e.row.attributes.isEnable?"green_active":"red_active"},deletedata:function(e){var t=this;this.$del_object("Dict",e).then((function(e){e&&(t.$message("成功删除"),t.chaxun())})).catch((function(e){}))},updatesubdialog:function(){var e=this;return Object(l["a"])(u.a.mark((function t(){var a,n;return u.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.protoldialog=!0,a="1",n={__type:"Pointer",className:"Product",objectId:e.productId},Object(p["getChannelCountByProduct"])(e.channellength,e.channelstart,n,a).then((function(t){e.protolchannel=t.results,e.$refs.multipleTable.toggleAllSelection()})).catch((function(t){e.$baseMessage("请求出错",t.error,3e3)}));case 4:case"end":return t.stop()}}),t)})))()},chaxun:function(){var e=this,t={count:"objectId",skip:this.decoderstart,limit:this.decoderlength,where:{type:"decoder"}};this.dialogTableVisible=!0,this.$query_object("Dict",t).then((function(t){t&&(e.decodertotal=t.count,e.gridData=t.results)})).catch((function(e){}))},protol:function(){var e=this,t="";Object(h["Compile"])(Base64.encode(r.getValue())).then((function(a){a&&(e.$message({type:"success",message:"编译成功"}),t="编译成功"+a.mod+"\r\n",e.warningeditror=a.warnings,e.warningeditror.map((function(e){t+=e+"\r\n"})),b+=t,i.setValue(b))})).catch((function(a){e.warningeditror=a.error,e.warningeditror.map((function(e){t+=e+"\r\n"})),b+=t,i.setValue(b)}))}}},y=v,w=(n("7c56"),n("bdd7")),_=Object(w["a"])(y,s,o,!1,null,null,null);a["default"]=_.exports},a817:function(e,t,a){"use strict";a("3b74")},a99f0:function(e,t,a){"use strict";a("86cf")},b0ba:function(e,t,a){},b142:function(e,t,a){},b175:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mycontainer"},[a("div",{staticClass:"ticker-dialog"},[a("div",{staticClass:"home_dialog"},[a("el-dialog",{attrs:{"append-to-body":!0,title:e.detail.name,visible:e.showdeviceFlag,width:"100vh"},on:{"update:visible":function(t){e.showdeviceFlag=t}}},[a("change-step",{ref:"ChangeStep",attrs:{detail:e.detail,"show-footer":e.isfooter,"show-hard":e.ishard,step:e.step}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:3!=e.detail.status,expression:"detail.status != 3"}],attrs:{type:"primary"},on:{click:function(t){return e.check()}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.check"))+" ")])],1)],1),a("el-dialog",{attrs:{"append-to-body":!0,title:e.$translateTitle("Maintenance.create Ticket"),visible:e.dialogFormVisible,width:"90vh"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"form",staticClass:"create-ticker",attrs:{"label-width":"auto",model:e.form,rules:e.rules,size:"medium "}},[a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.project"),prop:"product"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$translateTitle("Maintenance.Please choose the product")},on:{change:e.prodChange},model:{value:e.form.product,callback:function(t){e.$set(e.form,"product",t)},expression:"form.product"}},e._l(e._Product,(function(e,t){return a("el-option",{directives:[{name:"show",rawName:"v-show",value:0!=e.objectId,expression:"item.objectId != 0"}],key:t,attrs:{label:e.name,value:e.objectId}})})),1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.Equipment name"),prop:"name"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{disabled:!e.Device.length,placeholder:0==e.Device.length?e.$translateTitle("Maintenance.Please choose the product"):e.$translateTitle("Maintenance.Please select a device")},on:{change:e.deviceChange},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}},e._l(e.Device,(function(e,t){return a("el-option",{directives:[{name:"show",rawName:"v-show",value:e.objectId,expression:"item.objectId"}],key:t,attrs:{label:e.name,value:e.objectId}})})),1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.Ticket type"),prop:"type"}},[a("el-input",{model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.Ticket description")}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.photo")}},[a("el-upload",{attrs:{action:"#","auto-upload":!0,"http-request":e.myUpload,"list-type":"picture-card"}},[a("i",{staticClass:"el-icon-plus",attrs:{slot:"default"},slot:"default"}),e._l(e.form.photo,(function(e,t){return a("div",{key:t},[a("img",{staticClass:"el-upload-list__item-thumbnail",attrs:{alt:"",src:e.url}})])}))],2),a("el-dialog",{attrs:{"append-to-body":!0,visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("img",{attrs:{alt:"",src:e.dialogImageUrl,width:"100%"}})])],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.submitForm("form")}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.Create now"))+" ")]),a("el-button",{on:{click:function(t){return e.resetForm("form")}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.Reset"))+" ")])],1)],1)],1)]),a("vab-query-form",{staticClass:"query-form"},[a("vab-query-form-top-panel",[a("el-form",{attrs:{inline:!0,"label-width":"auto",model:e.queryForm},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.number")}},[a("el-input",{attrs:{clearable:"",placeholder:e.$translateTitle("Maintenance.Ticket number")},model:{value:e.queryForm.number,callback:function(t){e.$set(e.queryForm,"number","string"===typeof t?t.trim():t)},expression:"queryForm.number"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.projects")}},[a("el-select",{attrs:{clearable:"",placeholder:e.$translateTitle("Maintenance.project")},model:{value:e.queryForm.product,callback:function(t){e.$set(e.queryForm,"product",t)},expression:"queryForm.product"}},e._l(e._Product,(function(e,t){return a("el-option",{directives:[{name:"show",rawName:"v-show",value:0!=e.objectId,expression:"item.objectId != 0"}],key:t,attrs:{label:e.name,value:e.objectId}})})),1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.type")}},[a("el-input",{attrs:{clearable:"",placeholder:e.$translateTitle("Maintenance.Ticket type")},model:{value:e.queryForm.type,callback:function(t){e.$set(e.queryForm,"type",t)},expression:"queryForm.type"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.times")}},[a("el-date-picker",{attrs:{"end-placeholder":e.$translateTitle("Maintenance.end time"),format:"yyyy-MM-dd","start-placeholder":e.$translateTitle("Maintenance.start time"),type:"daterange","value-format":"yyyy-MM-dd"},model:{value:e.queryForm.searchDate,callback:function(t){e.$set(e.queryForm,"searchDate",t)},expression:"queryForm.searchDate"}})],1),a("el-form-item",[a("el-button",{attrs:{icon:"el-icon-search",size:"mini",type:"primary"},on:{click:e.fetchData}},[e._v(" "+e._s(e.$translateTitle("Maintenance.search"))+" ")]),a("el-button",{attrs:{disabled:!e.selectedList.length,icon:"el-icon-s-promotion",size:"mini",type:"primary"},on:{click:function(t){return e.batchExport(e.selectedList)}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.Export"))+" ")])],1)],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"tableSort",attrs:{border:"",data:e.list,height:e.height,stripe:""},on:{"selection-change":e.changeBox},scopedSlots:e._u([{key:"empty",fn:function(){return[a("vab-empty")]},proxy:!0}])},[a("el-table-column",{attrs:{align:"center","class-name":"isCheck","show-overflow-tooltip":"",type:"selection",width:"55"}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("Maintenance.Ticket number"),prop:"number","show-overflow-tooltip":"",sortable:"",width:"120"}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("Maintenance.Ticket type"),prop:"type","show-overflow-tooltip":"",sortable:""}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("Maintenance.Ticket status"),"show-overflow-tooltip":"",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(e.getStatus(a.status,a))+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("Maintenance.project"),"show-overflow-tooltip":"",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.info&&a.info.productname?a.info.productname:"")+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("Maintenance.Equipment name"),"show-overflow-tooltip":"",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.info&&a.info.devicename?a.info.devicename:"")+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("Maintenance.Initiator"),"show-overflow-tooltip":"",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.info&&a.info.createdname?a.info.createdname:"")+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("Maintenance.the starting time"),"show-overflow-tooltip":"",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(e.$moment(a.createdAt).format("YYYY-MM-DD HH:mm:ss"))+" ")]}}])}),a("el-table-column",{attrs:{align:"center",fixed:"right",label:e.$translateTitle("Maintenance.operating"),width:"220"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.showInfo(n,!0,!1)}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.View"))+" ")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:2==n.status,expression:"row.status == 2"}],attrs:{size:"mini",type:"info"},on:{click:function(t){return e.showInfo(n,!0)}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.Evaluation"))+" ")])]}}])})],1),a("vab-Pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],attrs:{limit:e.queryForm.pageSize,page:e.queryForm.pageNo,total:e.total},on:{"update:limit":function(t){return e.$set(e.queryForm,"pageSize",t)},"update:page":function(t){return e.$set(e.queryForm,"pageNo",t)},pagination:e.fetchData}})],1)},r=[],i=a("fb07"),s=a("e97b"),o=a("d0d7"),l=a.n(o),c=(a("c4bc"),a("16b8"),a("80ab"),a("a98c"),a("3dec"),a("9c6a"),a("79da"),a("0941")),u=a("dcc6"),d=a("1285"),m=a("5880"),p=a("824b"),f=a("12674"),h={name:"EvaluationTicket",components:{ChangeStep:p["default"]},data:function(){return{showdeviceFlag:!1,created:0,Assigned:0,form:{receiveuseid:"",productname:"",devicename:"",createdname:"",receiveusername:"",receiveuserphone:"",name:"",product:"",type:"",description:"",photo:[],objectId:""},dialogFormVisible:!1,fold:!1,step:1,ishard:!1,height:this.$baseTableHeight(0)-30,isfooter:!0,detail:{},AllDevice:[],selectedList:[],types:["故障维修"],Device:[],dialogImageUrl:"",dialogVisible:!1,disabled:!1,formLabelWidth:"140px",rules:{product:[{required:!0,message:"请选择所属项目",trigger:"change"}],name:[{required:!0,message:"请选择设备",trigger:"change"}],type:[{required:!0,message:"请输入工单类型",trigger:"change"}]},list:[],listLoading:!1,layout:"total, sizes, prev, pager, next, jumper",total:0,status:[{key:0,text:"Maintenance.To be assigned"},{key:1,text:"Maintenance.Assigned"},{key:2,text:"Maintenance.Processed"},{key:3,text:"Maintenance.Statement"}],queryForm:{devicename:"",statusFlag:!1,status:"",number:"",product:"",type:"",pageNo:1,pageSize:20,searchDate:[],limt:10,skip:0,order:"-createdAt",keys:"count(*)"}}},computed:Object(s["a"])(Object(s["a"])({},Object(m["mapGetters"])({_Product:"user/_Product",objectid:"user/objectId",role:"acl/role",username:"user/username"})),{},{_deviceStep:{get:function(){return this.$store.state.global._deviceStep},set:function(e){this.set_deviceStep(e)}},aclObj:function(){var e={};return this.role.map((function(t){e["".concat("role:"+t.name)]={read:!0,write:!0}})),e}}),watch:{_deviceStep:function(e){-1==e&&(this.showdeviceFlag=!1,this.fetchData())},"queryForm.status":function(e){this.queryForm.statusFlag=""!=e}},created:function(){},mounted:function(){this.handleCreated("created")},methods:Object(s["a"])(Object(s["a"])({myUpload:function(e){var t=this,a={headers:{proxy:!0,produrl:"/",devurl:"iotapi/"}};Object(f["UploadImg"])(e.file,a).then((function(e){e.data.url&&t.form.photo.push(e.data.url)})).catch((function(e){}))},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;t.createdTicket(t.form)}))},createdTicket:function(e){var t=this;return Object(i["a"])(l.a.mark((function a(){var n,r,i;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n={},n[t.objectid]={read:!0,write:!0},r={number:moment(new Date).unix()+"",type:e.type,ACL:_.merge(n,t.aclObj),info:{photo:e.photo,timeline:[{timestamp:moment(new Date).format("YYYY-MM-DD HH:mm:ss"),h4:"生成工单",p:"".concat(t.username,"新建工单")}],description:e.description,step1:{},step2:{},step3:{},step4:{},productid:e.product,productname:e.productname,devicename:e.devicename,deviceid:e.name,createdname:t.username,receiveusername:e.receiveusername,receiveuseid:e.receiveuseid,receiveuserphone:e.receiveuserphone},device:{objectId:e.name,__type:"Pointer",className:"Device"}},i=t.$baseColorfullLoading(),a.next=6,Object(c["create_object"])("Maintenance",r);case 6:a.sent,i.close(),t.fetchData(),t.dialogFormVisible=!1;case 10:case"end":return a.stop()}}),a)})))()},resetForm:function(e){this.$refs[e].resetFields()},changeBox:function(e){var t=this;this.selectedList=[],e.forEach((function(e){t.selectedList.push(e)}))}},Object(m["mapMutations"])({set_deviceStep:"global/set_deviceStep"})),{},{handleFold:function(){this.fold=!this.fold,this.handleHeight()},batchExport:function(e){var t=this;return Object(i["a"])(l.a.mark((function a(){var n,r;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,n={results:[]},n["results"]=e,a.next=5,Object(f["exlout"])(n);case 5:r=a.sent,t.$convertRes2Blob(r),t.$message.success(t.$translateTitle("node.export success")),a.next=13;break;case 10:a.prev=10,a.t0=a["catch"](0),t.$message.error(t.$translateTitle("node.export error")+"".concat(a.t0));case 13:case"end":return a.stop()}}),a,null,[[0,10]])})))()},handleDelete:function(e,t){var a=this,n=[];2==t?n.push({method:"DELETE",path:"/classes/Maintenance/".concat(e.objectId),body:{}}):e.forEach((function(e){n.push({method:"DELETE",path:"/classes/Maintenance/".concat(e.objectId),body:{}})})),this.$baseConfirm(this.$translateTitle("Maintenance.Are you sure you want to delete the current item"),null,Object(i["a"])(l.a.mark((function e(){return l.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(u["batch"])(n);case 2:e.sent,a.$baseMessage(a.$translateTitle("Maintenance.successfully deleted"),"success","vab-hey-message-success"),setTimeout((function(){a.fetchData()}),1500);case 5:case"end":return e.stop()}}),e)}))))},handleHeight:function(){this.fold?this.height=this.$baseTableHeight(0)-20:this.height=this.$baseTableHeight(0)-30},getStatus:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;switch(e){case 0:return this.$translateTitle("Maintenance.To be assigned");case 1:return this.$translateTitle("Maintenance.Assigned");case 2:return this.$translateTitle("Maintenance.Processed");case 3:return this.$translateTitle("Maintenance.Statement");default:return e}},showInfo:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.showdeviceFlag=!1,this.ishard=t,this.isfooter=a;var n=e.status,r=void 0===n?0:n;this.detail=e,this.step=r+1,this.showdeviceFlag=!0,this.set_deviceStep(r)},handleCreated:function(e){"created"==e?this.created++:this.Assigned++,this.fetchData()},fetchData:function(){var e=arguments,t=this;return Object(i["a"])(l.a.mark((function a(){var n,r,i,s;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=e.length>0&&void 0!==e[0]?e[0]:{},r.limit||(r=t.queryForm),t.listLoading=!1,i=t.$baseColorfullLoading(),s={limit:r.limit,order:r.order,skip:r.skip,keys:r.keys,where:{"info.receiveuseid":t.Assigned%2==0?{$ne:"99"}:t.objectid,number:t.queryForm.number.length?{$regex:t.queryForm.number}:{$ne:null},status:{$gte:2},"info.productid":t.queryForm.product.length?t.queryForm.product:{$ne:"99"},type:t.queryForm.type.length?{$regex:t.queryForm.type}:{$ne:null}}},null!==(n=t.queryForm.searchDate)&&void 0!==n&&n.length&&(s.where["createdAt"]={$gt:{__type:"Date",iso:t.queryForm.searchDate[0]}},s.where["updatedAt"]={$lt:{__type:"Date",iso:t.queryForm.searchDate[1]}}),a.next=8,Object(c["query_object"])("Maintenance",s).then((function(e){var a=e.results,n=void 0===a?[]:a,r=e.count,s=void 0===r?0:r;t.list=n,t.list.forEach((function(e){if(e._user="暂无",e.ACL)for(var t in e.ACL)e._user=t.substr(0)})),t.total=s,i.close()})).catch((function(e){t.$message.error("".concat(e)),i.close()}));case 8:case"end":return a.stop()}}),a)})))()},prodChange:function(e){var t=this;return Object(i["a"])(l.a.mark((function a(){var n,r,i;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.Device=[],t._Product.map((function(a){a.objectId==e&&(t.form.productname=a.name)})),t.form.name="",n={where:{product:e}},a.next=6,Object(d["queryDevice"])(n);case 6:r=a.sent,i=r.results,t.Device=i;case 9:case"end":return a.stop()}}),a)})))()},deviceChange:function(e){var t=this;this.Device.map((function(a){a.objectId==e&&(t.form.devicename=a.name)}))},dispatch:function(){this.$refs.ChangeStep.$refs.step1.dispatchUser()},backChange:function(e){var t=this;return Object(i["a"])(l.a.mark((function a(){var n,r,i,s;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=e.objectId,r=e.info,r.timeline.push({timestamp:moment(new Date).format("YYYY-MM-DD HH:mm:ss"),h4:"已回退",p:"".concat(t.username," 回退了流程")}),i={status:0,info:r},a.next=5,Object(c["update_object"])("Maintenance",n,i);case 5:s=a.sent,s.updatedAt&&t.set_deviceStep(-1);case 7:case"end":return a.stop()}}),a)})))()},Reassign:function(e){var t=this;return Object(i["a"])(l.a.mark((function a(){var n,r,i,s;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=e.objectId,r=e.info,r.timeline.push({timestamp:moment(new Date).format("YYYY-MM-DD HH:mm:ss"),h4:"已改派",p:"".concat(t.username," 改派了工单")}),i={status:0,info:r},a.next=5,Object(c["update_object"])("Maintenance",n,i);case 5:s=a.sent,s.updatedAt&&t.set_deviceStep(-1);case 7:case"end":return a.stop()}}),a)})))()},dealwith:function(){this.$refs.ChangeStep.$refs.step2.dispatchUser()},check:function(){this.$refs.ChangeStep.$refs.step3.dispatchUser()}})},b=h,g=(a("d322"),a("bdd7")),v=Object(g["a"])(b,n,r,!1,null,"51785f33",null);t["default"]=v.exports},b2ee:function(e,t,a){"use strict";a("715c")},bacb:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:e.$translateTitle("Maintenance.Work order information"),name:"first"}},[a("el-form",{ref:"form",staticClass:"create-ticker",attrs:{"label-width":"auto",model:e.form,size:"medium "}},[a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{lg:12,md:12,sm:24,xl:12,xs:24}},[a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.project")+": "}},[a("span",[e._v(e._s(e.form.info.productname))])])],1),a("el-col",{attrs:{lg:12,md:12,sm:24,xl:12,xs:24}},[a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.Equipment name")+": "}},[a("span",[e._v(e._s(e.form.info.devicename))])])],1),a("el-col",{attrs:{lg:12,md:12,sm:24,xl:12,xs:24}},[a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.Initiator")+": "}},[a("span",[e._v(e._s(e.form.info.createdname))])])],1),a("el-col",{attrs:{lg:24,md:24,sm:24,xl:24,xs:24}},[a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.Ticket description")+": "}},[e._v(" "+e._s(e.form.info.description)+" ")])],1),a("el-col",{attrs:{lg:24,md:24,sm:24,xl:24,xs:24}},[a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.photo")+": "}},[a("el-carousel",{attrs:{height:"200px",interval:2e3,type:"card"}},e._l(e.form.info.photo,(function(e,t){return a("el-carousel-item",{key:t},[a("img",{staticStyle:{width:"100%",height:"100%"},attrs:{alt:e,src:e,title:e}})])})),1)],1)],1),e.showFooter?a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.Evaluation description")+": "}},[a("el-input",{attrs:{placeholder:e.$translateTitle("Maintenance.Please record the processing content in detail!"),type:"textarea"},model:{value:e.form.info.step3.Remarks,callback:function(t){e.$set(e.form.info.step3,"Remarks",t)},expression:"form.info.step3.Remarks"}})],1)],1):e._e()],1)],1)],1),a("el-tab-pane",{staticStyle:{height:"90%","overflow-x":"hidden","overflow-y":"auto"},attrs:{label:e.$translateTitle("Maintenance.work process"),name:"second"}},[a("el-card",{attrs:{shadow:"hover"},scopedSlots:e._u([{key:"header",fn:function(){return[a("el-radio-group",{staticClass:"card-header-radio",model:{value:e.reverse,callback:function(t){e.reverse=t},expression:"reverse"}},[a("el-radio",{attrs:{label:!0}},[e._v(" "+e._s(e.$translateTitle("Maintenance.Positive order"))+" ")]),a("el-radio",{attrs:{label:!1}},[e._v(" "+e._s(e.$translateTitle("Maintenance.Reverse order"))+" ")])],1)]},proxy:!0}])},[a("el-timeline",{attrs:{reverse:e.reverse}},e._l(e.form.info.timeline,(function(t){return a("el-timeline-item",{key:t.timestamp,attrs:{placement:"top",timestamp:t.timestamp}},[a("el-card",[a("h4",[e._v(e._s(t.h4))]),a("p",[e._v(e._s(t.p))])])],1)})),1)],1)],1)],1)],1)},r=[],i=a("fb07"),s=a("e97b"),o=a("d0d7"),l=a.n(o),c=a("0941"),u=a("8665"),d=a("5880"),m={props:{detail:{type:Object,default:function(){}},showFooter:{type:Boolean,default:!1}},data:function(){return{reverse:!0,activeName:"first",form:this.detail}},computed:Object(s["a"])({},Object(d["mapGetters"])({username:"user/username"})),mounted:function(){this.featUser()},methods:Object(s["a"])(Object(s["a"])({},Object(d["mapMutations"])({set_deviceFlag:"global/set_deviceFlag",set_deviceStep:"global/set_deviceStep"})),{},{featUser:function(){var e=this;return Object(i["a"])(l.a.mark((function t(){var a,n;return l.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(u["queryUser"])({});case 2:a=t.sent,n=a.results,e.user=n;case 5:case"end":return t.stop()}}),t)})))()},dispatchUser:function(){var e=this;this.$refs["form"].validate(function(){var t=Object(i["a"])(l.a.mark((function t(a){var n,r,i,s,o;return l.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a||!e.form.info.receiveusername){t.next=10;break}return n=e.form,r=n.objectId,i=n.info,i.timeline.push({timestamp:moment(new Date).format("YYYY-MM-DD HH:mm:ss"),h4:"已结单",p:"".concat(e.username," 已结束这条工单")}),s={status:3,info:i},t.next=6,Object(c["update_object"])("Maintenance",r,s);case 6:o=t.sent,o.updatedAt&&(e.set_deviceFlag(!1),e.set_deviceStep(-1)),t.next=12;break;case 10:return e.$message.error("请选择分配人员"),t.abrupt("return",!1);case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}})},p=m,f=(a("28c4"),a("bdd7")),h=Object(f["a"])(p,n,r,!1,null,"786b8a94",null);t["default"]=h.exports},bd5f:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mycontainer"},[a("div",{staticClass:"ticker-dialog"},[a("div",{staticClass:"home_dialog"},[a("el-dialog",{attrs:{"append-to-body":!0,title:e.detail.name,visible:e.showdeviceFlag,width:"100vh"},on:{"update:visible":function(t){e.showdeviceFlag=t}}},[a("change-step",{ref:"ChangeStep",attrs:{detail:e.detail,"show-footer":e.isfooter,"show-hard":e.ishard,step:e.step}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:0==e.detail.status,expression:"detail.status == 0"}],on:{click:function(t){return e.set_deviceStep(0)}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:0==e.detail.status&&e.isfooter,expression:"detail.status == 0 && isfooter"}],attrs:{type:"primary"},on:{click:function(t){return e.dispatch()}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.Dispatch"))+" ")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:1==e.detail.status,expression:"detail.status == 1"}],on:{click:function(t){return e.backChange(e.detail)}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.back"))+" ")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:2==e.detail.status&&e.isfooter,expression:"detail.status == 2 && isfooter"}],attrs:{type:"primary"},on:{click:function(t){return e.Reassign(e.detail)}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.Reassign"))+" ")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:2==e.detail.status&&e.isfooter,expression:"detail.status == 2 && isfooter"}],attrs:{type:"primary"},on:{click:function(t){return e.check()}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.check"))+" ")]),a("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.dealwith()}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.deal with"))+" ")])],1)],1),a("el-dialog",{attrs:{"append-to-body":!0,title:e.$translateTitle("Maintenance.create Ticket"),visible:e.dialogFormVisible,width:"90vh"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"form",staticClass:"create-ticker",attrs:{"label-width":"auto",model:e.form,rules:e.rules,size:"medium "}},[a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.project"),prop:"product"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$translateTitle("Maintenance.Please choose the product")},on:{change:e.prodChange},model:{value:e.form.product,callback:function(t){e.$set(e.form,"product",t)},expression:"form.product"}},e._l(e._Product,(function(e,t){return a("el-option",{directives:[{name:"show",rawName:"v-show",value:0!=e.objectId,expression:"item.objectId != 0"}],key:t,attrs:{label:e.name,value:e.objectId}})})),1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.Equipment name"),prop:"name"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{disabled:!e.Device.length,placeholder:0==e.Device.length?e.$translateTitle("Maintenance.Please choose the product"):e.$translateTitle("Maintenance.Please select a device")},on:{change:e.deviceChange},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}},e._l(e.Device,(function(e,t){return a("el-option",{directives:[{name:"show",rawName:"v-show",value:e.objectId,expression:"item.objectId"}],key:t,attrs:{label:e.name,value:e.objectId}})})),1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.Ticket type"),prop:"type"}},[a("el-input",{model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.Ticket description")}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.photo")}},[a("el-upload",{attrs:{action:"#","auto-upload":!0,"http-request":e.myUpload,"list-type":"picture-card"}},[a("i",{staticClass:"el-icon-plus",attrs:{slot:"default"},slot:"default"}),e._l(e.form.photo,(function(e,t){return a("div",{key:t},[a("img",{staticClass:"el-upload-list__item-thumbnail",attrs:{alt:"",src:e.url}})])}))],2),a("el-dialog",{attrs:{"append-to-body":!0,visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("img",{attrs:{alt:"",src:e.dialogImageUrl,width:"100%"}})])],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.submitForm("form")}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.Create now"))+" ")]),a("el-button",{on:{click:function(t){return e.resetForm("form")}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.Reset"))+" ")])],1)],1)],1)]),a("vab-query-form",{staticClass:"query-form"},[a("vab-query-form-top-panel",[a("el-form",{attrs:{inline:!0,"label-width":"auto",model:e.queryForm},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.number")}},[a("el-input",{attrs:{clearable:"",placeholder:e.$translateTitle("Maintenance.Ticket number")},model:{value:e.queryForm.number,callback:function(t){e.$set(e.queryForm,"number","string"===typeof t?t.trim():t)},expression:"queryForm.number"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.projects")}},[a("el-select",{attrs:{clearable:"",placeholder:e.$translateTitle("Maintenance.project")},model:{value:e.queryForm.product,callback:function(t){e.$set(e.queryForm,"product",t)},expression:"queryForm.product"}},e._l(e._Product,(function(e,t){return a("el-option",{directives:[{name:"show",rawName:"v-show",value:0!=e.objectId,expression:"item.objectId != 0"}],key:t,attrs:{label:e.name,value:e.objectId}})})),1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.type")}},[a("el-input",{attrs:{clearable:"",placeholder:e.$translateTitle("Maintenance.Ticket type")},model:{value:e.queryForm.type,callback:function(t){e.$set(e.queryForm,"type",t)},expression:"queryForm.type"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.times")}},[a("el-date-picker",{attrs:{"end-placeholder":e.$translateTitle("Maintenance.end time"),format:"yyyy-MM-dd","start-placeholder":e.$translateTitle("Maintenance.start time"),type:"daterange","value-format":"yyyy-MM-dd"},model:{value:e.queryForm.searchDate,callback:function(t){e.$set(e.queryForm,"searchDate",t)},expression:"queryForm.searchDate"}})],1),a("el-form-item",[a("el-button",{attrs:{icon:"el-icon-search",size:"mini",type:"primary"},on:{click:e.fetchData}},[e._v(" "+e._s(e.$translateTitle("Maintenance.search"))+" ")]),a("el-button",{attrs:{disabled:!e.selectedList.length,icon:"el-icon-s-promotion",size:"mini",type:"primary"},on:{click:function(t){return e.batchExport(e.selectedList)}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.Export"))+" ")])],1)],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"tableSort",attrs:{border:"",data:e.list,height:e.height,stripe:""},on:{"selection-change":e.changeBox},scopedSlots:e._u([{key:"empty",fn:function(){return[a("vab-empty")]},proxy:!0}])},[a("el-table-column",{attrs:{align:"center","class-name":"isCheck","show-overflow-tooltip":"",type:"selection",width:"55"}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("Maintenance.Ticket number"),prop:"number","show-overflow-tooltip":"",sortable:"",width:"120"}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("Maintenance.Ticket type"),prop:"type","show-overflow-tooltip":"",sortable:""}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("Maintenance.Ticket status"),"show-overflow-tooltip":"",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(e.getStatus(a.status,a))+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("Maintenance.project"),"show-overflow-tooltip":"",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.info&&a.info.productname?a.info.productname:"")+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("Maintenance.Equipment name"),"show-overflow-tooltip":"",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.info&&a.info.devicename?a.info.devicename:"")+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("Maintenance.Initiator"),"show-overflow-tooltip":"",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.info&&a.info.createdname?a.info.createdname:"")+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("Maintenance.the starting time"),"show-overflow-tooltip":"",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(e.$moment(a.createdAt).format("YYYY-MM-DD HH:mm:ss"))+" ")]}}])}),a("el-table-column",{attrs:{align:"center",fixed:"right",label:e.$translateTitle("Maintenance.operating"),width:"220"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.showInfo(n,!0,!1)}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.View"))+" ")]),a("el-button",{attrs:{size:"mini",type:"info"},on:{click:function(t){return e.showInfo(n,!0,!0)}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.deal with"))+" ")])]}}])})],1),a("vab-Pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],attrs:{limit:e.queryForm.pageSize,page:e.queryForm.pageNo,total:e.total},on:{"update:limit":function(t){return e.$set(e.queryForm,"pageSize",t)},"update:page":function(t){return e.$set(e.queryForm,"pageNo",t)},pagination:e.fetchData}})],1)},r=[],i=a("fb07"),s=a("e97b"),o=a("d0d7"),l=a.n(o),c=(a("c4bc"),a("16b8"),a("80ab"),a("a98c"),a("3dec"),a("9c6a"),a("79da"),a("0941")),u=a("dcc6"),d=a("1285"),m=a("5880"),p=a("824b"),f=a("12674"),h={name:"ProcessTicket",components:{ChangeStep:p["default"]},data:function(){return{showdeviceFlag:!1,created:0,Assigned:0,form:{receiveuseid:"",productname:"",devicename:"",createdname:"",receiveusername:"",receiveuserphone:"",name:"",product:"",type:"",description:"",photo:[],objectId:""},dialogFormVisible:!1,fold:!1,step:1,ishard:!1,height:this.$baseTableHeight(0)-30,isfooter:!0,detail:{},AllDevice:[],selectedList:[],types:["故障维修"],Device:[],dialogImageUrl:"",dialogVisible:!1,disabled:!1,formLabelWidth:"140px",rules:{product:[{required:!0,message:"请选择所属项目",trigger:"change"}],name:[{required:!0,message:"请选择设备",trigger:"change"}],type:[{required:!0,message:"请输入工单类型",trigger:"change"}]},list:[],listLoading:!1,layout:"total, sizes, prev, pager, next, jumper",total:0,status:[{key:0,text:"Maintenance.To be assigned"},{key:1,text:"Maintenance.Assigned"},{key:2,text:"Maintenance.Processed"},{key:3,text:"Maintenance.Statement"}],queryForm:{devicename:"",statusFlag:!1,status:"",number:"",product:"",type:"",pageNo:1,pageSize:20,searchDate:[],limt:10,skip:0,order:"-createdAt",keys:"count(*)"}}},computed:Object(s["a"])(Object(s["a"])({},Object(m["mapGetters"])({_Product:"user/_Product",objectid:"user/objectId",role:"acl/role",username:"user/username"})),{},{_deviceStep:{get:function(){return this.$store.state.global._deviceStep},set:function(e){this.set_deviceStep(e)}},aclObj:function(){var e={};return this.role.map((function(t){e["".concat("role:"+t.name)]={read:!0,write:!0}})),e}}),watch:{_deviceStep:function(e){-1==e&&(this.fetchData(),this.showdeviceFlag=!1)},"queryForm.status":function(e){this.queryForm.statusFlag=""!=e}},created:function(){},mounted:function(){this.handleCreated("created")},methods:Object(s["a"])(Object(s["a"])({myUpload:function(e){var t=this,a={headers:{proxy:!0,produrl:"/",devurl:"iotapi/"}};Object(f["UploadImg"])(e.file,a).then((function(e){e.data.url&&t.form.photo.push(e.data.url)})).catch((function(e){}))},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;t.createdTicket(t.form)}))},createdTicket:function(e){var t=this;return Object(i["a"])(l.a.mark((function a(){var n,r,i;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n={},n[t.objectid]={read:!0,write:!0},r={number:moment(new Date).unix()+"",type:e.type,ACL:_.merge(n,t.aclObj),info:{photo:e.photo,timeline:[{timestamp:moment(new Date).format("YYYY-MM-DD HH:mm:ss"),h4:"生成工单",p:"".concat(t.username,"新建工单")}],description:e.description,step1:{},step2:{},step3:{},step4:{},productid:e.product,productname:e.productname,devicename:e.devicename,deviceid:e.name,createdname:t.username,receiveusername:e.receiveusername,receiveuseid:e.receiveuseid,receiveuserphone:e.receiveuserphone},device:{objectId:e.name,__type:"Pointer",className:"Device"}},i=t.$baseColorfullLoading(),a.next=6,Object(c["create_object"])("Maintenance",r);case 6:a.sent,i.close(),t.fetchData(),t.dialogFormVisible=!1;case 10:case"end":return a.stop()}}),a)})))()},resetForm:function(e){this.$refs[e].resetFields()},changeBox:function(e){var t=this;this.selectedList=[],e.forEach((function(e){t.selectedList.push(e)}))}},Object(m["mapMutations"])({set_deviceStep:"global/set_deviceStep"})),{},{handleFold:function(){this.fold=!this.fold,this.handleHeight()},batchExport:function(e){var t=this;return Object(i["a"])(l.a.mark((function a(){var n,r;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,n={results:[]},n["results"]=e,a.next=5,Object(f["exlout"])(n);case 5:r=a.sent,t.$convertRes2Blob(r),t.$message.success(t.$translateTitle("node.export success")),a.next=13;break;case 10:a.prev=10,a.t0=a["catch"](0),t.$message.error(t.$translateTitle("node.export error")+"".concat(a.t0));case 13:case"end":return a.stop()}}),a,null,[[0,10]])})))()},handleDelete:function(e,t){var a=this,n=[];2==t?n.push({method:"DELETE",path:"/classes/Maintenance/".concat(e.objectId),body:{}}):e.forEach((function(e){n.push({method:"DELETE",path:"/classes/Maintenance/".concat(e.objectId),body:{}})})),this.$baseConfirm(this.$translateTitle("Maintenance.Are you sure you want to delete the current item"),null,Object(i["a"])(l.a.mark((function e(){return l.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(u["batch"])(n);case 2:e.sent,a.$baseMessage(a.$translateTitle("Maintenance.successfully deleted"),"success","vab-hey-message-success"),setTimeout((function(){a.fetchData()}),1500);case 5:case"end":return e.stop()}}),e)}))))},handleHeight:function(){this.fold?this.height=this.$baseTableHeight(0)-20:this.height=this.$baseTableHeight(0)-30},getStatus:function(e){return this.$translateTitle("Maintenance.Assigned")},showInfo:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.showdeviceFlag=!1,this.ishard=t,this.isfooter=a;var n=e.status,r=void 0===n?0:n;this.detail=e,this.step=r+1,this.set_deviceStep(r),this.showdeviceFlag=!0},handleCreated:function(e){"created"==e?this.created++:this.Assigned++,this.fetchData()},fetchData:function(){var e=arguments,t=this;return Object(i["a"])(l.a.mark((function a(){var n,r,i,s;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=e.length>0&&void 0!==e[0]?e[0]:{},r.limit||(r=t.queryForm),t.listLoading=!1,i=t.$baseColorfullLoading(),s={limit:r.limit,order:r.order,skip:r.skip,keys:r.keys,where:{"info.receiveuseid":t.Assigned%2==0?{$ne:"99"}:t.objectid,number:t.queryForm.number.length?{$regex:t.queryForm.number}:{$ne:null},status:1,"info.productid":t.queryForm.product.length?t.queryForm.product:{$ne:"99"},type:t.queryForm.type.length?{$regex:t.queryForm.type}:{$ne:null}}},null!==(n=t.queryForm.searchDate)&&void 0!==n&&n.length&&(s.where["createdAt"]={$gt:{__type:"Date",iso:t.queryForm.searchDate[0]}},s.where["updatedAt"]={$lt:{__type:"Date",iso:t.queryForm.searchDate[1]}}),a.next=8,Object(c["query_object"])("Maintenance",s).then((function(e){var a=e.results,n=void 0===a?[]:a,r=e.count,s=void 0===r?0:r;t.list=n,t.list.forEach((function(e){if(e._user="暂无",e.ACL)for(var t in e.ACL)e._user=t.substr(0)})),t.total=s,i.close()})).catch((function(e){t.$message.error("".concat(e)),i.close()}));case 8:case"end":return a.stop()}}),a)})))()},prodChange:function(e){var t=this;return Object(i["a"])(l.a.mark((function a(){var n,r,i;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.Device=[],t._Product.map((function(a){a.objectId==e&&(t.form.productname=a.name)})),t.form.name="",n={where:{product:e}},a.next=6,Object(d["queryDevice"])(n);case 6:r=a.sent,i=r.results,t.Device=i;case 9:case"end":return a.stop()}}),a)})))()},deviceChange:function(e){var t=this;this.Device.map((function(a){a.objectId==e&&(t.form.devicename=a.name)}))},dispatch:function(){this.$refs.ChangeStep.$refs.step1.dispatchUser()},backChange:function(e){var t=this;return Object(i["a"])(l.a.mark((function a(){var n,r,i,s;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=e.objectId,r=e.info,r.timeline.push({timestamp:moment(new Date).format("YYYY-MM-DD HH:mm:ss"),h4:"已回退",p:"".concat(t.username," 回退了流程")}),i={status:0,info:r},a.next=5,Object(c["update_object"])("Maintenance",n,i);case 5:s=a.sent,s.updatedAt&&(t.set_deviceStep(-1),t.showdeviceFlag=!1);case 7:case"end":return a.stop()}}),a)})))()},Reassign:function(e){var t=this;return Object(i["a"])(l.a.mark((function a(){var n,r,i,s;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=e.objectId,r=e.info,r.timeline.push({timestamp:moment(new Date).format("YYYY-MM-DD HH:mm:ss"),h4:"已改派",p:"".concat(t.username," 改派了工单")}),i={status:0,info:r},a.next=5,Object(c["update_object"])("Maintenance",n,i);case 5:s=a.sent,s.updatedAt&&(t.set_deviceStep(-1),t.showdeviceFlag=!1);case 7:case"end":return a.stop()}}),a)})))()},dealwith:function(){this.$refs.ChangeStep.$refs.step2.dispatchUser()},check:function(){this.$refs.ChangeStep.$refs.step3.dispatchUser()}})},b=h,g=(a("27f0"),a("bdd7")),v=Object(g["a"])(b,n,r,!1,null,"53ee4580",null);t["default"]=v.exports},be74:function(e,t,a){},c26ac:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"logs logs-container",class:{"vab-fullscreen":e.isFullscreen}},[a("vab-query-form",[a("vab-query-form-top-panel",[a("el-form",{ref:"form",attrs:{inline:!0,"label-width":"100px",model:e.queryForm},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",{staticClass:"item-time",attrs:{label:e.$translateTitle("device.Log type")}},[a("el-select",{attrs:{multiple:"",placeholder:"请选择"},model:{value:e.queryForm.domain,callback:function(t){e.$set(e.queryForm,"domain",t)},expression:"queryForm.domain"}},e._l(e.domainOptions,(function(t){return a("el-option",{key:t,attrs:{label:e.$translateTitle("deviceLog."+t),value:t}})})),1)],1),a("el-form-item",{staticClass:"item-time",attrs:{label:e.$translateTitle("Maintenance.times")}},[a("el-date-picker",{staticClass:"item-time-picker",attrs:{"end-placeholder":e.$translateTitle("Maintenance.end time"),format:"yyyy-MM-dd","start-placeholder":e.$translateTitle("Maintenance.start time"),type:"daterange","value-format":"yyyy-MM-dd"},model:{value:e.queryForm.searchDate,callback:function(t){e.$set(e.queryForm,"searchDate",t)},expression:"queryForm.searchDate"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!e.isDeviceInfo,expression:"!isDeviceInfo"}],attrs:{label:e.$translateTitle("equipment.Products")}},[a("el-select",{attrs:{clearable:""},model:{value:e.queryForm.productid,callback:function(t){e.$set(e.queryForm,"productid",t)},expression:"queryForm.productid"}},e._l(e.proTableData,(function(t,n){return a("el-option",{directives:[{name:"show",rawName:"v-show",value:0!=t.objectId,expression:"item.objectId != 0"}],key:n,attrs:{label:e.$translateTitle("deviceLog."+t.name),value:t.objectId}})})),1)],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!e.isDeviceInfo,expression:"!isDeviceInfo"}],attrs:{label:e.$translateTitle("equipment.devicenumber")}},[a("el-input",{attrs:{clearable:"",placeholder:e.$translateTitle("equipment.enterdevicenumber")},model:{value:e.queryForm.devaddr,callback:function(t){e.$set(e.queryForm,"devaddr",t)},expression:"queryForm.devaddr"}})],1),a("el-form-item",[a("el-button",{attrs:{icon:"el-icon-search","native-type":"submit",type:"primary"},on:{click:function(t){return e.queryTable({})}}}),a("el-button",{staticStyle:{margin:"0 10px 10px 10px !important"},attrs:{type:"success"},on:{click:e.handleHeight}},[a("vab-icon",{attrs:{icon:e.isFullscreen?"fullscreen-exit-fill":"fullscreen-fill"}})],1),a("el-popover",{attrs:{trigger:"hover"},scopedSlots:e._u([{key:"reference",fn:function(){return[a("el-button",{staticStyle:{margin:"0 0 10px 0 !important"},attrs:{icon:"el-icon-setting",type:"primary"}},[e._v(" "+e._s(e.$translateTitle("Logs.Draggable column settings"))+" ")])]},proxy:!0}])},[a("el-checkbox-group",{model:{value:e.checkList,callback:function(t){e.checkList=t},expression:"checkList"}},[a("vue-draggable",e._b({attrs:{list:e.logcolumns}},"vue-draggable",e.dragOptions,!1),e._l(e.logcolumns,(function(t,n){return a("div",{key:t+n},[a("vab-icon",{attrs:{icon:"drag-drop-line"}}),a("el-checkbox",{attrs:{disabled:!0===t.disableCheck,label:t}},[e._v(" "+e._s(e.$translateTitle("deviceLog."+t))+" ")])],1)})),0)],1)],1)],1)],1)],1)],1),a("el-dialog",{attrs:{"append-to-body":"",visible:e.preDialog},on:{"update:visible":function(t){e.preDialog=t}}},[a("vab-editor",{key:e.refreshFlag,attrs:{height:(e.isFullscreen,Number(e.$baseTableHeight(1))),lang:"json","max-lines":(e.isFullscreen,Number(e.$baseTableHeight(1))/12),"min-lines":(e.isFullscreen,Number(e.$baseTableHeight(1))/12),theme:"gob"},model:{value:e.msg,callback:function(t){e.msg=t},expression:"msg"}})],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],key:e.finallyColumns.length+e.momentKey,ref:"dragTable",staticClass:"block",attrs:{border:"",data:e.logdata,"element-loading-background":"rgba(0, 0, 0, 0.8)","element-loading-spinner":"el-icon-loading","element-loading-text":e.$translateTitle("developer.Waitingtoreturn"),height:e.height,"highlight-current-row":"",resizable:"","row-class-name":e.tableRowClassName,size:"mini",stripe:""},scopedSlots:e._u([{key:"empty",fn:function(){return[a("vab-empty")]},proxy:!0}])},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-descriptions",{staticClass:"margin-top",attrs:{border:"",column:2,size:e.size}},e._l(t.row,(function(t,n,r){return a("el-descriptions-item",{key:r,attrs:{label:e.$translateTitle("deviceLog."+n),"label-class-name":"my-label"}},[e._v(" "+e._s(t)+" ")])})),1)]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("device.Log type")},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(e.$translateTitle("deviceLog."+a.domain))+" ")]}}])}),e._l(e.finallyColumns,(function(t,n){return a("el-table-column",{key:n,attrs:{align:"center",label:e.$translateTitle("deviceLog."+t),prop:t,"show-overflow-tooltip":"",sortable:""}})})),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("concentrator.operation")},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.showDetail(n)}}},[e._v(" "+e._s(e.$translateTitle("concentrator.detail"))+" ")])]}}])})],2),a("vab-Pagination",{directives:[{name:"show",rawName:"v-show",value:e.queryForm.total>0,expression:"queryForm.total > 0"}],attrs:{limit:e.queryForm.pageSize,page:e.queryForm.pageNo,total:e.queryForm.total},on:{"update:limit":function(t){return e.$set(e.queryForm,"pageSize",t)},"update:page":function(t){return e.$set(e.queryForm,"pageNo",t)},pagination:e.queryTable}})],1)},r=[],i=a("fb07"),s=a("d0d7"),o=a.n(s),l=(a("a0e0"),a("3dec"),a("f764"),a("5662"),a("e170"),a("04d6"),a("9c6a"),a("d6a4"),a("4656"),a("d292")),c=a("7212"),u={name:"AccessLog",props:{productid:{type:String,default:""},devaddr:{type:String,default:""},deviceid:{type:String,default:""},isDeviceInfo:{type:Boolean,default:!0}},data:function(){return{preDialog:!1,msg:"",loading:!1,size:"",domainOptions:["device_statuslog","device_operationlog","transparent","event","tcp_send","tcp_receive","readProperty","writeProperty","reportProperty","child","childReply","functionInvoke","readPropertyReply","writePropertyReply","functionReply","register","unregister","offline","online","other","parse_api"],isFullscreen:!1,height:this.$baseTableHeight(2),logdata:[],refreshFlag:moment(new Date).valueOf(),momentKey:moment(new Date).valueOf(),checkList:["time","msg"],logcolumns:["devaddr","time","msg","username","productname","devicename","status","protocol","thingname","identifier","value"],proTableData:[],activeName:"second",queryForm:{total:0,count:"objectId",limit:20,pageNo:1,pageSize:20,skip:0,level:"",peername:"",pid:"",mfa:"",topic:"",domain:[],searchDate:[moment().subtract("days",7).format("YYYY-MM-DD"),moment(new Date).format("YYYY-MM-DD")],order:"-createdAt",keys:"count(*)",productid:"",devaddr:""}}},computed:{dragOptions:function(){return{animation:600,group:"description"}},finallyColumns:function(){var e=this;return this.logcolumns.filter((function(t){return e.checkList.includes(t)}))}},created:function(){},mounted:function(){this.productid&&(this.queryForm.productid=this.productid),this.deviceid&&(this.queryForm.deviceid=this.deviceid),this.$route.query.deviceid&&(this.queryForm.deviceid=this.$route.query.deviceid),this.queryTable({}),this.rowDrop(),this.queryProduct(),this.columnDrop()},methods:{queryProduct:function(){var e=this;return Object(i["a"])(o.a.mark((function t(){var a,n,r;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.proTableData=[],t.next=3,Object(c["queryProduct"])({count:"objectId",order:"-updatedAt",where:{category:"IotHub"}});case 3:a=t.sent,n=a.results,r=void 0===n?[]:n,e.proTableData=r;case 7:case"end":return t.stop()}}),t)})))()},handleHeight:function(){this.isFullscreen=!this.isFullscreen,this.isFullscreen?this.height=this.$baseTableHeight(0)+120:this.height=this.$baseTableHeight(0),this.momentKey=moment(new Date).valueOf()},tableRowClassName:function(e){var t=e.row;return t.disabled?"disabled":""},rowDrop:function(){var e=this.$refs.dragTable.$el.querySelector(".el-table__body-wrapper tbody"),t=this;Sortable.create(e,{draggable:".el-table__row",onEnd:function(e){var a=e.newIndex,n=e.oldIndex,r=t.logdata.splice(n,1)[0];t.logdata.splice(a,0,r)}})},columnDrop:function(){var e=this,t=this.$refs.dragTable.$el.querySelector(".el-table__header-wrapper tr");e.sortable=Sortable.create(t,{animation:180,delay:0,onEnd:function(t){var a=e.finallyColumns[t.oldIndex];e.finallyColumns.splice(t.oldIndex,1),e.finallyColumns.splice(t.newIndex,0,a),e.momentKey=moment(new Date).valueOf(),setTimeout((function(){e.rowDrop(),e.columnDrop()}),1500)}})},showDetail:function(e){this.preDialog=!0,this.msg=JSON.stringify(e,null,2),this.refreshFlag=moment(new Date).valueOf()},queryTable:function(){var e=arguments,t=this;return Object(i["a"])(o.a.mark((function a(){var n,r,i,s,c,u,d,m;return o.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=e.length>0&&void 0!==e[0]?e[0]:{},t.loading=!0,n.limit||(n=t.queryForm),r=t.$baseColorfullLoading(),a.prev=4,r.close(),i={limit:n.limit,skip:n.skip,order:n.order,count:t.queryForm.count,include:"",where:{deviceid:t.deviceid?t.deviceid:"",domain:t.queryForm.domain.length?{$in:t.queryForm.domain}:{$ne:""},createdAt:{$gte:{__type:"Date",iso:"".concat(t.queryForm.searchDate[0],"T00:00:00.000Z")},$lte:{__type:"Date",iso:"".concat(t.queryForm.searchDate[1],"T23:59:59.000Z")}}}},a.next=9,Object(l["queryLog"])(i);case 9:s=a.sent,c=s.results,u=void 0===c?[]:c,d=s.count,m=void 0===d?0:d,u.forEach((function(e){if(e.time=t.$moment(Number(e.time.toString().substring(0,13))).format("YYYY-MM-DD HH:mm:ss"),"text"!=e.type){var a=JSON.parse(e.msg);for(var n in a)e[n]=a[n]}})),t.logdata=u,t.queryForm.total=m,t.$baseMessage(t.$translateTitle("alert.Data request successfully"),"success","vab-hey-message-success"),r.close(),a.next=25;break;case 21:a.prev=21,a.t0=a["catch"](4),r.close(),t.$baseMessage(t.$translateTitle("alert.Data request error")+"".concat(a.t0),"error","vab-hey-message-error");case 25:t.loading=!1;case 26:case"end":return a.stop()}}),a,null,[[4,21]])})))()}}},d=u,m=(a("b2ee"),a("bdd7")),p=Object(m["a"])(d,n,r,!1,null,"5cb4799c",null);t["default"]=p.exports},c30a:function(e,t,a){"use strict";a("fb77")},c559:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"CloudOT-container"},[a("div",{staticClass:"CloudOT-content"},[e._v(" "+e._s(e.infoData)+" ")])])},r=[],i={name:"CloudOT",components:{},data:function(){return{infoData:"CloudOT"}},computed:{},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){},methods:{}},s=i,o=(a("965a"),a("bdd7")),l=Object(o["a"])(s,n,r,!1,null,"ab5b3ff6",null);t["default"]=l.exports},c6b1:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mycontainer"},[a("div",{staticClass:"ticker-dialog"},[a("div",{staticClass:"home_dialog"},[a("el-dialog",{attrs:{"append-to-body":!0,title:e.detail.name,visible:e.showdeviceFlag,width:"100vh"},on:{"update:visible":function(t){e.showdeviceFlag=t}}},[a("Change-Step",{ref:"ChangeStep",attrs:{detail:e.detail,"show-footer":e.isfooter,"show-hard":e.ishard,step:e.step}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:0==e.detail.status,expression:"detail.status == 0"}],on:{click:function(t){return e.set_deviceStep(-1)}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:0==e.detail.status&&e.isfooter,expression:"detail.status == 0 && isfooter"}],attrs:{type:"primary"},on:{click:function(t){return e.dispatch()}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.Dispatch"))+" ")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:1==e.detail.status,expression:"detail.status == 1"}],on:{click:function(t){return e.backChange(e.detail)}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.back"))+" ")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:2==e.detail.status&&e.isfooter,expression:"detail.status == 2 && isfooter"}],attrs:{type:"primary"},on:{click:function(t){return e.Reassign(e.detail)}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.Reassign"))+" ")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:2==e.detail.status&&e.isfooter,expression:"detail.status == 2 && isfooter"}],attrs:{type:"primary"},on:{click:function(t){return e.check()}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.check"))+" ")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:1==e.detail.status&&e.isfooter,expression:"detail.status == 1 && isfooter"}],attrs:{type:"primary"},on:{click:function(t){return e.dealwith()}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.deal with"))+" ")])],1)],1),a("el-dialog",{attrs:{"append-to-body":!0,title:e.$translateTitle("Maintenance.create Ticket"),visible:e.dialogFormVisible,width:"90vh"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"form",staticClass:"create-ticker",attrs:{"label-width":"auto",model:e.form,rules:e.rules,size:"medium "}},[a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.project"),prop:"product"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:e.$translateTitle("Maintenance.Please choose the product")},on:{change:e.prodChange},model:{value:e.form.product,callback:function(t){e.$set(e.form,"product",t)},expression:"form.product"}},e._l(e._Product,(function(e,t){return a("el-option",{directives:[{name:"show",rawName:"v-show",value:0!=e.objectId,expression:"item.objectId != 0"}],key:t,attrs:{label:e.name,value:e.objectId}})})),1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.Equipment name"),prop:"name"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{disabled:!e.Device.length,placeholder:0==e.Device.length?e.$translateTitle("Maintenance.Please choose the product"):e.$translateTitle("Maintenance.Please select a device")},on:{change:e.deviceChange},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}},e._l(e.Device,(function(e,t){return a("el-option",{directives:[{name:"show",rawName:"v-show",value:e.objectId,expression:"item.objectId"}],key:t,attrs:{label:e.name,value:e.objectId}})})),1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.Ticket type"),prop:"type"}},[a("el-input",{model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.Ticket description")}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.photo")}},[a("el-upload",{attrs:{action:"#","auto-upload":!0,"http-request":e.myUpload,"list-type":"picture-card"}},[a("i",{staticClass:"el-icon-plus",attrs:{slot:"default"},slot:"default"}),e._l(e.form.photo,(function(e,t){return a("div",{key:t},[a("img",{staticClass:"el-upload-list__item-thumbnail",attrs:{alt:"",src:e.url}})])}))],2),a("el-dialog",{attrs:{"append-to-body":!0,visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("img",{attrs:{alt:"",src:e.dialogImageUrl,width:"100%"}})])],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.submitForm("form")}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.Create now"))+" ")]),a("el-button",{on:{click:function(t){return e.resetForm("form")}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.Reset"))+" ")])],1)],1)],1)]),a("vab-query-form",{staticClass:"query-form"},[a("vab-query-form-top-panel",[a("el-form",{attrs:{inline:!0,"label-width":"auto",model:e.queryForm},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.number")}},[a("el-input",{attrs:{clearable:"",placeholder:e.$translateTitle("Maintenance.Ticket number")},model:{value:e.queryForm.number,callback:function(t){e.$set(e.queryForm,"number","string"===typeof t?t.trim():t)},expression:"queryForm.number"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.projects")}},[a("el-select",{attrs:{clearable:"",placeholder:e.$translateTitle("Maintenance.project")},model:{value:e.queryForm.product,callback:function(t){e.$set(e.queryForm,"product",t)},expression:"queryForm.product"}},e._l(e._Product,(function(e,t){return a("el-option",{directives:[{name:"show",rawName:"v-show",value:0!=e.objectId,expression:"item.objectId != 0"}],key:t,attrs:{label:e.name,value:e.objectId}})})),1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.type")}},[a("el-input",{attrs:{clearable:"",placeholder:e.$translateTitle("Maintenance.Ticket type")},model:{value:e.queryForm.type,callback:function(t){e.$set(e.queryForm,"type",t)},expression:"queryForm.type"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.times")}},[a("el-date-picker",{attrs:{"end-placeholder":e.$translateTitle("Maintenance.end time"),format:"yyyy-MM-dd","start-placeholder":e.$translateTitle("Maintenance.start time"),type:"daterange","value-format":"yyyy-MM-dd"},model:{value:e.queryForm.searchDate,callback:function(t){e.$set(e.queryForm,"searchDate",t)},expression:"queryForm.searchDate"}})],1),a("el-form-item",[a("el-button",{attrs:{icon:"el-icon-search",size:"mini",type:"primary"},on:{click:e.fetchData}},[e._v(" "+e._s(e.$translateTitle("Maintenance.search"))+" ")]),a("el-button",{attrs:{icon:"el-icon-circle-plus-outline",size:"mini",type:"primary"},on:{click:function(t){e.dialogFormVisible=!e.dialogFormVisible}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.create Ticket"))+" ")]),a("el-button",{attrs:{disabled:!e.selectedList.length,icon:"el-icon-s-promotion",size:"mini",type:"primary"},on:{click:function(t){return e.batchExport(e.selectedList)}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.Export"))+" ")])],1)],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"tableSort",attrs:{border:"",data:e.list,height:e.height,stripe:""},on:{"selection-change":e.changeBox},scopedSlots:e._u([{key:"empty",fn:function(){return[a("vab-empty")]},proxy:!0}])},[a("el-table-column",{attrs:{align:"center","class-name":"isCheck","show-overflow-tooltip":"",type:"selection",width:"55"}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("Maintenance.Ticket number"),prop:"number","show-overflow-tooltip":"",sortable:"",width:"120"}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("Maintenance.Ticket type"),prop:"type","show-overflow-tooltip":"",sortable:""}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("Maintenance.Ticket status"),"show-overflow-tooltip":"",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(e.getStatus(a.status,a))+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("Maintenance.project"),"show-overflow-tooltip":"",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.info&&a.info.productname?a.info.productname:"")+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("Maintenance.Equipment name"),"show-overflow-tooltip":"",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.info&&a.info.devicename?a.info.devicename:"")+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("Maintenance.Initiator"),"show-overflow-tooltip":"",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.info&&a.info.createdname?a.info.createdname:"")+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("Maintenance.the starting time"),"show-overflow-tooltip":"",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(e.$moment(a.createdAt).format("YYYY-MM-DD HH:mm:ss"))+" ")]}}])}),a("el-table-column",{attrs:{align:"center",fixed:"right",label:e.$translateTitle("Maintenance.operating"),width:"220"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.showInfo(n,!0,!1)}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.View"))+" ")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:3!=n.status,expression:"row.status != 3"}],attrs:{disabled:0!=n.status,size:"mini",type:"danger"},on:{click:function(t){return e.handleDelete(n,2)}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.delete"))+" ")])]}}])})],1),a("vab-Pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],attrs:{limit:e.queryForm.pageSize,page:e.queryForm.pageNo,total:e.total},on:{"update:limit":function(t){return e.$set(e.queryForm,"pageSize",t)},"update:page":function(t){return e.$set(e.queryForm,"pageNo",t)},pagination:e.fetchData}})],1)},r=[],i=a("fb07"),s=a("e97b"),o=a("d0d7"),l=a.n(o),c=(a("c4bc"),a("16b8"),a("f1e1"),a("80ab"),a("a98c"),a("3dec"),a("9c6a"),a("79da"),a("0941")),u=a("dcc6"),d=a("1285"),m=a("5880"),p=a("824b"),f=a("12674"),h={name:"CreateTicket",components:{ChangeStep:p["default"]},data:function(){return{showdeviceFlag:!1,created:0,Assigned:0,form:{receiveuseid:"",productname:"",devicename:"",createdname:"",receiveusername:"",receiveuserphone:"",name:"",product:"",type:"",description:"",photo:[],objectId:""},dialogFormVisible:!1,fold:!1,step:1,ishard:!1,height:this.$baseTableHeight(0)-30,isfooter:!0,detail:{},AllDevice:[],selectedList:[],types:["故障维修"],Device:[],dialogImageUrl:"",dialogVisible:!1,disabled:!1,formLabelWidth:"140px",rules:{product:[{required:!0,message:"请选择所属项目",trigger:"change"}],name:[{required:!0,message:"请选择设备",trigger:"change"}],type:[{required:!0,message:"请输入工单类型",trigger:"change"}]},list:[],listLoading:!1,layout:"total, sizes, prev, pager, next, jumper",total:0,status:[{key:0,text:"Maintenance.To be assigned"},{key:1,text:"Maintenance.Assigned"},{key:2,text:"Maintenance.Processed"},{key:3,text:"Maintenance.Statement"}],queryForm:{devicename:"",statusFlag:!1,status:"",number:"",product:"",type:"",pageNo:1,pageSize:20,searchDate:[],limt:10,skip:0,order:"-createdAt",keys:"count(*)"}}},computed:Object(s["a"])(Object(s["a"])({},Object(m["mapGetters"])({_Product:"user/_Product",objectid:"user/objectId",role:"acl/role",username:"user/username"})),{},{_deviceStep:{get:function(){return this.$store.state.global._deviceStep},set:function(e){this.set_deviceStep(e)}},aclObj:function(){var e={};return this.role.map((function(t){e["".concat("role:"+t.name)]={read:!0,write:!0}})),e}}),watch:{_deviceStep:function(e){-1==e&&this.fetchData()},"queryForm.status":function(e){this.queryForm.statusFlag=""!=e}},created:function(){},mounted:function(){this.handleCreated("created")},methods:Object(s["a"])(Object(s["a"])({myUpload:function(e){var t=this,a=e.file,n=a.name.substring(a.name.lastIndexOf(".")+1),r={file:a,path:"ticket",filename:"ticket"+"".concat(moment().format("x"),".").concat(n)};Object(f["UploadImg"])(r).then((function(e){e.data.url&&t.form.photo.push(e.data.url)})).catch((function(e){}))},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;t.createdTicket(t.form)}))},createdTicket:function(e){var t=this;return Object(i["a"])(l.a.mark((function a(){var n,r,i;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n={},n[t.objectid]={read:!0,write:!0},r={number:moment(new Date).unix()+"",type:e.type,ACL:_.merge(n,t.aclObj),info:{photo:e.photo,timeline:[{timestamp:moment(new Date).format("YYYY-MM-DD HH:mm:ss"),h4:"生成工单",p:"".concat(t.username,"新建工单")}],description:e.description,step1:{},step2:{},step3:{},step4:{},productid:e.product,productname:e.productname,devicename:e.devicename,deviceid:e.name,createdname:t.username,receiveusername:e.receiveusername,receiveuseid:e.receiveuseid,receiveuserphone:e.receiveuserphone},device:{objectId:e.name,__type:"Pointer",className:"Device"}},i=t.$baseColorfullLoading(),a.next=6,Object(c["create_object"])("Maintenance",r);case 6:a.sent,t.set_deviceStep(-1),i.close(),t.fetchData(),t.dialogFormVisible=!1;case 11:case"end":return a.stop()}}),a)})))()},resetForm:function(e){this.$refs[e].resetFields()},changeBox:function(e){var t=this;this.selectedList=[],e.forEach((function(e){t.selectedList.push(e)}))}},Object(m["mapMutations"])({set_deviceStep:"global/set_deviceStep"})),{},{handleFold:function(){this.fold=!this.fold,this.handleHeight()},batchExport:function(e){var t=this;return Object(i["a"])(l.a.mark((function a(){var n,r;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,n={results:[]},n["results"]=e,a.next=5,Object(f["exlout"])(n);case 5:r=a.sent,t.$convertRes2Blob(r),t.$message.success(t.$translateTitle("node.export success")),a.next=13;break;case 10:a.prev=10,a.t0=a["catch"](0),t.$message.error(t.$translateTitle("node.export error")+"".concat(a.t0));case 13:case"end":return a.stop()}}),a,null,[[0,10]])})))()},handleDelete:function(e,t){var a=this,n=[];2==t?n.push({method:"DELETE",path:"/classes/Maintenance/".concat(e.objectId),body:{}}):e.forEach((function(e){n.push({method:"DELETE",path:"/classes/Maintenance/".concat(e.objectId),body:{}})})),this.$baseConfirm(this.$translateTitle("Maintenance.Are you sure you want to delete the current item"),null,Object(i["a"])(l.a.mark((function e(){return l.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(u["batch"])(n);case 2:e.sent,a.$baseMessage(a.$translateTitle("Maintenance.successfully deleted"),"success","vab-hey-message-success"),setTimeout((function(){a.fetchData()}),1500);case 5:case"end":return e.stop()}}),e)}))))},handleHeight:function(){this.fold?this.height=this.$baseTableHeight(0)-20:this.height=this.$baseTableHeight(0)-30},getStatus:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;switch(e){case 0:return this.$translateTitle("Maintenance.To be assigned");case 1:return this.$translateTitle("Maintenance.Assigned");case 2:return this.$translateTitle("Maintenance.Processed");case 3:return this.$translateTitle("Maintenance.Statement");default:return e}},showInfo:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.showdeviceFlag=!1,this.ishard=t,this.isfooter=a;var n=e.status,r=void 0===n?0:n;this.detail=e,this.step=r+1,this.set_deviceStep(r),this.showdeviceFlag=!0},handleCreated:function(e){"created"==e?this.created++:this.Assigned++,this.fetchData()},fetchData:function(){var e=arguments,t=this;return Object(i["a"])(l.a.mark((function a(){var n,r,i,s;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=e.length>0&&void 0!==e[0]?e[0]:{},r.limit||(r=t.queryForm),t.listLoading=!1,i=t.$baseColorfullLoading(),s={limit:r.limit,order:r.order,skip:r.skip,keys:r.keys,where:{"info.receiveuseid":t.Assigned%2==0?{$ne:"99"}:t.objectid,number:t.queryForm.number.length?{$regex:t.queryForm.number}:{$ne:null},status:0,"info.productid":t.queryForm.product.length?t.queryForm.product:{$ne:"99"},type:t.queryForm.type.length?{$regex:t.queryForm.type}:{$ne:null}}},null!==(n=t.queryForm.searchDate)&&void 0!==n&&n.length&&(s.where["createdAt"]={$gt:{__type:"Date",iso:t.queryForm.searchDate[0]}},s.where["updatedAt"]={$lt:{__type:"Date",iso:t.queryForm.searchDate[1]}}),a.next=8,Object(c["query_object"])("Maintenance",s).then((function(e){var a=e.results,n=void 0===a?[]:a,r=e.count,s=void 0===r?0:r;t.list=n,t.list.forEach((function(e){if(e._user="暂无",e.ACL)for(var t in e.ACL)e._user=t.substr(0)})),t.total=s,i.close()})).catch((function(e){t.$message.error("".concat(e)),i.close()}));case 8:case"end":return a.stop()}}),a)})))()},prodChange:function(e){var t=this;return Object(i["a"])(l.a.mark((function a(){var n,r,i;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.Device=[],t._Product.map((function(a){a.objectId==e&&(t.form.productname=a.name)})),t.form.name="",n={where:{product:e}},a.next=6,Object(d["queryDevice"])(n);case 6:r=a.sent,i=r.results,t.Device=i;case 9:case"end":return a.stop()}}),a)})))()},deviceChange:function(e){var t=this;this.Device.map((function(a){a.objectId==e&&(t.form.devicename=a.name)}))},dispatch:function(){this.$refs.ChangeStep.$refs.step1.dispatchUser()},backChange:function(e){var t=this;return Object(i["a"])(l.a.mark((function a(){var n,r,i,s;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=e.objectId,r=e.info,r.timeline.push({timestamp:moment(new Date).format("YYYY-MM-DD HH:mm:ss"),h4:"已回退",p:"".concat(t.username," 回退了流程")}),i={status:0,info:r},a.next=5,Object(c["update_object"])("Maintenance",n,i);case 5:s=a.sent,s.updatedAt&&t.set_deviceStep(-1);case 7:case"end":return a.stop()}}),a)})))()},Reassign:function(e){var t=this;return Object(i["a"])(l.a.mark((function a(){var n,r,i,s;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=e.objectId,r=e.info,r.timeline.push({timestamp:moment(new Date).format("YYYY-MM-DD HH:mm:ss"),h4:"已改派",p:"".concat(t.username," 改派了工单")}),i={status:0,info:r},a.next=5,Object(c["update_object"])("Maintenance",n,i);case 5:s=a.sent,s.updatedAt&&t.set_deviceStep(-1);case 7:case"end":return a.stop()}}),a)})))()},dealwith:function(){this.$refs.ChangeStep.$refs.step2.dispatchUser()},check:function(){this.$refs.ChangeStep.$refs.step3.dispatchUser()}})},b=h,g=(a("e6d6"),a("bdd7")),v=Object(g["a"])(b,n,r,!1,null,"990dcd62",null);t["default"]=v.exports},c937:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"dashboard-container"},[a("div",{staticClass:"main"},[a("a-tabs",{staticClass:"tabs",attrs:{"default-active-key":"iframe"}},[a("a-tab-pane",{key:"iframe",attrs:{tab:e.$translateTitle("leftbar.monitor")}},[a("iframe",{directives:[{name:"show",rawName:"v-show",value:""!=e.dashboardrul&&e.dashboardrul,expression:"dashboardrul != '' && dashboardrul"}],staticClass:"iframe",attrs:{id:"iframe",frameborder:"0",height:"700",width:"100%"}})]),a("a-tab-pane",{key:"chart",attrs:{"force-render":"",tab:e.$translateTitle("equipment.chart")}},[a("empty")],1)],1)],1)])},r=[],i=(a("1d17"),a("98da"),a("43b8")),s={name:"Dashboard",components:{empty:i["default"]},data:function(){return{currentRole:"adminDashboard",isshow:0,childshow:0,form:{date1:"",date2:""},refresh:"",dashboardrul:"http://47.105.106.54:3000/",timerefesh:{val1:"15s",val2:"30s",val3:"60s"},categoryIndex:0}},computed:{},mounted:function(){this.getDashboard()},methods:{getDashboard:function(){this.dashboardrul=location.protocol+"//"+location.hostname+":3000";var e=document.getElementById("iframe");e.setAttribute("src",this.dashboardrul)},selectval:function(e,t){var a=/(refresh=[^&]+)/;this.dashboardrul=this.dashboardrul.replace(a,"refresh="+e),this.categoryIndex=t}}},o=s,l=(a("6bff"),a("bdd7")),c=Object(l["a"])(o,n,r,!1,null,null,null);t["default"]=c.exports},cb07:function(e,t,a){"use strict";a("4a31")},cb5a:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"custom-table",staticClass:"custom-table-container",class:{"vab-fullscreen":e.isFullscreen}},[n("div",{key:e.height,staticClass:"components"},[n("vab-dialog",{attrs:{show:e.activePopShow},on:{"update:show":function(t){e.activePopShow=t}}},[n("h3",{attrs:{slot:"title"},slot:"title"},[e._v(" "+e._s(e.$translateTitle("cloudTest.add"))+e._s(e.$translateTitle("cloudTest.report template"))+" ")]),n("div",{staticClass:"content"},[n("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{"label-width":"100px",model:e.ruleForm,rules:e.rules}},[n("el-form-item",{attrs:{label:e.$translateTitle("cloudTest.Template name"),prop:"name"}},[n("el-input",{model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),n("el-form-item",{attrs:{label:e.$translateTitle("cloudTest.category"),prop:"category"}},[n("el-input",{model:{value:e.ruleForm.category,callback:function(t){e.$set(e.ruleForm,"category",t)},expression:"ruleForm.category"}})],1),n("el-form-item",{attrs:{label:e.$translateTitle("cloudTest.Trade Names"),prop:"factory",required:""}},[n("el-input",{model:{value:e.ruleForm.factory,callback:function(t){e.$set(e.ruleForm,"factory",t)},expression:"ruleForm.factory"}})],1),n("el-form-item",{attrs:{label:e.$translateTitle("cloudTest.Template file"),prop:"file",required:""}},[n("el-upload",{key:e.momentKey,ref:"upload",staticClass:"upload-demo",attrs:{accept:".doc,.docx",action:"string","before-upload":e.onBeforeUploadImage,"file-list":e.fileList,"http-request":e.UploadImage,limit:1,"list-type":"text","on-change":e.fileChange},model:{value:e.ruleForm.file,callback:function(t){e.$set(e.ruleForm,"file",t)},expression:"ruleForm.file"}},[n("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v(" "+e._s(e.$translateTitle("application.selectfile"))+" ")])],1)],1)],1)],1),n("Vab-amis",{attrs:{schema:e.amisJson}}),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v(" "+e._s(e.$translateTitle("product.createnow"))+" ")]),n("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v(" "+e._s(e.$translateTitle("zetadevices.reset"))+" ")])],1)],1),n("vab-dialog",{attrs:{show:e.tempPopShow},on:{"update:show":function(t){e.tempPopShow=t}}},[n("h3",{attrs:{slot:"title"},slot:"title"},[e._v(" "+e._s(e.$translateTitle("cloudTest.report template"))+" ")]),n("div",{staticClass:"content"},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"tableSort",attrs:{border:e.border,data:e.tempList,height:e.$baseTableHeight(3),size:e.lineHeight,stripe:e.stripe},scopedSlots:e._u([{key:"empty",fn:function(){return[n("el-image",{staticClass:"vab-data-empty",attrs:{src:a("c2ad")}})]},proxy:!0}])},[n("el-table-column",{attrs:{align:"center",label:e.$translateTitle("cloudTest.number"),"show-overflow-tooltip":"",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.$index;return[e._v(" "+e._s(a+1)+" ")]}}])}),n("el-table-column",{attrs:{align:"center",label:e.$translateTitle("cloudTest.Template name"),prop:"name","show-overflow-tooltip":"",width:"auto"}}),n("el-table-column",{attrs:{align:"center",label:e.$translateTitle("cloudTest.Template content"),width:"auto"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("el-image",{staticStyle:{width:"40px",height:"40px"},attrs:{"preview-src-list":[e.$FileServe+a.icon],src:e.$FileServe+a.icon}})]}}])}),n("el-table-column",{attrs:{align:"center",flex:"right",label:e.$translateTitle("product.Template management"),"show-overflow-tooltip":"",width:"auto"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("el-button",{attrs:{type:"success"},on:{click:function(t){return e.handlekonva(a)}}},[e._v(" "+e._s(e.$translateTitle("developer.mapping"))+" ")]),n("el-button",{attrs:{type:"warning"},on:{click:function(t){return e.handleDelete(a,1)}}},[e._v(" "+e._s(e.$translateTitle("cloudTest.delete"))+" ")])]}}])})],1)],1)])],1),n("vab-query-form",[n("vab-query-form-left-panel",[n("el-form",{ref:"form",attrs:{inline:!0,"label-width":"0",model:e.queryForm},nativeOn:{submit:function(e){e.preventDefault()}}},[n("el-form-item",[n("el-input",{attrs:{placeholder:e.$translateTitle("cloudTest.Please enter the query content")},model:{value:e.queryForm.name,callback:function(t){e.$set(e.queryForm,"name",t)},expression:"queryForm.name"}})],1),n("el-form-item",[n("el-button",{attrs:{icon:"el-icon-search","native-type":"submit",type:"primary"},on:{click:function(t){return e.fetchData(e.queryForm)}}},[e._v(" "+e._s(e.$translateTitle("cloudTest.search"))+" ")]),n("el-button",{attrs:{icon:"el-icon-plus",type:"primary"},on:{click:e.handleAdd}},[e._v(" "+e._s(e.$translateTitle("cloudTest.add"))+" ")])],1)],1)],1),n("vab-query-form-right-panel",[n("el-button",{staticStyle:{margin:"0 10px 10px 0 !important"},attrs:{type:"primary"},on:{click:e.clickFullScreen}},[n("vab-icon",{attrs:{icon:e.isFullscreen?"fullscreen-exit-fill":"fullscreen-fill"}}),e._v(" "+e._s(e.$translateTitle("cloudTest.full screen"))+" ")],1),n("el-popover",{ref:"popover",attrs:{"popper-class":"custom-table-checkbox",trigger:"hover"},scopedSlots:e._u([{key:"reference",fn:function(){return[n("el-button",{staticStyle:{margin:"0 10px 10px 0 !important"},attrs:{type:"primary"}},[n("vab-icon",{attrs:{icon:"line-height"}}),e._v(" "+e._s(e.$translateTitle("cloudTest.size"))+" ")],1)]},proxy:!0}])},[n("el-radio-group",{model:{value:e.lineHeight,callback:function(t){e.lineHeight=t},expression:"lineHeight"}},[n("el-radio",{attrs:{label:"medium"}},[e._v(" "+e._s(e.$translateTitle("cloudTest.medium"))+" ")]),n("el-radio",{attrs:{label:"small"}},[e._v(" "+e._s(e.$translateTitle("cloudTest.small"))+" ")]),n("el-radio",{attrs:{label:"mini"}},[e._v(" "+e._s(e.$translateTitle("cloudTest.mini"))+" ")])],1)],1),n("el-popover",{attrs:{"popper-class":"custom-table-checkbox",trigger:"hover"},scopedSlots:e._u([{key:"reference",fn:function(){return[n("el-button",{staticStyle:{margin:"0 0 10px 0 !important"},attrs:{icon:"el-icon-setting",type:"primary"}},[e._v(" "+e._s(e.$translateTitle("cloudTest.Draggable column"))+" ")])]},proxy:!0}])},[n("el-checkbox-group",{model:{value:e.checkList,callback:function(t){e.checkList=t},expression:"checkList"}},[n("vab-draggable",e._b({attrs:{list:e.columns}},"vab-draggable",e.dragOptions,!1),e._l(e.columns,(function(t,a){return n("div",{key:t+a},[n("vab-icon",{attrs:{icon:"drag-drop-line"}}),n("el-checkbox",{attrs:{disabled:!0===t.disableCheck,label:t.label}},[e._v(" "+e._s(e.$translateTitle("cloudTest."+t.label))+" ")])],1)})),0)],1)],1)],1)],1),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"tableSort",attrs:{border:e.border,data:e.list,height:e.height,size:e.lineHeight,stripe:e.stripe},scopedSlots:e._u([{key:"empty",fn:function(){return[n("el-image",{staticClass:"vab-data-empty",attrs:{src:a("c2ad")}})]},proxy:!0}])},[n("el-table-column",{attrs:{align:"center",label:e.$translateTitle("cloudTest.number"),"show-overflow-tooltip":"",width:"95"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.$index;return[e._v(" "+e._s(a+1)+" ")]}}])}),e._l(e.finallyColumns,(function(t,a){return n("el-table-column",{key:a,attrs:{align:"center",label:e.$translateTitle("cloudTest."+t.label),prop:t.prop,"show-overflow-tooltip":"",sortable:t.sortable,width:t.width}})})),n("el-table-column",{attrs:{align:"center",label:e.$translateTitle("cloudTest.operate"),"show-overflow-tooltip":"",width:"185"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("el-button",{attrs:{type:"success"},on:{click:function(t){return e.handleManagement(a)}}},[e._v(" "+e._s(e.$translateTitle("product.Template management"))+" ")]),n("el-button",{attrs:{type:"warning"},on:{click:function(t){return e.handleDelete(a,0)}}},[e._v(" "+e._s(e.$translateTitle("cloudTest.delete"))+" ")])]}}])})],2),n("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper",page:e.queryForm.pageNo,"page-size":e.queryForm.pageSize,"page-sizes":e.queryForm.pageSizes,total:e.queryForm.total},on:{"update:page":function(t){return e.$set(e.queryForm,"pageNo",t)},"current-change":e.currentChange,"size-change":e.sizeChange}})],1)},r=[],i=a("fb07"),s=a("e97b"),o=a("d0d7"),l=a.n(o),c=(a("a0e0"),a("3dec"),a("f764"),a("5662"),a("16b8"),a("04d6"),a("79da"),a("9c6a"),a("7212")),u=a("58dd"),d=a("289a"),m=a.n(d),p=a("5880"),f=a("07e2"),h={name:"ReportIndex",components:{VabDraggable:m.a},data:function(){var e=function(e,t,a){""===t?a(new Error("请上传文件")):a()};return{categoryTreeData:[],amisJson:{},fileList:[],momentKey:moment(new Date).valueOf(),ruleForm:{file:null,name:"",category:"",factory:"",date2:""},rules:{name:[{required:!0,message:"请输入模板名称",trigger:"blur"},{min:3,max:8,message:"长度在 3 到 8 个字符",trigger:"blur"}],category:[{required:!0,message:"请输入所属品类",trigger:"blur"},{min:3,max:8,message:"长度在 3 到 8 个字符",trigger:"blur"}],factory:[{required:!0,message:"请输入厂商名称",trigger:"blur"},{min:3,max:8,message:"长度在 3 到 8 个字符",trigger:"blur"}],file:[{validator:e,trigger:"blur"}]},activePopShow:!1,tempPopShow:!1,isFullscreen:!1,border:!0,height:this.$baseTableHeight(0)-20,stripe:!0,lineHeight:"medium",checkList:["objectId","Template name","category","Trade Names","Creation time"],columns:[{label:"objectId",width:"auto",prop:"objectId",sortable:!0,disableCheck:!0},{label:"Template name",width:"auto",prop:"name",sortable:!0},{label:"category",width:"auto",prop:"category.name",sortable:!0},{label:"Trade Names",width:"auto",prop:"devType",sortable:!0},{label:"Creation time",width:"auto",prop:"createdAt",sortable:!0}],list:[],tempList:[],listLoading:!0,layout:"total, sizes, prev, pager, next, jumper",temprow:{},queryForm:{pageSizes:[10,20,30,50],limit:10,order:"-createdAt",keys:"count(*)",total:0,skip:0,pageNo:1,pageSize:10,name:""}}},computed:Object(s["a"])(Object(s["a"])({},Object(p["mapGetters"])({language:"settings/language",collapse:"settings/collapse"})),{},{dragOptions:function(){return{animation:600,group:"description"}},finallyColumns:function(){var e=this;return this.columns.filter((function(t){return e.checkList.includes(t.label)}))}}),watch:{language:{deep:!0,limit:!0,handler:function(e){}}},created:function(){this.fetchData(this.queryForm)},mounted:function(){this.categorytree()},methods:{categorytree:function(){var e=this;return Object(i["a"])(l.a.mark((function t(){var a,n,r,i;return l.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={class:"Category",filter:'{"order": "createdAt","keys":["parent","name","level"],"where":{"parent": "d6ad425529"}}',parent:"parent"},t.prev=1,t.next=4,Object(f["post_tree"])(a);case 4:n=t.sent,r=n.results,i=void 0===r?[]:r,e.categoryTreeData=i,t.next=12;break;case 10:t.prev=10,t.t0=t["catch"](1);case 12:case"end":return t.stop()}}),t,null,[[1,10]])})))()},onBeforeUploadImage:function(e){var t=["application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/msword"],a=t.includes(e.type),n=e.size/1024/1024<30;return a||this.$message.error("上传文件只能是doc/docx格式!"),n||this.$message.error("上传文件大小不能超过 30MB!"),this.momentKey=moment(new Date).valueOf(),a&&n},UploadImage:function(e){this.ruleForm.file=e.file},fileChange:function(e){this.$refs.upload.clearFiles(),this.logo=e.raw,this.fileList=[{name:e.name,url:e.url}]},submitUpload:function(){this.$refs.upload.submit()},handlePreview:function(e){},submitForm:function(e){var t=this;this.$refs[e].validate(function(){var e=Object(i["a"])(l.a.mark((function e(a){var n,r,i,s;return l.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!a){e.next=24;break}return n=new FormData,r={identifier:"inspectionReportTemp",client:t.ruleForm.factory},n.append("devType",t.ruleForm.category),n.append("name",t.ruleForm.name),n.append("config",JSON.stringify(r)),n.append("file",t.ruleForm.file),i=t.$baseColorfullLoading(1),e.prev=8,e.next=11,Object(u["postReportFile"])(n);case 11:s=e.sent,s.result,t.$message.success(t.$translateTitle("cloudTest.Template created successfully")),t.activePopShow=!1,t.fetchData(t.queryForm),e.next=21;break;case 18:e.prev=18,e.t0=e["catch"](8),t.$message.error(t.$translateTitle("cloudTest.Template creation failed"));case 21:i.close(),e.next=25;break;case 24:return e.abrupt("return",!1);case 25:case"end":return e.stop()}}),e,null,[[8,18]])})));return function(t){return e.apply(this,arguments)}}())},sizeChange:function(e){this.queryForm.limit=e,this.fetchData(this.queryForm)},currentChange:function(e){this.queryForm.skip=(e-1)*this.queryForm.limit,this.fetchData(this.queryForm)},resetForm:function(e){this.ruleForm.file=null,this.fileList=[],this.$refs[e].resetFields()},clickFullScreen:function(){this.isFullscreen=!this.isFullscreen,this.handleHeight()},handleHeight:function(){this.isFullscreen?this.height=this.$baseTableHeight(1)+210:this.height=this.$baseTableHeight(1)},handleAdd:function(){this.activePopShow=!0},handlekonva:function(e){this.$router.push({path:"/Topo",query:{productid:e.objectId,icon:e.icon,type:"Evidence"}})},handleManagement:function(e){var t=this;return Object(i["a"])(l.a.mark((function a(){var n,r,i,s,o;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.temprow=e,n={limit:50,skip:0,keys:"count(*)",where:{$relatedTo:{object:{__type:"Pointer",className:"Product",objectId:t.temprow.objectId},key:"children"}},order:"createdAt"},r=t.$baseColorfullLoading(1),a.prev=3,a.next=6,Object(c["queryProduct"])(n);case 6:i=a.sent,s=i.count,void 0===s?0:s,o=i.results,t.tempList=o,a.next=15;break;case 13:a.prev=13,a.t0=a["catch"](3);case 15:t.tempPopShow=!0,r.close();case 17:case"end":return a.stop()}}),a,null,[[3,13]])})))()},handleDelete:function(e,t){var a=this;this.$baseConfirm(this.$translateTitle("Maintenance.Are you sure you want to delete the current item"),null,Object(i["a"])(l.a.mark((function n(){return l.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,Object(c["delProduct"])(e.objectId);case 2:if(n.sent,a.$baseMessage(a.$translateTitle("successfully deleted"),"success","vab-hey-message-success"),0!=t){n.next=9;break}return n.next=7,a.fetchData(a.queryForm);case 7:n.next=11;break;case 9:return n.next=11,a.handleManagement(a.temprow);case 11:case"end":return n.stop()}}),n)}))))},fetchData:function(e){var t=this;return Object(i["a"])(l.a.mark((function a(){var n,r,i,s,o,u;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n={limit:e.limit,order:e.order,skip:t.queryForm.name?0:e.skip,keys:e.keys,include:"category",where:{name:t.queryForm.name?{$regex:t.queryForm.name}:{$ne:null},category:"d6ad425529",nodeType:1}},t.listLoading=!0,a.next=4,Object(c["queryProduct"])(n);case 4:r=a.sent,i=r.count,s=void 0===i?0:i,o=r.results,u=void 0===o?[]:o,u.forEach((function(e){e.createdAt=moment(e.createdAt).format("YYYY-MM-DD HH:mm:ss")})),t.list=u,t.queryForm.total=s,t.listLoading=!1;case 13:case"end":return a.stop()}}),a)})))()}}},b=h,g=a("bdd7"),v=Object(g["a"])(b,n,r,!1,null,null,null);t["default"]=v.exports},cee2:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"CloudTest-container"},[a("div",{staticClass:"CloudTest-content"},[e._v(" "+e._s(e.infoData)+" ")])])},r=[],i={name:"CloudTest",components:{},data:function(){return{infoData:"CloudTest"}},computed:{},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){},methods:{}},s=i,o=(a("2b89"),a("bdd7")),l=Object(o["a"])(s,n,r,!1,null,"7bc1a9ee",null);t["default"]=l.exports},d2ec:function(e,t,a){"use strict";a("b142")},d322:function(e,t,a){"use strict";a("15ed")},d4d8:function(e,t,a){"use strict";a("1855")},db6d:function(e,t,a){e.exports={"menu-color":"rgba(255,255,255,.95)","menu-color-active":"rgba(255,255,255,.95)","menu-background":"#282c34","column-second-menu-background":"#fff"}},e185:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"modules"},[a("el-dialog",{attrs:{"append-to-body":!0,title:"修改物模型",visible:e.edit_module,width:"17%"},on:{"update:visible":function(t){e.edit_module=t}}},[a("el-form",{ref:"editForm",staticClass:"demo-editForm",attrs:{"label-width":"100px",model:e.editForm,rules:e.rules}},[a("el-form-item",{attrs:{label:"产品名称",prop:"name"}},[a("el-input",{model:{value:e.editForm.name,callback:function(t){e.$set(e.editForm,"name",t)},expression:"editForm.name"}})],1),a("el-form-item",{attrs:{label:"产品类型",prop:"devType"}},[a("el-input",{model:{value:e.editForm.devType,callback:function(t){e.$set(e.editForm,"devType",t)},expression:"editForm.devType"}})],1),a("el-form-item",{attrs:{label:"所属分类",prop:"category"}},[a("el-cascader",{attrs:{options:e.categoryListOptions},model:{value:e.editForm.category,callback:function(t){e.$set(e.editForm,"category",t)},expression:"editForm.category"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.editPostForm("editForm")}}},[e._v(" 修改 ")]),a("el-button",{on:{click:function(t){return e.resetForm("editForm")}}},[e._v("重置")])],1)],1),a("el-dialog",{attrs:{"append-to-body":!0,title:"新增物模型",visible:e.add_module,width:"17%"},on:{"update:visible":function(t){e.add_module=t}}},[a("el-form",{ref:"moduleForm",staticClass:"demo-moduleForm",attrs:{"label-width":"100px",model:e.moduleForm,rules:e.rules}},[a("el-form-item",{attrs:{label:"产品名称",prop:"name"}},[a("el-input",{model:{value:e.moduleForm.name,callback:function(t){e.$set(e.moduleForm,"name",t)},expression:"moduleForm.name"}})],1),a("el-form-item",{attrs:{label:"产品类型",prop:"devType"}},[a("el-input",{model:{value:e.moduleForm.devType,callback:function(t){e.$set(e.moduleForm,"devType",t)},expression:"moduleForm.devType"}})],1),a("el-form-item",{attrs:{label:"所属分类",prop:"category"}},[a("el-cascader",{attrs:{options:e.categoryListOptions},model:{value:e.moduleForm.category,callback:function(t){e.$set(e.moduleForm,"category",t)},expression:"moduleForm.category"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.submitForm("moduleForm")}}},[e._v(" 立即创建 ")]),a("el-button",{on:{click:function(t){return e.resetForm("moduleForm")}}},[e._v("重置")])],1)],1),a("header",[a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:20}},[a("el-button",{attrs:{icon:"el-icon-plus",size:"mini",type:"primary"},on:{click:function(t){e.add_module=!0}}},[e._v(" 新增 ")])],1),a("el-col",{attrs:{span:4}},[a("el-input",{attrs:{placeholder:"请输入产品名称",size:"mini"},model:{value:e.searchText,callback:function(t){e.searchText=t},expression:"searchText"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search",size:"mini",type:"primary"},on:{click:function(t){return e.searchModule(e.searchText)}},slot:"append"},[e._v(" 搜索 ")])],1)],1)],1)],1),a("center",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.pictLoading,expression:"pictLoading"}],staticStyle:{width:"100%","min-height":"583px"},attrs:{data:e.tableData.filter((function(t){return!e.search||t.name.toLowerCase().includes(e.search.toLowerCase())})),"element-loading-background":"rgba(0, 0, 0, 0.5)","element-loading-spinner":"el-icon-loading","element-loading-text":"数据正在加载中","max-height":"583"}},[a("el-table-column",{attrs:{label:"objectId",prop:"objectId"}}),a("el-table-column",{attrs:{label:"产品名称"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.data.name)+" ")]}}])}),a("el-table-column",{attrs:{label:"产品类型"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.data.devType)+" ")]}}])}),a("el-table-column",{attrs:{label:"key",prop:"key"}}),a("el-table-column",{attrs:{label:"所属分类"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.data.category)+" ")]}}])}),a("el-table-column",{attrs:{align:"right"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("el-input",{attrs:{placeholder:"输入关键字搜索",size:"mini"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})]}},{key:"default",fn:function(t){var n=t.row;return[a("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.handleEdit(n.$index,n)}}},[e._v(" 修改 ")]),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleDelete(n.$index,n.tableData)}}},[e._v(" 删除 ")])]}}])})],1)],1),a("footer",[a("el-pagination",{attrs:{"current-page":e.currentPage,layout:"total, sizes, prev, pager, next, jumper","page-size":10,"page-sizes":[10,20,50,100],total:e.pageTotal},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1),e._v(" Parse ")],1)},r=[],i=a("fb07"),s=(a("04d6"),a("a0e0"),a("3dec"),a("c4bc"),a("16b8"),a("e170"),a("d0d7")),o=a.n(s),l=a("e0e9"),c=a("7212"),u=a("7497"),d={name:"Modules",components:{},data:function(){return{productObj:[],pictLoading:!1,categoryListOptions:[],limit:10,skip:0,add_module:!1,edit_module:!1,searchText:"",hashkey:"",categoryList:[],infoData:"物模型管理",currentPage:1,pageTotal:0,tableData:[],search:"",editForm:{name:"物模型管理",devType:"物模型管理",category:"",type:"Product"},moduleForm:{name:"物模型管理",devType:"物模型管理",category:"",type:"Product"},rules:{name:[{required:!0,message:"请输入产品名称",trigger:"blur"}],devType:[{required:!0,message:"请输入产品类型",trigger:"blur"}],category:[{required:!0,message:"请选择模型所属分类",trigger:"blur"}]}}},computed:{},mounted:function(){this.searchModule(""),this.Industry()},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){},methods:{getProduct:function(){var e=this;return Object(i["a"])(o.a.mark((function t(){var a,n;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(c["queryProduct"])();case 2:a=t.sent,n=a.results,n&&(e.productObj=n);case 5:case"end":return t.stop()}}),t)})))()},treeData:function(e){var t=JSON.parse(JSON.stringify(e));return t.filter((function(e){var a=t.filter((function(t){return e.id==t.parentid}));return a.length>0&&(e.children=a),0==e.parentid}))},Industry:function(){var e=this;this.categoryList=[],this.getProduct();var t={limit:10,where:{"data.key":"category"}};this.$query_object("Dict",t).then((function(t){t.results&&(t.results.map((function(t){var a={};a.value=t.type,a.label=t.data.CategoryName,a.id=t.data.Id,a.parentid=t.data.SuperId,e.categoryList.push(a)})),e.categoryListOptions=e.treeData(e.categoryList))})).catch((function(e){}))},blackDict:function(e,t,a){var n=this;return Object(i["a"])(o.a.mark((function r(){var i,s;return o.a.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return i={data:t,key:e,type:a},r.next=3,Object(l["postDict"])(i);case 3:s=r.sent,s?(n.$message({type:"success",message:"新建物模型成功"}),n.add_module=!1,n.searchModule("")):n.$message({type:"error",message:"新建物模型失败"});case 5:case"end":return r.stop()}}),r)})))()},submitForm:function(e){var t=this;this.$refs[e].validate(function(){var e=Object(i["a"])(o.a.mark((function e(a){var n,r,i,s;return o.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!a){e.next=8;break}return n={category:t.moduleForm.category[0],devType:t.moduleForm.devType,name:t.moduleForm.name},e.next=4,Object(u["getHashClass"])("Product",n);case 4:r=e.sent,i=r.objectId,s=r.code,200==s&&t.blackDict(i,n,t.moduleForm.type);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},resetForm:function(e){this.$refs[e].resetFields()},searchModule:function(e){var t=this;return Object(i["a"])(o.a.mark((function a(){var n,r,i,s,c;return o.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.pictLoading=!0,n=e.length?{order:"-createdAt",count:"objectId",limit:t.limit,skip:t.skip,where:{type:"Module",key:{$regex:"".concat(e)}}}:{order:"-createdAt",count:"objectId",limit:t.limit,skip:t.skip,where:{type:"Product"}},a.next=4,Object(l["getDictCount"])(n);case 4:r=a.sent,i=r.results,s=r.count,c=void 0===s?0:s,t.pictLoading=!1,i&&(t.tableData=i,t.pageTotal=c);case 10:case"end":return a.stop()}}),a)})))()},handleSizeChange:function(e){this.limit=e,this.searchModule(this.searchText)},handleCurrentChange:function(e){this.skip=this.limit*(e-1),this.searchModule(this.searchText)},handleEdit:function(e,t){this.edit_module=!0,this.editForm=t.data},editPostForm:function(e){},handleDelete:function(e,t,a){var n=this;return Object(i["a"])(o.a.mark((function r(){var i;return o.a.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,Object(l["delDict"])(t.objectId);case 2:i=r.sent,i?(a.splice(e,1),n.$message({type:"success",message:"删除成功"})):n.$message({type:"error",message:"删除失败"});case 4:case"end":return r.stop()}}),r)})))()}}},m=d,p=(a("cb07"),a("bdd7")),f=Object(p["a"])(m,n,r,!1,null,"16a8e6dc",null);t["default"]=f.exports},e49bb:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mycontainer"},[a("div",{staticClass:"ticker-dialog"},[a("el-dialog",{attrs:{"append-to-body":!0,title:e.detail.name,visible:e.deviceFlag,width:"100vh"},on:{"update:visible":function(t){e.deviceFlag=t}}},[a("change-info",{attrs:{detail:e.detail,"show-footer":e.isfooter,"show-hard":e.ishard,step:e.step}})],1)],1),a("vab-query-form",{staticClass:"query-form"},[a("vab-query-form-top-panel",[a("el-form",{attrs:{inline:!0,"label-width":"auto",model:e.queryForm},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.Ticket number")}},[a("el-input",{attrs:{clearable:"",placeholder:e.$translateTitle("Maintenance.Ticket number")},model:{value:e.queryForm.number,callback:function(t){e.$set(e.queryForm,"number","string"===typeof t?t.trim():t)},expression:"queryForm.number"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.project")}},[a("el-select",{attrs:{placeholder:e.$translateTitle("Maintenance.project")},model:{value:e.queryForm.product,callback:function(t){e.$set(e.queryForm,"product",t)},expression:"queryForm.product"}},e._l(e._Product,(function(e,t){return a("el-option",{directives:[{name:"show",rawName:"v-show",value:0!=e.objectId,expression:"item.objectId != 0"}],key:t,attrs:{label:e.name,value:e.objectId}})})),1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.Ticket type")}},[a("el-input",{attrs:{placeholder:e.$translateTitle("Maintenance.Ticket type")},model:{value:e.queryForm.type,callback:function(t){e.$set(e.queryForm,"type",t)},expression:"queryForm.type"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.the starting time")}},[a("el-date-picker",{attrs:{"end-placeholder":e.$translateTitle("Maintenance.end time"),format:"yyyy-MM-dd","start-placeholder":e.$translateTitle("Maintenance.start time"),type:"daterange","value-format":"yyyy-MM-dd"},model:{value:e.queryForm.searchDate,callback:function(t){e.$set(e.queryForm,"searchDate",t)},expression:"queryForm.searchDate"}})],1),a("el-form-item",[a("el-button",{attrs:{icon:"el-icon-search",type:"primary"},nativeOn:{click:function(t){return e.fetchData.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.search"))+" ")]),a("el-button",{attrs:{disabled:!e.selectedList.length,icon:"el-icon-folder-checked",type:"primary"},on:{click:function(t){return e.Export(e.selectedList)}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.Export"))+" ")])],1)],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.list,height:e.height},on:{"selection-change":e.changeBox},scopedSlots:e._u([{key:"empty",fn:function(){return[a("vab-empty")]},proxy:!0}])},[a("el-table-column",{attrs:{align:"center","class-name":"isCheck","show-overflow-tooltip":"",type:"selection",width:"55"}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("Maintenance.Ticket number"),prop:"number","show-overflow-tooltip":"",sortablesortable:"",width:"120"}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("Maintenance.Ticket type"),prop:"type","show-overflow-tooltip":"",sortable:"",width:"140"}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("Maintenance.Ticket status"),"show-overflow-tooltip":"",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(e.getStatus(a.status))+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("Maintenance.project"),"show-overflow-tooltip":"",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.info&&a.info.productname?a.info.productname:"")+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("Maintenance.Equipment name"),"show-overflow-tooltip":"",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.info&&a.info.devicename?a.info.devicename:"")+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("Maintenance.Initiator"),"show-overflow-tooltip":"",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.info&&a.info.createdname?a.info.createdname:"")+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("Maintenance.the starting time"),"show-overflow-tooltip":"",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(e.$moment(a.createdAt).format("YYYY-MM-DD HH:mm:ss"))+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("Maintenance.operating"),prop:"name","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.showInfo(n)}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.View"))+" ")])]}}])})],1),a("VabPagination",{directives:[{name:"show",rawName:"v-show",value:e.total,expression:"total"}],attrs:{limit:e.queryForm.pageSize,page:e.queryForm.pageNo,total:e.total},on:{"update:limit":function(t){return e.$set(e.queryForm,"pageSize",t)},"update:page":function(t){return e.$set(e.queryForm,"pageNo",t)},pagination:e.fetchData}})],1)},r=[],i=a("fb07"),s=a("e97b"),o=a("d0d7"),l=a.n(o),c=(a("c4bc"),a("16b8"),a("3dec"),a("9c6a"),a("79da"),a("1d17"),a("4c87"),a("e170"),a("0941")),u=a("12674"),d=a("1285"),m=a("e915"),p=a("5880"),f={name:"Index",components:{ChangeInfo:m["default"]},data:function(){return{selectedList:[],ishard:!0,isfooter:!1,step:1,detail:{},deviceFlag:!1,AllDevice:[],height:this.$baseTableHeight(0),dialogFormVisible:!1,types:["故障维修"],Device:[],dialogImageUrl:"",dialogVisible:!1,disabled:!1,formLabelWidth:"140px",rules:{product:[{required:!0,message:"请选择活动区域",trigger:"change"}],name:[{required:!0,message:"请选择活动区域",trigger:"change"}],type:[{required:!0,message:"请选择活动资源",trigger:"change"}]},list:[],listLoading:!1,layout:"total, sizes, prev, pager, next, jumper",total:0,queryForm:{number:"",product:"",type:"",searchDate:[],limit:20,skip:0,order:"-createdAt",keys:"count(*)"}}},computed:Object(s["a"])(Object(s["a"])({},Object(p["mapGetters"])({_Product:"user/_Product",objectId:"user/objectId",role:"acl/role",username:"user/username"})),{},{aclObj:function(){var e={};return this.role.map((function(t){e["".concat("role:"+t.name)]={read:!0,write:!0}})),e}}),created:function(){},mounted:function(){this.fetchData()},methods:{changeBox:function(e){var t=this;this.selectedList=[],e.forEach((function(e){t.selectedList.push(e)}))},Export:function(e){var t=this;return Object(i["a"])(l.a.mark((function a(){var n,r;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,n={results:[]},n["results"]=e,a.next=5,Object(u["exlout"])(n);case 5:r=a.sent,t.$convertRes2Blob(r),t.$message.success(t.$translateTitle("node.export success")),a.next=13;break;case 10:a.prev=10,a.t0=a["catch"](0),t.$message.error(t.$translateTitle("node.export error")+"".concat(a.t0));case 13:case"end":return a.stop()}}),a,null,[[0,10]])})))()},showInfo:function(e){this.ishard=!0,this.isfooter=!1;var t=e.status,a=void 0===t?0:t;this.detail=e,this.step=a+1,this.deviceFlag=!0},getStatus:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;switch(e){case 0:return"待分配";case 1:return"已分配";case 2:return"已处理";case 3:return"已结单";default:return e}},fetchData:function(){var e=arguments,t=this;return Object(i["a"])(l.a.mark((function a(){var n,r,i,s;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=e.length>0&&void 0!==e[0]?e[0]:{},r.limit||(r=t.queryForm),t.listLoading=!1,i=t.$baseColorfullLoading(),s={limit:r.limit,order:r.order,skip:r.skip,keys:r.keys,where:{number:t.queryForm.number.length?{$regex:t.queryForm.number}:{$ne:null},"info.productid":t.queryForm.product.length?t.queryForm.product:{$ne:"98"},type:t.queryForm.type.length?{$regex:t.queryForm.type}:{$ne:null}}},null!==(n=t.queryForm.searchDate)&&void 0!==n&&n.length&&(s.where["createdAt"]={$gt:{__type:"Date",iso:t.queryForm.searchDate[0]}},s.where["updatedAt"]={$lt:{__type:"Date",iso:t.queryForm.searchDate[1]}}),a.next=8,Object(c["query_object"])("Maintenance",s).then((function(e){var a=e.results,n=void 0===a?[]:a,r=e.count,s=void 0===r?0:r;t.list=n,t.list.forEach((function(e){if(e._user="暂无",e.ACL)for(var t in e.ACL)e._user=t.substr(5)})),t.total=s,i.close()})).catch((function(e){t.$message.error("".concat(e)),i.close()}));case 8:case"end":return a.stop()}}),a)})))()},prodChange:function(e){var t=this;return Object(i["a"])(l.a.mark((function a(){var n,r,i;return l.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.Device=[],n={where:{product:e}},a.next=4,Object(d["queryDevice"])(n);case 4:r=a.sent,i=r.results,t.Device=i;case 7:case"end":return a.stop()}}),a)})))()},handleRemove:function(e){var t=this;this.form.photo.forEach((function(a,n){a.split("/")["".concat(a.split("/").length-1)]==e.name&&t.form.photo.splice(n,1)}))},handleSizeChange:function(e){this.queryForm.limit=e,this.fetchData()},handleCurrentChange:function(e){this.queryForm.skip=(e-1)*this.queryForm.limit,this.fetchData()}}},h=f,b=(a("ed3c"),a("bdd7")),g=Object(b["a"])(h,n,r,!1,null,"50f01b62",null);t["default"]=g.exports},e6d6:function(e,t,a){"use strict";a("74f5")},e915:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.detail?a("div",{staticClass:"changeInfo"},[a("el-row",{directives:[{name:"show",rawName:"v-show",value:1==e.showHard,expression:"showHard == true"}],staticClass:"row-bg",attrs:{justify:"space-around",type:"flex"}},[a("el-col",{attrs:{span:6}},[a("div",{staticClass:"grid-content bg-purple"},[e._v(" "+e._s(e.$translateTitle("Maintenance.Ticket number"))+" : "+e._s(e.detail.number)+" ")])]),a("el-col",{attrs:{span:5}},[a("div",{staticClass:"grid-content bg-purple-light"},[e._v(" "+e._s(e.$translateTitle("Maintenance.Ticket type"))+" : "+e._s(e.detail.type)+" ")])]),a("el-col",{attrs:{span:7}},[a("div",{staticClass:"grid-content bg-purple"},[e._v(" "+e._s(e.$translateTitle("Maintenance.the starting time"))+" : "+e._s(e.$moment(e.detail.createdAt).format("YYYY-MM-DD HH:mm:ss"))+" ")])])],1),a("el-steps",{directives:[{name:"show",rawName:"v-show",value:1==e.showHard,expression:"showHard == true"}],staticClass:"steps",attrs:{active:e.step,"finish-status":"success",simple:""}},[a("el-step",{attrs:{title:e.$translateTitle("Maintenance.To be assigned")}}),a("el-step",{attrs:{title:e.$translateTitle("Maintenance.Assigned")}}),a("el-step",{attrs:{title:e.$translateTitle("Maintenance.Processed")}}),a("el-step",{attrs:{title:e.$translateTitle("Maintenance.Statement")}})],1),1===e.step?a("step1",{ref:"step1",attrs:{detail:e.detail,"show-footer":e.showFooter,"show-hard":e.showHard,step:e.step},on:{"change-step":e.handleSetStep}}):e._e(),2===e.step?a("step2",{ref:"step2",attrs:{detail:e.detail,"show-footer":e.showFooter,"show-hard":"showHard",step:e.step},on:{"change-step":e.handleSetStep}}):e._e(),3===e.step?a("step3",{ref:"step3",attrs:{detail:e.detail,"show-footer":e.showFooter,"show-hard":"showHard",step:e.step},on:{"change-step":e.handleSetStep}}):e._e(),4===e.step?a("Step4",{ref:"step4",attrs:{detail:e.detail,"show-footer":e.showFooter,"show-hard":"showHard",step:e.step},on:{"change-step":e.handleSetStep}}):e._e()],1):a("div",{staticClass:"empty"},[a("vab-empty")],1)},r=[],i=(a("d6a4"),a("f47e3")),s=a("4f46"),o=a("bacb"),l=a("34f5"),c={name:"ChangeInfo",components:{Step1:i["default"],Step2:s["default"],Step3:o["default"],Step4:l["default"]},props:{detail:{type:Object,default:function(){}},showFooter:{type:Boolean,default:!1},showHard:{type:Boolean,default:!1},step:{type:Number,default:1}},data:function(){return{isStep:0}},mounted:function(){4==this.step&&(this.isStep=4)},methods:{next:function(){this.isStep++>5&&(this.isStep=0)},handleSetStep:function(e,t){t&&(this.form=Object.assign(this.form,t))}}},u=c,d=(a("4b37"),a("bdd7")),m=Object(d["a"])(u,n,r,!1,null,"769e66c8",null);t["default"]=m.exports},ea2b:function(e,t,a){},ec0d:function(e,t,a){},ecf4:function(e,t,a){"use strict";a("db6d")},ed3c:function(e,t,a){"use strict";a("94b8")},f2b6:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mycontainer"},[a("div",{staticClass:"ticker-dialog"},[a("el-dialog",{directives:[{name:"drag",rawName:"v-drag"}],attrs:{"append-to-body":!0,visible:e.parserView},on:{"update:visible":function(t){e.parserView=t}}},[a("ele-form",e._b({attrs:{config:e.formConfig,pure:"","request-fn":e.handleSubmit},on:{"request-success":function(t){return e.handleSuccess(e.alertConfig)}},model:{value:e.alertConfig.config,callback:function(t){e.$set(e.alertConfig,"config",t)},expression:"alertConfig.config"}},"ele-form",e.alertConfig.config,!1))],1),a("el-dialog",{directives:[{name:"drag",rawName:"v-drag"}],attrs:{"append-to-body":!0,visible:e.dynamicformView,width:"50vh"},on:{"update:visible":function(t){e.dynamicformView=t}}},[a("el-form",[a("el-form-item",{attrs:{label:"设备名称","label-width":"200"}},[a("span",[e._v(e._s(e.devicename))])])],1),e._l(e.dynamicformInfo,(function(t){return a("el-form",{key:t.key,ref:"dynamicformInfo",refInFor:!0},[a("el-form-item",{attrs:{label:t.key}},[a("el-link",{attrs:{type:"success"}},[e._v(" "+e._s(t.value)+" ")])],1)],1)})),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-form",[a("el-form-item",{attrs:{label:e.$translateTitle("alert.Alarm status")}},[a("el-radio",{attrs:{label:"1"},model:{value:e.status,callback:function(t){e.status=t},expression:"status"}},[e._v("已处理")]),a("el-radio",{attrs:{label:"2"},model:{value:e.status,callback:function(t){e.status=t},expression:"status"}},[e._v("误报")])],1),a("el-form-item",{attrs:{label:e.$translateTitle("alert.Alarm handling"),"label-width":"200"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.process,callback:function(t){e.process=t},expression:"process"}})],1)],1),a("el-button",{on:{click:function(t){e.dynamicformView=!1}}},[e._v(" "+e._s(e.$translateTitle("button.cancel"))+" ")]),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.submitAlert(e.alertId)}}},[e._v(" "+e._s(e.$translateTitle("button.submit"))+" ")])],1)],2)],1),a("vab-query-form",{staticClass:"query-form"},[a("vab-query-form-top-panel",[a("el-form",{attrs:{inline:!0,"label-width":"auto",model:e.queryForm,size:"mini"},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",{attrs:{label:e.$translateTitle("alert.productname")}},[a("el-select",{attrs:{clearable:"",placeholder:e.$translateTitle("equipment.entername")},model:{value:e.queryForm.productName,callback:function(t){e.$set(e.queryForm,"productName",t)},expression:"queryForm.productName"}},e._l(e._Product,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.objectId}})})),1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("alert.isprocess")}},[a("el-select",{attrs:{clearable:"",placeholder:e.$translateTitle("alert.isprocess")},model:{value:e.queryForm.isprocess,callback:function(t){e.$set(e.queryForm,"isprocess",t)},expression:"queryForm.isprocess"}},e._l(e.processAll,(function(e,t){return a("el-option",{key:t,attrs:{label:e.key,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.times")}},[a("el-date-picker",{attrs:{"end-placeholder":e.$translateTitle("Maintenance.end time"),format:"yyyy-MM-dd","start-placeholder":e.$translateTitle("Maintenance.start time"),type:"daterange","value-format":"yyyy-MM-dd"},model:{value:e.queryForm.searchDate,callback:function(t){e.$set(e.queryForm,"searchDate",t)},expression:"queryForm.searchDate"}})],1),a("el-form-item",[a("el-button",{attrs:{icon:"el-icon-search",type:"primary"},nativeOn:{click:function(t){return e.fetchData.apply(null,arguments)}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.search"))+" ")])],1),a("el-form-item",[a("el-button",{attrs:{disabled:!e.selectedList.length,icon:"el-icon-delete",type:"danger"},on:{click:function(t){return e.fetchDelete(e.selectedList)}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.delete"))+" ")])],1)],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.list,height:e.height},on:{"selection-change":e.changeBox},scopedSlots:e._u([{key:"empty",fn:function(){return[a("vab-empty")]},proxy:!0}])},[a("el-table-column",{attrs:{align:"center","class-name":"isCheck","show-overflow-tooltip":"",type:"selection",width:"55"}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("alert.alert number"),prop:"objectId","show-overflow-tooltip":"",sortablesortable:"",width:"120"}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("alert.productname"),prop:"productname","show-overflow-tooltip":"",sortable:""}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("alert.devicename"),prop:"devicename","show-overflow-tooltip":"",sortable:""}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("equipment.createdAt"),"show-overflow-tooltip":"",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(e.$moment(a.createdAt).format("YYYY-MM-DD HH:mm:ss"))+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("alert.Alarm status"),"show-overflow-tooltip":"",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-tag",{attrs:{effect:"dark",type:n.alertstatus?"danger":"success"}},[e._v(" "+e._s(n.alertstatus?e.$translateTitle("alert.start"):e.$translateTitle("alert.stop"))+" ")])]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("alert.Alarm handling"),"show-overflow-tooltip":"",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-link",{attrs:{effect:"dark",type:1==n.status?"success":"info"}},[e._v(" "+e._s(1==n.status?e.$translateTitle("Maintenance.Processed"):0==n.status?e.$translateTitle("Maintenance.Untreated"):e.$translateTitle("Maintenance.Distort"))+" ")])]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("alert.process"),prop:"process","show-overflow-tooltip":"",sortable:""}}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("Maintenance.operating"),prop:"name","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.showdynamicform(n.objectId,n.Public,n.dynamicform,n.process,n.status,n.devicename)}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.View"))+" ")]),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleDelete(n.objectId)}}},[e._v(" "+e._s(e.$translateTitle("Maintenance.delete"))+" ")])]}}])})],1),a("VabPagination",{directives:[{name:"show",rawName:"v-show",value:e.total,expression:"total"}],attrs:{limit:e.queryForm.pageSize,page:e.queryForm.pageNo,total:e.total},on:{"update:limit":function(t){return e.$set(e.queryForm,"pageSize",t)},"update:page":function(t){return e.$set(e.queryForm,"pageNo",t)},pagination:e.fetchData}})],1)},r=[],i=a("e636"),s=a("fb07"),o=a("e97b"),l=a("d0d7"),c=a.n(l),u=(a("3dec"),a("9c6a"),a("d6a4"),a("1d17"),a("4c87"),a("f1e1"),a("c4bc"),a("79da"),a("16b8"),a("e170"),a("4569")),d=a("dcc6"),m=a("7212"),p=a("5880"),f=a("adc7"),h={name:"Index",components:{},data:function(){return{selectedList:[],isDisable:!1,parserView:!1,dynamicformView:!1,formConfig:{},alertConfig:{},dynamicformInfo:{},alertId:"",step:1,detail:{},deviceFlag:!1,AllDevice:[],height:this.$baseTableHeight(0),dialogFormVisible:!1,types:["故障维修"],Device:[],dialogImageUrl:"",dialogVisible:!1,disabled:!1,formLabelWidth:"140px",process:"",status:"",devicename:"",rules:{product:[{required:!0,message:"请选择活动区域",trigger:"change"}],name:[{required:!0,message:"请选择活动区域",trigger:"change"}],type:[{required:!0,message:"请选择活动资源",trigger:"change"}]},processAll:[{key:"未处理",value:0},{key:"已处理",value:1},{key:"误报",value:2}],list:[],listLoading:!1,layout:"total, sizes, prev, pager, next, jumper",total:0,queryForm:{productName:"",isprocess:"",number:"",product:"",type:"",searchDate:[],limit:20,skip:0,order:"-createdAt",keys:"count(*)"}}},computed:Object(o["a"])({},Object(p["mapGetters"])({_Product:"user/_Product",objectId:"user/objectId",role:"acl/role",username:"user/username"})),created:function(){},mounted:function(){this.fetchData()},methods:{fetchDelete:function(e){var t=this,a=[];e.forEach((function(e){a.push({method:"DELETE",path:"/classes/Notification/".concat(e.objectId),body:{}})})),this.$baseConfirm(this.$translateTitle("Maintenance.Are you sure you want to delete the current item"),null,Object(s["a"])(c.a.mark((function e(){return c.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(d["batch"])(a);case 2:e.sent,t.$baseMessage(t.$translateTitle("Maintenance.successfully deleted"),"success","vab-hey-message-success"),setTimeout((function(){t.fetchData()}),1500);case 5:case"end":return e.stop()}}),e)}))))},handleSubmit:function(e){return f["Promise"].resolve()},handleSuccess:function(e){var t=this;return Object(s["a"])(c.a.mark((function a(){var n,r,i;return c.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(n=e.table,r={public:!0},n){a.next=4;break}return a.abrupt("return");case 4:return i=t.$baseColorfullLoading(3),a.prev=5,a.next=8,t.$update_object(n,t.alertId,r);case 8:a.sent,i.close(),a.next=16;break;case 12:a.prev=12,a.t0=a["catch"](5),i.close(),t.$message.error("".concat(a.t0));case 16:t.$nextTick((function(){t.parserView=!1,t.fetchData()}));case 17:case"end":return a.stop()}}),a,null,[[5,12]])})))()},changeBox:function(e){var t=this;this.selectedList=[],e.forEach((function(e){t.selectedList.push(e)}))},submitAlert:function(e){var t=this;return Object(s["a"])(c.a.mark((function a(){var n,r;return c.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=t.$baseColorfullLoading(4),n.close(),r={process:t.process,status:Number(t.status)},a.prev=3,a.next=6,Object(u["putNotification"])(e,r);case 6:a.sent,t.$message.success("处理成功"),a.next=13;break;case 10:a.prev=10,a.t0=a["catch"](3),t.$message.error("处理失败");case 13:t.fetchData(),t.dynamicformView=!1;case 15:case"end":return a.stop()}}),a,null,[[3,10]])})))()},showdynamicform:function(e,t,a,n,r,i){this.alertId=e,this.isDisable=t,this.process=n,this.status=String(r),this.devicename=i;var s=[];for(var o in a)for(var l in a[o]){var c={key:l,value:a[o][l]};s.push(c)}this.dynamicformInfo=s,this.dynamicformView=!0},showInfo:function(e,t,a){var n=this;return Object(s["a"])(c.a.mark((function r(){var s,o,l,u,d,p,f,h,b,g,v,y,w;return c.a.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return s=n.$baseColorfullLoading(4),o=e.split("_"),l=Object(i["a"])(o,2),u=l[0],d=l[1],n.alertId=a,r.prev=3,r.next=6,Object(m["getProduct"])(u);case 6:p=r.sent,f=p.config,s.close(),h=f.parser,b=void 0===h?[]:h,g=f.profile,v=void 0===g?[]:g,y=[].concat(v,b),w=y.map((function(e){if(e.uid==d)return e})),n.formConfig=w[0].config,n.alertConfig=w[0],r.next=20;break;case 16:r.prev=16,r.t0=r["catch"](3),s.close(),n.$message.error("".concat(r.t0));case 20:n.formConfig=_.merge(t,n.formConfig),n.$nextTick((function(){n.parserView=!0}));case 22:case"end":return r.stop()}}),r,null,[[3,16]])})))()},handleDelete:function(e){var t=this;return Object(s["a"])(c.a.mark((function a(){var n;return c.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(u["delNotification"])(e);case 2:n=a.sent,n=={}&&t.$message.success(t.$translateTitle("Maintenance.delete")+$translateTitle("message.success")),t.fetchData();case 5:case"end":return a.stop()}}),a)})))()},fetchData:function(){var e=arguments,t=this;return Object(s["a"])(c.a.mark((function a(){var n,r,i;return c.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=e.length>0&&void 0!==e[0]?e[0]:{},n.limit||(n=t.queryForm),t.listLoading=!1,r=t.$baseColorfullLoading(3),i={limit:n.limit,order:n.order,skip:n.skip,keys:n.keys,productid:t.queryForm.productName?t.queryForm.productName:"all",isprocess:t.queryForm.isprocess,include:"",where:{objectId:t.queryForm.number.length?{$regex:t.queryForm.number}:{$ne:null}}},t.queryForm.searchDate.length&&(i.where["createdAt"]={$gt:{__type:"Date",iso:t.queryForm.searchDate[0]}},i.where["updatedAt"]={$lt:{__type:"Date",iso:t.queryForm.searchDate[1]}}),a.next=8,Object(u["queryNotification"])(i).then((function(e){var a=e.results,n=void 0===a?[]:a,i=e.count,s=void 0===i?0:i;t.list=n,t.total=s,r.close()})).catch((function(e){t.$message.error("".concat(e)),r.close()}));case 8:case"end":return a.stop()}}),a)})))()},prodChange:function(e){var t=this;return Object(s["a"])(c.a.mark((function a(){var n,r,i;return c.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.Device=[],n={where:{product:e}},a.next=4,queryDevice(n);case 4:r=a.sent,i=r.results,t.Device=i;case 7:case"end":return a.stop()}}),a)})))()},handleRemove:function(e){var t=this;this.form.photo.forEach((function(a,n){a.split("/")["".concat(a.split("/").length-1)]==e.name&&t.form.photo.splice(n,1)}))},handleSizeChange:function(e){this.queryForm.limit=e,this.fetchData()},handleCurrentChange:function(e){this.queryForm.skip=(e-1)*this.queryForm.limit,this.fetchData()}}},b=h,g=(a("d2ec"),a("bdd7")),v=Object(g["a"])(b,n,r,!1,null,"600ea346",null);t["default"]=v.exports},f47e3:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:e.$translateTitle("Maintenance.Work order information"),name:"first"}},[a("el-form",{ref:"form",staticClass:"create-ticker",attrs:{"label-width":"auto",model:e.form,rules:e.rules,size:"medium "}},[a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{lg:12,md:12,sm:24,xl:12,xs:24}},[a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.project")+": "}},[a("span",[e._v(e._s(e.form.info.productname))])])],1),a("el-col",{attrs:{lg:12,md:12,sm:24,xl:12,xs:24}},[a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.Equipment name")+": "}},[a("span",[e._v(e._s(e.form.info.devicename))])])],1),a("el-col",{attrs:{lg:12,md:12,sm:24,xl:12,xs:24}},[a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.Initiator")+": "}},[a("span",[e._v(e._s(e.form.info.createdname))])])],1),a("el-col",{attrs:{lg:24,md:24,sm:24,xl:24,xs:24}},[a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.Ticket description")+": "}},[e._v(" "+e._s(e.form.info.description)+" ")])],1),a("el-col",{attrs:{lg:24,md:24,sm:24,xl:24,xs:24}},[a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.photo")+": "}},[a("el-carousel",{attrs:{height:"200px",interval:2e3,type:"card"}},e._l(e.form.info.photo,(function(e,t){return a("el-carousel-item",{key:t},[a("img",{staticStyle:{width:"100%",height:"100%"},attrs:{alt:e,src:e,title:e}})])})),1)],1)],1),e.showFooter?a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.Remarks")}},[a("el-input",{staticStyle:{"margin-bottom":"20px"},attrs:{placeholder:e.$translateTitle("Maintenance.Please record the processing content in detail!"),type:"textarea"},model:{value:e.form.info.step1.Remarks,callback:function(t){e.$set(e.form.info.step1,"Remarks",t)},expression:"form.info.step1.Remarks"}})],1)],1):e._e(),e.showFooter?a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.$translateTitle("Maintenance.Maintenance staff"),prop:"info.receiveusername",required:""}},[a("el-tree",{ref:"workGroup",staticStyle:{float:"left",width:"50%"},attrs:{data:e.deptTreeData,"default-expand-all":"","expand-on-click-node":!1,"node-key":"index",props:e.roleProps},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.node,r=t.data;return a("div",{staticClass:"custom-tree-node"},[a("span",{class:{selected:r.objectId==e.curDepartmentId},on:{click:function(t){return e.handleNodeClick(r,n)}}},[e._v(" "+e._s(n.label)+" ")])])}}],null,!1,2722443036)}),a("el-select",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"50%"},attrs:{disabled:!e.user.length,"element-loading-background":"rgba(0, 0, 0, 0.8)","element-loading-spinner":"el-icon-loading","element-loading-text":e.$translateTitle("developer.Data is loading"),placeholder:e.$translateTitle("product.selectdepartment")},model:{value:e.form.info.receiveusername,callback:function(t){e.$set(e.form.info,"receiveusername",t)},expression:"form.info.receiveusername"}},e._l(e.user,(function(t){return a("el-option",{key:t.objectId,attrs:{label:t.nick,value:t.objectId}},[a("span",{staticStyle:{float:"left"}},[e._v(e._s(t.nick))]),a("span",{staticStyle:{float:"right","font-size":"14px",color:"#8492a6"}},[e._v(" "+e._s(t.objectId)+" ")])])})),1)],1)],1):e._e()],1)],1)],1),a("el-tab-pane",{staticStyle:{height:"90%","overflow-x":"hidden","overflow-y":"auto"},attrs:{label:e.$translateTitle("Maintenance.work process"),name:"second"}},[a("el-card",{attrs:{shadow:"hover"},scopedSlots:e._u([{key:"header",fn:function(){return[a("el-radio-group",{staticClass:"card-header-radio",model:{value:e.reverse,callback:function(t){e.reverse=t},expression:"reverse"}},[a("el-radio",{attrs:{label:!0}},[e._v(" "+e._s(e.$translateTitle("Maintenance.Positive order"))+" ")]),a("el-radio",{attrs:{label:!1}},[e._v(" "+e._s(e.$translateTitle("Maintenance.Reverse order"))+" ")])],1)]},proxy:!0}])},[a("el-timeline",{attrs:{reverse:e.reverse}},e._l(e.form.info.timeline,(function(t){return a("el-timeline-item",{key:t.timestamp,attrs:{placement:"top",timestamp:t.timestamp}},[a("el-card",[a("h4",[e._v(e._s(t.h4))]),a("p",[e._v(e._s(t.p))])])],1)})),1)],1)],1)],1)],1)},r=[],i=a("fb07"),s=a("e97b"),o=a("d0d7"),l=a.n(o),c=(a("d6a4"),a("16b8"),a("a0e0"),a("3dec"),a("f1e1"),a("0941")),u=a("5da95"),d=a("bc35"),m=a("5880"),p={props:{detail:{type:Object,default:function(){}},step:{type:Number,default:1},showFooter:{type:Boolean,default:!1},showHard:{type:Boolean,default:!1}},data:function(){return{roleName:"",loading:!1,user:[],deptTreeData:[],reverse:!0,roleProps:{children:"children",label:"name"},rules:{reverse:!0,"info.receiveusername":[{required:!0,message:"请选择分配人员",trigger:"change"}]},curDepartmentId:"",activeName:"first",form:this.detail}},computed:Object(s["a"])({},Object(m["mapGetters"])({username:"user/username",token:"user/token",objectId:"user/objectId"})),mounted:function(){this.getRoletree()},methods:Object(s["a"])(Object(s["a"])({},Object(m["mapMutations"])({set_deviceFlag:"global/set_deviceFlag",set_deviceStep:"global/set_deviceStep"})),{},{getRoletree:function(){var e=this;return Object(i["a"])(l.a.mark((function t(){return l.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(d["Roletree"])().then((function(t){e.deptTreeData=t.results,e.handleNodeClick(t.results[0],0)})).catch((function(e){}));case 2:case"end":return t.stop()}}),t)})))()},handleNodeClick:function(e,t){var a=this;return Object(i["a"])(l.a.mark((function t(){var n,r;return l.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a.loading=!0,a.curDepartmentId=e.objectId,a.user=[],a.roleName=e.name,t.next=6,Object(u["queryRoledepartment"])({name:e.name});case 6:n=t.sent,r=n.users,a.user=r,a.loading=!1;case 10:case"end":return t.stop()}}),t)})))()},dispatchUser:function(){var e=this;this.$refs["form"].validate(function(){var t=Object(i["a"])(l.a.mark((function t(a){var n,r,i,s,o,u,d,m;return l.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.user.filter((function(t){return t.objectId==e.form.info.receiveusername})),!a||!e.form.info.receiveusername){t.next=17;break}return r={},i=e.form,s=i.objectId,o=i.info,u=i.ACL,i.user,o.timeline.push({timestamp:moment(new Date).format("YYYY-MM-DD HH:mm:ss"),h4:"已分配",p:"".concat(e.username," 分配给 ").concat(n[0].nick)}),o.receiveusername=n[0].nick,o.receiveuseid=n[0].objectId,o.receiveuserphone=n[0].phone,r["".concat(n[0].objectId)]={read:!0,write:!0},r["role:".concat(e.roleName)]={read:!0,write:!0},d={status:1,info:o,ACL:_.merge(r,u),user:{objectId:n[0].objectId,__type:"Pointer",className:"_User"}},t.next=13,Object(c["update_object"])("Maintenance",s,d);case 13:m=t.sent,m.updatedAt&&(e.set_deviceFlag(!1),e.set_deviceStep(-1)),t.next=19;break;case 17:return e.$message.error("请选择分配人员"),t.abrupt("return",!1);case 19:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}})},f=p,h=(a("829f"),a("bdd7")),b=Object(h["a"])(f,n,r,!1,null,"14106efb",null);t["default"]=b.exports},f5a9:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"system-log-container"},[a("vab-query-form",[a("vab-query-form-top-panel",[a("el-form",{attrs:{inline:!0,"label-width":"60px",model:e.queryForm},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",{attrs:{label:"账号"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入账号"},model:{value:e.queryForm.account,callback:function(t){e.$set(e.queryForm,"account","string"===typeof t?t.trim():t)},expression:"queryForm.account"}})],1),a("el-form-item",{attrs:{label:"周期"}},[a("el-date-picker",{attrs:{"end-placeholder":"结束日期",format:"yyyy-MM-dd","start-placeholder":"开始日期",type:"daterange","value-format":"yyyy-MM-dd"},model:{value:e.queryForm.searchDate,callback:function(t){e.$set(e.queryForm,"searchDate",t)},expression:"queryForm.searchDate"}})],1),a("el-form-item",[a("el-button",{attrs:{icon:"el-icon-search",type:"primary"},nativeOn:{click:function(t){return e.queryData.apply(null,arguments)}}},[e._v(" 查询 ")])],1)],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.list},scopedSlots:e._u([{key:"empty",fn:function(){},proxy:!0}])},[a("el-table-column",{attrs:{align:"center",label:"日志类型",prop:"type","show-overflow-tooltip":"",width:"230px"}}),a("el-table-column",{attrs:{align:"center",label:"账号",prop:"account","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{align:"center",label:"执行结果",prop:"executeResult","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return["登录成功"===n.executeResult?a("span",[a("span",{staticClass:"vab-dot vab-dot-success"},[a("span")]),e._v(" "+e._s(n.executeResult)+" ")]):a("span",[a("span",{staticClass:"vab-dot vab-dot-error"},[a("span")]),e._v(" "+e._s(n.executeResult)+" ")])]}}])}),a("el-table-column",{attrs:{align:"center",label:"登录IP",prop:"ip"}}),a("el-table-column",{attrs:{align:"center",label:"访问时间",prop:"datetime","show-overflow-tooltip":""}})],1),a("el-pagination",{attrs:{background:"","current-page":e.queryForm.pageNo,layout:e.layout,"page-size":e.queryForm.pageSize,total:e.total},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1)},r=[],i=a("fb07"),s=a("d0d7"),o=a.n(s),l=a("8781"),c={name:"SystemLog",data:function(){return{list:[],listLoading:!0,layout:"total, sizes, prev, pager, next, jumper",total:0,queryForm:{account:"",searchDate:"",pageNo:1,pageSize:20}}},created:function(){this.fetchData()},methods:{handleSizeChange:function(e){this.queryForm.pageSize=e,this.fetchData()},handleCurrentChange:function(e){this.queryForm.pageNo=e,this.fetchData()},queryData:function(){this.queryForm.pageNo=1,this.fetchData()},fetchData:function(){var e=this;return Object(i["a"])(o.a.mark((function t(){var a,n,r,i;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.listLoading=!0,t.next=3,Object(l["getList"])(e.queryForm);case 3:a=t.sent,n=a.data,r=n.list,i=n.total,e.list=r,e.total=i,e.listLoading=!1;case 10:case"end":return t.stop()}}),t)})))()}}},u=c,d=a("bdd7"),m=Object(d["a"])(u,n,r,!1,null,null,null);t["default"]=m.exports},fb77:function(e,t,a){},fe50:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"CloudSystem-container"},[a("div",{staticClass:"CloudSystem-content"},[e._v(" "+e._s(e.infoData)+" ")])])},r=[],i={name:"CloudSystem",components:{},data:function(){return{infoData:"CloudSystem"}},computed:{},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){},methods:{}},s=i,o=(a("c30a"),a("bdd7")),l=Object(o["a"])(s,n,r,!1,null,"e3e43272",null);t["default"]=l.exports}}]);