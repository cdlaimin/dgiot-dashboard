<!DOCTYPE html>
<html>
<head>
  <script src="https://unpkg.com/konva@7.2.5/konva.min.js"></script>
  <meta charset="utf-8"/>
  <title>Konva Zoom Image on Hover Demo</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background-color: #f0f0f0;
    }
  </style>
</head>
<body>
<div id="container"></div>
<script>
  var width = window.innerWidth
  var height = window.innerHeight

  //imageObj.src = 'https://konvajs.org/assets/yoda.jpg';

  // const json = '{"attrs":{"width":2382,"height":1684,"draggable":true},"className":"Stage","children":[{"attrs":{"hitGraphEnabled":false},"className":"Layer","children":[{"attrs":{},"className":"Image"},{"attrs":{"source":"https://konvajs.org/assets/yoda.jpg"},"className":"Image"}]},{"attrs":{},"className":"Layer","children":[{"attrs":{"draggable":true,"x":306,"y":303,"transformsEnabled":"position"},"className":"Group","children":[{"attrs":{"radius":20,"stroke":"#231fff","strokeWidth":4,"fill":"#ffffff"},"className":"Circle"},{"attrs":{"text":"1","fontSize":14,"originX":"center","originY":"center","fill":"#231fff","x":-5,"y":-5},"className":"Text"},{"attrs":{"data":"M.91,0H29.09A.91.91,0,0,1,30,.91v243a.88.88,0,0,1-.26.63L15.65,258.86a.9.9,0,0,1-1.3,0L.26,244.52a.88.88,0,0,1-.26-.63V.91A.91.91,0,0,1,.91,0Z","originX":"center","originY":"bottom","x":10,"y":15,"angle":-30,"fill":"#231fff","scaleX":0.15,"scaleY":0.15,"rotation":-30},"className":"Path"}]},{"attrs":{"draggable":true,"x":490,"y":557,"transformsEnabled":"position"},"className":"Group","children":[{"attrs":{"radius":20,"stroke":"#231fff","strokeWidth":4,"fill":"#ffffff"},"className":"Circle"},{"attrs":{"text":"2","fontSize":14,"originX":"center","originY":"center","fill":"#231fff","x":-5,"y":-5},"className":"Text"},{"attrs":{"data":"M.91,0H29.09A.91.91,0,0,1,30,.91v243a.88.88,0,0,1-.26.63L15.65,258.86a.9.9,0,0,1-1.3,0L.26,244.52a.88.88,0,0,1-.26-.63V.91A.91.91,0,0,1,.91,0Z","originX":"center","originY":"bottom","x":10,"y":15,"angle":-30,"fill":"#231fff","scaleX":0.15,"scaleY":0.15,"rotation":-30},"className":"Path"}]}]}]}'
  const json = '{"attrs":{"draggable":true,"height":767,"id":"current1","width":1836,"x":195.96326119532247,"y":-88.00001118213845},"className":"Stage","children":[{"attrs":{},"className":"Layer","children":[{"attrs":{"id":"e494d568c9","scaleX":0.4771162413932782,"scaleY":0.33855623950755453,"source":"http://flow.hzmctech.com/group1/group1/990.gif","text":"fdasfas","x":-189.9999999999999,"y":-117.00000000000006},"className":"Image"},{"attrs":{"borderDash":[5],"borderStroke":"#000","id":"Transformer_KuVF1b","keepRatio":false},"className":"Transformer"},{"attrs":{"borderDash":[5],"borderStroke":"#000","id":"Transformer_aORk08","keepRatio":false},"className":"Transformer"},{"attrs":{"borderDash":[5],"borderStroke":"#000","id":"Transformer_kbaR0k","keepRatio":false,"x":-96,"y":-16},"className":"Transformer"},{"attrs":{"borderDash":[5],"borderStroke":"#000","id":"Transformer_T5y6KT","keepRatio":false,"x":-96,"y":-16},"className":"Transformer"},{"attrs":{"id":"Group_kihipo","draggable":true},"className":"Group","children":[{"attrs":{"data":"M853.333333 480H544V170.666667c0-17.066667-14.933333-32-32-32s-32 14.933333-32 32v309.333333H170.666667c-17.066667 0-32 14.933333-32 32s14.933333 32 32 32h309.333333V853.333333c0 17.066667 14.933333 32 32 32s32-14.933333 32-32V544H853.333333c17.066667 0 32-14.933333 32-32s-14.933333-32-32-32z","originX":"center","originY":"bottom","id":"#dgiot-add-0","x":10,"y":15,"angle":-30,"scaleX":0.15,"scaleY":0.15,"className":"Path"},"className":"Path"}]},{"attrs":{"x":670,"y":546,"id":"Group_zKVLDZ","draggable":true},"className":"Group","children":[{"attrs":{"data":"M691.2 230.4a102.4 102.4 0 0 1 102.4 102.4v358.4a102.4 102.4 0 0 1-102.4 102.4H332.8a102.4 102.4 0 0 1-102.4-102.4V332.8a102.4 102.4 0 0 1 102.4-102.4h358.4z m0 51.2H332.8a51.2 51.2 0 0 0-51.072 47.36L281.6 332.8v358.4a51.2 51.2 0 0 0 47.36 51.072L332.8 742.4h358.4a51.2 51.2 0 0 0 51.072-47.36L742.4 691.2V332.8a51.2 51.2 0 0 0-47.36-51.072L691.2 281.6z","originX":"center","originY":"bottom","id":"#dgiot-fensantiaodu-0","x":10,"y":15,"angle":-30,"fill":"#429FEE","scaleX":0.15,"scaleY":0.15,"className":"Path"},"className":"Path"},{"attrs":{"data":"M716.8 486.4a76.8 76.8 0 0 1 76.8 76.8v153.6a76.8 76.8 0 0 1-76.8 76.8h-153.6a76.8 76.8 0 0 1-76.8-76.8v-153.6a76.8 76.8 0 0 1 76.8-76.8h153.6z m0 51.2h-153.6a25.6 25.6 0 0 0-25.4208 22.6048L537.6 563.2v153.6a25.6 25.6 0 0 0 22.6048 25.4208L563.2 742.4h153.6a25.6 25.6 0 0 0 25.4208-22.6048L742.4 716.8v-153.6a25.6 25.6 0 0 0-22.6048-25.4208L716.8 537.6z","originX":"center","originY":"bottom","id":"#dgiot-fensantiaodu-1","x":10,"y":15,"angle":-30,"fill":"#429FEE","scaleX":0.15,"scaleY":0.15,"className":"Path"},"className":"Path"}]},{"attrs":{"x":670,"y":546,"id":"Group_lAtxIq","draggable":true},"className":"Group","children":[{"attrs":{"data":"M642 162H382c-82.71 0-150 67.29-150 150v400c0 82.71 67.29 150 150 150h260c82.71 0 150-67.29 150-150V312c0-82.71-67.29-150-150-150z m90 550c0 49.624-40.376 90-90 90H382c-49.624 0-90-40.376-90-90V312c0-49.624 40.376-90 90-90h260c49.624 0 90 40.376 90 90v400z","originX":"center","originY":"bottom","id":"#dgiot-shubiao-0","x":10,"y":15,"angle":-30,"scaleX":0.15,"scaleY":0.15,"className":"Path"},"className":"Path"},{"attrs":{"data":"M482 292h60v130h-60z","originX":"center","originY":"bottom","id":"#dgiot-shubiao-1","x":10,"y":15,"angle":-30,"scaleX":0.15,"scaleY":0.15,"className":"Path"},"className":"Path"}]},{"attrs":{"x":670,"y":546,"id":"Group_GGIRTl","draggable":true},"className":"Group","children":[{"attrs":{"data":"M342 396.146h60v100h-60zM622 396.146h60v100h-60zM222 222h169.998v-60H162v230h60zM631.998 162v60H802v170h60V162zM222 632h-60v230h229.998v-60H222zM802 802H631.998v60H862V632h-60zM590.826 602.398c-18.296 23.528-46.777 38.748-78.826 38.748s-60.532-15.222-78.828-38.75l-42.644 42.646c29.341 34.309 72.888 56.104 121.472 56.104s92.131-21.794 121.47-56.104l-42.644-42.644z","originX":"center","originY":"bottom","id":"#dgiot-renlianshibie-0","x":10,"y":15,"angle":-30,"scaleX":0.15,"scaleY":0.15,"className":"Path"},"className":"Path"}]}]},{"attrs":{"id":"996"},"className":"Layer","children":[{"attrs":{"height":2000,"id":"switch","width":2000},"className":"Group","children":[{"attrs":{"draggable":true,"fill":"#000000","fontFamily":"Calibri","fontSize":15,"id":"day_electricity","text":"天发电量","type":"text","x":43,"y":424},"className":"Text"},{"attrs":{"container":"","draggable":true,"fill":"#000000","fontFamily":"Calibri","fontSize":26,"id":"total_power","text":"累计发电量","type":"text","x":396,"y":424},"className":"Text"},{"attrs":{"container":"","draggable":true,"fill":"#000000","fontFamily":"Calibri","fontSize":20,"id":"core_temperature","text":"内部温度","type":"text","x":760,"y":190},"className":"Text"},{"attrs":{"draggable":true,"fill":"#000000","fontFamily":"Calibri","fontSize":20,"id":"v_solarpanel","text":"太阳能板电压","type":"text","x":118,"y":474},"className":"Text"},{"attrs":{"draggable":true,"fill":"#000000","fontFamily":"Calibri","fontSize":20,"id":"i_out","text":"输出电流","type":"text","x":795,"y":348},"className":"Text"},{"attrs":{"draggable":true,"fill":"#000000","fontFamily":"Calibri","fontSize":20,"id":"v_out","text":"输出电压","type":"text","x":797,"y":310},"className":"Text"},{"attrs":{"draggable":true,"fill":"#000000","fontFamily":"Calibri","fontSize":20,"id":"battery_voltage","text":"电池电压","type":"text","x":764,"y":163},"className":"Text"},{"attrs":{"draggable":true,"fill":"#000000","fontFamily":"Calibri","fontSize":26,"id":"runtime","text":"运行时长","type":"text","x":726,"y":425},"className":"Text"}]}]},{"attrs":{},"className":"Layer","children":[]}]}'
  const stage = Konva.Node.create(json, 'container')

  stage.find('Image').forEach((node) => {
    const img = new Image()
    img.src = node.getAttr('source')
    img.onload = () => {
      node.image(img)
      stage.batchDraw()
    }
  })
  console.log(stage.toJSON())
</script>
</body>
</html>
